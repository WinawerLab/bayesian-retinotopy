(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    274256,       6281]
NotebookOptionsPosition[    269873,       6138]
NotebookOutlinePosition[    270911,       6169]
CellTagsIndexPosition[    270868,       6166]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
V1, V2, and V3 Retinotopic Maps:
Visualizations\
\>", "Title"],

Cell[TextData[{
 "Noah C. Benson",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]]],
 ", Geoff K. Aguirre",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "2"], TraditionalForm]]],
 ", Jonathan Winawer",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", 
    RowBox[{"1", ",", "3"}]], TraditionalForm]]],
 "\[LineSeparator]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]],
  FontSize->18],
 StyleBox["Department of Psychology, New York University, New York, NY, USA\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "2"], TraditionalForm]],
  FontSize->18],
 StyleBox["Department of Neurology, University of Pennsylvania, Philadelphia, \
PA, USA\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "3"], TraditionalForm]],
  FontSize->18],
 StyleBox["Center for Neural Sciences, New York University, New York, NY, USA",
  FontSize->18]
}], "Chapter"],

Cell[CellGroupData[{

Cell["Header", "Chapter"],

Cell["\<\
This section includes all code that:
  (a) defines a piece of data
  (b) configures the environment
  (c) constructs a library of tools for visualization and analysis
All code in this section should either run very quickly or should be defined \
using MemoizeSafe, AutoCache, and/or AutoManageData so as to run immediately \
and load data or perform calculations lazily when requested. Accordingly, \
this section should evaluate quickly, much like loading a project library.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Introduction", "Subchapter"],

Cell[CellGroupData[{

Cell["Dependencies", "Section"],

Cell[BoxData[{
 RowBox[{"<<", "ErrorBarPlots`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Neurotica`"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Paths", "Section"],

Cell["\<\
This notebook expects to be able to access data in the V123 data root, the \
contents of which can be downloaded from the open science framework \
(http://osf.io/). If you have the V123_DATA_ROOT environment variable set \
correctly, or if this notebook is in the root, then this cell should find the \
root fine; otherwise, you may need to set it manually.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$DataRoot", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$DataRoot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"env", "=", 
         RowBox[{"Environment", "[", "\"\<V123_DATA_ROOT\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"loc", "=", 
         RowBox[{"Quiet", "@", 
          RowBox[{"Check", "[", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", "$Failed"}], 
           "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"env", "=!=", "$Failed"}], ",", "env", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<analyses\>\""}], "}"}], "]"}], ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<freesurfer_subjects\>\""}], "}"}], 
              "]"}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "loc", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "True", ",", "$Failed"}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input"],

Cell["\<\
These data simply define directories in terms of the above data root:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FreeSurferRoot", ",", "$AnalysesRoot", ",", "$RetinotopyRoot", ",", 
    "$FigureRoot"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FreeSurferRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<freesurfer_subjects\>\""}], "}"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AnalysesRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<analyses\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<retinotopy\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<retinotopy\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing Data", "Subchapter"],

Cell["\<\
In this section of the notebook, we import the data from the retinotopy and \
analyses directories; we setup subject datasets according to these \
\>", "Text"],

Cell[CellGroupData[{

Cell["The list of subjects", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Subjects", ",", "$SubjectDatasets"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Subjects", ":=", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FileNames", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$RetinotopyRoot", ",", "\"\<S*\>\""}], "}"}], "]"}]}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$SubjectDatasets", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "\[Rule]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fs", "=", 
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FileNames", "@", 
                RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                  "$RetinotopyRoot", ",", "sub", ",", 
                   "\"\<lh_*_angle.mgz\>\""}], "}"}], "]"}]}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Union", "@", 
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "5"}], "}"}]}], "]"}], "&"}], "/@", 
              "fs"}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"sub", ",", "$Subjects"}], "}"}]}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading subject surface data", "Section"],

Cell["\<\
These cells just import the mgz files in the analyses directory and organize \
them into a convenient data structure.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "SubjectRetinotopyData", ",", "SubjectAnalysesData", ",", "SubjectData"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubjectRetinotopyData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FileNames", "@", 
               RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "$RetinotopyRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                  RowBox[{"StringJoin", "@", 
                   RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                    "\"\<:*\>\""}], ",", 
                    RowBox[{"#1", "<>", "\"\<.mgz\>\""}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\"\<_\>\""}], "]"}]}]}], "}"}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<prfsz\>\"", ",", 
            "\"\<vexpl\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<PRFSize\>\"", ",", "\"\<VarianceExplained\>\""}], "}"}]}], 
         "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectAnalysesData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "@", 
           RowBox[{"Rule", "[", "\[IndentingNewLine]", 
            RowBox[{"#2", ",", "\[IndentingNewLine]", 
             RowBox[{"Import", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                  RowBox[{"StringJoin", "@", 
                   RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    "\"\<.predict_\>\"", ",", "\[IndentingNewLine]", "#1", 
                    ",", "\"\<.\>\"", ",", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], ",", 
                    "\"\<.mgz\>\""}], "]"}]}]}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<v123roi\>\""}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
              "\"\<VisualArea\>\""}], "}"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ds", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"Outer", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "@", 
              RowBox[{"Rule", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Magnification\>\"", "<>", "#1", "<>", "#2"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Import", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"FileNameJoin", "@", 
                   RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
                    "\"\<.cm_\>\"", "<>", 
                    RowBox[{"ToLowerCase", "[", "#1", "]"}], "<>", 
                    "\"\<_\>\"", "<>", 
                    RowBox[{"ToLowerCase", "[", "#2", "]"}], "<>", 
                    "\"\<.mgz\>\""}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                 "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Pial\>\"", ",", "\"\<White\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", 
               "\"\<Tangential\>\""}], "}"}], ",", "\[IndentingNewLine]", "1",
              ",", "1"}], "]"}]}]}], "]"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rdat", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"adat", "=", 
          RowBox[{"SubjectAnalysesData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rgs", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ags", "=", 
          RowBox[{"SubjectAnalysesData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"This", " ", "is", " ", "the", " ", "vexpl"}], "-", "to", 
           "-", 
           RowBox[{
           "weight", " ", "transform", " ", "used", " ", "in", " ", "the", 
            " ", "python", " ", "library", " ", "v123"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"vexplToWeight", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"#", ">", "0.2"}], "&"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Erf", "@", 
              RowBox[{"Times", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"InverseErf", "[", "0.5", "]"}], "/", 
                 RowBox[{"Median", "[", "w", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Unitize", "[", "#", "]"}], "*", "#"}]}], "]"}]}]}], 
            "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<PRFSize\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<VarianceExplained\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Weight\>\"", "\[Rule]", 
             RowBox[{"vexplToWeight", "@", 
              RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}]}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<PredictedPolarAngle\>\"", "\[Rule]", 
             RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<PredictedEccentricity\>\"", "\[Rule]", 
             RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<PredictedVisualArea\>\"", "\[Rule]", 
             RowBox[{"adat", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldPolarAngle\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldEccentricity\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldPRFSize\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldVarianceExplained\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldWeight\>\"", "\[Rule]", 
             RowBox[{"vexplToWeight", "@", 
              RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nm", "\[Rule]", 
             RowBox[{"ags", "[", "nm", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"nm", ",", 
              RowBox[{"Join", "@@", 
               RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\"\<Magnification\>\"", "<>", "#1", "<>", "#2"}], 
                  "&"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<White\>\"", ",", "\"\<Pial\>\""}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", 
                   "\"\<Tangential\>\""}], "}"}], ",", "\[IndentingNewLine]", 
                 "1", ",", "1"}], "]"}]}]}], "}"}]}], "]"}]}], "]"}]}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading subject meshes and maps", "Section"],

Cell["Here we just cache the FreeSurfer subject objects.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Subject", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Subject", "[", "sub_String", "]"}], ":=", 
    RowBox[{"FreeSurferSubject", "@", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"$FreeSurferRoot", ",", "sub"}], "}"}], "]"}]}]}], "]"}], 
  ";"}]}], "Input"],

Cell["\<\
Here, we create a subject mesh and apply all the subject\[CloseCurlyQuote]s \
data to it.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectMesh", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectMesh", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "surf_String", ",", "ds_Integer"}], 
     "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdat", "=", 
         RowBox[{"SubjectData", "[", 
          RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"msh", "=", 
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"Subject", "[", "sub", "]"}], ",", "hemi", ",", "surf"}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SetVertexProperties", "[", 
       RowBox[{"msh", ",", 
        RowBox[{"Normal", "[", "sdat", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input"],

Cell["\<\
This cell creates a template map projection that is a duplicate of the one \
found in the standard.ffm.gz file distributed with the Neuropythy library \
(this is the V123 model used in registration).\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SymToMap", ",", "SubjectMap"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymToMap", "::", "usage"}], "=", 
    "\"\<SymToMap[mesh, hemi] projects the given fsaverage_sym-aligned \
spherical mesh to a map; if hemi is RH, then reverses this so that it \
resembles a right-hemisphere projection.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymToMap", "[", 
     RowBox[{"mesh_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"map0", "=", 
        RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"Center", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"14.6527", ",", 
               RowBox[{"-", "79.1814"}], ",", 
               RowBox[{"-", "50.0635"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"66.23000", ",", 
               RowBox[{"-", "47.09000"}], ",", 
               RowBox[{"-", "58.28000"}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", "\"\<Equirectangular\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Radius", "\[Rule]", 
           RowBox[{"Quantity", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"Pi", "/", "4"}], "]"}], ",", "\"\<Radians\>\""}], 
            "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"hemi", "===", "LH"}], ",", "\[IndentingNewLine]", "map0", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"CorticalMap", "[", 
         RowBox[{"map0", ",", 
          RowBox[{"VertexCoordinates", "\[Rule]", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
             RowBox[{"VertexCoordinatesTr", "[", "map0", "]"}]}], "]"}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectMap", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
    RowBox[{"SymToMap", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SubjectMesh", "[", 
       RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "ds"}], "]"}], 
      ",", "\[IndentingNewLine]", "hemi"}], "]"}]}], "]"}], ";"}]}], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting/Analysis Code", "Subchapter",
 CellChangeTimes->{{3.662807324689231*^9, 3.662807328992319*^9}, 
   3.6628132807895737`*^9}],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.658508587333959*^9, 3.658508589721416*^9}, {
  3.662853387814995*^9, 3.662853389412607*^9}}],

Cell[CellGroupData[{

Cell["Default Styles for Figures", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FontFamily", ",", "$FontWeight", ",", "$FontSize", ",", "$BaseStyle"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontFamily", "=", "\"\<Helvetica Neue\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontWeight", "=", "\"\<Light\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontSize", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$BaseStyle", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{"$FontSize", ",", 
     RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}]}], "]"}]}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auto-Cache Exported Images", "Subsection",
 CellChangeTimes->{{3.662845319835968*^9, 3.6628453308192596`*^9}, {
  3.662853392948634*^9, 3.662853395036529*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"AutoCachePNG", ",", "AutoCachePDF"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePNG", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoCachePNG", "[", 
     RowBox[{"name_", ",", "code_"}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flnm", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"#", ",", 
               RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.png\>\""}], ",",
             "#", ",", 
            RowBox[{"#", "<>", "\"\<.png\>\""}]}], "]"}], "&"}], "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"Prepend", "[", 
             RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"img", "=", 
            RowBox[{"Image", "[", 
             RowBox[{"code", ",", 
              RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{"flnm", ",", "img", ",", "\"\<PNG\>\"", ",", 
             RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePDF", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoCachePDF", "[", 
    RowBox[{"name_", ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"flnm", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.pdf\>\""}], ",", 
           "#", ",", 
           RowBox[{"#", "<>", "\"\<.pdf\>\""}]}], "]"}], "&"}], "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Prepend", "[", 
            RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"img", "=", "code"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"flnm", ",", "img", ",", "\"\<PDF\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Color Functions", "Subsection",
 CellChangeTimes->{{3.676117055363916*^9, 3.676117057478757*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "RetinotopyColor", ",", "$CMagBlendColors", ",", "$PRFBlendColors"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RetinotopyColor", "::", "usage"}], "=", 
    "\"\<RetinotopyColor[\\\"PolarAngle\\\"] and \
RetinotopyColor[\\\"Eccentricity\\\"] both yield functions appropriate for \
use with CortexPlot and CortexPlot3D which deduce whether the map/mesh is a \
raw data or predicted mesh and color it appropriately. Color schemas \
\\\"Magnification\\\" and \\\"PRFSize\\\" also plot the appropriate data.\n\
RetinotopyColor[name -> \\\"PolarAngle\\\"] can alternately be used to tell \
RetinotopyColor that the property with the given name should be colored as if \
it were PolarAngle.\n\nThe following options may be used:\n * Range (default: \
Automatic) specifies that only the eccentricity range given will be plotted; \
this may be given as a single max eccentricity or as {min, max}.\n * \
Eccentricity, VisualArea, and Weights may all be given strings, which change \
the default name of the property used in determining whether a vertex should \
be plotted and its transparency.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "RetinotopyColor", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Eccentricity", "\[Rule]", "\"\<Eccentricity\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VisualArea", "\[Rule]", "\"\<VisualArea\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Weights", "\[Rule]", "\"\<Weight\>\""}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CMagBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4.0", ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"16.0", ",", "Yellow"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"64.0", ",", "White"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$PRFBlendColors", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.0", ",", "White"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"2.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"4.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"6.0", ",", "Black"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", ":", 
      RowBox[{
      "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
       "\"\<Magnification\>\"", "|", "\"\<CMag\>\"", "|", 
       "\"\<PRFSize\>\""}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"type", "\[Rule]", "type"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prop_String", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"type", ":", 
        RowBox[{
        "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
         "\"\<Magnification\>\"", "|", "\"\<PRFSize\>\""}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"range", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "90"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"n_", "?", "NumberQ"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "n"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eccenName", "=", 
        RowBox[{"OptionValue", "[", "Eccentricity", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"areasName", "=", 
        RowBox[{"OptionValue", "[", "VisualArea", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"weightName", "=", 
        RowBox[{"OptionValue", "[", "Weights", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vertexOkayFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", "eccenName"}], "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"NumberQ", "[", 
               RowBox[{"#", "[", "eccenName", "]"}], "]"}]}]}], ",", "False", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"range", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
               RowBox[{"#", "[", "eccenName", "]"}], "\[LessEqual]", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", "False", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"NumberQ", "@", 
                 RowBox[{"#", "[", "areasName", "]"}]}]}], "||", 
               RowBox[{
                RowBox[{"#", "[", "areasName", "]"}], "\[Equal]", "0"}]}], 
              ")"}]}], ",", "False", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
             RowBox[{
              RowBox[{"#", "[", "weightName", "]"}], "\[LessEqual]", "0"}]}], 
            ",", "False", ",", "\[IndentingNewLine]", "True", ",", "True"}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<CMag\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<Magnification\>\""}]}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$CMagBlendColors", ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<PRFSize\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$PRFBlendColors", ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Function", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\[IndentingNewLine]", "\"\<Curvature\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"CorticalColorData", "[", "type", "]"}], "[", 
                   RowBox[{"<|", 
                    RowBox[{"type", "\[Rule]", 
                    RowBox[{"#", "[", "prop", "]"}]}], "|>"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a Direction Compass on the Maps", "Subsection",
 CellChangeTimes->{{3.676119297276575*^9, 3.676119301843574*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "MapCompass", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapCompass", "::", "usage"}], "=", 
    "\"\<MapCompass[hemi] yields a Graphics object that represents the \
appropriate directions compass (dorsal/ventral, medial/lateral indicator) for \
the given hemisphere's map projections.\nMapCompass[hemi, style] uses the \
given style for the compass arrows.\nMapCompass accepts all the options \
appropriate for Graphics as well as the Style option, which may be a list of \
any options appropriate for Style; these are used to format the text.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MapCompass", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Options", "[", "Graphics", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Scale", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Center", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapCompass", "[", 
    RowBox[{
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", 
     RowBox[{"style_:", 
      RowBox[{"{", "White", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sty", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Style", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
            RowBox[{"FontSize", "\[Rule]", "$FontSize"}], ",", 
            RowBox[{"FontColor", "\[Rule]", "White"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}]}], "}"}]}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Scale", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", "10"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"medlat", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"center", "=", 
        RowBox[{"OptionValue", "[", "Center", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
         RowBox[{"{", "style", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"center", "+", 
             RowBox[{"xy", "*", "scale", "*", "0.9"}]}]}], "}"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"xy", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<D\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", "scale"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<V\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "scale"}]}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<L\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", 
               RowBox[{"-", "scale"}]}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "+", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<M\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", "scale"}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "-", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Common Patterns", "Subsection"],

Cell["\<\
These variables are common patterns that we want to be used commonly \
throughout the notebook.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$EmpiricalPattern", ",", "$GoldPattern", ",", "$PredictedPattern"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EmpiricalPattern", "=", 
   RowBox[{
   "\"\<Empirical\>\"", "|", "\"\<Measured\>\"", "|", "\"\<PRF\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$GoldPattern", "=", 
   RowBox[{
   "\"\<Gold\>\"", "|", "\"\<GoldStandard\>\"", "|", "\"\<Validation\>\""}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PredictedPattern", "=", 
   RowBox[{
   "\"\<Predicted\>\"", "|", "\"\<Prediction\>\"", "|", "\"\<Fit\>\"", "|", 
    "\"\<Model\>\""}]}], ";"}]}], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting projections to the visual field", "Section"],

Cell["\<\
The functions defined in this section of the notebook allow one to plot data \
projected into the visual field; these projections can be based either on the \
individualized template fits or on the raw data.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Functions to Parse Options", "Subsection"],

Cell["\<\
These functions parse options given to the various functions that follow them,\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldParseOption", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "::", "badopt"}], "=", 
   "\"\<Bad option given to VisualField option parser: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Range", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Projection", "\[Rule]", "\"\<Empirical\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "\"\<VarianceExplained\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Select", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Range", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Range", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"m_", "?", "NumericQ"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mm", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "\[RuleDelayed]", 
        "mm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"None", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Automatic", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Range should be a max eccentricity or a {min,max} list.\>\""}],
          "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Select", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Select", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"None", "|", "Automatic", "|", "False"}], "\[Rule]", "None"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"VisualArea", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "VisualArea", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"None", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"All", "|", "Full"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", ":", 
         RowBox[{"1", "|", "2", "|", "3"}]}], "\[RuleDelayed]", 
        RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{"3", "\[Equal]", 
          RowBox[{"Length", "@", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "x"}], 
            "]"}]}]}]}], "\[RuleDelayed]", 
        RowBox[{"Union", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<VisualArea must be 1, 2, 3, a list containing 1, 2, or 3, or \
All\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Projection", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$EmpiricalPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"$GoldPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GoldPolarAngle\>\"", ",", "\"\<GoldEccentricity\>\""}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$PredictedPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<PredictedPolarAngle\>\"", ",", 
          "\"\<PredictedEccentricity\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ang_String", ",", "ecc_String"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"inAllMeshes", "[", "ang", "]"}], "&&", 
           RowBox[{"inAllMeshes", "[", "ecc", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ang", ",", "ecc"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<polar angle/eccentricity properties were not present in all \
specified meshes\>\""}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m_", "?", "MatrixQ"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit angles can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Projection should be Empirical or GoldStandard\>\""}], 
         "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Weights", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Weights", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"False", "|", "None"}], "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Weight\>\"", "\[Rule]", "\"\<Weight\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<VarianceExplained\>\"", "\[Rule]", "\"\<VarianceExplained\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"s_String", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inAllMeshes", "[", "s", "]"}], ",", "\[IndentingNewLine]", 
          "s", ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<weight property not present in all meshes\>\""}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m_List", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit weights can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Weights should be \\\"Weight\\\", \\\"VarianceExplained\\\", \
or None\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Averaging data into the visual field", "Subsection"],

Cell["\<\
Given a subject or group of subjects, a property to project, and polar \
angle/eccentricity properties (optionally weight), combine all the data into \
a single visual field mesh and return it.
The visual field mesh is returned as a function.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldFunction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldFunction", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "GaussianInterpolation", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "::", "badarg"}], "=", 
   "\"\<Bad argument given to VisualFieldFunction: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "[", 
    RowBox[{"who_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"allMeshes", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Outer", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub", "=", "#1"}], ",", 
                    RowBox[{"hem", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"sub", ",", "hem", ",", "\"\<Sym\>\"", ",", "#"}],
                     "]"}]}], "&"}], "/@", 
                   RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", "All"}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Empirical\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Measured\>\""}]}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Training\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Train\>\""}]}], ",", 
                    RowBox[{"Rest", "@", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Gold\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<GoldStandard\>\""}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
                    "True", ",", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\"\<Unrecognized dataset arg\>\""}], "]"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "===", "All"}], ",", 
                 "$Subjects", ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "All"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "LR"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "1", ",", "1"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"Dimensions", "[", "who", "]"}]}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{"{", "who", "}"}], ",", "who"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sel", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Select", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"area", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "VisualArea", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nSubHems", "=", 
          RowBox[{"Length", "@", 
           RowBox[{"Union", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Subject\>\"", ",", "\"\<Hemisphere\>\""}], "}"}],
                "/.", 
               RowBox[{"Options", "[", 
                RowBox[{"msh", ",", "MetaInformation"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"msh", ",", "allMeshes"}], "}"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"meshes", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"hemi", "\[Rule]", 
              RowBox[{"Select", "[", 
               RowBox[{"allMeshes", ",", 
                RowBox[{
                 RowBox[{"hemi", "===", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Hemisphere\>\"", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"#", ",", "MetaInformation"}], "]"}]}], ")"}]}], 
                 "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"inAllMeshes", "=", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "=", "#1"}], "}"}], ",", 
             RowBox[{"AllTrue", "[", 
              RowBox[{"allMeshes", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"VertexPropertyList", "[", "#", "]"}], ",", "x"}], 
                 "]"}], "&"}]}], "]"}]}], "]"}], "&"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"projAngleNames", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Projection", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"_", "\[Rule]", "None"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"weights", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Weights", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projAngle", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180.0"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90.0", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "msh"}], ")"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "msh"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ws0", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"weights", "===", "None"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"VertexCount", "[", "msh", "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", "weights", "]"}], ",", "weights", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"weights", "===", "Automatic"}], ",", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$EmpiricalPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "msh"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$GoldPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "\"\<GoldVarianceExplained\>\"", ")"}], "/.",
                     "msh"}], ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"_", "\[RuleDelayed]", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<If Projection is explicit, weights must be explicit \
or None.\>\""}], "]"}]}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", "weights", "]"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"weights", "/.", "msh"}], ")"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<Could not understand Weights argument; should be \
\\\"VarianceExplained\\\", \\\"Weight\\\", or None\>\""}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"idcs", "=", 
               RowBox[{"Association", "@", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"hemi", "\[Rule]", 
                   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"allVtcs", "=", 
                    RowBox[{"Range", "@", 
                    RowBox[{"VertexCount", "[", "#1", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sel", "===", "None"}], ",", "allVtcs", ",", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"MapVertices", "[", 
                    RowBox[{"sel", ",", "#1"}], "]"}], ",", "True"}], "]"}]}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"e_", "/;", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "e", 
                    "\[LessEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"Sign", "[", "#3", "]"}], ",", "1"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"area", "===", "None"}], "||", 
                    RowBox[{"#4", "===", "None"}]}], ",", 
                    "\[IndentingNewLine]", "allVtcs", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{"#4", ",", "a"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "area"}], "}"}]}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"areas", "===", "None"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"None", "&"}], ")"}], "/@", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], ",", 
                    RowBox[{"areas", "[", "hemi", "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"coords", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ang", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"ecc", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", "ecc", "*", 
                    RowBox[{"Cos", "[", "ang", "]"}]}], ",", 
                    RowBox[{"ecc", "*", 
                    RowBox[{"Sin", "[", "ang", "]"}]}]}], "}"}], "]"}], "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"vals", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", "prop", "]"}], ",", 
                    RowBox[{"prop", "/.", "#1"}], ",", "prop"}], "]"}], ",", 
                    "#2"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"ws", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"fs", "=", 
                   RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"coords", "[", "hemi", "]"}]}], "\[Equal]", "0"}],
                     ",", "\[IndentingNewLine]", "None", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "GaussianInterpolation", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Append", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", "hemi", "]"}], ",", 
                    RowBox[{"vals", "[", "hemi", "]"}]}], "}"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Weights", "\[Rule]", 
                    RowBox[{"ws", "[", "hemi", "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], "&&", 
                    RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}]}], ",", 
                   "$Failed", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "RH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Norm", "[", "#", "]"}], "\[LessEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", 
                    "Indeterminate", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
                    "Indeterminate", ",", "\[IndentingNewLine]", "True", ",", 
                    
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "RH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "LH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Norm", "[", "#", "]"}], "\[LessEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", 
                    "Indeterminate", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
                    "Indeterminate", ",", "\[IndentingNewLine]", "True", ",", 
                    
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fl", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], ",", 
                    RowBox[{"fr", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], "||", 
                    RowBox[{"#", "===", "RH"}]}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Norm", "[", "#", "]"}], "\[LessEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", 
                    "Indeterminate", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
                    RowBox[{"fr", "[", "#", "]"}], ",", "\[IndentingNewLine]",
                     "True", ",", 
                    RowBox[{"fl", "[", "#", "]"}]}], "]"}]}]}], "]"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting a Field", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ColorFunctionScaling", "\[Rule]", "_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"ColorFunctionScaling", "\[Rule]", "Automatic"}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ColorFunction", "\[Rule]", "_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"ColorFunction", "\[Rule]", "Automatic"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Frame", "\[Rule]", "_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"Frame", "\[Rule]", "None"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"AspectRatio", "\[Rule]", "_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"BaseStyle", "\[Rule]", "_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"PlotRange", "\[Rule]", "_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"WorkingPrecision", "\[Rule]", "_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"WorkingPrecision", "->", "MachinePrecision"}], ")"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldFunction", "[", 
           RowBox[{"spec", ",", "prop"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"projections", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "RH", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "LH", "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"DensityPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"range", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"White", ",", 
                RowBox[{"Annulus", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
                RowBox[{"{", 
                 RowBox[{"White", ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Thin", ",", "White", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xmin", "\[Equal]", "0"}], "||", 
                  RowBox[{"xmax", "\[Equal]", "0"}]}], ",", "2", ",", "1"}], 
                "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ColorFunctionScaling", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===", 
                  "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{
                   "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], "[", 
                   RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                   "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{
                   "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                   "[", 
                   RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                   "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}]}], 
               "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "\[Rule]", 
                   RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{
                 RowBox[{"Options", "[", "VisualFieldPlot", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}]}], 
            "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell["Plotting properties of a subject or group of subjects in ", "Subsection"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code below this point not yet incorporated into the notebook (old code that \
needs to be tweaked to work with the data).\
\>", "Chapter"],

Cell[CellGroupData[{

Cell["Subject Contours", "Section",
 CellChangeTimes->{{3.6628453146458893`*^9, 3.662845316563508*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SubjectContours", ",", "VisualAreaStyleFunction"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "::", "badarg"}], "=", 
   "\"\<Bad argument given to SubjectContours: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VisualAreaStyleFunction", "::", "usage"}], "=", 
    "\"\<VisualAreasStyleFunction is an option to SubjectContours.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectContours", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EccentricityLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "1.25", ",", "2.5", ",", "5", ",", "10", ",", "20", ",", "40", ",", 
          "80"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"EccentricityStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90", ",", "180"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreas", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreaStyleFunction", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BoundaryStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Mesh", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VertexCoordinates", "\[Rule]", "Automatic"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "SubjectPredictedMap", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Xarg", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{
              RowBox[{"Length", "[", "m", "]"}], "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}]}]}], "\[RuleDelayed]", 
            RowBox[{"Transpose", "[", "m", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{"1", "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}], "<", "4"}]}], 
            "\[RuleDelayed]", "m"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Automatic", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"_", "\[RuleDelayed]", 
            RowBox[{"Message", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SubjectContours", "::", "badarg"}], ",", 
              "\[IndentingNewLine]", 
              "\"\<VertexCoordinates must be an n x 2 or n x 3 matrix or \
Automatic\>\""}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pre", "=", 
         RowBox[{"Fold", "[", "\[IndentingNewLine]", 
          RowBox[{"Replace", ",", "\[IndentingNewLine]", 
           RowBox[{"OptionValue", "[", "Mesh", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"s_String", "\[RuleDelayed]", 
              RowBox[{"ToLowerCase", "[", "s", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"s_String", "/;", 
                 RowBox[{"StringStartsQ", "[", 
                  RowBox[{"s", ",", "\"\<sym\>\""}], "]"}]}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"s", "\[Equal]", "\"\<symmap\>\""}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"WithOptions", "[", 
                   RowBox[{
                    RowBox[{"SubjectPredictedMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "opts"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"WithOptions", "[", 
                   RowBox[{
                    RowBox[{"SubjectPredictedSymMesh", "[", 
                    RowBox[{"sub", ",", "hemi", ",", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"s", ",", "3"}], "]"}], ",", "ds"}], "]"}], ",", 
                    "opts"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s_String", "/;", 
                 RowBox[{"StringStartsQ", "[", 
                  RowBox[{"s", ",", "\"\<native\>\""}], "]"}]}], 
                "\[RuleDelayed]", 
                RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"SubjectPredictedMesh", "[", 
                   RowBox[{"sub", ",", "hemi", ",", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"s", ",", "6"}], "]"}], ",", "ds"}], "]"}], ",", 
                  "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"s_String", "\[RuleDelayed]", 
                RowBox[{"WithOptions", "[", 
                 RowBox[{
                  RowBox[{"SubjectPredictedMesh", "[", 
                   RowBox[{"sub", ",", "hemi", ",", "s", ",", "ds"}], "]"}], 
                  ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Xarg", "===", "Automatic"}], ",", 
                  RowBox[{"WithOptions", "[", 
                   RowBox[{
                    RowBox[{"SubjectPredictedMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "opts"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "Xarg", "]"}]}], "\[Equal]", "2"}], 
                  ",", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectPredictedMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectPredictedMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectPredictedMesh", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectPredictedMesh", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectPredictedSymMesh", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectPredictedSymMesh", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<VertexCoordinates do not match a mesh size\>\""}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "}"}]}], "}"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"elines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "1.25", ",", "2.5", ",", "5", ",", "10", ",", "20", ",", 
                   "40", ",", "80"}], "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<EccentricityLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"estyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", "Black", "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"plines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "90"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<PolarAngleLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"pstyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", 
                   RowBox[{"Thick", ",", "White"}], "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3"}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Full", "|", "All"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "5"}], ",", 
                   RowBox[{"-", "4"}], ",", 
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4",
                    ",", "5"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"astyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreaStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Round", "@", 
                    RowBox[{"Abs", "[", "#", "]"}]}], ",", 
                    "\[IndentingNewLine]", "1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Blue"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Green"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "3", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Red"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "_", ",", "None"}], "]"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"bstyle", "=", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "BoundaryStyle", "]"}], ",", 
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"idxFix", "=", 
              RowBox[{"Function", "[", 
               RowBox[{"VertexIndex", "[", 
                RowBox[{"pre", ",", "#"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"inRangeQ", "=", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"All", "|", "Full"}], "\[Rule]", 
                   RowBox[{"Function", "[", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", "#3"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"emax_", "?", "NumericQ"}], "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", "#3"}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", "#3"}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a0_", "?", "NumericQ"}], ",", 
                    RowBox[{"amax_", "?", "NumericQ"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    "a0", "\[LessEqual]", "#1", "\[LessEqual]", "amax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}]}]}],
                  "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"angleDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PolarAngle\>\""}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"eccenDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<Eccentricity\>\""}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"areasDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<VisualArea\>\""}], "]"}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"bound", "=", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"bound0", "=", 
                   RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SelectVertices", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#VisualArea", "\[Equal]", "a"}], "&&", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PolarAngle", ",", "#Eccentricity", ",", "#VisualArea"}],
                     "]"}]}], "&"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "rotate", " ", "it", " ", "so", " ", "that", " ", "the", 
                    " ", "start", " ", "is", " ", "the", " ", "fovea"}], 
                   "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"RotateLeft", "[", 
                  RowBox[{"bound0", ",", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Ordering", "[", 
                    RowBox[{
                    RowBox[{"eccenDat", "[", 
                    RowBox[{"[", "bound0", "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "-", "1"}]}], "]"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], ",", 
                 
                 RowBox[{"Automatic", "\[RuleDelayed]", 
                  RowBox[{"VertexCoordinates", "[", "pre", "]"}]}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Okay", ",", " ", 
                 RowBox[{
                  RowBox[{
                  "the", " ", "rest", " ", "will", " ", "be", " ", "done", 
                   " ", "somewhat", " ", "procedurally"}], "..."}]}], " ", 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"First", "@", 
                RowBox[{"Last", "@", 
                 RowBox[{"Reap", "[", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"First", ",", " ", 
                    RowBox[{
                    RowBox[{
                    "find", " ", "the", " ", "areas", " ", "and", " ", 
                    "render", " ", "them"}], "..."}]}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"astyle", "[", "a", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#VisualArea", "\[Equal]", "a"}], "&&", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PolarAngle", ",", "#Eccentricity", ",", "#VisualArea"}],
                     "]"}]}], "&"}]}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{"Next", ",", " ", 
                    RowBox[{"we", " ", "do", " ", "eccentricity"}]}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"estyle", "[", "e", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#Eccentricity", "<", "e"}], "&&", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PolarAngle", ",", "#Eccentricity", ",", "#VisualArea"}],
                     "]"}]}], "&"}]}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", "elines"}], "}"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"Then", " ", "polar", " ", "angle"}], "..."}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"pstyle", "[", "p", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "]"}]}], 
                    "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", "#"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "0"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "2"}], "||", 
                    RowBox[{"a", "\[Equal]", "3"}]}], ")"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "180"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "2"}]}], "||", 
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "3"}]}]}], ")"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "90"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "1"}], "||", 
                    RowBox[{"a", "\[Equal]", "2"}]}], ")"}]}]}], "]"}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "||", 
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "2"}]}]}], ")"}]}]}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0", "<", "p", "<", "90"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "1"}], "||", 
                    RowBox[{"a", "\[Equal]", "2"}]}], ")"}], "&&", 
                    RowBox[{"pa", "\[LessEqual]", "p"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "2"}], "||", 
                    RowBox[{"a", "\[Equal]", "3"}]}], ")"}], "&&", 
                    RowBox[{"pa", "\[LessEqual]", "p"}]}]}], "]"}]}]}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"90", "<", "p", "<", "180"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "1"}]}], "||", 
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "2"}]}]}], ")"}], "&&", 
                    RowBox[{"pa", "\[GreaterEqual]", "p"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", "#VisualArea"}], ",", 
                    RowBox[{"pa", "=", "#PolarAngle"}], ",", 
                    RowBox[{"e", "=", "#Eccentricity"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{"pa", ",", "e", ",", "a"}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "2"}]}], "||", 
                    RowBox[{"a", "\[Equal]", 
                    RowBox[{"-", "3"}]}]}], ")"}], "&&", 
                    RowBox[{"pa", "\[GreaterEqual]", "p"}]}]}], "]"}]}]}], 
                    "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "plines"}], "}"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{"Last", ",", " ", 
                    RowBox[{
                    RowBox[{"do", " ", "the", " ", "boundary"}], "..."}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bstyle", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "bstyle", "]"}], ",", "bstyle", ",", 
                    RowBox[{"{", "bstyle", "}"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", "bound", "]"}]}], "]"}]}]}], "]"}]}],
                   "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.658508599436679*^9, 3.658508601654513*^9}, {
   3.658508638509685*^9, 3.6585087294890537`*^9}, {3.658582634818886*^9, 
   3.658582702735421*^9}, {3.658582738127853*^9, 3.658583306412799*^9}, {
   3.658583405866976*^9, 3.658583420510717*^9}, {3.658583597642411*^9, 
   3.658584095783531*^9}, {3.6585841480513268`*^9, 3.6585841783809633`*^9}, {
   3.658584243654513*^9, 3.658584252069977*^9}, {3.658584287383404*^9, 
   3.658584330696204*^9}, {3.658584460971904*^9, 3.658584461797284*^9}, {
   3.6585845101340837`*^9, 3.65858454229777*^9}, {3.658584585138586*^9, 
   3.658584688671769*^9}, {3.65858471928318*^9, 3.65858480225224*^9}, {
   3.6585848426737213`*^9, 3.6585849196128197`*^9}, {3.65858502728799*^9, 
   3.658585027705212*^9}, {3.6585851262876577`*^9, 3.658585170015955*^9}, {
   3.658585605639982*^9, 3.658585671081955*^9}, {3.658585773986314*^9, 
   3.658585775661868*^9}, {3.65858587122036*^9, 3.658585883291087*^9}, {
   3.658586529021482*^9, 3.658586529676289*^9}, {3.658586625130679*^9, 
   3.6585866766438427`*^9}, {3.658586720036174*^9, 3.658586839724348*^9}, {
   3.658586934652711*^9, 3.658586944330986*^9}, {3.658586978380768*^9, 
   3.6585870260361032`*^9}, {3.6585870851775103`*^9, 3.658587195686778*^9}, {
   3.658587254075005*^9, 3.6585874354139853`*^9}, {3.6585875418169327`*^9, 
   3.6585876939287148`*^9}, {3.658587820166843*^9, 3.658587829832796*^9}, {
   3.6585881029591103`*^9, 3.658588114894538*^9}, {3.658588395245398*^9, 
   3.6585883957973967`*^9}, {3.6585886295395527`*^9, 3.658588666664648*^9}, {
   3.6585921930013113`*^9, 3.6585922358183413`*^9}, {3.658592477345971*^9, 
   3.658592589218502*^9}, {3.658592657717602*^9, 3.658592706677928*^9}, 
   3.658592818987527*^9, {3.65859303244606*^9, 3.658593038149085*^9}, {
   3.6585930713596277`*^9, 3.658593198406187*^9}, {3.6585933017712927`*^9, 
   3.658593418120709*^9}, {3.6585934757879953`*^9, 3.6585935033051863`*^9}, {
   3.6585935413980827`*^9, 3.6585936433792667`*^9}, {3.6585937846603928`*^9, 
   3.658593817712391*^9}, {3.658593904819024*^9, 3.658593951653186*^9}, {
   3.658594015902247*^9, 3.658594038751816*^9}, {3.658594081849966*^9, 
   3.6585940883869143`*^9}, {3.6585941982331343`*^9, 
   3.6585942267956142`*^9}, {3.658594281100108*^9, 3.658594287197755*^9}, {
   3.658594446924872*^9, 3.658594577883657*^9}, {3.658594947745923*^9, 
   3.658594962942728*^9}, {3.6585996613245287`*^9, 3.658599674022654*^9}, {
   3.662600016517869*^9, 3.66260006875801*^9}, {3.662642961085578*^9, 
   3.662643006011911*^9}, {3.66264333486829*^9, 3.662643341800596*^9}, {
   3.6626434784908543`*^9, 3.6626437471403522`*^9}, {3.6626440668719397`*^9, 
   3.6626442217496758`*^9}, {3.662644489524555*^9, 3.662644575817629*^9}, {
   3.662644612185347*^9, 3.662644799831603*^9}, {3.6626448384389687`*^9, 
   3.662644894342835*^9}, {3.662644924868101*^9, 3.662645074194243*^9}, {
   3.662645114413898*^9, 3.662645116341877*^9}, {3.662645183330159*^9, 
   3.662645248920701*^9}, {3.662645281929349*^9, 3.662645399388283*^9}, {
   3.662645445125305*^9, 3.662645449269196*^9}, {3.662645490682234*^9, 
   3.662645573181458*^9}, {3.662645889110751*^9, 3.662645907454248*^9}, {
   3.6626462282976923`*^9, 3.66264660325399*^9}, {3.662646673322604*^9, 
   3.66264668995942*^9}, {3.662646983456047*^9, 3.662647021212007*^9}, {
   3.6626470714875174`*^9, 3.662647078078433*^9}, {3.662735986447625*^9, 
   3.6627359875100203`*^9}, {3.6627361406967287`*^9, 3.662736154593062*^9}, {
   3.6627362372688227`*^9, 3.662736237915786*^9}, {3.662736271272208*^9, 
   3.662736271760412*^9}, {3.6627363470375357`*^9, 3.6627363514767036`*^9}, {
   3.6718864355644817`*^9, 3.6718864931726427`*^9}, {3.671886578730568*^9, 
   3.671886834600378*^9}, {3.671886870195773*^9, 3.671886936807602*^9}, {
   3.674317717890108*^9, 3.6743177506614637`*^9}, {3.674317786064961*^9, 
   3.674317787381665*^9}, {3.674317835171215*^9, 3.674317847337679*^9}, {
   3.674317934071068*^9, 3.6743179691758423`*^9}, {3.678201903784975*^9, 
   3.678201914124558*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["SubjectDisplayPlot", "Section",
 CellChangeTimes->{{3.662807335274323*^9, 3.662807338583898*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "SubjectDisplayPlot", ",", "SubjectDisplayPlotInterpretContours", ",", 
     "$SubjectDisplayPlotDefaultContourOptions", ",", 
     "SubjectDisplayPlotInvertTx"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectDisplayPlot", "::", "usage"}], "=", 
   "\"\<SubjectDisplayPlot[sub,ds] plots a side-by-side comparison of the \
left and right hemispheres of the given subject's given dataset ds. By \
default this plots only the polar angle and eccentricity of the subject on  \
using the following available options:\n  * Mesh (default: \\\"Inflated\\\") \
specifies which mesh to use; may be \\\"Sym<mesh>\\\" to specify the \
fsaverage_sym hemisphere and otherwise may be either a name (such as \
\\\"White\\\") or that prepended with \\\"Native\\\", such as \
\\\"NativeMidGray\\\". {lhMesh, rhMesh} may be given to specify separate \
meshes for right and left.\n  * TransformationMatrix (default: \
RotationMatrix[-10Degree, {0,0,1}]) may be given as a matrix, or as a list of \
two matrices, one for the right and one for the left hemisphere; if only one \
is given then it is assumed to be for the left hemisphere, and its reflection \
across the Y-Z plane will be used for the right hemisphere. The matrices may \
be 3x3 rotation matrices or 4x4 rotation + translation matrices.\n  * \
DataSource (default: \\\"Empirical\\\") specifies which data to plot; must be \
one of \\\"Prediction\\\" or \\\"Empirical\\\".\n  * Opacity (default: 0.6) \
specifies the opacity of prediction plot for the detaulft color functions.\n  \
* ColorFunction (default: {\\\"PolarAngle\\\", \\\"Eccentricity\\\"}) \
specifies how to color the plots. This option may take many forms:\n    * \
\\\"PolarAngle\\\" or \\\"Eccentricity\\\" specifies that both hemisphere's \
should be plotted to show either polar angle or eccentricity, respectively, \
and that the values should be plotted transparently, according to weight, if \
the dataset is empirical (otherwise, they are plotted at the <option Opacity> \
level).\n    * A function will specify that both hemispheres use the given \
function as their ColorFunction.\n    * A list, {lh, rh} specifies that the \
left hemisphere is colored according to the method lh, and the right \
hemisphere is colored according to the instuction rh.\n  * SubjectContours \
(default: None) specifies how to draw subject contours on the plots. This may \
be one of None (no contours), Automatic (standardized styling of contours), \
or a list containing, optionally, first a list of subject/dataset pairs to \
draw, and following that any list of options to SubjectContours. An argument \
of {lh, rh} specifies separate instructions for left and right hemispheres.\n \
 * Options (default: Automatic) specifies a list of options to pass to \
CortexPlot3D; two lists may be given as {lh, rh}. These options override any \
automatically-configured options that are assumed via other variables.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SubjectDisplayPlot", "::", "badarg"}], "=", 
    "\"\<Bad argument given to SubjectDisplayPlot: `1`\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataSource", "::", "usage"}], "=", 
    "\"\<DataSource is an option to SubjectDisplayPlot that specifies whether \
the data plotted should be \\\"Empirical\\\" data or \\\"Prediction\\\" data.\
\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SubjectDisplayPlot", "]"}], "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Mesh", "\[Rule]", "\"\<Inflated\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TransformationMatrix", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DataSource", "\[Rule]", "\"\<Empirical\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Opacity", "\[Rule]", "0.6"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ColorFunction", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"SubjectContours", "\[Rule]", "None"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Options", "\[Rule]", "Automatic"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Options", "[", "Graphics3D", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$SubjectDisplayPlotColorFunctions", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
       RowBox[{"Function", "@", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"opac", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Function", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "\"\<VisualArea\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", 
                RowBox[{"#", "[", "\"\<VisualArea\>\"", "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"CorticalColorData", "[", "q", "]"}], "[", "#", 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Curvature\>\"", ",", "\"\<PolarAngle\>\""}], 
                    "}"}]}], "}"}]}], "]"}], ",", "opac"}], "]"}], ",", 
               "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"CorticalColorData", "[", "q", "]"}], "[", "#", 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"q", ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Curvature\>\"", ",", "\"\<PolarAngle\>\""}], 
                    "}"}]}], "}"}]}], "]"}], ",", "#Weight"}], "]"}]}], 
            "]"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
       RowBox[{"Function", "@", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"opac", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Function", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "\"\<VisualArea\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", 
                RowBox[{"#", "[", "\"\<VisualArea\>\"", "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"CorticalColorData", "[", "q", "]"}], "[", "#", 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Curvature\>\"", ",", "\"\<Eccentricity\>\""}], 
                    "}"}]}], "}"}]}], "]"}], ",", "opac"}], "]"}], ",", 
               "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"CorticalColorData", "[", "q", "]"}], "[", "#", 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"q", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Curvature\>\"", ",", "\"\<Eccentricity\>\""}], 
                    "}"}]}], "}"}]}], "]"}], ",", "#Weight"}], "]"}]}], 
            "]"}]}]}], "]"}]}]}]}], "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$SubjectDisplayPlotDefaultContourOptions", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EccentricityLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"2.5", ",", "5", ",", "10", ",", "20"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"EccentricityStyleFunction", "\[Rule]", 
       RowBox[{"Function", "@", 
        RowBox[{"Lighter", "[", 
         RowBox[{
          RowBox[{"CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
          "[", "#", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PolarAngleLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "90", ",", "180"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PolarAngleStyleFunction", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "White"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BoundaryStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "White"}], "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SubjectDisplayPlotInterpretContours", "[", 
     RowBox[{"subject_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "mesh_", ",", "tx_", ",", "code_"}], 
     "]"}], ":=", 
    RowBox[{"Catch", "@", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dsets", "=", 
          RowBox[{"SubjectDatasets", "[", "subject", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"dsetNames", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"SubjectDatasetName", "[", 
             RowBox[{"subject", ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"SubjectDatasets", "[", "subject", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"name", "=", 
          RowBox[{"SubjectName", "[", "subject", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"sub", "=", 
          RowBox[{"Subject", "[", "subject", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"who", "=", 
           RowBox[{"First", "@", 
            RowBox[{"Last", "@", 
             RowBox[{"Reap", "@", 
              RowBox[{"Fold", "[", "\[IndentingNewLine]", 
               RowBox[{"ReplaceAll", ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ListQ", "[", "code", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"code", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"Throw", "[", "None", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "code", "]"}], ">", "1"}], "&&", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"code", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}]}], "]"}]}], ",", 
                    RowBox[{"First", "[", "code", "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", "code"}], "]"}], ",", 
                  "\[IndentingNewLine]", "code"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s_String", ",", "Automatic"}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "k"}], "}"}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Rest", "@", 
                    RowBox[{"SubjectDatasets", "[", "s", "]"}]}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s_String", ",", "All"}], "}"}], "\[RuleDelayed]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "k"}], "}"}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"SubjectDatasets", "[", "s", "]"}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s_String", ",", 
                    RowBox[{"lst", ":", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ".."}], "}"}]}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "i"}], "}"}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "lst"}], "}"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s_String", ",", "i_Integer"}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "i"}], "}"}], "]"}], ";"}], ")"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Automatic", "\[RuleDelayed]", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"name", ",", "k"}], "}"}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Rest", "[", "dsets", "]"}]}], "}"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"None", "\[RuleDelayed]", 
                   RowBox[{"Throw", "[", "None", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"All", "\[RuleDelayed]", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"name", ",", "k"}], "}"}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "dsets"}], "}"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"s_String", "\[RuleDelayed]", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "i"}], "}"}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Rest", "@", 
                    RowBox[{"SubjectDatasets", "[", "s", "]"}]}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"i_Integer", "\[RuleDelayed]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"name", ",", "i"}], "}"}], "]"}], ";"}], ")"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"is", ":", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ".."}], "}"}]}], "\[RuleDelayed]", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"name", ",", "i"}], "}"}], "]"}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "is"}], "}"}]}], "]"}]}]}], "}"}]}], 
               "]"}]}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"opts", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "code", "]"}], "===", "Rule"}], "||", 
                RowBox[{
                 RowBox[{"Head", "[", "code", "]"}], "===", "RuleDelayed"}]}],
                ",", 
               RowBox[{"{", "code", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"!", 
                RowBox[{"ListQ", "[", "code", "]"}]}], ",", 
               RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"Head", "@", 
                  RowBox[{"First", "[", "code", "]"}]}], ",", 
                 RowBox[{"Rule", "|", "RuleDelayed"}]}], "]"}], ",", "code", 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Length", "[", "code", "]"}], "<", "2"}], ",", 
               RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"code", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Rule", "|", "RuleDelayed"}]}], "]"}], ",", 
               RowBox[{"code", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;", "All"}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", "True", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Replace", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SubjectContours", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"e", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "hemi", ",", 
                 RowBox[{"e", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"Join", "[", 
                   RowBox[{"opts", ",", 
                    RowBox[{"{", 
                    RowBox[{"Mesh", "\[Rule]", "mesh"}], "}"}], ",", 
                    "$SubjectDisplayPlotDefaultContourOptions"}], "]"}]}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"GraphicsComplex", "[", 
                 RowBox[{"X_", ",", "etc_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"GraphicsComplex", "[", 
                 RowBox[{
                  RowBox[{"tx", "[", "X", "]"}], ",", "etc"}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"e", ",", "who"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SubjectDisplayPlotInvertTx", "[", "matrix_", "]"}], ":=", 
    RowBox[{"Times", "[", "\[IndentingNewLine]", 
     RowBox[{"matrix", ",", "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"1", ",", 
          RowBox[{"Dimensions", "[", "matrix", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "matrix", "]"}], "\[Equal]", "4"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", 
             RowBox[{"-", "1"}]}], ",", "Nothing"}], "]"}]}], "}"}]}], 
       "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectDisplayPlot", "[", 
    RowBox[{"subject_", ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mesh", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Mesh", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"lh", ":", 
                RowBox[{"_String", "|", 
                 RowBox[{"{", 
                  RowBox[{"_String", ",", "___"}], "}"}]}]}], ",", 
               RowBox[{"rh", ":", 
                RowBox[{"_String", "|", 
                 RowBox[{"{", 
                  RowBox[{"_String", ",", "___"}], "}"}]}]}]}], "}"}], 
             "\[RuleDelayed]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "lh"}], ",", 
               RowBox[{"RH", "\[Rule]", "rh"}]}], "|>"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"both", ":", 
              RowBox[{"_String", "|", 
               RowBox[{"{", 
                RowBox[{"_String", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "..."}]}], 
                "}"}]}]}], "\[RuleDelayed]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "both"}], ",", 
               RowBox[{"RH", "\[Rule]", "both"}]}], "|>"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "\"\<Inflated\>\""}], ",", 
               RowBox[{"RH", "\[Rule]", "\"\<Inflated\>\""}]}], "|>"}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"x_", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"SubjectDisplayPlot", "::", "badarg"}], ",", 
                 "\"\<Mesh should be a mesh name string or a pair of \
them\>\""}], "]"}], ";", "x"}], ")"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"rot", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "TransformationMatrix", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"l_List", "/;", 
              RowBox[{
               RowBox[{"ArrayQ", "[", 
                RowBox[{"l", ",", "3", ",", "NumericQ"}], "]"}], "&&", 
               RowBox[{
                RowBox[{"Length", "[", "l", "]"}], "\[Equal]", "2"}], "&&", 
               RowBox[{"2", "<", 
                RowBox[{"Length", "[", 
                 RowBox[{"l", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "5"}]}]}], 
             "\[RuleDelayed]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", 
                RowBox[{"l", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"RH", "\[Rule]", 
                RowBox[{"l", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"l_List", "/;", 
              RowBox[{
               RowBox[{"MatrixQ", "[", 
                RowBox[{"l", ",", "NumericQ"}], "]"}], "&&", 
               RowBox[{"2", "<", 
                RowBox[{"Length", "[", "l", "]"}], "<", "5"}]}]}], 
             "\[RuleDelayed]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "l"}], ",", 
               RowBox[{"RH", "\[Rule]", 
                RowBox[{"SubjectDisplayPlotInvertTx", "[", "l", "]"}]}]}], 
              "|>"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Automatic", "\[RuleDelayed]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"m", "=", 
                 RowBox[{"Transpose", "@", 
                  RowBox[{"Append", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"-", "30"}], "Degree"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "10"}], ",", "0", ",", "0", ",", "1"}], 
                    "}"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"LH", "\[Rule]", "m"}], ",", 
                 RowBox[{"RH", "\[Rule]", 
                  RowBox[{"SubjectDisplayPlotInvertTx", "[", "m", "]"}]}]}], 
                "|>"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"x_", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"SubjectDisplayPlot", "::", "badarg"}], ",", 
                 "\"\<RotationMatrix should be a 3D or 4D matrix or a pair of \
them\>\""}], "]"}], ";", "x"}], ")"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsrc", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "DataSource", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", 
              RowBox[{"\"\<Empirical\>\"", "|", "\"\<Prediction\>\""}]}], 
             "\[RuleDelayed]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "x"}], ",", 
               RowBox[{"RH", "\[Rule]", "x"}]}], "|>"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "\"\<Empirical\>\""}], ",", 
               RowBox[{"RH", "\[Rule]", "\"\<Empirical\>\""}]}], "|>"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pair", ":", 
               RowBox[{"{", 
                RowBox[{"\"\<Empirical\>\"", "|", "\"\<Prediction\>\"", "|", 
                 RowBox[{"Automatic", ".."}]}], "}"}]}], "/;", 
              RowBox[{
               RowBox[{"Length", "[", "pair", "]"}], "\[Equal]", "2"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"Association", "@", 
              RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
               RowBox[{"Rule", ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                  RowBox[{"Replace", "[", 
                   RowBox[{"pair", ",", 
                    RowBox[{"Automatic", "\[Rule]", "\"\<Empirical\>\""}], 
                    ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], "}"}]}], "]"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"x_", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"SubjectDisplayPlot", "::", "badarg"}], ",", 
                 "\"\<Dataset must be either \\\"Empirical\\\" or \
\\\"Prediction\\\"\>\""}], "]"}], ";", "x"}], ")"}]}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"opac", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Opacity", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", ":", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"a_", "?", "NumericQ"}], "/;", 
                   RowBox[{"0", "\[LessEqual]", "a", "\[LessEqual]", "1"}]}], 
                  ")"}], ".."}], "}"}]}], "/;", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"RH", "\[Rule]", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "|>"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "/;", 
              RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "x"}], ",", 
               RowBox[{"RH", "\[Rule]", "x"}]}], "|>"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"LH", "\[Rule]", "0.6"}], ",", 
               RowBox[{"RH", "\[Rule]", "0.6"}]}], "|>"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"x_", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"SubjectDisplayPlot", "::", "badarg"}], ",", 
                 "\"\<Opacity must be a number between 0 and 1\>\""}], "]"}], 
               ";", "x"}], ")"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"meshPick", "=", 
        RowBox[{"Function", "@", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dataSource", "=", "#1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"meshName", "=", 
              RowBox[{"ToLowerCase", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ListQ", "[", "#2", "]"}], ",", 
                 RowBox[{"First", "[", "#2", "]"}], ",", "#2"}], "]"}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"meshOpts", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ListQ", "[", "#2", "]"}], ",", 
                RowBox[{"Rest", "[", "#", "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"hemi", "=", "#3"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"symQ", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"StringStartsQ", "[", 
                  RowBox[{"meshName", ",", "\"\<sym\>\""}], "]"}], ",", 
                 "True", ",", "False"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Replace", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"StringDrop", "[", "\[IndentingNewLine]", 
                RowBox[{"meshName", ",", "\[IndentingNewLine]", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"StringStartsQ", "[", 
                    RowBox[{"meshName", ",", "\"\<sym\>\""}], "]"}], ",", "3",
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"StringStartsQ", "[", 
                    RowBox[{"meshName", ",", "\"\<native\>\""}], "]"}], ",", 
                   "6", ",", "\[IndentingNewLine]", "True", ",", "0"}], 
                  "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"dataSource", "\[Equal]", "\"\<Empirical\>\""}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"symQ", ",", "\[IndentingNewLine]", 
                   RowBox[{"name_", "\[RuleDelayed]", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "subject", ",", "hemi", ",", "name", ",", "ds", ",", 
                    RowBox[{"Sequence", "@@", "meshOpts"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"name_", "\[RuleDelayed]", 
                    RowBox[{"SubjectNativeMesh", "[", 
                    RowBox[{
                    "subject", ",", "hemi", ",", "name", ",", "ds", ",", 
                    RowBox[{"Sequence", "@@", "meshOpts"}]}], "]"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"symQ", ",", "\[IndentingNewLine]", 
                   RowBox[{"name_", "\[RuleDelayed]", 
                    RowBox[{"SubjectPredictedSymMesh", "[", 
                    RowBox[{
                    "subject", ",", "hemi", ",", "name", ",", "ds", ",", 
                    RowBox[{"Sequence", "@@", "meshOpts"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"name_", "\[RuleDelayed]", 
                    RowBox[{"SubjectPredictedMesh", "[", 
                    RowBox[{
                    "subject", ",", "hemi", ",", "name", ",", "ds", ",", 
                    RowBox[{"Sequence", "@@", "meshOpts"}]}], "]"}]}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tx", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mtx", "=", 
                RowBox[{"rot", "[", "#1", "]"}]}], ",", 
               RowBox[{"dat", "=", "#2"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mtx", "===", "None"}], ",", "\[IndentingNewLine]", 
               "dat", ",", "\[IndentingNewLine]", 
               RowBox[{"Transpose", "@", 
                RowBox[{"Most", "@", 
                 RowBox[{"Dot", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "mtx", "]"}], "\[Equal]", "4"}], 
                    ",", "\[IndentingNewLine]", "mtx", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"mtx", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
                    "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "dat", "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "dat", "]"}]}], "]"}]}], "]"}]}], 
                  "]"}]}]}]}], "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"colorFn", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x_List", "/;", 
                RowBox[{
                 RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "2"}]}], 
               "\[RuleDelayed]", 
               RowBox[{"Association", "@", 
                RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Function", "[", "\[IndentingNewLine]", 
                   RowBox[{"#1", "\[Rule]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringQ", "[", "#2", "]"}], "&&", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"$SubjectDisplayPlotColorFunctions", ",", "#2"}], 
                    "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "$SubjectDisplayPlotColorFunctions", "[", "#2", "]"}], 
                    "[", 
                    RowBox[{"opac", "[", "#1", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"#2", "===", "Automatic"}], ",", 
                    RowBox[{
                    RowBox[{"$SubjectDisplayPlotColorFunctions", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "LH"}], ",", "\"\<PolarAngle\>\"", 
                    ",", "\"\<Eccentricity\>\""}], "]"}], "]"}], "[", 
                    RowBox[{"opac", "[", "#1", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", "#2"}], "]"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}], ",", "x"}], "}"}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s_String", "/;", 
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"$SubjectDisplayPlotColorFunctions", ",", "s"}], 
                 "]"}]}], "\[RuleDelayed]", 
               RowBox[{"Association", "@", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"hemi", "\[Rule]", 
                   RowBox[{
                    RowBox[{
                    "$SubjectDisplayPlotColorFunctions", "[", "s", "]"}], "[", 
                    RowBox[{"opac", "[", "hemi", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"x_", "\[RuleDelayed]", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"LH", "\[Rule]", "x"}], ",", 
                 RowBox[{"RH", "\[Rule]", "x"}]}], "|>"}]}]}], "}"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"options", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Options", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lh", ":", 
                  RowBox[{"_Rule", "|", "_RuleDelayed", "|", "_List"}]}], ",", 
                 RowBox[{"rh", ":", 
                  RowBox[{"_Rule", "|", "_RuleDelayed", "|", "_List"}]}]}], 
                "}"}], "\[RuleDelayed]", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"LH", "\[Rule]", "lh"}], ",", 
                 RowBox[{"RH", "\[Rule]", "rh"}]}], "|>"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[RuleDelayed]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"rule", "=", 
                   RowBox[{"FaceRenderingFunction", "\[Rule]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{
                    RowBox[{"#OriginalCoordinates", "&"}], "/@", 
                    "#VertexProperties"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"-", "50"}]}], ",", "\[IndentingNewLine]", 
                    "Nothing", ",", "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "[", 
                    RowBox[{"#VertexIndex", ",", 
                    RowBox[{"VertexColors", "\[Rule]", "#VertexColors"}]}], 
                    "]"}]}], "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"<|", 
                  RowBox[{
                   RowBox[{"LH", "\[Rule]", 
                    RowBox[{"{", "rule", "}"}]}], ",", 
                   RowBox[{"RH", "\[Rule]", 
                    RowBox[{"{", "rule", "}"}]}]}], "|>"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"x_", "\[RuleDelayed]", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"LH", "\[Rule]", "x"}], ",", 
                 RowBox[{"RH", "\[Rule]", "x"}]}], "|>"}]}]}], "}"}]}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"contours", "=", 
           RowBox[{"Catch", "@", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"o", "=", 
                RowBox[{"OptionValue", "[", "SubjectContours", "]"}]}], "}"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ListQ", "[", "o", "]"}], "&&", 
                  RowBox[{
                   RowBox[{"Length", "[", "o", "]"}], "\[Equal]", "2"}]}], 
                 ",", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", "=", 
                    RowBox[{"SubjectDisplayPlotInterpretContours", "[", 
                    RowBox[{"subject", ",", "LH", ",", 
                    RowBox[{"mesh", "[", "LH", "]"}], ",", 
                    RowBox[{
                    RowBox[{"tx", "[", 
                    RowBox[{"LH", ",", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"o", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "=!=", "$Failed"}], ",", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"b", "=", 
                    RowBox[{"SubjectDisplayPlotInterpretContours", "[", 
                    RowBox[{"subject", ",", "RH", ",", 
                    RowBox[{"mesh", "[", "RH", "]"}], ",", 
                    RowBox[{
                    RowBox[{"tx", "[", 
                    RowBox[{"RH", ",", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"o", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"b", "=!=", "$Failed"}], ",", 
                    RowBox[{"Throw", "[", 
                    RowBox[{"<|", 
                    RowBox[{
                    RowBox[{"LH", "\[Rule]", "a"}], ",", 
                    RowBox[{"RH", "\[Rule]", "b"}]}], "|>"}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"ctrs", "=", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectDisplayPlotInterpretContours", "[", 
                    RowBox[{"subject", ",", "hemi", ",", 
                    RowBox[{"mesh", "[", "hemi", "]"}], ",", 
                    RowBox[{
                    RowBox[{"tx", "[", 
                    RowBox[{"hemi", ",", "#"}], "]"}], "&"}], ",", "o"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ctrs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "===", "$Failed"}], "||", 
                    
                    RowBox[{
                    RowBox[{"ctrs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "$Failed"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"SubjectDisplayPlot", "::", "badarg"}], ",", 
                    "\"\<Could not interpret SubjectContours option\>\""}], 
                    "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"LH", "\[Rule]", 
                    RowBox[{"ctrs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"RH", "\[Rule]", 
                    RowBox[{"ctrs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "|>"}]}]}], "]"}]}]}],
              "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"msh", "=", 
                   RowBox[{
                    RowBox[{"meshPick", "[", 
                    RowBox[{
                    RowBox[{"dsrc", "[", "hemi", "]"}], ",", 
                    RowBox[{"mesh", "[", "hemi", "]"}], ",", "hemi"}], "]"}], 
                    "//", 
                    RowBox[{"Function", "[", "\[IndentingNewLine]", 
                    RowBox[{"SetVertexProperties", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"\"\<OriginalCoordinates\>\"", "\[Rule]", 
                    RowBox[{"VertexCoordinates", "[", "#", "]"}]}]}], "]"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"CorticalMesh", "[", 
                    RowBox[{"msh", ",", 
                    RowBox[{"VertexCoordinates", "\[Rule]", 
                    RowBox[{"tx", "[", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"VertexCoordinates", "[", "msh", "]"}]}], 
                    "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"options", "[", "hemi", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"colorFn", "[", "hemi", "]"}]}]}], "]"}]}], "]"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"hemi", ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Replace", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"contours", "[", "LH", "]"}], ",", 
                 RowBox[{"contours", "[", "RH", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"g_GraphicsComplex", ".."}], "}"}], 
                  "\[RuleDelayed]", 
                  RowBox[{"Graphics3D", "[", "g", "]"}]}], ",", 
                 RowBox[{"_", "\[RuleDelayed]", "Nothing"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", 
              RowBox[{"Options", "[", "Graphics3D", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ViewPoint", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1.2"}], ",", 
              RowBox[{"-", "0.6"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ViewCenter", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ViewVertical", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.662764335580016*^9, 3.662764507035018*^9}, {
   3.662764810835918*^9, 3.662764811252749*^9}, {3.662765269060279*^9, 
   3.6627655819532633`*^9}, {3.662765683256461*^9, 3.662765734048798*^9}, {
   3.6627657701227627`*^9, 3.662765846937149*^9}, {3.662766015345722*^9, 
   3.6627660176623297`*^9}, {3.662766412482444*^9, 3.6627666266722937`*^9}, {
   3.662766660985821*^9, 3.662766763675764*^9}, {3.662766800949317*^9, 
   3.662766905739793*^9}, {3.6627669430109053`*^9, 3.6627670290027533`*^9}, {
   3.662767067507189*^9, 3.662767206096637*^9}, {3.662767243080947*^9, 
   3.662767253150176*^9}, {3.662767361698057*^9, 3.662767464498855*^9}, {
   3.6627675425808773`*^9, 3.662767621714917*^9}, {3.662767658917214*^9, 
   3.6627676783132057`*^9}, {3.662767717410738*^9, 3.6627677387676373`*^9}, {
   3.6627678707869864`*^9, 3.662767937175118*^9}, {3.662768104154706*^9, 
   3.6627681422454*^9}, {3.662768179588925*^9, 3.662768200706038*^9}, {
   3.6627682596852493`*^9, 3.6627686214192677`*^9}, {3.662768658722127*^9, 
   3.662769209909565*^9}, {3.662769251711474*^9, 3.662769930942368*^9}, {
   3.6627699774611397`*^9, 3.6627699799645977`*^9}, {3.662770025621476*^9, 
   3.6627702045410347`*^9}, {3.662770238299458*^9, 3.662770356093834*^9}, {
   3.662770670976616*^9, 3.662770671504505*^9}, {3.6627707252707787`*^9, 
   3.66277108558873*^9}, {3.662771170461478*^9, 3.662771215179854*^9}, {
   3.662771286836453*^9, 3.662771349126013*^9}, {3.662771385911928*^9, 
   3.662771396966855*^9}, {3.6627714494048986`*^9, 3.6627714660834084`*^9}, {
   3.662771511025037*^9, 3.662771511842514*^9}, {3.662771556146267*^9, 
   3.662771718507701*^9}, {3.662771751492733*^9, 3.662771847888997*^9}, {
   3.662772476968402*^9, 3.662772546285717*^9}, {3.662772593134934*^9, 
   3.66277259728559*^9}, {3.662772642005927*^9, 3.662772749775249*^9}, {
   3.662772786798154*^9, 3.662772798437256*^9}, {3.662772832656474*^9, 
   3.662772916989753*^9}, {3.66277297036379*^9, 3.6627729853045053`*^9}, {
   3.662773021925508*^9, 3.662773479739335*^9}, {3.662773528552499*^9, 
   3.662773532029807*^9}, {3.662773572347878*^9, 3.66277382390177*^9}, {
   3.6627738976682367`*^9, 3.662773909878868*^9}, {3.66277393993959*^9, 
   3.662774098643106*^9}, {3.6627741313020477`*^9, 3.66277436365235*^9}, {
   3.6627744315916367`*^9, 3.662774505119191*^9}, {3.6627745532082644`*^9, 
   3.6627745561246967`*^9}, {3.662774595854195*^9, 3.662774825668272*^9}, {
   3.6627748585101757`*^9, 3.6627750864980183`*^9}, {3.662775127650879*^9, 
   3.662775178043271*^9}, {3.662775213895544*^9, 3.662775220255458*^9}, {
   3.662775269775738*^9, 3.6627758803868427`*^9}, {3.662775913394281*^9, 
   3.662776147577777*^9}, {3.662776194349847*^9, 3.662776311862154*^9}, {
   3.662776343690542*^9, 3.6627764409076433`*^9}, {3.66277649001057*^9, 
   3.662776658461591*^9}, {3.662777577614682*^9, 3.6627780222437267`*^9}, {
   3.662805401130637*^9, 3.6628054275487947`*^9}, {3.662805562130486*^9, 
   3.662805583850231*^9}, {3.662805656936981*^9, 3.6628057889409323`*^9}, {
   3.662805825685964*^9, 3.662805826245722*^9}, {3.6628058689497213`*^9, 
   3.662805944538753*^9}, {3.662805996417904*^9, 3.662806056151795*^9}, {
   3.662806087421846*^9, 3.662806338712872*^9}, {3.662806374328279*^9, 
   3.6628069540728807`*^9}, {3.662807050079962*^9, 3.662807195434623*^9}, {
   3.6628073795448637`*^9, 3.6628073803267593`*^9}, {3.662807474149899*^9, 
   3.6628075520098886`*^9}, {3.662807614174909*^9, 3.6628076568762293`*^9}, {
   3.6628077204485683`*^9, 3.662807774353149*^9}, {3.6628078796938*^9, 
   3.662807889204403*^9}, {3.6628079197868156`*^9, 3.66280792352169*^9}, {
   3.662808033681364*^9, 3.6628080464464493`*^9}, {3.662808100031052*^9, 
   3.6628081555103893`*^9}, {3.662808334729103*^9, 3.662808344413539*^9}, {
   3.662808478707594*^9, 3.662808579350381*^9}, {3.662814432976309*^9, 
   3.6628144340631533`*^9}, {3.662814583042449*^9, 3.662814602224998*^9}, {
   3.662814749255931*^9, 3.662814834357732*^9}, {3.662815033816287*^9, 
   3.662815074299375*^9}, {3.6628151745624638`*^9, 3.662815192166299*^9}, 
   3.662815377213028*^9, {3.662815527286359*^9, 3.662815576239357*^9}, {
   3.662815835382213*^9, 3.662815873117566*^9}, {3.66281614589294*^9, 
   3.662816159484365*^9}, {3.662816194916136*^9, 3.662816196152974*^9}, {
   3.662816376841847*^9, 3.662816403319536*^9}, {3.6628165786282988`*^9, 
   3.662816593479196*^9}, {3.662817108288069*^9, 3.662817108498321*^9}, {
   3.662817264949108*^9, 3.662817270328882*^9}, {3.6628173114530897`*^9, 
   3.6628173116601067`*^9}, {3.662817935369748*^9, 3.662817937743619*^9}, {
   3.662818421783844*^9, 3.662818487538343*^9}, {3.6628206684497128`*^9, 
   3.6628206686611156`*^9}, {3.662820873205358*^9, 3.6628208749719753`*^9}, {
   3.662820919933812*^9, 3.66282096051749*^9}, {3.662820999818831*^9, 
   3.662821162513506*^9}, {3.6628216058720016`*^9, 3.662821733443968*^9}, {
   3.662822117432629*^9, 3.662822118053406*^9}, 3.662822333398546*^9, {
   3.662822464805963*^9, 3.66282246676497*^9}, {3.662822602206653*^9, 
   3.662822607228174*^9}, {3.6628227849473867`*^9, 3.662822785476849*^9}, {
   3.662823045818757*^9, 3.66282307547361*^9}, {3.662823456287795*^9, 
   3.662823475571602*^9}, 3.662823678909449*^9, {3.6628238908139133`*^9, 
   3.6628240006052933`*^9}, {3.662824292561303*^9, 3.662824297075395*^9}, {
   3.6628243524176292`*^9, 3.662824418387865*^9}, {3.662824472827043*^9, 
   3.662824623912334*^9}, {3.662824804512714*^9, 3.662824815565989*^9}, {
   3.6628248473658257`*^9, 3.662824847603327*^9}, {3.662826119958049*^9, 
   3.662826137426771*^9}, {3.66284147752783*^9, 3.6628414824154663`*^9}, {
   3.6628415723600807`*^9, 3.662841575287109*^9}, {3.662841633101716*^9, 
   3.662841751593261*^9}, {3.662841909854536*^9, 3.662841921375301*^9}, {
   3.6628419822911663`*^9, 3.662842007180953*^9}, {3.662845118390456*^9, 
   3.662845119799799*^9}, {3.662848504122403*^9, 3.662848513021731*^9}, {
   3.6628502922433157`*^9, 3.662850297037462*^9}, {3.6628503620906973`*^9, 
   3.662850398310069*^9}, {3.6628508228634977`*^9, 3.662850823517949*^9}, {
   3.662850872940494*^9, 3.66285087793046*^9}, {3.662850916574855*^9, 
   3.662850929819355*^9}, {3.662857308219489*^9, 3.662857308408371*^9}, {
   3.6687666668904047`*^9, 3.668766669990531*^9}, {3.6687669580947523`*^9, 
   3.668766960894174*^9}, 3.671886953064233*^9, {3.675076747619214*^9, 
   3.6750767497323847`*^9}, {3.6750791602926197`*^9, 3.675079160965663*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["SubjectRegistrationPlot", "Section",
 CellChangeTimes->{{3.6698110956573963`*^9, 3.669811115954049*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "SubjectRegistrationPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectRegistrationPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectRegistrationPlot", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectPredictedMap", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Prolog", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectRegistrationPlot", "[", 
    RowBox[{"sub_", ",", "hemi_", ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"map", "=", 
        RowBox[{"SubjectMap", "[", 
         RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"pre", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"SubjectPredictedMap", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"reg", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"SubjectRegisteredMap", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"contours", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"SubjectContours", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"empiricalColor", "=", 
        RowBox[{"Function", "@", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"type", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Function", "@", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"CorticalColorData", "[", "\"\<Curvature\>\"", "]"}],
                  "[", "#", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"CorticalColorData", "[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"#Weight", ">", "0"}], ",", "type", ",", 
                    "\"\<Curvature\>\""}], "]"}], "]"}], "[", "#", "]"}]}], 
               "}"}], ",", "\[IndentingNewLine]", "#Weight"}], "]"}]}]}], 
          "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
               RowBox[{"reg", ",", "\[IndentingNewLine]", 
                RowBox[{"EdgeRenderingFunction", "\[Rule]", "Line"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FaceRenderingFunction", "\[Rule]", "None"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"clr", "=", 
                    RowBox[{"empiricalColor", "[", "type", "]"}]}], "}"}], 
                   ",", 
                   RowBox[{
                    RowBox[{"Darker", "@", 
                    RowBox[{"clr", "[", "#", "]"}]}], "&"}]}], "]"}]}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"V123LinePlot", "[", "$V123Model", "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
            RowBox[{"map", ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"empiricalColor", "[", "type", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", "contours"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
            RowBox[{"pre", ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"Function", "@", 
               RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Curvature\>\"", "]"}], "[",
                     "#", "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"CorticalColorData", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumberQ", "[", "#VisualArea", "]"}], ",", "type",
                     ",", "\"\<Curvature\>\""}], "]"}], "]"}], "[", "#", 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", "0.65"}], 
                "]"}]}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"type", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
            "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"OptionValue", "[", "ImageSize", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Prolog", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Prolog", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Epilog", "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.669809237771223*^9, 3.669809386072822*^9}, {
   3.669809451163319*^9, 3.669809616564199*^9}, {3.6698100671516953`*^9, 
   3.669810107448414*^9}, {3.669810144413072*^9, 3.669810400935163*^9}, {
   3.66981044136576*^9, 3.669810442487871*^9}, {3.6698104795966387`*^9, 
   3.6698108175646267`*^9}, {3.6698108984529877`*^9, 3.669810956057102*^9}, {
   3.6698110330563793`*^9, 3.669811071655539*^9}, {3.669811403000746*^9, 
   3.669811455202589*^9}, {3.66981150882729*^9, 3.669811513690854*^9}, 
   3.669811563158849*^9, 3.6698116206177263`*^9, {3.669811697178385*^9, 
   3.669811726900619*^9}, {3.669812342326997*^9, 3.669812345077648*^9}, {
   3.669812475685474*^9, 3.6698124767848597`*^9}, {3.673871855780142*^9, 
   3.673871858955369*^9}, {3.67507661122976*^9, 3.675076622145138*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["FieldPlot and FieldsPlot Functions", "Section",
 CellChangeTimes->{{3.678137401082602*^9, 3.6781374060239553`*^9}, {
  3.678190090074369*^9, 3.678190093999463*^9}, {3.6781920659406147`*^9, 
  3.678192068401821*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"PredictedFieldPlot", ",", "SubjectFieldPlot"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PredictedFieldPlot", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Hemi", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Curvature", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VertexColors", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Properties", "\[Rule]", "None"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Options", "[", "ListDensityPlot", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Background", "\[Rule]", "_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Background", "\[Rule]", "\"\<Curvature\>\""}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"AspectRatio", "\[Rule]", "_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"AspectRatio", "\[Rule]", "2"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Frame", "\[Rule]", "_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Frame", "\[Rule]", "None"}], ")"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "1", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Except", "[", "ColorFunctionScaling", "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PredictedFieldPlot", "[", 
     RowBox[{
      RowBox[{"map_", "?", "CorticalObjectQ"}], ",", 
      RowBox[{"area", ":", 
       RowBox[{"1", "|", "2", "|", "3"}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"opts", "=", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Cases", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"o", "\[Rule]", 
               RowBox[{"OptionValue", "[", "o", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"o", ",", 
                RowBox[{
                 RowBox[{"Options", "[", "PredictedFieldPlot", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Except", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Background", "\[Rule]", "\"\<Curvature\>\""}], ")"}], 
              "|", 
              RowBox[{"(", 
               RowBox[{"ColorFunction", "\[Rule]", "_"}], ")"}], "|", 
              RowBox[{"(", 
               RowBox[{"Properties", "\[Rule]", "_"}], ")"}]}], "]"}]}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"curvQ", "=", 
         RowBox[{"TrueQ", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Background", "]"}], "\[Equal]", 
           "\"\<Curvature\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"curv", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "Curvature", "]"}], "===", 
            "Automatic"}], ",", 
           RowBox[{"\"\<Curvature\>\"", "/.", "map"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"CorticalMapQ", "@", 
            RowBox[{"OptionValue", "[", "Curvature", "]"}]}], ",", 
           RowBox[{"\"\<Curvature\>\"", "/.", 
            RowBox[{"OptionValue", "[", "Curvature", "]"}]}], ",", 
           "\[IndentingNewLine]", "True", ",", 
           RowBox[{"OptionValue", "[", "Curvature", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"props", "=", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Properties", "]"}], ",", 
           RowBox[{"Automatic", "\[Rule]", "None"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"All", "|", "Full"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"r", ":", 
               RowBox[{"Except", "[", 
                RowBox[{"{", 
                 RowBox[{"_", ",", "_"}], "}"}], "]"}]}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "r"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"hemi", "=", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"meta", "=", 
             RowBox[{"MetaInformation", "[", "map", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"OptionValue", "[", "Hemi", "]"}], "=!=", "Automatic"}],
              ",", 
             RowBox[{"OptionValue", "[", "Hemi", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"meta", ",", "\"\<Hemisphere\>\""}], "]"}], ",", 
             RowBox[{"meta", "[", "\"\<Hemisphere\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"meta", ",", "\"\<Hemi\>\""}], "]"}], ",", 
             RowBox[{"meta", "[", "\"\<Hemi\>\"", "]"}], ",", 
             "\[IndentingNewLine]", "True", ",", "LH"}], "]"}]}], "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ang", "=", 
           RowBox[{
            RowBox[{"Pi", "/", "180"}], "*", 
            RowBox[{"(", 
             RowBox[{"90", "-", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"hemi", "===", "RH"}], ",", 
                 RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"\"\<PolarAngle\>\"", "/.", "map"}], ")"}]}]}], 
             ")"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ecc", "=", 
           RowBox[{"(", 
            RowBox[{"\"\<Eccentricity\>\"", "/.", "map"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"dat", "=", 
           RowBox[{"Range", "@", 
            RowBox[{"VertexCount", "[", "map", "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"idcs", "=", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i0", "=", 
                 RowBox[{"Pick", "[", 
                  RowBox[{
                   RowBox[{"Range", "@", 
                    RowBox[{"VertexCount", "[", "map", "]"}]}], ",", 
                   RowBox[{"Round", "@", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"\"\<VisualArea\>\"", "/.", "map"}], "]"}]}], ",",
                    "area"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Pick", "[", 
                  RowBox[{"i0", ",", 
                   RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"ecc", "[", 
                    RowBox[{"[", "i0", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"1", "|", "0"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"i0", ",", 
                   RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"ecc", "[", 
                    RowBox[{"[", "i0", "]"}], "]"}], "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"1", "|", "0"}]}], "]"}]}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"roundingPoints", "=", 
             RowBox[{
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "t", "]"}], ",", 
                  RowBox[{"Sin", "[", "t", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", 
                  RowBox[{"-", "Pi"}], ",", "Pi", ",", "0.05"}], "}"}]}], 
               "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xy", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ecc", "[", 
                   RowBox[{"[", "idcs", "]"}], "]"}], "*", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"ang", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"ecc", "[", 
                   RowBox[{"[", "idcs", "]"}], "]"}], "*", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"ang", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}]}], "}"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"pointData", "=", 
               RowBox[{"dat", "[", 
                RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"roundingData", "=", 
                 RowBox[{"First", "@", 
                  RowBox[{"Transpose", "@", 
                   RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "xy", "]"}], "\[Rule]", 
                    "pointData"}], ",", "roundingPoints", ",", "1"}], 
                    "]"}]}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"roundingCurv", "=", 
                 RowBox[{"First", "@", 
                  RowBox[{"Transpose", "@", 
                   RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "xy", "]"}], "\[Rule]", 
                    RowBox[{"curv", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "roundingPoints", ",", "1"}], "]"}]}]}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"clrs", "=", 
                  RowBox[{
                  "Neurotica`Mesh`Private`GetVertexColors", "[", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"props", "===", "None"}], ",", "map", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"CorticalObjectQ", "[", "props", "]"}], ",", 
                    "props", ",", "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"SetVertexProperties", "[", 
                    RowBox[{"map", ",", "props"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OptionValue", "[", "VertexColors", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}]}], 
                   "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"plot", "=", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ListDensityPlot", "@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Join", ",", 
                    RowBox[{"{", 
                    RowBox[{"xy", ",", 
                    RowBox[{"Transpose", "[", "roundingPoints", "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"dat", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], ",", "roundingData"}], 
                    "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Function", "[", 
                    RowBox[{"clrs", "[", 
                    RowBox[{"[", 
                    RowBox[{"Round", "[", "#", "]"}], "]"}], "]"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"curvQ", ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ListContourPlot", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Join", ",", 
                    RowBox[{"{", 
                    RowBox[{"xy", ",", 
                    RowBox[{"Transpose", "[", "roundingPoints", "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"curv", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], ",", "roundingCurv"}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Contours", "\[Rule]", 
                    RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "CorticalCurvatureColor"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Quiet", "[", 
                    RowBox[{
                    RowBox[{"AbsoluteOptions", "[", "plot", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Ticks", "::", "ticks"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Except", "[", "Background", "]"}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "plot"}], "}"}], "]"}],
                     ",", "\[IndentingNewLine]", "plot"}], "]"}]}], "]"}]}], 
               "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectFieldPlot", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "PredictedFieldPlot", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "SubjectPredictedMap", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectFieldPlot", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", "ds_", ",", 
     RowBox[{"area", ":", 
      RowBox[{"1", "|", "2", "|", "3"}]}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"opts", "=", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"o", "\[Rule]", 
            RowBox[{"OptionValue", "[", "o", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{
              RowBox[{"Options", "[", "SubjectFieldPlot", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"predMap", "=", 
        RowBox[{"SubjectPredictedMesh", "[", 
         RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"curvQ", "=", 
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Background", "]"}], "\[Equal]", 
          "\"\<Curvature\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "10"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"All", "|", "Full"}], "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", ":", 
              RowBox[{"Except", "[", 
               RowBox[{"{", 
                RowBox[{"_", ",", "_"}], "}"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "r"}], "}"}]}]}], "}"}]}], "]"}]}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PredictedFieldPlot", "[", 
        RowBox[{"predMap", ",", "area"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hemi", "\[Rule]", "hemi"}], ",", "\[IndentingNewLine]", 
         "opts"}], "}"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0GtIUwEAhuHTKtiUDgUhMUXMQIfFyqmMZmpTIzO76CIqcszFEi+U5IiQ
5WJFjhKVSu1qNGSZjmopCUZaOishpCC0WRRItVIJNFHMcJ13Pz4eeH9+680n
CywyQRDipKHN8sF5tnhSX+vafBnXrjxdjzHnXrVhpq3lEfqG857gkVRFDxpL
LaN4O2zvF9TlnPmK5piXgVDvS5rFoYBxRTV9WZyIf5Vvleixdu7BbO+ffPSV
ljnxR6y2DoOJibcwcjRvEFWeztcYVbN8BHWrzVM4PD6/hAfq3EG803Ih3C45
LTsVi+tqlQnYs29uE36q6t+CMxWHUzCh69fkVUmx97dwTbLcoJGj6p1exIf+
gghMrR5TYeBmhRrlapkW/5nmdPgzrDUDF+4tZWHGg/eHUDjoL0SxTFOE2z+X
FKN769OQ+93h5Xhs/LwVbf0Ndtzmtzqww/u9HXc8O/4N71YWTuDUx+6Q6dni
DCa7FuWNkm0dhlVocuauwZFuTwQORS9Gosun2IhVlxQaDB69n4ZN6fO7cCDH
aGrmL298EXZtaG/FK8/1bpyoETKvS0Y/PpGF9hKH+oakY/fFkIYXA8m48402
Bf8Dxn805w==
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"PredictedFieldsPlot", ",", "SubjectFieldsPlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PredictedFieldsPlot", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"3.25", "*", "72"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"Options", "[", "PredictedFieldPlot", "]"}], ",", 
       RowBox[{"Except", "[", 
        RowBox[{"Range", "|", "ImageSize"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PredictedFieldsPlot", "[", 
    RowBox[{
     RowBox[{"m_", "?", "CorticalObjectQ"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"PredictedFieldsPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", "opts"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PredictedFieldsPlot", "[", 
    RowBox[{
     RowBox[{"m", ":", 
      RowBox[{"Except", "[", 
       RowBox[{
        RowBox[{"_", "?", "CorticalObjectQ"}], "|", "_List"}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"PredictedFieldsPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", "LH", "]"}], ",", 
       RowBox[{"m", "[", "RH", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PredictedFieldsPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lm_", "?", "CorticalObjectQ"}], ",", 
        RowBox[{"rm_", "?", "CorticalObjectQ"}]}], "}"}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"opts", "=", 
         RowBox[{"Cases", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"o", "\[Rule]", 
              RowBox[{"OptionValue", "[", "o", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{
                RowBox[{"Options", "[", "PredictedFieldsPlot", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Except", "[", 
            RowBox[{"Properties", "\[Rule]", "_"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "10"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"All", "|", "Full"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"r", ":", 
               RowBox[{"Except", "[", 
                RowBox[{"{", 
                 RowBox[{"_", ",", "_"}], "}"}], "]"}]}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "r"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"sz", "=", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"3.25", "*", "72"}]}], ",", 
             RowBox[{"Full", "\[Rule]", 
              RowBox[{"7", "*", "72"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"props", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Properties", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a_", "/;", 
               RowBox[{"AssociationQ", "[", "a", "]"}]}], "\[RuleDelayed]", 
              "a"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"lh_", ",", "rh_"}], "}"}], "\[RuleDelayed]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"LH", "\[Rule]", "lh"}], ",", 
                RowBox[{"RH", "\[Rule]", "rh"}]}], "|>"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"x_", "\[RuleDelayed]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"LH", "\[Rule]", "x"}], ",", 
                RowBox[{"RH", "\[Rule]", "x"}]}], "|>"}]}]}], "}"}]}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GraphicsRow", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"PredictedFieldPlot", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"hemi", "===", "LH"}], ",", "lm", ",", "rm"}], 
                  "]"}], ",", "area", ",", "\[IndentingNewLine]", 
                 RowBox[{"Properties", "\[Rule]", 
                  RowBox[{"props", "[", "hemi", "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Hemi", "\[Rule]", "hemi"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ColorFunction", "\[Rule]", 
                  RowBox[{"Function", "@", 
                   RowBox[{"Opacity", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "\"\<VarianceExplained\>\""}], "]"}], 
                    ",", 
                    RowBox[{"#", "[", "\"\<VarianceExplained\>\"", "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "\"\<Weight\>\""}], "]"}], ",", 
                    RowBox[{"#", "[", "\"\<Weight\>\"", "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", "0.65"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CorticalColorData", "[", "type", "]"}], "[", "#",
                     "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Epilog", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"White", ",", "Thin", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"90", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "5"}], "]"}]}], 
                    "]"}]}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               "opts"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"RH", ",", "LH"}], "}"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"type", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
             "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"area", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Spacings", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "sz"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Inset", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"GraphicsRow", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"PolarAngleLegend", "[", "h", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"h", ",", 
                    RowBox[{"{", 
                    RowBox[{"RH", ",", "LH"}], "}"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{"sz", "/", "10"}], ")"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.33", ",", "0.5"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"GraphicsRow", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"EccentricityLegend", "[", 
                    RowBox[{"h", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"h", ",", 
                    RowBox[{"{", 
                    RowBox[{"RH", ",", "LH"}], "}"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{"sz", "/", "10"}], ")"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.67", ",", "0.5"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
             RowBox[{"None", "\[Rule]", 
              RowBox[{"{", "}"}]}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectFieldsPlot", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"3.25", "*", "72"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Properties", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Range", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "SubjectPredictedMap", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectFieldsPlot", "[", 
    RowBox[{"sub_", ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PredictedFieldsPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectPredictedSymMesh", "[", 
            RowBox[{"sub", ",", "h", ",", "\"\<Inflated\>\"", ",", "ds"}], 
            "]"}], ",", "opts"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"{", 
            RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "@", 
             RowBox[{"Text", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"#1", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                 RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", "0"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<V1\>\"", ",", "\"\<V2\>\"", ",", "\"\<V3\>\""}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.33", ",", "0.67"}], "}"}]}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
            RowBox[{"None", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Properties", "\[Rule]", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Properties", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Automatic", "\[RuleDelayed]", 
           RowBox[{"<|", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"LH", "\[Rule]", 
              RowBox[{"SubjectMesh", "[", 
               RowBox[{"sub", ",", "LH", ",", "\"\<Inflated\>\"", ",", "ds"}],
                "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"RH", "\[Rule]", 
              RowBox[{"SubjectMesh", "[", 
               RowBox[{"sub", ",", "RH", ",", "\"\<Inflated\>\"", ",", "ds"}],
                "]"}]}]}], "|>"}]}]}], "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"o", "\[Rule]", 
        RowBox[{"OptionValue", "[", "o", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", 
         RowBox[{
          RowBox[{"Options", "[", "SubjectFieldsPlot", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvSD3euH09NeO25QDSkC024wHNSC6ZltjHYh+di2m
CUQ7vbraDKJv/b0zFUQf4nqwAETPmhS5AkR/4roBphPfW28B0SkMkWB60o3S
wyD6AOvjEyCaLXjjTRCdNbPnHohe8an1MVhcrvYjiF6+t/kriJa8vpN/BpDu
2pHmAqLvzDvsDqKFlrLpzQTZe4cTTF+6mmY3D8R/UAamH0t1OYNoXtM7HiD6
UG5Jxnwg/X3e/04Q/cGe4dgCIP1vT+N1EN1h9yB6IZDe/SAzDkTH+b5PAtFd
TY7JINpEfkY2iJ7GKVsMorf/aTBeBKRnzNQ2A9EAiGiuRw==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ResultsPlot Functions", "Section",
 CellChangeTimes->{{3.678192078977015*^9, 3.678192090009632*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "SubjectPredictionsPlot", ",", "$SymViewCenter", ",", "$SymViewPoint", 
     ",", "$SymViewPointWide"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SymViewCenter", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"LH", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.35", ",", "0.5"}], "}"}]}], ",", 
     RowBox[{"RH", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.35", ",", "0.5"}], "}"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SymViewPoint", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"LH", "\[Rule]", 
      RowBox[{"1.15", "*", 
       RowBox[{"Normalize", "[", 
        RowBox[{"{", 
         RowBox[{"0.8", ",", 
          RowBox[{"-", "1.3"}], ",", 
          RowBox[{"-", "0.2"}]}], "}"}], "]"}]}]}], ",", 
     RowBox[{"RH", "\[Rule]", 
      RowBox[{"1.15", "*", 
       RowBox[{"Normalize", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.8"}], ",", 
          RowBox[{"-", "1.3"}], ",", 
          RowBox[{"-", "0.2"}]}], "}"}], "]"}]}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$SymViewPointWide", "=", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"LH", "\[Rule]", 
       RowBox[{"1.15", "*", 
        RowBox[{"Normalize", "[", 
         RowBox[{"{", 
          RowBox[{"1.0", ",", 
           RowBox[{"-", "1.3"}], ",", 
           RowBox[{"-", "0.2"}]}], "}"}], "]"}]}]}], ",", 
      RowBox[{"RH", "\[Rule]", 
       RowBox[{"1.15", "*", 
        RowBox[{"Normalize", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.0"}], ",", 
           RowBox[{"-", "1.3"}], ",", 
           RowBox[{"-", "0.2"}]}], "}"}], "]"}]}]}]}], "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectPredictionsPlot", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectPrediction", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Mesh", "\[Rule]", "\"\<Inflated\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "GraphicsGrid", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectPredictionsPlot", "[", 
    RowBox[{"sub_", ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"meshType", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Mesh", "]"}], ",", 
         RowBox[{"Automatic", "\[Rule]", "\"\<Inflated\>\""}]}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"predMeshes", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"h", "\[Rule]", 
              RowBox[{"WithOptions", "[", 
               RowBox[{
                RowBox[{"SubjectPredictedSymMesh", "[", 
                 RowBox[{"sub", ",", "h", ",", "meshType", ",", "ds"}], "]"}],
                 ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"h", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"meshes", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"h", "\[Rule]", 
              RowBox[{"SubjectMesh", "[", 
               RowBox[{"sub", ",", "h", ",", "meshType", ",", "ds"}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"h", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GraphicsGrid", "@", 
          RowBox[{"List", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mesh", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{"FlipMesh", "[", "#", "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                   RowBox[{"meshes", "[", "hemi", "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"predMesh", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{"FlipMesh", "[", "#", "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                   RowBox[{"predMeshes", "[", "hemi", "]"}]}]}]}], "}"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pmesh", "=", 
                    RowBox[{"CorticalMesh", "[", "\[IndentingNewLine]", 
                    RowBox[{"mesh", ",", "\[IndentingNewLine]", 
                    RowBox[{"VertexCoordinates", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "*", "40"}], ",", "40", ",", 
                    "0"}], "}"}], "+", 
                    RowBox[{"VertexCoordinatesTr", "[", "mesh", "]"}]}], 
                    "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"ppredMesh", "=", 
                    RowBox[{"CorticalMesh", "[", "\[IndentingNewLine]", 
                    RowBox[{"predMesh", ",", "\[IndentingNewLine]", 
                    RowBox[{"VertexCoordinates", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "*", "40"}], ",", "40", ",", 
                    "0"}], "}"}], "+", 
                    RowBox[{"VertexCoordinatesTr", "[", "mesh", "]"}]}], 
                    "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Show", "[", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
                    RowBox[{"mesh", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{
                    "RetinotopyColor", "[", "\"\<Eccentricity\>\"", "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ViewPoint", "\[Rule]", 
                    RowBox[{"$SymViewPoint", "[", "hemi", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ViewCenter", "\[Rule]", 
                    RowBox[{"$SymViewCenter", "[", "hemi", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ViewAngle", "\[Rule]", 
                    RowBox[{"40", "Degree"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Graphics3D", "@", 
                    RowBox[{"SubjectContours", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "ds", ",", "\[IndentingNewLine]", 
                    RowBox[{"Mesh", "\[Rule]", "predMesh"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Range", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BoundaryStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", "White"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"EccentricityLines", "\[Rule]", 
                    RowBox[{"{", "5", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"EccentricityStyleFunction", "\[Rule]", 
                    RowBox[{"Function", "[", 
                    RowBox[{"{", 
                    RowBox[{"White", ",", "Thin"}], "}"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PolarAngleLines", "\[Rule]", "None"}]}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
                    RowBox[{"pmesh", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{
                    "RetinotopyColor", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ViewPoint", "\[Rule]", 
                    RowBox[{"$SymViewPoint", "[", "hemi", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ViewCenter", "\[Rule]", 
                    RowBox[{"$SymViewCenter", "[", "hemi", "]"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Graphics3D", "@", 
                    RowBox[{"SubjectContours", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "ds", ",", "\[IndentingNewLine]", 
                    RowBox[{"Mesh", "\[Rule]", "ppredMesh"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Range", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BoundaryStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", "White"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"EccentricityLines", "\[Rule]", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PolarAngleStyleFunction", "\[Rule]", 
                    RowBox[{"Function", "[", 
                    RowBox[{"{", 
                    RowBox[{"White", ",", "Thin"}], "}"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PolarAngleLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "90", ",", "180"}], "}"}]}]}], 
                    "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacings", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
         "opts"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6781992111957703`*^9, 3.678199539697233*^9}, {
   3.678199611291655*^9, 3.678199637204233*^9}, {3.678199804348329*^9, 
   3.678199936940053*^9}, 3.678200613651656*^9, {3.678200704145672*^9, 
   3.678200705592341*^9}, {3.6782008336022778`*^9, 3.678200836281672*^9}, {
   3.678200910975548*^9, 3.678200912181786*^9}, {3.678200957500926*^9, 
   3.678200970044305*^9}, {3.678201799804981*^9, 3.678201854061531*^9}, {
   3.678201952426856*^9, 3.678202027266261*^9}, {3.6782020585720387`*^9, 
   3.678202060544621*^9}, {3.6782021716282883`*^9, 3.678202180188671*^9}, {
   3.678202346845064*^9, 3.678202352167245*^9}, {3.678202395222846*^9, 
   3.6782023985070257`*^9}, {3.6782031071985407`*^9, 3.678203122664159*^9}, {
   3.6782031587657557`*^9, 3.678203184245509*^9}, {3.678203225435542*^9, 
   3.678203296744774*^9}, {3.678203464824766*^9, 3.678203467707196*^9}, {
   3.6782074181612387`*^9, 3.678207443666991*^9}, {3.6782077723807364`*^9, 
   3.6782077725283957`*^9}, {3.678207988697022*^9, 3.678207988869631*^9}, {
   3.678208229866762*^9, 3.678208351876554*^9}, {3.67820854037191*^9, 
   3.6782085405913563`*^9}, {3.6782087692554617`*^9, 3.678208769875917*^9}, {
   3.678209788162142*^9, 3.67820980281114*^9}, {3.678210671913931*^9, 
   3.678210695757945*^9}, {3.678210874939691*^9, 3.678210896906012*^9}, {
   3.6782109874159307`*^9, 3.678210987691577*^9}, {3.67821254374166*^9, 
   3.678212564802236*^9}, {3.678214253974681*^9, 3.6782142578369827`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "SubjectResultsPlot", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectResultsPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Union", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "SubjectPredictionsPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "SubjectFieldsPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Spacings", "\[Rule]", "_"}], ")"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"Spacings", "\[Rule]", "0"}], ")"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectResultsPlot", "[", 
    RowBox[{"sub_", ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fieldsPlot", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"SubjectFieldsPlot", "[", 
           RowBox[{"sub", ",", "ds"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"predsPlot", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"SubjectPredictionsPlot", "[", 
           RowBox[{"sub", ",", "ds"}], "]"}], ",", "opts"}], "]"}]}]}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Inset", "[", 
           RowBox[{"predsPlot", ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Inset", "[", 
           RowBox[{"fieldsPlot", ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0"}], "}"}], "]"}]}], "]"}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfeHEausZ6a8dxZ/6OYDoF7G1XiA6V/tlEYie6lFY
DqLzXvW2g+gyBuE+EM20L3MKiO7Qr5kLos8/nzsPbE5h8N3ZQPrG/SIwbfB/
PeM8IL0ibgIfiH6+MkQIRAek7FYE0UtqhLTB8m43dUD0Oovz5iCaJ87QEkTf
2CdXAqKPpx6qBov35y8H0YfWXQXTbzXz14HouAkOW8DqjyefAdFy9rpXQPSD
4uMPQfSr1AWPQHTYocefQHQwu/5XEJ1XfkpuPpA+UeujCqJNlx0KBNEcs96D
6a6v10JBtMzfRWEg+kf05MkLQPr+LgDTzD+FD4Loqh1WYBoAAd60BQ==
  "]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{937, 781},
WindowMargins->{{Automatic, 233}, {Automatic, 87}},
TrackCellChangeTimes->False,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Chapter"], CellFrame -> {{False, False}, {False, True}}], 
   Cell[
    StyleData["Subchapter"], CellMargins -> {{48, Inherited}, {8, 20}}], 
   Cell[
    StyleData["Section"], CellFrame -> {{0, 0}, {0, 0}}, CellDingbat -> 
    "\[GraySquare]", CellMargins -> {{51, Inherited}, {8, 18}}, FontSize -> 
    24, FontColor -> 
    RGBColor[0.7529411764705882, 0.15294117647058825`, 
      0.12156862745098039`]]}, Visible -> False, FrontEndVersion -> 
  "11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, 2016)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 72, 3, 148, "Title"],
Cell[655, 27, 935, 34, 153, "Chapter"],
Cell[CellGroupData[{
Cell[1615, 65, 25, 0, 63, "Chapter"],
Cell[1643, 67, 499, 9, 144, "Text"],
Cell[CellGroupData[{
Cell[2167, 80, 34, 0, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[2226, 84, 31, 0, 55, "Section"],
Cell[2260, 86, 115, 2, 57, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[2412, 93, 24, 0, 41, "Section"],
Cell[2439, 95, 381, 6, 68, "Text"],
Cell[2823, 103, 2098, 49, 329, "Input"],
Cell[4924, 154, 93, 2, 30, "Text"],
Cell[5020, 158, 1895, 49, 244, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[6964, 213, 36, 0, 47, "Subchapter"],
Cell[7003, 215, 169, 3, 49, "Text"],
Cell[CellGroupData[{
Cell[7197, 222, 39, 0, 55, "Section"],
Cell[7239, 224, 2073, 53, 285, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[9349, 282, 47, 0, 41, "Section"],
Cell[9399, 284, 141, 3, 30, "Text"],
Cell[9543, 289, 11965, 258, 1301, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[21545, 552, 50, 0, 41, "Section"],
Cell[21598, 554, 66, 0, 30, "Text"],
Cell[21667, 556, 420, 11, 74, "Input"],
Cell[22090, 569, 113, 3, 30, "Text"],
Cell[22206, 574, 1011, 27, 115, "Input"],
Cell[23220, 603, 223, 4, 49, "Text"],
Cell[23446, 609, 2863, 73, 382, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[26358, 688, 138, 2, 47, "Subchapter"],
Cell[CellGroupData[{
Cell[26521, 694, 143, 2, 55, "Section"],
Cell[CellGroupData[{
Cell[26689, 700, 48, 0, 44, "Subsection"],
Cell[26740, 702, 701, 19, 142, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[27478, 726, 165, 2, 36, "Subsection"],
Cell[27646, 730, 4020, 104, 437, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[31703, 839, 103, 1, 36, "Subsection"],
Cell[31809, 842, 11812, 269, 1385, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[43658, 1116, 128, 1, 36, "Subsection"],
Cell[43789, 1119, 6152, 162, 551, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49978, 1286, 37, 0, 36, "Subsection"],
Cell[50018, 1288, 119, 3, 30, "Text"],
Cell[50140, 1293, 691, 20, 97, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50880, 1319, 59, 0, 55, "Section"],
Cell[50942, 1321, 231, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[51198, 1329, 48, 0, 44, "Subsection"],
Cell[51249, 1331, 102, 2, 30, "Text"],
Cell[51354, 1335, 9646, 232, 1377, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61037, 1572, 58, 0, 44, "Subsection"],
Cell[61098, 1574, 266, 5, 68, "Text"],
Cell[61367, 1581, 32566, 697, 3049, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93970, 2283, 38, 0, 44, "Subsection"],
Cell[94011, 2285, 10634, 249, 978, "Input"]
}, Open  ]],
Cell[104660, 2537, 79, 0, 44, "Subsection"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104800, 2544, 148, 3, 162, "Chapter"],
Cell[CellGroupData[{
Cell[104973, 2551, 103, 1, 55, "Section"],
Cell[105079, 2554, 43561, 886, 3981, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148677, 3445, 103, 1, 55, "Section"],
Cell[148783, 3448, 58741, 1247, 4197, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[207561, 4700, 110, 1, 41, "Section"],
Cell[207674, 4703, 7111, 155, 726, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[214822, 4863, 221, 3, 41, "Section"],
Cell[215046, 4868, 21603, 492, 2238, "Input"],
Cell[236652, 5362, 16523, 392, 1881, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253212, 5759, 106, 1, 55, "Section"],
Cell[253321, 5762, 13385, 290, 1314, "Input"],
Cell[266709, 6054, 3124, 79, 369, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

