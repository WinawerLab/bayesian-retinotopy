(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    779102,      18011]
NotebookOptionsPosition[    758816,      17537]
NotebookOutlinePosition[    759855,      17568]
CellTagsIndexPosition[    759812,      17565]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
V1, V2, and V3 Retinotopic Maps:
Visualizations\
\>", "Title",ExpressionUUID->"8d4e763a-023f-4955-bab5-41368eb985c1"],

Cell[TextData[{
 "Noah C. Benson",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]],ExpressionUUID->
  "ff154506-5578-4f2b-ac40-a98a7d0ec16c"],
 ", Geoff K. Aguirre",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "2"], TraditionalForm]],ExpressionUUID->
  "d98c611e-5663-442d-a4a3-bb0ba75cb0ea"],
 ", Jonathan Winawer",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", 
    RowBox[{"1", ",", "3"}]], TraditionalForm]],ExpressionUUID->
  "bd4a7a2d-5696-479c-bd18-467cac4e22e9"],
 "\[LineSeparator]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]],
  FontSize->18,ExpressionUUID->"f7cad2f5-bf7e-4660-bb89-643604859e4d"],
 StyleBox["Department of Psychology, New York University, New York, NY, USA\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "2"], TraditionalForm]],
  FontSize->18,ExpressionUUID->"8e8e4f38-bd41-4335-986f-ec7b3ac910ed"],
 StyleBox["Department of Neurology, University of Pennsylvania, Philadelphia, \
PA, USA\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "3"], TraditionalForm]],
  FontSize->18,ExpressionUUID->"728df6d5-a032-4aa8-bfdc-6eeab1aa3acc"],
 StyleBox["Center for Neural Sciences, New York University, New York, NY, USA",
  FontSize->18]
}], "Chapter",ExpressionUUID->"53abb8f0-427e-41cf-a18a-2373101a7a0a"],

Cell[CellGroupData[{

Cell["Header", "Chapter",ExpressionUUID->"22e3e616-22a0-4d44-b329-2e5f6c36aab0"],

Cell["\<\
This section includes all code that:
  (a) defines a piece of data
  (b) configures the environment
  (c) constructs a library of tools for visualization and analysis
All code in this section should either run very quickly or should be defined \
using MemoizeSafe, AutoCache, and/or AutoManageData so as to run immediately \
and load data or perform calculations lazily when requested. Accordingly, \
this section should evaluate quickly, much like loading a project library.\
\>", "Text",ExpressionUUID->"cc710ea1-b471-4a37-9e59-5adda0d67774"],

Cell[CellGroupData[{

Cell["Introduction", "Subchapter",ExpressionUUID->"e7e7ff45-d5c6-45bf-b6a5-946d1d516f8f"],

Cell[CellGroupData[{

Cell["Dependencies", "Section",ExpressionUUID->"c865ccc4-87cf-43da-8ced-b782821d42f0"],

Cell[BoxData[{
 RowBox[{"<<", "ErrorBarPlots`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Neurotica`"}]}], "Input",ExpressionUUID->"1a59d6d9-0721-4ea4-\
a7bf-1bd215ee3e8d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Paths", "Section",ExpressionUUID->"2d83157c-2445-47bc-a4df-ca5ed1b9d327"],

Cell["\<\
This notebook expects to be able to access data in the V123 data root, the \
contents of which can be downloaded from the open science framework \
(http://osf.io/). If you have the V123_DATA_ROOT environment variable set \
correctly, or if this notebook is in the root, then this cell should find the \
root fine; otherwise, you may need to set it manually.\
\>", "Text",ExpressionUUID->"48921840-01bd-4d50-b387-14c57db6aefd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$DataRoot", ",", "$V123VisualizationNotebookDirectory"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$V123VisualizationNotebookDirectory", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$DataRoot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"env", "=", 
         RowBox[{"Environment", "[", "\"\<V123_DATA_ROOT\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"loc", "=", "$V123VisualizationNotebookDirectory"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"env", "=!=", "$Failed"}], ",", "env", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<analyses\>\""}], "}"}], "]"}], ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<freesurfer_subjects\>\""}], "}"}], 
              "]"}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "loc", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "True", ",", "$Failed"}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"673cb347-00ca-437d-8bfd-\
174cb5c89235"],

Cell["\<\
These data simply define directories in terms of the above data root:\
\>", "Text",ExpressionUUID->"376e780c-9366-41a2-92fd-88a766d36bae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FreeSurferRoot", ",", "$AnalysesRoot", ",", "$RetinotopyRoot", ",", 
    "$FigureRoot", ",", "$ModelRoot"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FreeSurferRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<freesurfer_subjects\>\""}], "}"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AnalysesRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<analyses\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<retinotopy\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<figures\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ModelRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<models\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"532b5e3a-bf9d-4a30-b93d-26ed995e4127"],

Cell["We want to make sure we can find FreeSurfer:", "Text",ExpressionUUID->"ff27e4fa-1a4e-4748-9817-038011652e97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"$FreeSurferSubjectsDirectories", ",", "$FreeSurferRoot"}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"AddFreeSurferSubjectsDirectory", "[", "$FreeSurferRoot", "]"}]}],
    "]"}], ";"}]], "Input",ExpressionUUID->"b1ab3cf7-5b82-4f3d-9a57-\
167951ace5f5"],

Cell["We also want to correctly set Neurotica\[CloseCurlyQuote]s cache \
directory:", "Text",ExpressionUUID->"096e146a-1c3e-4848-b0b2-9d4ebd930a87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CacheDirectory", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$CacheDirectory", ":=", 
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", ":", 
        RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"s", ",", "\"\<cache\>\"", ",", "\"\<mma\>\""}], "}"}], 
        "]"}]}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"b0408970-\
f60f-4633-ac49-25f60d0017f5"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing Data", "Subchapter",ExpressionUUID->"dd463ddd-83c9-4728-bc73-cabc33e4c4b5"],

Cell["\<\
In this section of the notebook, we import the data from the retinotopy and \
analyses directories; we setup subject datasets according to these \
\>", "Text",ExpressionUUID->"0188cd34-0261-447d-8333-00e1244f5c7d"],

Cell[CellGroupData[{

Cell["The list of subjects", "Section",ExpressionUUID->"a3ef7226-5bd7-48e3-af8d-243257829892"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Subjects", ",", "$SubjectDatasets"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Subjects", ":=", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FileNames", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$RetinotopyRoot", ",", "\"\<S*\>\""}], "}"}], "]"}]}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$SubjectDatasets", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "\[Rule]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fs", "=", 
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FileNames", "@", 
                RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                  "$RetinotopyRoot", ",", "sub", ",", 
                   "\"\<lh_*_angle.mgz\>\""}], "}"}], "]"}]}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Union", "@", 
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "5"}], "}"}]}], "]"}], "&"}], "/@", 
              "fs"}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"sub", ",", "$Subjects"}], "}"}]}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"5ff26971-3209-4f3e-8c32-e91e88bdfb1e"],

Cell["\<\
Simple function to return the fraction of total scans that went into a \
particular dataset.\
\>", "Text",ExpressionUUID->"7aee201c-f5b6-425c-80dd-928ef35241db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SubjectScanCount", ",", "SubjectDatasetCoverage"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectScanCount", "[", "sub_", "]"}], ":=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"StringTake", "[", 
     RowBox[{"sub", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectDatasetCoverage", "[", 
    RowBox[{"sub_", ",", "ds_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"scans", "=", 
        RowBox[{"SubjectScanCount", "[", "sub", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fnm", "=", 
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "@", 
          RowBox[{"First", "@", 
           RowBox[{"FileNames", "@", 
            RowBox[{"FileNameJoin", "@", 
             RowBox[{"List", "[", "\[IndentingNewLine]", 
              RowBox[{
              "$RetinotopyRoot", ",", "sub", ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<lh_\>\"", "<>", 
                RowBox[{"IntegerString", "[", 
                 RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                "\"\<:*_angle.mgz\>\""}]}], "]"}]}]}]}]}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"StringTake", "[", 
       RowBox[{"fnm", ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "8"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"15acbdbd-b790-48fc-beab-ad6e33a7be9e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading Benson14 group-average data", "Section",ExpressionUUID->"915cc7ed-f753-4751-b2b2-06aef3e4794d"],

Cell[CellGroupData[{

Cell["Load the raw data into nice data structures", "Subsection",ExpressionUUID->"15c6cef9-af7a-43ae-837c-e0f1c8237e9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "Benson14Data", ",", " ", "Benson14AnalysesData", ",", " ", 
     "$Benson14RetinotopyData"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Benson14AnalysesData", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Benson17\>\""}], ",", 
     RowBox[{"MaxSteps", "\[Rule]", "2000"}], ",", 
     RowBox[{"Scale", "\[Rule]", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "Benson14Data", "]"}], "=", 
    RowBox[{"Options", "[", "Benson14AnalysesData", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Benson14RetinotopyData", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"$RetinotopyRoot", ",", "\"\<aggregate\>\"", ",", 
                RowBox[{"#1", "<>", "\"\<.mgz\>\""}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<weight\>\""}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<Weight\>\""}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Benson14AnalysesData", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mdlString", "=", 
          RowBox[{"ToLowerCase", "@", 
           RowBox[{"Replace", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"steps", "=", 
          RowBox[{"OptionValue", "[", "MaxSteps", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"scale", "=", 
          RowBox[{"OptionValue", "[", "Scale", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tag", "=", 
           RowBox[{"StringJoin", "@", 
            RowBox[{"List", "[", "\[IndentingNewLine]", 
             RowBox[{
             "mdlString", ",", "\"\<_\>\"", ",", "\[IndentingNewLine]", 
              "\"\<steps=\>\"", ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{"steps", ",", "10", ",", "5"}], "]"}], ",", 
              "\[IndentingNewLine]", "\"\<_scale=\>\"", ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"scale", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}], ",", 
                 RowBox[{"NumberPadding", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<0\>\"", ",", "\"\<0\>\""}], "}"}]}]}], 
                "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Append", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"Rule", "[", "\[IndentingNewLine]", 
                RowBox[{"#2", ",", "\[IndentingNewLine]", 
                 RowBox[{"Import", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"FileNameJoin", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$AnalysesRoot", ",", "\"\<aggregate\>\"", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<lh.predict_\>\"", ",", "#1", ",", "\"\<.\>\"", ",", 
                    "tag", ",", "\"\<.mgz\>\""}], "}"}], "]"}]}], "]"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                  "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", 
                  "\"\<varea\>\""}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                  "\"\<VisualArea\>\""}], "}"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Registration\>\"", "\[Rule]", 
             RowBox[{"VertexCoordinates", "@", 
              RowBox[{"Import", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{"$AnalysesRoot", ",", "\"\<aggregate\>\"", ",", 
                   RowBox[{
                   "\"\<lh.retinotopy.\>\"", "<>", "tag", "<>", 
                    "\"\<.sphere.reg\>\""}]}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", "\"\<FreeSurferSurface\>\""}], 
               "]"}]}]}]}], "]"}]}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Benson14Data", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rdata", "=", "$Benson14RetinotopyData"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"adata", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"Benson14AnalysesData", "[", "]"}], ",", "opts"}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"rdata", ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\"\<Predicted\>\"", "<>", "#1"}], ")"}], "\[Rule]", 
              "#2"}], "]"}], ",", "\[IndentingNewLine]", "adata"}], "]"}]}]}],
         "]"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->\
"bd46d951-0891-4679-b5ce-5eb6b217feb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Apply the data to meshes and maps", "Subsection",ExpressionUUID->"c78ba169-4b66-4674-b3d5-e147155f8224"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "$SymMapTemplate", ",", "$MiniMapTemplate", ",", "SymToMap", ",", 
     "SymToMiniMap", ",", "$MiniMapCenter", ",", "$MiniMapRadius"}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymToMap", "::", "usage"}], "=", 
   "\"\<SymToMap[mesh, hemi] projects the given fsaverage_sym-aligned \
spherical mesh to a map; if hemi is RH, then reverses this so that it \
resembles a right-hemisphere projection.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"$SymMapTemplate", "::", "usage"}], "=", 
    "\"\<$SymMapTemplate is a template map for projecting a Sym hemisphere to \
a map of the visual cortex; see also SymToMap.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MiniMapCenter", "=", 
   RowBox[{"{", 
    RowBox[{"18", ",", "12"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$MiniMapRadius", "=", "50"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$SymMapTemplate", ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"CorticalMapQ", "[", "#", "]"}]}], ",", "$Failed", ",", 
          "#"}], "]"}], "&"}], "@", 
       RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"$FreeSurferSubjects", "[", "\"\<fsaverage_sym\>\"", "]"}],
            ",", "LH", ",", "\"\<Sphere\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "7.03"}], ",", 
              RowBox[{"-", "82.59"}], ",", 
              RowBox[{"-", "55.94"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2.98", ",", 
              RowBox[{"-", "78.78"}], ",", 
              RowBox[{"-", "61.52"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Radius", "\[Rule]", 
          RowBox[{"Quantity", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Pi", "/", "2.5"}], "]"}], ",", "\"\<Radians\>\""}], 
           "]"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"$MiniMapTemplate", ":=", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mesh", "=", 
          RowBox[{"\"\<SphericalMesh\>\"", "/.", 
           RowBox[{"Options", "[", 
            RowBox[{"$SymMapTemplate", ",", "MetaInformation"}], "]"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"CorticalMapQ", "[", "#", "]"}]}], ",", "$Failed", ",", 
            "#"}], "]"}], "&"}], "@", 
         RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
          RowBox[{"mesh", ",", "\[IndentingNewLine]", 
           RowBox[{"Center", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{"$SymMapTemplate", ",", "Center"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{"$SymMapTemplate", ",", "Method"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Radius", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{"$SymMapTemplate", ",", "Radius"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Exclusions", "\[Rule]", 
            RowBox[{"Complement", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"VertexList", "[", "mesh", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"SelectVertices", "[", 
               RowBox[{"$SymMapTemplate", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{"#VertexCoordinates", "-", "$MiniMapCenter"}], 
                   "]"}], "<", "$MiniMapRadius"}], "&"}]}], "]"}]}], 
             "]"}]}]}], "]"}]}]}], "]"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymToMap", "[", 
     RowBox[{"mesh_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}], ":", "LH"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"map0", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\"\<fsaverage_sym\>\"", "\[Equal]", 
           RowBox[{"Last", "@", 
            RowBox[{"FileNameSplit", "@", 
             RowBox[{"Path", "[", 
              RowBox[{"\"\<Subject\>\"", "/.", 
               RowBox[{"MetaInformation", "[", "mesh", "]"}]}], "]"}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
             RowBox[{"$SymMapTemplate", ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"u", "=", 
                  RowBox[{"VertexList", "[", "$SymMapTemplate", "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"p", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "/.", "mesh"}], ")"}], "[", 
                    RowBox[{"[", "u", "]"}], "]"}], ")"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", 
                    RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VertexPropertyList", "[", "mesh", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Except", "[", 
                    RowBox[{
                    "\"\<VertexIndex\>\"", "|", "\"\<VertexCoordinates\>\"", 
                    "|", "\"\<VertexNormals\>\""}], "]"}]}], "]"}]}], "}"}]}],
                  "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"MetaInformation", "\[Rule]", 
             RowBox[{"MetaInformation", "[", "mesh", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
           RowBox[{"mesh", ",", "\[IndentingNewLine]", 
            RowBox[{"Center", "\[Rule]", 
             RowBox[{"Options", "[", 
              RowBox[{"$SymMapTemplate", ",", "Center"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"Options", "[", 
              RowBox[{"$SymMapTemplate", ",", "Method"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Radius", "\[Rule]", 
             RowBox[{"Options", "[", 
              RowBox[{"$SymMapTemplate", ",", "Radius"}], "]"}]}]}], "]"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"hemi", "===", "LH"}], ",", "\[IndentingNewLine]", "map0", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"CorticalMap", "[", 
         RowBox[{"map0", ",", 
          RowBox[{"VertexCoordinates", "\[Rule]", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
             RowBox[{"VertexCoordinatesTr", "[", "map0", "]"}]}], "]"}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymToMiniMap", "[", 
    RowBox[{"mesh_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}], ":", "LH"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"map0", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"\"\<fsaverage_sym\>\"", "\[Equal]", 
          RowBox[{"Last", "@", 
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"Path", "[", 
             RowBox[{"\"\<Subject\>\"", "/.", 
              RowBox[{"MetaInformation", "[", "mesh", "]"}]}], "]"}]}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
            RowBox[{"$MiniMapTemplate", ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u", "=", 
                 RowBox[{"VertexList", "[", "$MiniMapTemplate", "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"p", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "/.", "mesh"}], ")"}], "[", 
                    RowBox[{"[", "u", "]"}], "]"}], ")"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", 
                   RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VertexPropertyList", "[", "mesh", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Except", "[", 
                    RowBox[{
                    "\"\<VertexIndex\>\"", "|", "\"\<VertexCoordinates\>\"", 
                    "|", "\"\<VertexNormals\>\""}], "]"}]}], "]"}]}], "}"}]}],
                 "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"MetaInformation", "\[Rule]", 
            RowBox[{"MetaInformation", "[", "mesh", "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"map1", "=", 
             RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
              RowBox[{"mesh", ",", "\[IndentingNewLine]", 
               RowBox[{"Center", "\[Rule]", 
                RowBox[{"Options", "[", 
                 RowBox[{"$MiniMapTemplate", ",", "Center"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Method", "\[Rule]", 
                RowBox[{"Options", "[", 
                 RowBox[{"$MiniMapTemplate", ",", "Method"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Radius", "\[Rule]", 
                RowBox[{"Options", "[", 
                 RowBox[{"$MiniMapTemplate", ",", "Radius"}], "]"}]}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
            RowBox[{"mesh", ",", "\[IndentingNewLine]", 
             RowBox[{"Center", "\[Rule]", 
              RowBox[{"Options", "[", 
               RowBox[{"$MiniMapTemplate", ",", "Center"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Method", "\[Rule]", 
              RowBox[{"Options", "[", 
               RowBox[{"$MiniMapTemplate", ",", "Method"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Radius", "\[Rule]", 
              RowBox[{"Options", "[", 
               RowBox[{"$MiniMapTemplate", ",", "Radius"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Exclusions", "\[Rule]", 
              RowBox[{"Complement", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"VertexList", "[", "mesh", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"SelectVertices", "[", 
                 RowBox[{"map1", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"#VertexCoordinates", "-", "$MiniMapCenter"}], 
                    "]"}], "<", "$MiniMapRadius"}], "&"}]}], "]"}]}], 
               "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"hemi", "===", "LH"}], ",", "\[IndentingNewLine]", "map0", ",",
        "\[IndentingNewLine]", 
       RowBox[{"CorticalMap", "[", 
        RowBox[{"map0", ",", 
         RowBox[{"VertexCoordinates", "\[Rule]", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
            RowBox[{"VertexCoordinatesTr", "[", "map0", "]"}]}], "]"}]}]}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"0ef92fd6-\
0de6-4743-94cc-8826659080ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Benson14Mesh", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Benson14Mesh", "]"}], "=", 
   RowBox[{"Options", "[", "Benson14Data", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Benson14Mesh", "[", 
     RowBox[{
      RowBox[{"surf", ":", 
       RowBox[{"Except", "[", "\"\<Retinotopy\>\"", "]"}], ":", 
       "\"\<Inflated\>\""}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdat", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"Benson14Data", "[", "]"}], ",", "opts"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"msh", "=", 
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"$FreeSurferSubjects", "[", "\"\<fsaverage_sym\>\"", "]"}],
            ",", "LH", ",", "surf"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVertexProperties", "[", 
       RowBox[{"msh", ",", 
        RowBox[{"Normal", "[", "sdat", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"3b496899-6d5b-46a4-a600-084895a6757c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "Benson14Map", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "Benson14Map", "]"}], "=", 
    RowBox[{"Options", "[", "Benson14Mesh", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Benson14Map", "[", 
     RowBox[{
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}], ":", "LH"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mesh", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"Benson14Mesh", "[", "\"\<Sphere\>\"", "]"}], ",", "opts"}],
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"map0", "=", 
           RowBox[{"SymToMap", "[", 
            RowBox[{"mesh", ",", "hemi"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"reg", "=", 
           RowBox[{"\"\<PredictedRegistration\>\"", "/.", "mesh"}]}]}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
         RowBox[{"map0", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<PredictedRegistration\>\"", "\[Rule]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x0", "=", 
               RowBox[{"VertexCoordinates", "@", 
                RowBox[{"Reproject", "[", 
                 RowBox[{"map0", ",", "reg"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"hemi", "===", "LH"}], ",", "x0", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "x0"}], 
                "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}],
   ";"}]}], "Input",ExpressionUUID->"59cf4f16-8281-4b65-a299-1ab6693d35b4"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading subject surface data", "Section",ExpressionUUID->"0e3f1085-9dee-4227-a6d7-86441afe6954"],

Cell[CellGroupData[{

Cell["Load the raw data into data structures", "Subsection",ExpressionUUID->"110c9e12-9379-4f79-bcad-0c0a9113819d"],

Cell["\<\
These cells just import the mgz files in the analyses directory and organize \
them into a convenient data structure.\
\>", "Text",ExpressionUUID->"aae2ec8b-88aa-4b72-a71e-7cb3f1a79a36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "SubjectRetinotopyData", ",", "SubjectAnalysesData", ",", 
     "SubjectBenson14Data", ",", "SubjectBenson17Data", ",", "SubjectData", 
     ",", "Subject1901WideFieldRetinotopyData", ",", "RetinotopyModel"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RetinotopyModel", "::", "usage"}], "=", 
    "\"\<RetinotopyModel is a keyword and option to SubjectData, SubjectMesh, \
SubjectMap, and similar; it specifies that either the \\\"Benson17\\\" \
(Automatic) or \\\"Schira\\\" model should be used.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectAnalysesData", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Benson17\>\""}], ",", 
     RowBox[{"Clip", "\[Rule]", "12"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SubjectData", "]"}], "=", 
    RowBox[{"Options", "[", "SubjectAnalysesData", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubjectRetinotopyData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FileNames", "@", 
               RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "$RetinotopyRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                  RowBox[{"StringJoin", "@", 
                   RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                    "\"\<:*\>\""}], ",", 
                    RowBox[{"#1", "<>", "\"\<.mgz\>\""}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\"\<_\>\""}], "]"}]}]}], "}"}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<prfsz\>\"", ",", 
            "\"\<vexpl\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<PRFSize\>\"", ",", "\"\<VarianceExplained\>\""}], "}"}]}], 
         "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Subject1901WideFieldRetinotopyData", "[", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FileNames", "@", 
               RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "$RetinotopyRoot", ",", "\"\<S1901\>\"", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"StringJoin", "@", 
                   RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    "\"\<widef\>\"", ",", 
                    RowBox[{"#1", "<>", "\"\<.mgz\>\""}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\"\<_\>\""}], "]"}]}]}], "}"}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<prfsz\>\"", ",", 
            "\"\<vexpl\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<WidePolarAngle\>\"", ",", "\"\<WideEccentricity\>\"", ",", 
            "\"\<WidePRFSize\>\"", ",", "\"\<WideVarianceExplained\>\""}], 
           "}"}]}], "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectAnalysesData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mdlString", "=", 
          RowBox[{"ToLowerCase", "@", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
             RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"clipString", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Clip", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k_Integer", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"\"\<_clip=\>\"", "<>", 
                 RowBox[{"ToString", "[", "k", "]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"None", "\[Rule]", "\"\<\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[Rule]", "\"\<_clip=12\>\""}]}], "}"}]}],
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "@", 
             RowBox[{"Rule", "[", "\[IndentingNewLine]", 
              RowBox[{"#2", ",", "\[IndentingNewLine]", 
               RowBox[{"Import", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                   "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    RowBox[{"StringJoin", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    "\"\<.predict_\>\"", ",", "mdlString", ",", "\"\<_\>\"", 
                    ",", "\[IndentingNewLine]", "#1", ",", "clipString", ",", 
                    "\"\<.\>\"", ",", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], ",", 
                    "\"\<.mgz\>\""}], "]"}]}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<varea\>\""}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                "\"\<VisualArea\>\""}], "}"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ds", ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"magData", "=", 
                RowBox[{"Join", "@@", 
                 RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "@", 
                    RowBox[{"Rule", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<Magnification\>\"", "<>", "#1", "<>", "#2"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Import", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
                    "\"\<.cm_\>\"", "<>", "mdlString", "<>", "\"\<_\>\"", "<>", 
                    RowBox[{"ToLowerCase", "[", "#1", "]"}], "<>", 
                    "\"\<_\>\"", "<>", 
                    RowBox[{"ToLowerCase", "[", "#2", "]"}], "<>", 
                    "\"\<_clip=12.mgz\>\""}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Pial\>\"", ",", "\"\<White\>\""}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", 
                    "\"\<Tangential\>\""}], "}"}], ",", "\[IndentingNewLine]",
                    "1", ",", "1"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ratios", "=", 
                  RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ma", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<Magnification\>\"", "<>", "s", "<>", "a"}], 
                    ")"}], "/.", "magData"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"mb", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<Magnification\>\"", "<>", "s", "<>", "b"}], 
                    ")"}], "/.", "magData"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "b"}], ",", 
                    "\[IndentingNewLine]", "Nothing", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "\"\<MagRatio\>\"", "<>", "s", "<>", "a", "<>", "b"}], 
                    ")"}], "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "@", 
                    RowBox[{"Chop", "[", "mb", "]"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"ma", "/", 
                    RowBox[{"(", 
                    RowBox[{"mb", "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "@", 
                    RowBox[{"Chop", "[", "mb", "]"}]}]}], ")"}]}], ")"}]}], 
                    ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"0.0", "\[Rule]", "1.0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Tangential\>\"", ",", "\"\<Radial\>\"", ",", 
                    "\"\<Areal\>\""}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Radial\>\"", ",", "\"\<Areal\>\""}], "}"}]}],
                     "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<White\>\"", ",", "\"\<Pial\>\""}], "}"}]}], 
                    "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Join", "[", 
                 RowBox[{"magData", ",", "ratios"}], "]"}]}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectBenson14Data", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"List", "[", "\[IndentingNewLine]", 
               RowBox[{"$AnalysesRoot", ",", "sub", ",", 
                RowBox[{
                 RowBox[{"ToLowerCase", "@", 
                  RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", "\"\<.\>\"",
                  "<>", "#1", "<>", "\"\<_benson14.mgz\>\""}]}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<varea\>\""}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<VisualArea\>\""}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectBenson17Data", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"List", "[", "\[IndentingNewLine]", 
               RowBox[{"$AnalysesRoot", ",", "sub", ",", 
                RowBox[{
                 RowBox[{"ToLowerCase", "@", 
                  RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", "\"\<.\>\"",
                  "<>", "#1", "<>", "\"\<_benson17.mgz\>\""}]}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<varea\>\""}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<VisualArea\>\""}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rdat", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"adat", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectAnalysesData", "[", 
             RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"rgs", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ags", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectAnalysesData", "[", 
             RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}], ",", "opts"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"b14", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectBenson14Data", "[", 
             RowBox[{"sub", ",", "hemi"}], "]"}], ",", "opts"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"b17", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectBenson17Data", "[", 
             RowBox[{"sub", ",", "hemi"}], "]"}], ",", "opts"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"This", " ", "is", " ", "the", " ", "vexpl"}], "-", "to", 
           "-", 
           RowBox[{
           "weight", " ", "transform", " ", "used", " ", "in", " ", "the", 
            " ", "python", " ", "library", " ", "v123"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"vexplToWeight", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"#", ">", "0.2"}], "&"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Erf", "@", 
              RowBox[{"Times", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"InverseErf", "[", "0.5", "]"}], "/", 
                 RowBox[{"Median", "[", "w", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Unitize", "[", "#", "]"}], "*", "#"}]}], "]"}]}]}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"schiraQ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StringQ", "[", "#", "]"}], "&&", 
              RowBox[{
               RowBox[{"ToLowerCase", "[", "#", "]"}], "\[Equal]", 
               "\"\<schira\>\""}]}], ")"}], "&"}], "@", 
           RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"mdlnm", "=", 
          RowBox[{"ToLowerCase", "@", 
           RowBox[{"ToString", "@", 
            RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}]}]}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"filt", "=", 
           RowBox[{"If", "[", 
            RowBox[{"schiraQ", ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"idcs", "=", 
                 RowBox[{"Indices", "[", 
                  RowBox[{
                   RowBox[{"adat", "[", "\"\<VisualArea\>\"", "]"}], ",", 
                   RowBox[{"x_", "/;", 
                    RowBox[{"Not", "[", 
                    RowBox[{"0", "<", 
                    RowBox[{"Abs", "[", "x", "]"}], "<", "4"}], "]"}]}]}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Function", "@", 
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"idcs", "\[Rule]", "0"}], "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", "Identity"}], "]"}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PRFSize\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<VarianceExplained\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"\"\<Weight\>\"", "\[Rule]", 
               RowBox[{"vexplToWeight", "@", 
                RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}]}], 
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson14PolarAngle\>\"", "\[Rule]", 
               RowBox[{"b14", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson14Eccentricity\>\"", "\[Rule]", 
               RowBox[{"b14", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson14VisualArea\>\"", "\[Rule]", 
               RowBox[{"b14", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson17PolarAngle\>\"", "\[Rule]", 
               RowBox[{"b17", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson17Eccentricity\>\"", "\[Rule]", 
               RowBox[{"b17", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson17VisualArea\>\"", "\[Rule]", 
               RowBox[{"b17", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedPolarAngle\>\"", "\[Rule]", 
               RowBox[{"filt", "@", 
                RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedEccentricity\>\"", "\[Rule]", 
               RowBox[{"filt", "@", 
                RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedVisualArea\>\"", "\[Rule]", 
               RowBox[{"filt", "@", 
                RowBox[{"Abs", "@", 
                 RowBox[{"adat", "[", "\"\<VisualArea\>\"", "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedRegistration\>\"", "\[Rule]", 
               RowBox[{"VertexCoordinates", "@", 
                RowBox[{"Import", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"FileNameJoin", "@", 
                   RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "\"\<lh\>\"", ",", 
                    "\"\<rhx\>\""}], "]"}], "<>", "\"\<.retinotopy.\>\"", "<>",
                     "mdlnm", "<>", "\"\<_\>\"", "<>", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                    "\"\<.sphere.reg\>\""}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", "\"\<FreeSurferSurface\>\""}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<ResidualPolarAngle\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}], "-", 
                 RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], ")"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<ResidualEccentricity\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}], "-", 
                 RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}], ")"}]}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<ResidualAngle\>\"", "\[Rule]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pang", "=", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"pecc", "=", 
                    RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"gang", "=", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"gecc", "=", 
                    RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pxy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pecc", "*", 
                    RowBox[{"Cos", "[", "pang", "]"}]}], ",", 
                    RowBox[{"pecc", "*", 
                    RowBox[{"Sin", "[", "pang", "]"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"gxy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"gecc", "*", 
                    RowBox[{"Cos", "[", "gang", "]"}]}], ",", 
                    RowBox[{"gecc", "*", 
                    RowBox[{"Sin", "[", "gang", "]"}]}]}], "}"}]}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"ColumnNorms", "[", 
                    RowBox[{"gxy", "-", "pxy"}], "]"}]}], "]"}]}], "]"}]}], 
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldPolarAngle\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldEccentricity\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldPRFSize\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldVarianceExplained\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldWeight\>\"", "\[Rule]", 
               RowBox[{"vexplToWeight", "@", 
                RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}]}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"sub", "\[Equal]", "\"\<S1901\>\""}], ",", 
              RowBox[{"Normal", "@", 
               RowBox[{
               "Subject1901WideFieldRetinotopyData", "[", "hemi", "]"}]}], 
              ",", 
              RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nm", "\[Rule]", 
               RowBox[{"ags", "[", "nm", "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"nm", ",", 
                RowBox[{"Join", "@@", 
                 RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<Magnification\>\"", "<>", "#1", "<>", "#2"}],
                     "&"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<White\>\"", ",", "\"\<Pial\>\""}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", 
                    "\"\<Tangential\>\""}], "}"}], ",", "\[IndentingNewLine]",
                    "1", ",", "1"}], "]"}]}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nm", "\[Rule]", 
               RowBox[{"ags", "[", "nm", "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"nm", ",", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "ags", "]"}], ",", 
                  RowBox[{
                   RowBox[{"StringStartsQ", "[", 
                    RowBox[{"#", ",", "\"\<MagRatio\>\""}], "]"}], "&"}]}], 
                 "]"}]}], "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"b20248dc-ad96-4538-ba15-\
66857ccda745"]
}, Closed]],

Cell[CellGroupData[{

Cell["Apply the data to subject meshes and maps", "Subsection",ExpressionUUID->"6ea778a1-be85-4233-9da7-9868a116d90d"],

Cell["Here we just cache the FreeSurfer subject objects.", "Text",ExpressionUUID->"71e2d094-3e94-4dd6-99da-9096cfa338e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Subject", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Subject", "[", "sub_String", "]"}], ":=", 
    RowBox[{"FreeSurferSubject", "@", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"$FreeSurferRoot", ",", "sub"}], "}"}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"38be62a3-af4d-45fe-8ac8-6d3e84442b66"],

Cell["\<\
Here, we create a subject mesh and apply all the subject\[CloseCurlyQuote]s \
data to it.\
\>", "Text",ExpressionUUID->"24f13436-2ba7-43fc-9102-b666f64039e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectMesh", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectMesh", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectData", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectMesh", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "surf_String", ",", "ds_Integer", 
      ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdat", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectData", "[", 
            RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"msh", "=", 
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"Subject", "[", "sub", "]"}], ",", "hemi", ",", "surf"}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SetVertexProperties", "[", 
       RowBox[{"msh", ",", 
        RowBox[{"Normal", "[", "sdat", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"4d3307c0-2a44-48d9-9902-6f5b51858a4c"],

Cell["\<\
This cell creates a template map projection that is a duplicate of the one \
found in the standard.ffm.gz file distributed with the Neuropythy library \
(this is the V123 model used in registration).\
\>", "Text",ExpressionUUID->"d79eb474-a227-41d2-a06b-508306878b89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SubjectMap", ",", "SubjectMiniMap"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectMap", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMesh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SubjectMiniMap", "]"}], "=", 
    RowBox[{"Options", "[", "SubjectMesh", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubjectMap", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"SymToMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "ds"}], 
            "]"}], ",", "opts"}], "]"}], ",", "\[IndentingNewLine]", "hemi"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"map0", "=", 
            RowBox[{"SubjectMap", "[", 
             RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sdat", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"SubjectData", "[", 
               RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"idcs", "=", 
             RowBox[{"VertexList", "[", "map0", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
            RowBox[{"map0", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "idcs"}], "]"}], "]"}]}], "&"}], "/@", 
              RowBox[{"Normal", "[", "sdat", "]"}]}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectMiniMap", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"SymToMiniMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "ds"}], 
            "]"}], ",", "opts"}], "]"}], ",", "\[IndentingNewLine]", "hemi"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"map0", "=", 
            RowBox[{"SubjectMiniMap", "[", 
             RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sdat", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"SubjectData", "[", 
               RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"idcs", "=", 
             RowBox[{"VertexList", "[", "map0", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
            RowBox[{"map0", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "idcs"}], "]"}], "]"}]}], "&"}], "/@", 
              RowBox[{"Normal", "[", "sdat", "]"}]}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"c7081acd-\
42e3-465e-bdc2-3b524487352f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading cortical magnification path data", "Section",ExpressionUUID->"5397d0a1-1a23-464b-a89a-f24a87ff7eaf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectPathData", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectPathData", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RetinotopyModel", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Clip", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectPathData", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", 
      RowBox[{"surf", ":", 
       RowBox[{"\"\<White\>\"", "|", "\"\<Pial\>\""}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"flbase", "=", 
         RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ToLowerCase", "@", 
            RowBox[{"ToString", "[", "hemi", "]"}]}], ",", "\"\<.cmpath_\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"ToLowerCase", "@", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
              RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], "]"}]}],
            ",", "\[IndentingNewLine]", "\"\<_\>\"", ",", 
           RowBox[{"ToLowerCase", "[", "surf", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"clipstr", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Clip", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", "\"\<_clip=12\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"k_Integer", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"\"\<_clip=\>\"", "<>", 
                RowBox[{"ToString", "[", "k", "]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"None", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"filtFls", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Clip", "]"}], ",", 
             RowBox[{"Automatic", "\[Rule]", "12"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"None", "\[Rule]", 
              RowBox[{"Function", "@", 
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"#", ",", "\"\<_clip\>\""}], "]"}], "\[Equal]", 
                   RowBox[{"{", "}"}]}], "&"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"_Integer", "\[Rule]", "Identity"}]}], "}"}]}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"angFiles", "=", 
           RowBox[{"filtFls", "@", 
            RowBox[{"FileNames", "@", 
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"List", "[", "\[IndentingNewLine]", 
               RowBox[{
               "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                RowBox[{
                "flbase", "<>", "\"\<_*_ang=*\>\"", "<>", "clipstr", "<>", 
                 "\"\<.dat\>\""}]}], "]"}]}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"eccFiles", "=", 
           RowBox[{"filtFls", "@", 
            RowBox[{"FileNames", "@", 
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"List", "[", "\[IndentingNewLine]", 
               RowBox[{
               "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                RowBox[{
                "flbase", "<>", "\"\<_*_ecc=*\>\"", "<>", "clipstr", "<>", 
                 "\"\<.dat\>\""}]}], "]"}]}]}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"parsed", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"nm", "=", 
                  RowBox[{"Last", "@", 
                   RowBox[{"FileNameSplit", "[", "flnm", "]"}]}]}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"parts", "=", 
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"nm", ",", 
                    RowBox[{
                    "\"\<_ecc=\>\"", "|", "\"\<_ang=\>\"", "|", 
                    "\"\<.dat\>\"", "|", "\"\<_\>\""}]}], "]"}]}], "}"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"flnm", ",", 
                    RowBox[{"parts", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"N", "@", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"parts", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
                 "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"fls", ",", 
                RowBox[{"{", 
                 RowBox[{"angFiles", ",", "eccFiles"}], "}"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"flnm", ",", "fls"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"asc0", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "@", 
                  RowBox[{"Rule", "[", "\[IndentingNewLine]", 
                   RowBox[{"#1", ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", "=", 
                    RowBox[{"GroupBy", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k", "\[Rule]", 
                    RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"part", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"raw", "=", 
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{"part", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Table\>\""}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#2", ",", "#3", ",", "#4"}], "}"}], "]"}], ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#5", ",", "#6"}], "}"}], "]"}]}], "}"}], "&"}], "@@@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", ",", "\[IndentingNewLine]", 
                    RowBox[{"GatherBy", "[", 
                    RowBox[{"raw", ",", "First"}], "]"}]}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"part", ",", 
                    RowBox[{"p", "[", "k", "]"}]}], "}"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Keys", "[", "p", "]"}]}], "}"}]}], "]"}]}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Isoangular\>\"", ",", "\"\<Isoeccentric\>\""}], 
                    "}"}], ",", "parsed"}], "}"}]}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Fix", " ", "up", " ", "the", " ", 
               RowBox[{"VL", "/", "DL"}], " ", "so", " ", "that", " ", 
               RowBox[{"it", "'"}], "s", " ", "in", " ", "both", " ", "V2", 
               " ", "and", " ", "V3"}], ";", " ", 
              RowBox[{"also", " ", "add", " ", 
               RowBox[{"V1", "'"}], "s", " ", "borders", " ", "to", " ", 
               "V2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"#", ",", 
                RowBox[{"\"\<Isoangular\>\"", "\[Rule]", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Isoangular\>\"", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "\"\<VL\>\"", "}"}], ",", 
                    RowBox[{"{", "\"\<DL\>\"", "}"}]}], "}"}]}], "]"}]}]}], 
               "]"}], "&"}], "@", 
             RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
              RowBox[{"asc0", ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Isoangular\>\"", ",", "\"\<V2\>\""}], "}"}], 
                  "\[Rule]", 
                  RowBox[{"Append", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V2\>\"", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<90V\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<VL\>\"", "]"}], "[", "90.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<90D\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<DL\>\"", "]"}], "[", "90.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0.0", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V1\>\"", "]"}], "[", "0.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"180.0", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V1\>\"", "]"}], "[", "180.0", "]"}]}]}], "}"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Isoangular\>\"", ",", "\"\<V3\>\""}], "}"}], 
                  "\[Rule]", 
                  RowBox[{"Append", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V3\>\"", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<90V\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<VL\>\"", "]"}], "[", "90.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<90D\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<DL\>\"", "]"}], "[", "90.0", "]"}]}]}], "}"}]}], 
                   "]"}]}]}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"80625b0d-3bd2-4972-\
8579-c096b870955f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectPath", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectPath", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMesh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectPath", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "meshName_String", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ToLowerCase", "[", "meshName", "]"}], "\[Equal]", 
       "\"\<white\>\""}], ",", 
      RowBox[{"WithOptions", "[", 
       RowBox[{
        RowBox[{"SubjectPathData", "[", 
         RowBox[{"sub", ",", "hemi", ",", "\"\<White\>\""}], "]"}], ",", 
        "opts"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToLowerCase", "[", "meshName", "]"}], "\[Equal]", 
       "\"\<pial\>\""}], ",", 
      RowBox[{"WithOptions", "[", 
       RowBox[{
        RowBox[{"SubjectPathData", "[", 
         RowBox[{"sub", ",", "hemi", ",", "\"\<Pial\>\""}], "]"}], ",", 
        "opts"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"omesh", "=", 
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"SubjectMesh", "[", 
              RowBox[{"sub", ",", "hemi", ",", "meshName", ",", "0"}], "]"}], 
             ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"wmesh", "=", 
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"SubjectMesh", "[", 
              RowBox[{"sub", ",", "hemi", ",", "\"\<White\>\"", ",", "0"}], 
              "]"}], ",", "opts"}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Association", "@", 
         RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"#1", "\[Rule]", 
             RowBox[{"Association", "@", 
              RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{"#1", "\[Rule]", 
                  RowBox[{"Association", "@", 
                   RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"CortexLookup", "[", 
                    RowBox[{"omesh", ",", 
                    RowBox[{"CortexAddress", "[", 
                    RowBox[{"wmesh", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
                    "\[IndentingNewLine]", "#2"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "#2"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", "#2"}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"SubjectPathData", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<White\>\""}], "]"}]}], 
          "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID-\
>"a17cab02-7d2f-4014-99a0-40a0e24de91b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PathSummary", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PathSummary", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectPath", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PathSummary", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"area", ":", 
       RowBox[{"1", "|", "2", "|", "3", "|", "All"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"type", ":", 
       RowBox[{"\"\<Isoeccentric\>\"", "|", "\"\<Isoangular\>\""}], ":", 
       "\"\<Isoeccentric\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
     ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dd", "=", 
         RowBox[{"SubjectPath", "[", 
          RowBox[{"\"\<S0901\>\"", ",", "LH", ",", "\"\<White\>\""}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"areas", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "area", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<V\>\"", "<>", 
             RowBox[{"ToString", "[", "area", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<V1\>\"", ",", "\"\<V2\>\"", ",", "\"\<V3\>\""}], 
            "}"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Association", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hemi", "\[Rule]", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ang", "\[Rule]", 
              RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"d", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectPath", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "\"\<White\>\""}], "]"}],
                     ",", "opts"}], "]"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Divide", "@@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Total", "@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"EuclideanDistance", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Most", "[", "#", "]"}], ",", 
                    RowBox[{"Rest", "[", "#", "]"}]}], "}"}]}], "]"}]}], 
                    "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", "type", "]"}], "[", "areastr", "]"}], 
                    "[", "ang", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "k"}], "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"areastr", ",", "areas"}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"ang", ",", 
               RowBox[{"Keys", "[", 
                RowBox[{
                 RowBox[{"dd", "[", "type", "]"}], "[", "\"\<V1\>\"", "]"}], 
                "]"}]}], "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"hemi", ",", 
           RowBox[{"{", 
            RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"e9ccdb23-d437-49d1-a442-\
feff5af52dbe"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting/Analysis Code", "Subchapter",
 CellChangeTimes->{{3.662807324689231*^9, 3.662807328992319*^9}, 
   3.6628132807895737`*^9},ExpressionUUID->"4c83839d-e39b-4e27-a90a-\
8a322170b2b3"],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.658508587333959*^9, 3.658508589721416*^9}, {
  3.662853387814995*^9, 
  3.662853389412607*^9}},ExpressionUUID->"ad840763-fbc9-4d1c-abd7-\
460f26883deb"],

Cell[CellGroupData[{

Cell["Default Styles for Figures", "Subsection",ExpressionUUID->"d6f0bb22-45e9-4f6e-92d7-d365389f07e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FontFamily", ",", "$FontWeight", ",", "$FontSize", ",", "$FontColor", 
    ",", "$BaseStyle"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontFamily", "=", "\"\<Helvetica Neue\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontWeight", "=", "\"\<Thin\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontSize", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontColor", "=", "Black"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$BaseStyle", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{"$FontSize", ",", 
     RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}], ",", 
     RowBox[{"FontColor", "\[Rule]", "$FontColor"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"ac0f1697-6ec7-4c09-8d61-d54a94e791ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$FigureSmallWidth", ",", "$FigureLargeWidth", ",", "$FigureDPI"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureSmallWidth", "=", "3.35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureLargeWidth", "=", "6.93"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureDPI", "=", "600"}], ";"}]}], "Input",ExpressionUUID->\
"7670f440-3eec-4b29-9ad8-da885b215a4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$SubjectSymbols", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<S0901\>\"", "\[Rule]", "\[FilledDiamond]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0902\>\"", "\[Rule]", "\[FilledCircle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0903\>\"", "\[Rule]", "\[FilledSquare]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0904\>\"", "\[Rule]", "\[FilledUpTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0905\>\"", "\[Rule]", "\[FilledDownTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0906\>\"", "\[Rule]", "\[FilledRightTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0907\>\"", "\[Rule]", "\[FilledLeftTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S1201\>\"", "\[Rule]", "\[FivePointedStar]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S1901\>\"", "\[Rule]", "\[SixPointedStar]"}]}], "|>"}]}], 
  ";"}]], "Input",ExpressionUUID->"b8d1e1fa-7772-4ae4-8192-03c7a6544e5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auto-Cache Exported Images", "Subsection",
 CellChangeTimes->{{3.662845319835968*^9, 3.6628453308192596`*^9}, {
  3.662853392948634*^9, 
  3.662853395036529*^9}},ExpressionUUID->"38341fdb-c3f0-4017-b9c2-\
cca874d2e052"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "AutoCachePNG", ",", "AutoCachePDF", ",", "AutoCacheImageFileName"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoCacheImageFileName", "[", 
    RowBox[{"name_", ",", "\"\<PNG\>\""}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"#", ",", 
          RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.png\>\""}], ",", "#",
        ",", 
       RowBox[{"#", "<>", "\"\<.png\>\""}]}], "]"}], "&"}], "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"Prepend", "[", 
        RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoCacheImageFileName", "[", 
     RowBox[{"name_", ",", "\"\<PDF\>\""}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"#", ",", 
           RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.pdf\>\""}], ",", 
        "#", ",", 
        RowBox[{"#", "<>", "\"\<.pdf\>\""}]}], "]"}], "&"}], "@", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"Prepend", "[", 
         RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePNG", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoCachePNG", "[", 
     RowBox[{"name_", ",", "code_"}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flnm", "=", 
        RowBox[{"AutoCacheImageFileName", "[", 
         RowBox[{"name", ",", "\"\<PNG\>\""}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"img", "=", 
            RowBox[{"Image", "[", 
             RowBox[{"code", ",", 
              RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{"flnm", ",", "img", ",", "\"\<PNG\>\"", ",", 
             RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePDF", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoCachePDF", "[", 
    RowBox[{"name_", ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"flnm", "=", 
       RowBox[{"AutoCacheImageFileName", "[", 
        RowBox[{"name", ",", "\"\<PDF\>\""}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"img", "=", "code"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"flnm", ",", "img", ",", "\"\<PDF\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"feaa8ba1-f80c-4112-9ab5-1acfd9f79c19"]
}, Closed]],

Cell[CellGroupData[{

Cell["Declaring a figure and canvas", "Subsection",ExpressionUUID->"d79c90f1-3ddf-43ae-97b4-b94e7cd81756"],

Cell["\<\
This code allows us to declare a figure; figures can be queried and saved in \
a programmatic way. Figures are given a name which must be a string or a list \
of strings (where earlier strings in the list are essentially figure \
categories/sub-categories).
Figures are auto-cached when displayed.\
\>", "Text",ExpressionUUID->"5684d721-995d-48e9-9357-f026c17de0d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"Figure", ",", "SFigure"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "::", "usage"}], "=", 
   "\"\<Figure is a convenience form for tracking figures produced by the \
notebook. A Figure can be declared by simply defining it using a SetDelayed \
form (Figure[name] := code). The code should produce a graphics object that \
can be exported either as a PNG file or as a PDF file (in which case, \
(Figure[name, \\\"PDF\\\"] := code) should be used). The figure will be \
automatically saved to the $FiguresRoot directory when it is first displayed \
and will be loaded from disk for future display.\n\nOnce a figure has been \
defined, a number of methods can be used:\n  * Show@Figure[name] displays the \
figure.\n  * Graphics@Figure[name] yields the raw graphics object (this may \
require running the code, even if the figure has been previously cached).\n  \
* FileName@Figure[name] yields the figure's filename.\n  * FileType[name] \
yields the figure's file format (\\\"PNG\\\" or \\\"PDF\\\").\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SFigure", "::", "usage"}], "=", 
    "\"\<SFigure[name] is an alias for Figure[{\\\"supplemental\\\", name}]; \
note that name may be a list.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Figure", "/:", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"Figure", "[", 
      RowBox[{"name_", ",", 
       RowBox[{"fmt", ":", 
        RowBox[{"\"\<PNG\>\"", "|", "\"\<PDF\>\""}], ":", "\"\<PNG\>\""}]}], 
      "]"}], ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sym", "=", 
       RowBox[{"TemporarySymbol", "[", "\"\<fig\>\"", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Figure", "[", "name", "]"}], "=", "sym"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "name", "]"}], "&&", 
         RowBox[{
          RowBox[{"First", "[", "name", "]"}], "\[Equal]", 
          "\"\<supplemental\>\""}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"sname", "=", 
            RowBox[{"Rest", "[", "name", "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"SFigure", "[", "sname", "]"}], "=", "sym"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sym", "/:", 
       RowBox[{"FileType", "[", "sym", "]"}], "=", "fmt"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sym", "/:", 
       RowBox[{"Graphics", "[", "sym", "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{"sym", "/:", 
         RowBox[{"Graphics", "[", "sym", "]"}], "=", "code"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sym", "/:", 
       RowBox[{"FileName", "[", "sym", "]"}], ":=", 
       RowBox[{"AutoCacheImageFileName", "[", 
        RowBox[{"name", ",", "fmt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ToLowerCase", "[", "fmt", "]"}], "\[Equal]", 
         "\"\<png\>\""}], ",", 
        RowBox[{"sym", "/:", 
         RowBox[{"Show", "[", "sym", "]"}], ":=", 
         RowBox[{"TagSet", "[", "\[IndentingNewLine]", 
          RowBox[{"sym", ",", 
           RowBox[{"Show", "[", "sym", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AutoCachePNG", "[", 
            RowBox[{"name", ",", 
             RowBox[{"Graphics", "[", "sym", "]"}]}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToLowerCase", "[", "fmt", "]"}], "\[Equal]", 
         "\"\<pdf\>\""}], ",", 
        RowBox[{"sym", "/:", 
         RowBox[{"Show", "[", "sym", "]"}], ":=", 
         RowBox[{"TagSet", "[", "\[IndentingNewLine]", 
          RowBox[{"sym", ",", 
           RowBox[{"Show", "[", "sym", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AutoCachePDF", "[", 
            RowBox[{"name", ",", 
             RowBox[{"Graphics", "[", "sym", "]"}]}], "]"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", "sym"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "/:", 
    RowBox[{"FileName", "[", 
     RowBox[{"f", ":", 
      RowBox[{"Figure", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sym", "=", "f"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "sym", "]"}], "===", "Figure"}], ",", "$Failed",
         ",", 
        RowBox[{"FileName", "[", "sym", "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SFigure", "[", "sname_", "]"}], ":=", 
   RowBox[{"Figure", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "sname", "]"}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"sname", ",", "\"\<supplemental\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<supplemental\>\"", ",", "sname"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SFigure", "/:", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"SFigure", "[", 
      RowBox[{"sname_", ",", 
       RowBox[{"fmt_:", "\"\<PNG\>\""}]}], "]"}], ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"name", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "sname", "]"}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{"sname", ",", "\"\<supplemental\>\""}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<supplemental\>\"", ",", "sname"}], "}"}]}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"SetDelayed", "@@", 
      RowBox[{"Hold", "[", 
       RowBox[{
        RowBox[{"Figure", "[", 
         RowBox[{"name", ",", "fmt"}], "]"}], ",", "code"}], "]"}]}]}], 
    "]"}]}], ";"}]}], "Input",ExpressionUUID->"f5f242e6-1ff8-407f-be32-\
42cd0869763f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Color Functions", "Subsection",
 CellChangeTimes->{{3.676117055363916*^9, 
  3.676117057478757*^9}},ExpressionUUID->"af822b92-4514-429c-9542-\
8624001eeb01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "RetinotopyColor", ",", "$CMagBlendColors", ",", "$PRFBlendColors"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RetinotopyColor", "::", "usage"}], "=", 
    "\"\<RetinotopyColor[\\\"PolarAngle\\\"] and \
RetinotopyColor[\\\"Eccentricity\\\"] both yield functions appropriate for \
use with CortexPlot and CortexPlot3D which deduce whether the map/mesh is a \
raw data or predicted mesh and color it appropriately. Color schemas \
\\\"Magnification\\\" and \\\"PRFSize\\\" also plot the appropriate data.\n\
RetinotopyColor[name -> \\\"PolarAngle\\\"] can alternately be used to tell \
RetinotopyColor that the property with the given name should be colored as if \
it were PolarAngle.\n\nThe following options may be used:\n * Range (default: \
Automatic) specifies that only the eccentricity range given will be plotted; \
this may be given as a single max eccentricity or as {min, max}.\n * \
Eccentricity, VisualArea, and Weights may all be given strings, which change \
the default name of the property used in determining whether a vertex should \
be plotted and its transparency.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "RetinotopyColor", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Eccentricity", "\[Rule]", "\"\<Eccentricity\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VisualArea", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Weights", "\[Rule]", "\"\<Weight\>\""}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CMagBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Black"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Brown"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"3.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Red"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"9.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Yellow"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"27.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "White"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PRFBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", "White"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"6.0", ",", "Black"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PolarAngleErrorBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "30.0"}], ",", "White"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "20.0"}], ",", "Yellow"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10.0"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"10.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"20.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"30.0", ",", "White"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EccentricityErrorBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5"}], ",", "White"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.0"}], ",", "Yellow"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1.5", ",", "White"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AngleErrorBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.0"}], ",", "White"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.0"}], ",", "Yellow"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.0"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"3.0", ",", "White"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$MagRatioBlendColors", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.5", ",", "1", ",", "1"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", "Cyan"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", "Blue"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"2", ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"3", ",", "Yellow"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "1", ",", "0.5"}], "]"}]}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"s_String", "/;", 
      RowBox[{"StringStartsQ", "[", 
       RowBox[{"s", ",", "\"\<Predicted\>\""}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "\[Rule]", 
      RowBox[{"StringTake", "[", 
       RowBox[{"s", ",", 
        RowBox[{"10", ";;", "All"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "opts", ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "\"\<PredictedVisualArea\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Eccentricity", "\[Rule]", "\"\<PredictedEccentricity\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "None"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"s_String", "/;", 
      RowBox[{"StringStartsQ", "[", 
       RowBox[{"s", ",", "\"\<Gold\>\""}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "\[Rule]", 
      RowBox[{"StringTake", "[", 
       RowBox[{"s", ",", 
        RowBox[{"5", ";;", "All"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "opts", ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Eccentricity", "\[Rule]", "\"\<GoldEccentricity\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "\"\<GoldWeight\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", ":", 
      RowBox[{
      "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
       "\"\<Magnification\>\"", "|", "\"\<CMag\>\"", "|", "\"\<PRFSize\>\"", 
       "|", "\"\<MagRatio\>\""}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"type", "\[Rule]", "type"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prop_String", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"type", ":", 
        RowBox[{
        "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
         "\"\<Magnification\>\"", "|", "\"\<MagnificationSquared\>\"", "|", 
         "\"\<PRFSize\>\"", "|", "\"\<MagRatio\>\""}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"range", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "90"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"n_", "?", "NumberQ"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "n"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eccenName", "=", 
        RowBox[{"OptionValue", "[", "Eccentricity", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"areasName", "=", 
        RowBox[{"OptionValue", "[", "VisualArea", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"weightName", "=", 
        RowBox[{"OptionValue", "[", "Weights", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vertexOkayFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", "eccenName"}], "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"NumberQ", "[", 
               RowBox[{"#", "[", "eccenName", "]"}], "]"}]}]}], ",", "False", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"range", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
               RowBox[{"#", "[", "eccenName", "]"}], "\[LessEqual]", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", "False", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"areasName", "=!=", "None"}], "&&", 
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"NumberQ", "@", 
                 RowBox[{"#", "[", "areasName", "]"}]}]}], "||", 
               RowBox[{
                RowBox[{"#", "[", "areasName", "]"}], "\[Equal]", "0"}]}], 
              ")"}]}], ",", "False", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"weightName", "=!=", "None"}], "&&", 
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
             RowBox[{
              RowBox[{"#", "[", "weightName", "]"}], "\[LessEqual]", "0"}]}], 
            ",", "False", ",", "\[IndentingNewLine]", "True", ",", "True"}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<CMag\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<Magnification\>\""}]}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$CMagBlendColors", ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<CMag2\>\"", ",", "\"\<Magnification2\>\"", ",", 
             "\"\<MagnificationSquared\>\"", ",", "\"\<CMagSquared\>\""}], 
            "}"}], ",", "type"}], "]"}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$CMagBlendColors", ",", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"#", "[", "prop", "]"}], "]"}]}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<MagRatio\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<MagnificationRatio\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<CMagRatio\>\""}]}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"vertexOkayFn", "[", "#", "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\"\<Curvature\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$MagRatioBlendColors", ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<PRFSize\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$PRFBlendColors", ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<PolarAngleError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$PolarAngleErrorBlendColors", ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<EccentricityError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$EccentricityErrorBlendColors", ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<AngleError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$AngleErrorBlendColors", ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Function", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\[IndentingNewLine]", "\"\<Curvature\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"CorticalColorData", "[", "type", "]"}], "[", 
                   RowBox[{"<|", 
                    RowBox[{"type", "\[Rule]", 
                    RowBox[{"#", "[", "prop", "]"}]}], "|>"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUU\
ID->"a1e9957a-85e8-426a-868f-8d003f42b7d1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a Direction Compass on the Maps", "Subsection",
 CellChangeTimes->{{3.676119297276575*^9, 
  3.676119301843574*^9}},ExpressionUUID->"09f24c71-cb48-4382-ad87-\
8f9c8b3b7223"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "MapCompass", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapCompass", "::", "usage"}], "=", 
    "\"\<MapCompass[hemi] yields a Graphics object that represents the \
appropriate directions compass (dorsal/ventral, medial/lateral indicator) for \
the given hemisphere's map projections.\nMapCompass[hemi, style] uses the \
given style for the compass arrows.\nMapCompass accepts all the options \
appropriate for Graphics as well as the Style option, which may be a list of \
any options appropriate for Style; these are used to format the text.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MapCompass", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Options", "[", "Graphics", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Scale", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Center", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapCompass", "[", 
    RowBox[{
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", 
     RowBox[{"style_:", 
      RowBox[{"{", "White", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sty", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Style", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
            RowBox[{"FontSize", "\[Rule]", "$FontSize"}], ",", 
            RowBox[{"FontColor", "\[Rule]", "White"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}]}], "}"}]}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Scale", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", "10"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"medlat", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"center", "=", 
        RowBox[{"OptionValue", "[", "Center", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
         RowBox[{"{", "style", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"center", "+", 
             RowBox[{"xy", "*", "scale", "*", "0.9"}]}]}], "}"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"xy", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<D\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", "scale"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<V\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "scale"}]}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<L\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", 
               RowBox[{"-", "scale"}]}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "+", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<M\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", "scale"}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "-", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID\
->"c57cd5f6-6b13-4a64-9fff-039bf27b4a34"]
}, Closed]],

Cell[CellGroupData[{

Cell["Common Patterns", "Subsection",ExpressionUUID->"361dfdf9-7674-4dfa-91b5-3487092ab9ef"],

Cell["\<\
These variables are common patterns that we want to be used commonly \
throughout the notebook.\
\>", "Text",ExpressionUUID->"1897b273-8c92-433a-b255-3f6e2e280cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$EmpiricalPattern", ",", "$GoldPattern", ",", "$PredictedPattern", ",", 
    "$AnatomyPattern", ",", "$SemiEmpiricalPattern"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EmpiricalPattern", "=", 
   RowBox[{
   "\"\<Empirical\>\"", "|", "\"\<Measured\>\"", "|", "\"\<PRF\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$GoldPattern", "=", 
   RowBox[{
   "\"\<Gold\>\"", "|", "\"\<GoldStandard\>\"", "|", "\"\<Validation\>\""}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PredictedPattern", "=", 
   RowBox[{
   "\"\<Predicted\>\"", "|", "\"\<Prediction\>\"", "|", "\"\<Fit\>\"", "|", 
    "\"\<Model\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AnatomyPattern", "=", 
   RowBox[{
   "\"\<Anatomy\>\"", "|", "\"\<Anatomical\>\"", "|", "\"\<Benson14\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SemiEmpiricalPattern", "=", 
   RowBox[{"\"\<SemiEmpirical\>\"", "|", "\"\<GoldEmpirical\>\""}]}], 
  ";"}]}], "Input",ExpressionUUID->"310eeeb8-a6ef-4850-b1fc-f6ef202e65b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Handling the Retinotopy Models", "Subsection",ExpressionUUID->"d05b912a-82dd-4182-9d91-6b77945ace80"],

Cell[CellGroupData[{

Cell["\<\
Code to generate conversion functions from cortical map to visual field\
\>", "Subsubsection",ExpressionUUID->"2ce2f043-6c4b-4956-9abd-f3e526529791"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "FMMFunctions", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FMMFunctions", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"tx0_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mesh", "=", 
        RowBox[{"data", "[", "\"\<Mesh\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"coords", "=", 
        RowBox[{"data", "[", "\"\<Coordinates\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "=", 
        RowBox[{
         RowBox[{"data", "[", "\"\<FMM\>\"", "]"}], "[", "\"\<Triangles\>\"", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"angle", "=", 
        RowBox[{"data", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eccen", "=", 
        RowBox[{"data", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"iregions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "@", 
         RowBox[{"data", "[", "\"\<VisualAreaKey\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tx", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tx0", "===", "Automatic"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"AffineTransform", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", ";;", "2"}], ",", 
                  RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", 
                  RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}], 
            "&"}], "@", 
           RowBox[{"Replace", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"data", "[", "\"\<FMM\>\"", "]"}], "[", 
               "\"\<Header\>\"", "]"}], "[", "\"\<Transform\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\"\<None\>\"", "|", "None"}], ")"}], "\[Rule]", 
              RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tx0", "===", "None"}], ",", "Identity", ",", 
          "\[IndentingNewLine]", "True", ",", "tx0"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"field", "=", 
          RowBox[{"eccen", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", "*", "angle"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ifieldAll", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"coords", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", "I", "}"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"itx", "=", 
          RowBox[{"InverseFunction", "[", "tx", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xy", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "[", "field", "]"}], ",", 
               RowBox[{"Im", "[", "field", "]"}]}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"bounds", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"id", "<>", "\"\<BoundaryMesh\>\""}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"id", ",", "iregions"}], "}"}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"near", "=", 
             RowBox[{"Association", "@", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"id", "\[Rule]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{"Pick", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "coords", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Unitize", "@", 
                    RowBox[{"RegionDistance", "[", 
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"id", "<>", "\"\<BoundaryMesh\>\""}], "]"}], ",", 
                    "coords"}], "]"}]}], ",", "\[IndentingNewLine]", "0"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "\[Rule]", "idcs"}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"id", ",", "iregions"}], "}"}]}], "]"}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{"data", ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<Options\>\"", "\[Rule]", 
                RowBox[{"<|", 
                 RowBox[{"\"\<AffineTransform\>\"", "\[Rule]", "tx"}], 
                 "|>"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<CorticalMapToVisualField\>\"", "\[Rule]", 
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"datAndPost", "=", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], ",", "Identity"}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", "#1", "]"}]}], "]"}]}], "}"}], 
                    "]"}], ",", "Identity"}], "}"}], ",", 
                    "\[IndentingNewLine]", " ", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                    ",", "Identity"}], "}"}], ",", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "##", "}"}], "}"}], ",", "First"}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], 
                    ",", "#", ",", 
                    RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], ",", 
                    "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"VectorQ", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "#", "}"}], ",", "First"}], "}"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "Identity"}], "}"}]}], "]"}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dat", "=", 
                    RowBox[{"itx", "[", 
                    RowBox[{"datAndPost", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"post", "=", 
                    RowBox[{"datAndPost", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"post", "@", 
                    RowBox[{"ReIm", "@", 
                    RowBox[{"MeshRegionInterpolate", "[", 
                    RowBox[{"mesh", ",", "field", ",", "dat", ",", 
                    RowBox[{"Chop", "\[Rule]", "0.1"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SparseArray", "@", 
                    RowBox[{"post", "@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Boole", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"RegionMember", "[", 
                    RowBox[{"b", ",", "dat"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "bounds"}], "}"}]}], "]"}]}]}]}]}]}], 
                    "}"}]}], "]"}]}], "]"}]}]}]}], "|>"}]}], "]"}]}], "]"}]}],
         "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->\
"e12cd5a6-e823-422f-bda3-9b115d82dcce"]
}, Closed]],

Cell[CellGroupData[{

Cell["The models themselves", "Subsubsection",ExpressionUUID->"a27c6ea1-9b90-41fe-a611-b88e5d60e72b"],

Cell["First, define the Schira model that we use in this notebook.", "Text",ExpressionUUID->"bca084cf-95a7-44f0-9b62-3fdf76a99152"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$SchiraModel", ",", "$SchiraModelUnrotated"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SchiraModel", ":=", 
     RowBox[{"SchiraModel", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "1.05"}], ",", 
       RowBox[{"B", "\[Rule]", "90.0"}], ",", 
       RowBox[{"\[CapitalLambda]", "\[Rule]", "0.4"}], ",", 
       RowBox[{"\[CapitalPsi]", "\[Rule]", "0.15"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"V1Size", "\[Rule]", "1.2"}], ",", 
       RowBox[{"V2Size", "\[Rule]", "0.6"}], ",", 
       RowBox[{"V3Size", "\[Rule]", "0.4"}], ",", 
       RowBox[{"V3ASize", "\[Rule]", "0.9"}], ",", 
       RowBox[{"HV4Size", "\[Rule]", "0.9"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FC", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6.0"}], ",", "0.0"}], "}"}]}], ",", 
       RowBox[{"Scale", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"21.0", ",", "21.0"}], "}"}]}], ",", 
       RowBox[{"Shear", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$SchiraModelUnrotated", ":=", 
     RowBox[{"SchiraModel", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "1.05"}], ",", 
       RowBox[{"B", "\[Rule]", "90.0"}], ",", 
       RowBox[{"\[CapitalLambda]", "\[Rule]", "0.4"}], ",", 
       RowBox[{"\[CapitalPsi]", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"V1Size", "\[Rule]", "1.2"}], ",", 
       RowBox[{"V2Size", "\[Rule]", "0.6"}], ",", 
       RowBox[{"V3Size", "\[Rule]", "0.4"}], ",", 
       RowBox[{"V3ASize", "\[Rule]", "0.9"}], ",", 
       RowBox[{"HV4Size", "\[Rule]", "0.9"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FC", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6.0"}], ",", "0.0"}], "}"}]}], ",", 
       RowBox[{"Scale", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"21.0", ",", "21.0"}], "}"}]}], ",", 
       RowBox[{"Shear", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"bde3cbe7-368d-4af0-8992-a4faf1533aa3"],

Cell["Next, define the 8-area Benson17 model.", "Text",ExpressionUUID->"b245438d-34fa-4483-a3a1-137d405743da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$Benson17Model", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Benson17Model", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dat", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"$ModelRoot", ",", "\"\<benson17.fmm.gz\>\""}], "}"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<GZIP\>\"", ",", "\"\<FMM\>\""}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"regs", "=", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<V1\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<V2\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<V3\>\"", "\[Rule]", "3"}], ",", 
           RowBox[{"\"\<hV4\>\"", "\[Rule]", "4"}], ",", 
           RowBox[{"\"\<VO1\>\"", "\[Rule]", "5"}], ",", 
           RowBox[{"\"\<LO1\>\"", "\[Rule]", "6"}], ",", 
           RowBox[{"\"\<V3a\>\"", "\[Rule]", "7"}], ",", 
           RowBox[{"\"\<V3b\>\"", "\[Rule]", "8"}]}], "|>"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"regNames", "=", 
           RowBox[{"Association", "[", 
            RowBox[{"Reverse", "/@", 
             RowBox[{"Normal", "[", "regs", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"mapPts", "=", 
           RowBox[{
            RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"vfPts", "=", 
           RowBox[{
            RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"lbls", "=", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FMMFunctions", "@", 
         RowBox[{"Association", "@", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"MeshRegion", "[", 
              RowBox[{"mapPts", ",", 
               RowBox[{"Triangle", "/@", 
                RowBox[{"dat", "[", "\"\<Triangles\>\"", "]"}]}]}], "]"}], "//", 
             RowBox[{"Function", "@", 
              RowBox[{"List", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Mesh\>\"", "\[Rule]", "#"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<BoundaryMesh\>\"", "\[Rule]", 
                 RowBox[{"BoundaryMesh", "[", "#", "]"}]}]}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
               RowBox[{"vfPts", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
               RowBox[{"vfPts", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "mapPts"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<VisualArea\>\"", "\[Rule]", "lbls"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<VisualAreaKey\>\"", "\[Rule]", "regs"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<VisualAreaNames\>\"", "\[Rule]", "regNames"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"\"\<FMM\>\"", "\[Rule]", "dat"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"KeyExistsQ", "[", 
                  RowBox[{"regNames", ",", "k"}], "]"}]}], ",", 
                "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
                
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"regNames", "[", "k", "]"}], "<>", 
                   "\"\<BoundaryMesh\>\""}], ")"}], "\[Rule]", 
                 RowBox[{"BoundaryMesh", "@", 
                  RowBox[{"MeshRegion", "[", "\[IndentingNewLine]", 
                   RowBox[{"mapPts", ",", "\[IndentingNewLine]", 
                    RowBox[{"Triangle", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"dat", "[", "\"\<Triangles\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"lbls", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "k"}], "]"}], 
                    "&"}]}], "]"}]}]}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Union", "[", "lbls", "]"}]}], "}"}]}], "]"}]}], 
           "]"}]}]}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUU\
ID->"4fa30373-5c3b-4801-9610-4b08f9b3ca3b"],

Cell["We use this model when generating certain schematic figures:", "Text",ExpressionUUID->"6164d0b9-5d90-45ca-bd3e-e9767cbfc800"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$V123Model", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$V123Model", ":=", 
    RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dat", "=", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"$ModelRoot", ",", "\"\<v123.fmm.gz\>\""}], "}"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<FMM\>\""}], "}"}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"regs", "=", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<V1\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<V2\>\"", "\[Rule]", "2"}], ",", 
             RowBox[{"\"\<V3\>\"", "\[Rule]", "3"}]}], "|>"}]}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"regNames", "=", 
             RowBox[{"Association", "[", 
              RowBox[{"Reverse", "/@", 
               RowBox[{"Normal", "[", "regs", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"mapPts", "=", 
             RowBox[{
              RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"vfPts", "=", 
             RowBox[{
              RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2", ",", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"lbls", "=", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FMMFunctions", "@", 
           RowBox[{"Association", "@", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"MeshRegion", "[", 
                RowBox[{"mapPts", ",", 
                 RowBox[{"Triangle", "/@", 
                  RowBox[{"dat", "[", "\"\<Triangles\>\"", "]"}]}]}], "]"}], "//", 
               RowBox[{"Function", "@", 
                RowBox[{"List", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<Mesh\>\"", "\[Rule]", "#"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<BoundaryMesh\>\"", "\[Rule]", 
                   RowBox[{"BoundaryMesh", "[", "#", "]"}]}]}], "]"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
                 RowBox[{"vfPts", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
                 RowBox[{"vfPts", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "mapPts"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<VisualArea\>\"", "\[Rule]", "lbls"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<VisualAreaKey\>\"", "\[Rule]", "regs"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<VisualAreaNames\>\"", "\[Rule]", "regNames"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<FMM\>\"", "\[Rule]", "dat"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"regNames", ",", "k"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", "Nothing", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"regNames", "[", "k", "]"}], "<>", 
                    "\"\<BoundaryMesh\>\""}], ")"}], "\[Rule]", 
                   RowBox[{"BoundaryMesh", "@", 
                    RowBox[{"MeshRegion", "[", "\[IndentingNewLine]", 
                    RowBox[{"mapPts", ",", "\[IndentingNewLine]", 
                    RowBox[{"Triangle", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"dat", "[", "\"\<Triangles\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"lbls", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "k"}], "]"}], 
                    "&"}]}], "]"}]}]}], "]"}]}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"Union", "[", "lbls", "]"}]}], "}"}]}], "]"}]}], 
             "]"}]}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       StyleBox[
        RowBox[{"MeshRegion", "::", "dgcellr"}], "MessageName"], 
       StyleBox["}", "MessageName"]}]}], 
     StyleBox["]", "MessageName"]}]}], 
   StyleBox["]", "MessageName"]}], ";"}]}], "Input",ExpressionUUID->"90500fe3-\
e953-454e-ac11-b95c6c5ca83e"],

Cell["Annotations of the models.", "Text",ExpressionUUID->"11b2335a-fc0f-488c-a8e3-a1a3ec5dd668"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ModelVisualAreas", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", 
    RowBox[{"mdl_", "?", "AssociationQ"}], "]"}], ":=", 
   RowBox[{"mdl", "[", "\"\<VisualAreaNames\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", "mdl_SchiraModelObject", "]"}], ":=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "\"\<V1\>\""}], ",", 
     RowBox[{"2", "\[Rule]", "\"\<V2\>\""}], ",", 
     RowBox[{"3", "\[Rule]", "\"\<V3\>\""}], ",", 
     RowBox[{"4", "\[Rule]", "\"\<xV4v\>\""}], ",", 
     RowBox[{"5", "\[Rule]", "\"\<xV4d\>\""}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", "\"\<Benson17\>\"", "]"}], ":=", 
   RowBox[{"ModelVisualAreas", "[", "$Benson17Model", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", "\"\<V123\>\"", "]"}], ":=", 
   RowBox[{"ModelVisualAreas", "[", "$V123Model", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", "\"\<Schira\>\"", "]"}], ":=", 
   RowBox[{"ModelVisualAreas", "[", "$SchiraModelUnrotated", "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"5de752c6-62a1-4704-bfde-88b7dc238a43"],

Cell["These functions generate lines for use in figures.", "Text",ExpressionUUID->"e436b776-c0a4-468e-93e5-718058654fe8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "V123FigLines", ",", "V123FigBoundary", ",", "FigToVisualFieldFn", ",", 
     "VisualFieldFnToV123FigFn", ",", "V123FigLinesFMM", ",", 
     "V123FigLinesSchira", ",", "V123FigBoundaryFMM", ",", 
     "V123FigBoundarySchira"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigLines", "::", "usage"}], "=", 
   "\"\<V123FigLines[maxEccentricity] yields a Graphics object of the lines \
for a typical plot of V1-V3 on a model schematic.\n\nOptions:\n  * \
RetinotopyModel (default: \\\"V123\\\") specifies the model of retinotopy to \
use; may be an instance of a SchiraModel, an association specifying a Flat \
Mesh Model (FMM), or one of the following strings: \\\"V123\\\", a symmetric \
visually pleasing FMM stored in $V123Model; \\\"Schira\\\", the Schira model \
instance in $SchiraModel; \\\"Benson17\\\", the FMM stored in $Benson17Model.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V123FigLines", "::", "badmdl"}], "=", 
    "\"\<Unrecognized RetinotopyModel argument: `1`\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigLines", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Benson17\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigBoundary", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigLines", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "VisualFieldFnToV123FigFn", "]"}], "=", 
    RowBox[{"Options", "[", "V123FigLines", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"V123FigLinesFMM", "[", 
       RowBox[{"maxEcc_", ",", "mdl_"}], "]"}], ":=", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vbs", "=", 
           RowBox[{"mdl", "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<V1BoundaryMesh\>\"", ",", "\"\<V2BoundaryMesh\>\"", ",", 
              "\"\<V3BoundaryMesh\>\""}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ecc", "=", 
           RowBox[{"mdl", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"msh", "=", 
           RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"outer", "=", 
             RowBox[{"ConvexHullMesh", "@", 
              RowBox[{"Pick", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Sign", "[", 
                 RowBox[{"ecc", "-", "maxEcc"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"0", "|", 
                 RowBox[{"-", "1"}]}]}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"iidcs", "=", 
             RowBox[{"Pick", "[", 
              RowBox[{
               RowBox[{"Range", "@", 
                RowBox[{"Length", "[", "ecc", "]"}]}], ",", 
               RowBox[{"Sign", "[", 
                RowBox[{"ecc", "-", "maxEcc"}], "]"}], ",", 
               RowBox[{"0", "|", 
                RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"X", "=", 
             RowBox[{"MeshCoordinates", "[", "msh", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"v1b", "=", 
             RowBox[{"vbs", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"v2b", "=", 
             RowBox[{"RegionUnion", "[", 
              RowBox[{
               RowBox[{"vbs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"vbs", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"v3b", "=", 
             RowBox[{"RegionUnion", "@@", "vbs"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hulls", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ConvexHullMesh", "[", 
                   RowBox[{"X", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Pick", "[", "\[IndentingNewLine]", 
                  RowBox[{"iidcs", ",", "\[IndentingNewLine]", 
                   RowBox[{"Sign", "@", 
                    RowBox[{"SignedRegionDistance", "[", 
                    RowBox[{"reg", ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"[", "iidcs", "]"}], "]"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"reg", ",", 
                  RowBox[{"{", 
                   RowBox[{"v1b", ",", "v2b", ",", "v3b"}], "}"}]}], "}"}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Join", "@@", 
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", "=", 
                    RowBox[{"MeshCoordinates", "[", "#", "]"}]}], "}"}], ",", 
                  
                  RowBox[{
                   RowBox[{"MeshCells", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "/.", 
                   RowBox[{
                    RowBox[{"Line", "[", "i_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"Line", "[", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], "&"}],
                ",", "\[IndentingNewLine]", "hulls"}], "]"}]}]}], "]"}]}], 
         "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V123FigLinesSchira", "[", 
       RowBox[{"maxEcc_", ",", "mdl_"}], "]"}], ":=", 
      RowBox[{"Cases", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"SchiraLinePlot", "[", "\[IndentingNewLine]", 
          RowBox[{"mdl", ",", "\[IndentingNewLine]", 
           RowBox[{"Range", "\[Rule]", "maxEcc"}], ",", "\[IndentingNewLine]", 
           RowBox[{"EccentricityLines", "\[Rule]", 
            RowBox[{"{", "maxEcc", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PolarAngleLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "90", ",", "180"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Line", "[", "___", "]"}], ",", "\[IndentingNewLine]", 
        "Infinity"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V123FigBoundarySchira", "[", 
       RowBox[{"maxEcc_", ",", "mdl_SchiraModelObject"}], "]"}], ":=", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"boundLines", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Cases", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"SchiraLinePlot", "[", "\[IndentingNewLine]", 
                RowBox[{"mdl", ",", "\[IndentingNewLine]", 
                 RowBox[{"Range", "\[Rule]", "maxEcc"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"EccentricityLines", "\[Rule]", 
                  RowBox[{"lns", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PolarAngleLines", "\[Rule]", 
                  RowBox[{"lns", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"VisualAreas", "\[Rule]", 
                  RowBox[{"lns", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Line", "[", "___", "]"}], ",", "\[IndentingNewLine]", 
              "\[Infinity]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"lns", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "maxEcc", "}"}], ",", "None", ",", 
                  "Automatic"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", 
                  RowBox[{"{", "0", "}"}], ",", 
                  RowBox[{"-", "3"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", 
                  RowBox[{"{", "180", "}"}], ",", "3"}], "}"}]}], "}"}]}], 
             "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"path", "=", 
            RowBox[{"Join", "@@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"First", "@", 
                    RowBox[{"FindCurvePath", "[", "#", "]"}]}]}], "]"}], 
                 "&"}], "@", 
                RowBox[{"Cases", "[", 
                 RowBox[{"l", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x_", "?", "NumericQ"}], ",", 
                    RowBox[{"y_", "?", "NumericQ"}]}], "}"}], ",", 
                  "Infinity"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"l", ",", "boundLines"}], "}"}]}], "]"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"BoundaryMeshRegion", "[", 
           RowBox[{"path", ",", 
            RowBox[{"Line", "@", 
             RowBox[{"First", "@", 
              RowBox[{"FindCurvePath", "[", "path", "]"}]}]}]}], "]"}]}], 
         "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V123FigBoundaryFMM", "[", 
       RowBox[{"maxEcc_", ",", 
        RowBox[{"mdl", ":", 
         RowBox[{"Except", "[", "_SchiraModelObject", "]"}]}]}], "]"}], ":=", 
      
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ConvexHullMesh", "@*", "Union", "@*", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "&"}], "@*", "Join"}], 
       "@@", 
       RowBox[{"V123FigLines", "[", "maxEcc", "]"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigLines", "[", 
    RowBox[{"maxEcc_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Automatic", "|", "\"\<V123\>\""}], "\[RuleDelayed]", 
        RowBox[{"V123FigLinesFMM", "[", 
         RowBox[{"maxEcc", ",", "$V123Model"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Schira\>\"", "\[RuleDelayed]", 
        RowBox[{"V123FigLinesSchira", "[", 
         RowBox[{"maxEcc", ",", "$SchiraModelUnrotated"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Benson17\>\"", "\[RuleDelayed]", 
        RowBox[{"V123FigLinesFMM", "[", 
         RowBox[{"maxEcc", ",", "$Benson17Model"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"mdl_SchiraModelObject", "\[RuleDelayed]", 
        RowBox[{"V123FigLinesSchira", "[", 
         RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"mdl_", "?", "AssociationQ"}], "\[RuleDelayed]", 
        RowBox[{"V123FigLinesFMM", "[", 
         RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"mdl_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"V123FigLines", "::", "badmdl"}], ",", "mdl"}], "]"}]}]}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V123FigBoundary", "[", 
     RowBox[{"maxEcc_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Automatic", "|", "\"\<V123\>\""}], "\[RuleDelayed]", 
         RowBox[{"V123FigBoundaryFMM", "[", 
          RowBox[{"maxEcc", ",", "$V123Model"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Schira\>\"", "\[RuleDelayed]", 
         RowBox[{"V123FigBoundarySchira", "[", 
          RowBox[{"maxEcc", ",", "$SchiraModelUnrotated"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Benson17\>\"", "\[RuleDelayed]", 
         RowBox[{"V123FigBoundaryFMM", "[", 
          RowBox[{"maxEcc", ",", "$Benson17Model"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"mdl_SchiraModelObject", "\[RuleDelayed]", 
         RowBox[{"V123FigBoundarySchira", "[", 
          RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mdl_", "?", "AssociationQ"}], "\[RuleDelayed]", 
         RowBox[{"V123FigBoundaryFMM", "[", 
          RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"mdl_", "\[RuleDelayed]", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"V123FigLines", "::", "badmdl"}], ",", "mdl"}], "]"}]}]}], 
       "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigToVisualFieldFn", "[", "\"\<V123\>\"", "]"}], ":=", 
   RowBox[{"$V123Model", "[", "\"\<CorticalMapToVisualField\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigToVisualFieldFn", "[", "\"\<Benson17\>\"", "]"}], ":=", 
   RowBox[{"$Benson17Model", "[", "\"\<CorticalMapToVisualField\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigToVisualFieldFn", "[", "\"\<Schira\>\"", "]"}], ":=", 
   RowBox[{"Function", "@", 
    RowBox[{"CorticalMapToVisualField", "[", 
     RowBox[{"$SchiraModelUnrotated", ",", "##"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FigToVisualFieldFn", "[", "x_", "]"}], ":=", 
    RowBox[{"Function", "@", 
     RowBox[{"CorticalMapToVisualField", "[", 
      RowBox[{"x", ",", "##"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFnToV123FigFn", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"retmdl", "=", 
       RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fns", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ListQ", "[", "f", "]"}], ",", "f", ",", 
              RowBox[{"{", "f", "}"}]}], "]"}], ",", 
            RowBox[{"Length", "@", 
             RowBox[{"ModelVisualAreas", "[", "retmdl", "]"}]}], ",", 
            "None"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"frommap", "=", 
          RowBox[{"FigToVisualFieldFn", "[", "retmdl", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "@", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"datPost", "=", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ListQ", "[", 
                  RowBox[{
                   RowBox[{"{", "##", "}"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{
                   RowBox[{"{", "##", "}"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", "##", "}"}], "]"}], ",", "Identity"}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"ListQ", "[", 
                 RowBox[{
                  RowBox[{"{", "##", "}"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", "#1", "]"}]}], "]"}]}], "}"}], 
                   "]"}], ",", "Identity"}], "}"}], " ", ",", 
                RowBox[{"ListQ", "[", 
                 RowBox[{
                  RowBox[{"{", "##", "}"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                  ",", "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
                "True", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", "##", "}"}], "}"}], ",", "First"}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"MatrixQ", "[", "#", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], 
                  ",", "#", ",", 
                  RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], ",", 
                "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"VectorQ", "[", "#", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", "First"}], "}"}], ",", "True", 
              ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "Identity"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"dat", "=", 
               RowBox[{"datPost", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"post", "=", 
               RowBox[{"datPost", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ptsAndAreas", "=", 
                RowBox[{"frommap", "[", "dat", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"pts", "=", 
                   RowBox[{"ptsAndAreas", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"areas", "=", 
                   RowBox[{"1", "+", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"ptsAndAreas", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Missing", "[", "_", "]"}], "\[RuleDelayed]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_Integer", "/;", 
                    RowBox[{
                    RowBox[{"0", "<", "x", "\[LessEqual]", 
                    RowBox[{"Length", "[", "fns", "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"fns", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "=!=", "None"}]}]}], 
                    "}"}], "\[RuleDelayed]", "x"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"_", "\[Rule]", "0"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"fs", "=", 
                   RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "===", "None"}], ",", 
                    RowBox[{"Indeterminate", "&"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indeterminate", "&"}]}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"post", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fs", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], "[", "#2", "]"}], "&"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"areas", ",", "pts"}], "}"}]}], "]"}]}]}], 
               "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"c366d373-00f1-4167-8f0f-90a4efc4c873"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Residuals and Errors", "Section",ExpressionUUID->"4c0516a3-6250-4ed5-9999-c09da9736816"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "SubjectErrorSummary", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectErrorSummary", "::", "usage"}], "=", 
   "\"\<SubjectErrorSummary[sub,hemi,dataset,type] yields a summary of the \
error for the appropriate subject, hemisphere, and dataset; the summary is a \
nested association containing error data calculated as the weighted mean of \
the difference between the datatype in the given dataset and the \
gold-standard (weight is the gold-standard variance explained). The type \
argument may be \\\"Predicted\\\", \\\"Training\\\", or \\\"Anatomical\\\".\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectErrorSummary", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectMesh", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Masking", "\[Rule]", "\"\<V123\>\""}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectErrorSummary", "[", 
     RowBox[{"sub_", ",", "hemi_", ",", "ds_", ",", "type_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"roiemax", "=", "15"}], ",", "\[IndentingNewLine]", 
        RowBox[{"msh", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "ds"}], 
            "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"gs", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "0"}], "]"}],
            ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"mp", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMap", "[", 
            RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}], ",", "opts"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tname", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ToLowerCase", "@", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ListQ", "[", "type", "]"}], ",", 
              RowBox[{"First", "[", "type", "]"}], ",", "type"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "\"\<predict\>\"", "|", "\"\<predicted\>\"", "|", 
               "\"\<prediction\>\""}], "\[Rule]", "\"\<Predicted\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "\"\<empirical\>\"", "|", "\"\<measured\>\"", "|", 
               "\"\<train\>\"", "|", "\"\<training\>\""}], "\[Rule]", 
              "\"\<\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "\"\<anatomical\>\"", "|", "\"\<anatomy\>\"", "|", 
               "\"\<benson14\>\""}], "\[Rule]", "\"\<Benson14\>\""}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tarea", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", "type", "]"}], ",", 
             RowBox[{"Last", "[", "type", "]"}], ",", "All"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"All", "|", "Full"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"1", "|", "2", "|", "3"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"x", ":", 
               RowBox[{"1", "|", "2", "|", "3"}]}], "\[RuleDelayed]", "x"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"x_List", "\[RuleDelayed]", 
              RowBox[{"Apply", "[", 
               RowBox[{"Alternatives", ",", "x"}], "]"}]}]}], "}"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "10"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"All", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"Full", "|", "None"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{"OccipitalPole", "[", 
          RowBox[{
           RowBox[{"$FreeSurferSubjects", "[", "\"\<fsaverage_sym\>\"", "]"}],
            ",", "LH", ",", "\"\<Sphere\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rescale", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s", "=", "#1"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Function", "@", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mu", "=", 
                 RowBox[{"Mean", "[", "#", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"s", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "#", "]"}], "-", "mu"}], 
                   ")"}]}], "+", "mu"}], "]"}]}], "]"}]}]}], "]"}]}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"eccidcs", "=", 
           RowBox[{"Indices", "[", 
            RowBox[{
             RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "mp"}], ",", 
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "/;", 
              RowBox[{
               RowBox[{"range", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "x", "<", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"vaidcs", "=", 
           RowBox[{"Replace", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Masking", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Automatic", "|", "\"\<V123\>\""}], "\[RuleDelayed]", 
                
                RowBox[{"Indices", "[", 
                 RowBox[{
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "mp"}], ",", 
                  RowBox[{"1", "|", "2", "|", "3"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s_String", "/;", 
                 RowBox[{"StringMatchQ", "[", 
                  RowBox[{"s", ",", 
                   RowBox[{"\"\<V\>\"", "~~", "DigitCharacter"}]}], "]"}]}], 
                "\[RuleDelayed]", 
                RowBox[{"Indices", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "mp"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ToExpression", "@", 
                   RowBox[{"StringTake", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"v_Integer", "\[RuleDelayed]", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "mp"}], ",", 
                  "v"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"v", ":", 
                 RowBox[{"{", 
                  RowBox[{"_Integer", ".."}], "}"}]}], "\[RuleDelayed]", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "mp"}], ",", 
                  RowBox[{"Alternatives", "@@", "v"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"All", "|", "Full"}], "\[RuleDelayed]", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                  RowBox[{"Unitize", "[", 
                   RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "mp"}], "]"}],
                   ",", "1"}], "]"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"idcs", "=", 
            RowBox[{
             RowBox[{"VertexList", "[", "mp", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"Intersection", "[", 
               RowBox[{"eccidcs", ",", "vaidcs"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vals", "=", 
               RowBox[{"Part", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tname", "<>", "\"\<PolarAngle\>\""}], ")"}], "/.",
                     "msh"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tname", "<>", "\"\<Eccentricity\>\""}], ")"}], "/.",
                     "msh"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<PolarAngle\>\"", "/.", "gs"}], ",", 
                    RowBox[{"\"\<Eccentricity\>\"", "/.", "gs"}]}], "}"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", "All", ",", "All", ",", 
                 "idcs"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"w", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\"\<VarianceExplained\>\"", "/.", "gs"}], ")"}], 
                "[", 
                RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "=", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"xys", "=", 
                 RowBox[{"Map", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pa", "=", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", "pa", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", "pa", "]"}]}]}], "}"}]}], "]"}]}], 
                   ",", "\[IndentingNewLine]", "vals"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"prfsz", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\"\<PRFSize\>\"", "/.", "gs"}], ")"}], "[", 
                  RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"absang", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Abs", "@", "#"}], ",", 
                    RowBox[{"Arg", "@", "#"}]}], "}"}], "&"}], "@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "I"}], "}"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Association", "@", 
                 RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mean", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{"#2", ",", "w"}], "]"}], "/", 
                    RowBox[{"Total", "[", "w", "]"}]}], ")"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"<|", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<Mean\>\"", "\[Rule]", "mean"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<StandardDeviation\>\"", "\[Rule]", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#2", "-", "mean"}], ")"}], "^", "2"}], ",", 
                    "w"}], "]"}], "/", 
                    RowBox[{"Total", "[", "w", "]"}]}], "]"}]}]}], "|>"}]}]}],
                     "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                    "\"\<AbsAngle\>\"", ",", "\"\<ArgAngle\>\"", ",", 
                    "\"\<AnglePerPRFRadius\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "delta", ",", "absang", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Unitize", "[", "prfsz", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"absang", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"prfsz", "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", "prfsz", "]"}]}], ")"}]}], 
                    ")"}]}], ")"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}]}]}], 
               "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"439d35e7-67ee-4246-9f7e-f6d36228ef24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"ErrorSummaries", ",", "$ErrorSummaries"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ErrorSummaries", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectErrorSummary", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ErrorSummaries", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mdl", "=", 
          RowBox[{"ToLowerCase", "@", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
             RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"clip", "=", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Clip", "]"}], "/.", 
           RowBox[{"Automatic", "\[Rule]", "None"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"mask", "=", 
          RowBox[{"OptionValue", "[", "Masking", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
          RowBox[{"\"\<error-summaries\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<_model=\>\"", "<>", "mdl"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<_clip=\>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"clip", "===", "None"}], ",", "\"\<none\>\"", ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{"clip", ",", "10", ",", "2"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<_mask=\>\"", "<>", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"StringQ", "[", "mask", "]"}], ",", "mask", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"IntegerQ", "[", "mask", "]"}], ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{"mask", ",", "10", ",", "2"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ListQ", "[", "mask", "]"}], ",", 
              RowBox[{"\"\<[\>\"", "<>", 
               RowBox[{"StringJoin", "@", 
                RowBox[{"Riffle", "[", 
                 RowBox[{
                  RowBox[{"ToString", "/@", 
                   RowBox[{"Sort", "[", "mask", "]"}]}], ",", "\"\<,\>\""}], 
                 "]"}]}], "<>", "\"\<]\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"mask", "===", "All"}], "||", 
               RowBox[{"mask", "===", "Full"}]}], ",", "\"\<all\>\"", ",", 
              "\[IndentingNewLine]", "True", ",", "\"\<??\>\""}], "]"}]}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<Subject\>\"", "\[Rule]", "sub"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Hemi\>\"", "\[Rule]", "hemi"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Dataset\>\"", "\[Rule]", "ds"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Coverage\>\"", "\[Rule]", 
              RowBox[{"SubjectDatasetCoverage", "[", 
               RowBox[{"sub", ",", "ds"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<RetinotopyModel\>\"", "\[Rule]", 
              RowBox[{"Capitalize", "@", 
               RowBox[{"ToLowerCase", "[", "mdl", "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Clip\>\"", "\[Rule]", "clip"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Training\>\"", "\[Rule]", 
              RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"SubjectErrorSummary", "[", 
                 RowBox[{
                 "sub", ",", "hemi", ",", "ds", ",", "\"\<Training\>\"", ",", 
                  
                  RowBox[{"Range", "\[Rule]", "None"}]}], "]"}], ",", 
                "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Predicted\>\"", "\[Rule]", 
              RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"SubjectErrorSummary", "[", 
                 RowBox[{
                 "sub", ",", "hemi", ",", "ds", ",", "\"\<Predicted\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Anatomical\>\"", "\[Rule]", 
              RowBox[{"WithOptions", "[", "\[IndentingNewLine]", " ", 
               RowBox[{
                RowBox[{"SubjectErrorSummary", "[", 
                 RowBox[{
                 "sub", ",", "hemi", ",", "0", ",", "\"\<Anatomical\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}]}], 
            "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"hemi", ",", 
             RowBox[{"{", 
              RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"ds", ",", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Rest", "@", 
                RowBox[{"$SubjectDatasets", "[", "sub", "]"}]}], ",", 
               "IntegerQ"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"$ErrorSummaries", ":=", 
     RowBox[{"ErrorSummaries", "[", "]"}]}]}], "]"}], ";"}]}], "Input",Express\
ionUUID->"f754a305-d725-4d70-bc13-739aec031f0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ErrorSummaryDataset", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ErrorSummaryDataset", "::", "usage"}], "=", 
   "\"\<ErrorSummaryDataset[model] where model is either \\\"Benson17\\\" or \
\\\"Schira\\\" yields a (cached) dataset of errors that is slightly more \
verbose than the data yielded by ErrorSummaries[].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ErrorSummaryDataset", "[", 
     RowBox[{"model", ":", 
      RowBox[{"\"\<Benson17\>\"", "|", "\"\<Schira\>\""}]}], "]"}], ":=", 
    RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<error-summary-dataset_model=\>\"", "<>", 
       RowBox[{"ToLowerCase", "[", "model", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Dataset", "@", 
       RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Subject\>\"", "\[Rule]", "sub"}], ",", 
           RowBox[{"\"\<Hemi\>\"", "\[Rule]", "hem"}], ",", 
           RowBox[{"\"\<Dataset\>\"", "\[Rule]", "ds"}], ",", 
           RowBox[{"\"\<VisualArea\>\"", "\[Rule]", "mask"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<PredictionError\>\"", "\[Rule]", 
            RowBox[{"SubjectErrorSummary", "[", "\[IndentingNewLine]", 
             RowBox[{
             "sub", ",", "hem", ",", "ds", ",", "\"\<Predicted\>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RetinotopyModel", "\[Rule]", "model"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Masking", "\[Rule]", "mask"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<MeasurementError\>\"", "\[Rule]", 
            RowBox[{"SubjectErrorSummary", "[", "\[IndentingNewLine]", 
             RowBox[{
             "sub", ",", "hem", ",", "ds", ",", "\"\<Measured\>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RetinotopyModel", "\[Rule]", "model"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Range", "\[Rule]", "None"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Masking", "\[Rule]", "mask"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Benson14Error\>\"", "\[Rule]", 
            RowBox[{"SubjectErrorSummary", "[", "\[IndentingNewLine]", 
             RowBox[{
             "sub", ",", "hem", ",", "ds", ",", "\"\<Benson14\>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RetinotopyModel", "\[Rule]", "model"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Masking", "\[Rule]", "mask"}]}], "]"}]}]}], "|>"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"hem", ",", 
           RowBox[{"{", 
            RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"ds", ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Rest", "@", 
              RowBox[{"$SubjectDatasets", "[", "sub", "]"}]}], ",", 
             "IntegerQ"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"mask", ",", 
           RowBox[{"Range", "[", "8", "]"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"bf977e38-7466-4e44-9129-\
c8d0d1391917"]
}, Closed]],

Cell[CellGroupData[{

Cell["Organizing Cortical Magnification Data", "Section",ExpressionUUID->"740216cd-e0eb-47b0-942d-56f32658b2b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$CMagData", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$CMagData", ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hemi", "\[Rule]", 
        RowBox[{"Association", "@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sub", "\[Rule]", 
            RowBox[{"Association", "@", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pa", "=", 
                  RowBox[{
                   RowBox[{"Pi", "/", "180"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedPolarAngle\>\"", "/.", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}], ")"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ec", "=", 
                  RowBox[{"\"\<PredictedEccentricity\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"va", "=", 
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"cma", "=", 
                  RowBox[{"\"\<MagnificationWhiteAreal\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"cmt", "=", 
                  RowBox[{"\"\<MagnificationWhiteTangential\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"cmr", "=", 
                  RowBox[{"\"\<MagnificationWhiteRadial\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"idcs", "=", 
                   RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{"ec", ",", 
                    RowBox[{
                    RowBox[{"x_", "?", "NumericQ"}], "/;", 
                    RowBox[{"x", "\[LessEqual]", "24"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"N", "[", "va", "]"}], ",", 
                    RowBox[{"1.0", "|", "2.0", "|", "3.0"}]}], "]"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{
                    RowBox[{"ec", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"pa", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}]}], ",", 
                    RowBox[{"y", "=", 
                    RowBox[{
                    RowBox[{"ec", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"pa", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}]}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Coordinate\>\"", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
                    RowBox[{"ec", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<VisualArea\>\"", "\[Rule]", 
                    RowBox[{"va", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<ArealMagnification\>\"", "\[Rule]", 
                    RowBox[{"cma", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<TangentialMagnification\>\"", "\[Rule]", 
                    RowBox[{"cmt", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<RadialMagnification\>\"", "\[Rule]", 
                    RowBox[{"cmr", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
                "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"sub", ",", "$Subjects"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"hemi", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"14b33c91-cac7-4ded-ae85-93871d70cbea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$CMagSummaryBySubject", ",", "CMagSummaryBySubject", ",", "CMagSummary"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$CMagSummaryBySubject", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eccs", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0.5", ",", "12", ",", "0.25"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"key", "=", "#1"}], ",", 
               RowBox[{"val", "=", "#2"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"key", "\[Rule]", 
              RowBox[{"Association", "@", 
               RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "@", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"data", "=", "#2"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"mags", "=", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"t", "<>", "\"\<Magnification\>\""}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Radial\>\"", ",", "\"\<Tangential\>\"", ",", 
                    "\"\<Areal\>\""}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ecc", "=", 
                    RowBox[{"#2", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"va", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"#2", "[", "\"\<VisualArea\>\"", "]"}], "]"}]}]}],
                     "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{"Pick", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "va", "]"}]}], ",", "va", ",", 
                    "area"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"near", "=", 
                    RowBox[{"Nearest", "@", 
                    RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"ecc", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"mags", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], "]"}]}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "e0"}], "]"}], "&"}], "@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Median", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
                    RowBox[{"#", "<", "85"}]}], "&"}]}], "]"}]}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"near", "[", 
                    RowBox[{"e0", ",", 
                    RowBox[{"{", 
                    RowBox[{"Infinity", ",", "1.0"}], "}"}]}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"e0", ",", "eccs"}], "}"}]}], "]"}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"area", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", "val"}], 
                "]"}]}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "$CMagData"}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CMagSummaryBySubject", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH", "|", "All"}]}], ",", "area_", ",", 
       "type_String"}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tid", "=", 
         RowBox[{"type", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Radial\>\"", "\[Rule]", "1"}], ",", 
            RowBox[{"\"\<Tangential\>\"", "\[Rule]", "2"}], ",", 
            RowBox[{"\"\<Areal\>\"", "\[Rule]", "3"}]}], "}"}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"$CMagSummaryBySubject", "[", "hem", "]"}], "[", "sub", 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"tid", "+", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"hem", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"hemi", "===", "All"}], ",", 
             RowBox[{"{", 
              RowBox[{"LH", ",", "RH"}], "}"}], ",", 
             RowBox[{"{", "hemi", "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"sub", ",", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Keys", "@", 
              RowBox[{"$CMagSummaryBySubject", "[", "hem", "]"}]}], ",", 
             RowBox[{"Except", "[", "\"\<S0902\>\"", "]"}]}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"IntegerQ", "[", "area", "]"}], ",", 
             RowBox[{"{", "area", "}"}], ",", 
             RowBox[{"area", "===", "All"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "True", ",", 
             "area"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CMagSummary", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH", "|", "All"}]}], ",", "area_", ",", 
       "type_String", ",", 
       RowBox[{"q_:", "0.1"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"CMagSummaryBySubject", "[", 
           RowBox[{"hemi", ",", "area", ",", "type"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dat", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{"Prepend", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Quantile", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"q", ",", "0.25", ",", "0.5", ",", "0.75", ",", 
                   RowBox[{"1", "-", "q"}]}], "}"}]}], "]"}], "&"}], "/@", 
              "dat"}], ",", "\[IndentingNewLine]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID-\
>"cb43c9a7-6bb8-45ec-81f5-56cab25f49e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Plotting projections to the visual field and retinotopy model\
\>", "Section",ExpressionUUID->"48084d53-3837-481c-8283-4d013c0d6266"],

Cell["\<\
The functions defined in this section of the notebook allow one to plot data \
projected into the visual field; these projections can be based either on the \
individualized template fits or on the raw data.\
\>", "Text",ExpressionUUID->"db03362c-b47b-4887-9069-01118e09ed97"],

Cell[CellGroupData[{

Cell["Functions to Parse Options", "Subsection",ExpressionUUID->"7d3ad60a-7a80-409c-a8a2-04393eccf467"],

Cell["\<\
These functions parse options given to the various functions that follow them,\
\>", "Text",ExpressionUUID->"247c33b9-128a-413d-8f62-cc9068472ad0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldParseOption", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "::", "badopt"}], "=", 
   "\"\<Bad option given to VisualField option parser: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Range", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Projection", "\[Rule]", "\"\<Empirical\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "\"\<VarianceExplained\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Select", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Range", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Range", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"m_", "?", "NumericQ"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mm", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "\[RuleDelayed]", 
        "mm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"None", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Automatic", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Range should be a max eccentricity or a {min,max} list.\>\""}],
          "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Select", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Select", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"None", "|", "Automatic", "|", "False"}], "\[Rule]", "None"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"VisualArea", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "VisualArea", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"None", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"All", "|", "Full"}], "\[Rule]", 
        RowBox[{"Keys", "@", 
         RowBox[{"$Benson17Model", "[", "\"\<VisualAreaNames\>\"", "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"x_Integer", "\[RuleDelayed]", 
        RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"x_String", "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"$Benson17Model", "[", "\"\<VisualAreaKey\>\"", "]"}], "[", 
          "x", "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{"VectorQ", "[", 
          RowBox[{"x", ",", "StringQ"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"$Benson17Model", "[", "\"\<VisualAreaKey\>\"", "]"}], "/@",
           "x"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{"VectorQ", "[", 
          RowBox[{"x", ",", "StringQ"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Union", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<VisualArea must be an integer, a string, a list containing \
integers/strings, or All\>\""}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Projection", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$EmpiricalPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"$SemiEmpiricalPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"$GoldPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GoldPolarAngle\>\"", ",", "\"\<GoldEccentricity\>\""}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$PredictedPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<PredictedPolarAngle\>\"", ",", 
          "\"\<PredictedEccentricity\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$AnatomyPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Benson14PolarAngle\>\"", ",", "\"\<Benson14Eccentricity\>\""}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ang_String", ",", "ecc_String"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"inAllMeshes", "[", "ang", "]"}], "&&", 
           RowBox[{"inAllMeshes", "[", "ecc", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ang", ",", "ecc"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<polar angle/eccentricity properties were not present in all \
specified meshes\>\""}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m_", "?", "MatrixQ"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit angles can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Projection (\>\"", "<>", 
           RowBox[{"ToString", "@", 
            RowBox[{"OptionValue", "[", "Projection", "]"}]}], "<>", 
           "\"\<) should be Empirical or GoldStandard\>\""}]}], "]"}]}]}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Weights", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Weights", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"False", "|", "None"}], "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Weight\>\"", "\[Rule]", "\"\<Weight\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<VarianceExplained\>\"", "\[Rule]", "\"\<VarianceExplained\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"s_String", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inAllMeshes", "[", "s", "]"}], ",", "\[IndentingNewLine]", 
          "s", ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<weight property not present in all meshes\>\""}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m_List", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit weights can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Weights should be \\\"Weight\\\", \\\"VarianceExplained\\\", \
or None\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->\
"28029415-8ef1-4c8b-9c92-2d2671fd32cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Averaging data into the visual field", "Subsection",ExpressionUUID->"d58ed629-e2d9-4aa0-9120-28d81b18f4e7"],

Cell["\<\
Given a subject or group of subjects, a property to project, and polar \
angle/eccentricity properties (optionally weight), combine all the data into \
a single visual field mesh and return it.
The visual field mesh is returned as a function.\
\>", "Text",ExpressionUUID->"44aab93c-c7bd-4d55-b4f7-58f68f13efd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldFunction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldFunction", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectMesh", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "GaussianInterpolation", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "::", "badarg"}], "=", 
   "\"\<Bad argument given to VisualFieldFunction: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "[", 
    RowBox[{"who_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"allMeshes", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Outer", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub", "=", "#1"}], ",", 
                    RowBox[{"hem", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"sub", ",", "hem", ",", "\"\<Sym\>\"", ",", "#"}],
                     "]"}], ",", "opts"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", "All"}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Empirical\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Measured\>\""}]}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Training\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Train\>\""}]}], ",", 
                    RowBox[{"Rest", "@", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Gold\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<GoldStandard\>\""}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
                    "True", ",", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\"\<Unrecognized dataset arg\>\""}], "]"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "===", "All"}], ",", 
                 "$Subjects", ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "All"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "LR"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "1", ",", "1"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"Dimensions", "[", "who", "]"}]}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{"{", "who", "}"}], ",", "who"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"allMeshGolds", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Outer", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub", "=", "#1"}], ",", 
                    RowBox[{"hem", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"sub", ",", "hem", ",", "\"\<Sym\>\"", ",", "0"}],
                     "]"}], ",", "opts"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", "All"}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Empirical\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Measured\>\""}]}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Training\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Train\>\""}]}], ",", 
                    RowBox[{"Rest", "@", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Gold\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<GoldStandard\>\""}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
                    "True", ",", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\"\<Unrecognized dataset arg\>\""}], "]"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "===", "All"}], ",", 
                 "$Subjects", ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "All"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "LR"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "1", ",", "1"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"Dimensions", "[", "who", "]"}]}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{"{", "who", "}"}], ",", "who"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sel", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Select", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"area", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "VisualArea", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nSubHems", "=", 
          RowBox[{"Length", "@", 
           RowBox[{"Union", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Subject\>\"", ",", "\"\<Hemisphere\>\""}], "}"}],
                "/.", 
               RowBox[{"Options", "[", 
                RowBox[{"msh", ",", "MetaInformation"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"msh", ",", "allMeshes"}], "}"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"meshes", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"hemi", "\[Rule]", 
              RowBox[{"Select", "[", 
               RowBox[{"allMeshes", ",", 
                RowBox[{
                 RowBox[{"hemi", "===", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Hemisphere\>\"", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"#", ",", "MetaInformation"}], "]"}]}], ")"}]}], 
                 "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"meshGolds", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"hemi", "\[Rule]", 
              RowBox[{"Select", "[", 
               RowBox[{"allMeshGolds", ",", 
                RowBox[{
                 RowBox[{"hemi", "===", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Hemisphere\>\"", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"#", ",", "MetaInformation"}], "]"}]}], ")"}]}], 
                 "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"inAllMeshes", "=", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "=", "#1"}], "}"}], ",", 
             RowBox[{"AllTrue", "[", 
              RowBox[{"allMeshes", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"VertexPropertyList", "[", "#", "]"}], ",", "x"}], 
                 "]"}], "&"}]}], "]"}]}], "]"}], "&"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"projAngleNames", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Projection", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"$AnatomyPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<Benson14VisualArea\>\"", "/.", "msh"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"$SemiEmpiricalPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshGolds", "[", "hemi", "]"}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"_", "\[Rule]", "None"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"weights", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Weights", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projAngle", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180.0"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90.0", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "msh"}], ")"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "msh"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ws0", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"weights", "===", "None"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"VertexCount", "[", "msh", "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", "weights", "]"}], ",", "weights", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"weights", "===", "Automatic"}], ",", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$EmpiricalPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "msh"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$SemiEmpiricalPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "msh"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$GoldPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "\"\<GoldVarianceExplained\>\"", ")"}], "/.",
                     "msh"}], ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$AnatomyPattern", "\[RuleDelayed]", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"\"\<Benson14VisualArea\>\"", "/.", "msh"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"_", "\[RuleDelayed]", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<If Projection is explicit, weights must be explicit \
or None.\>\""}], "]"}]}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", "weights", "]"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"weights", "/.", "msh"}], ")"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<Could not understand Weights argument; should be \
\\\"VarianceExplained\\\", \\\"Weight\\\", or None\>\""}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"idcs", "=", 
               RowBox[{"Association", "@", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"hemi", "\[Rule]", 
                   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"allVtcs", "=", 
                    RowBox[{"Range", "@", 
                    RowBox[{"VertexCount", "[", "#1", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sel", "===", "None"}], ",", "allVtcs", ",", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"MapVertices", "[", 
                    RowBox[{"sel", ",", "#1"}], "]"}], ",", "True"}], "]"}]}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"e_", "/;", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "e", 
                    "\[LessEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"Sign", "[", "#3", "]"}], ",", "1"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"area", "===", "None"}], "||", 
                    RowBox[{"#4", "===", "None"}]}], ",", 
                    "\[IndentingNewLine]", "allVtcs", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{"#4", ",", "a"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "area"}], "}"}]}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"areas", "===", "None"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"None", "&"}], ")"}], "/@", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], ",", 
                    RowBox[{"areas", "[", "hemi", "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"coords", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ang", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"ecc", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", "ecc", "*", 
                    RowBox[{"Cos", "[", "ang", "]"}]}], ",", 
                    RowBox[{"ecc", "*", 
                    RowBox[{"Sin", "[", "ang", "]"}]}]}], "}"}], "]"}], "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"vals", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", "prop", "]"}], ",", 
                    RowBox[{"prop", "/.", "#1"}], ",", "prop"}], "]"}], ",", 
                    "#2"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"ws", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"fs", "=", 
                   RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"coords", "[", "hemi", "]"}]}], "\[Equal]", "0"}],
                     ",", "\[IndentingNewLine]", "None", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "GaussianInterpolation", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Append", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", "hemi", "]"}], ",", 
                    RowBox[{"vals", "[", "hemi", "]"}]}], "}"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Weights", "\[Rule]", 
                    RowBox[{"ws", "[", "hemi", "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], "&&", 
                    RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}]}], ",", 
                   "$Failed", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "RH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "RH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "LH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fl", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], ",", 
                    RowBox[{"fr", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], "||", 
                    RowBox[{"#", "===", "RH"}]}], ",", "\[IndentingNewLine]", 
                    "True", ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dat", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], 
                    ",", "#", ",", 
                    RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", "#", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"hems", "=", 
                    RowBox[{"3", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ")"}]}],
                     ")"}], "/", "2"}], "+", 
                    RowBox[{"3", "/", "2"}]}], ")"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lidcs", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"hems", ",", "1"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ridcs", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"hems", ",", "2"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", "=", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"SparseArray", "@", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"lidcs", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"lidcs", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"fl", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", "lidcs", "]"}], "]"}], "]"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"ridcs", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ridcs", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"fr", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", "ridcs", "]"}], "]"}], "]"}]}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", "r", ",", 
                    RowBox[{"First", "[", "r", "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
   ";"}]}], "Input",ExpressionUUID->"62469fef-f688-4433-bd2f-3466e0048f20"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a Visual Field Projection", "Subsection",ExpressionUUID->"960ea701-bcc8-49a1-a77d-318e741a64f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "VisualFieldMeshPlot", ",", "VisualFieldDensityPlot", ",", 
    "VisualFieldContourPlot", ",", "$VisualFieldOptionDeltas"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$VisualFieldOptionDeltas", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "Automatic"}], ")"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ColorFunction", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ColorFunction", "\[Rule]", "Automatic"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Frame", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Frame", "\[Rule]", "None"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"AspectRatio", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BaseStyle", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PlotRange", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"WorkingPrecision", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"WorkingPrecision", "->", "MachinePrecision"}], ")"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldMeshPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "Graphics", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"$VisualFieldOptionDeltas", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "ContourPlot", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldFunction", "[", 
           RowBox[{"spec", ",", "prop"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"projections", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "RH", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "LH", "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"reg", "=", 
            RowBox[{"Apply", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "Annulus", 
                ",", "Disk"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "range", 
                  ",", 
                  RowBox[{"range", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"projections", "[", "RH", "]"}], "&&", 
                   RowBox[{"projections", "[", "LH", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"projections", "[", "RH", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", "True", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"DensityPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"projections", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Element", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", "reg"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Thin", ",", "White", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                  "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Automatic", "\[RuleDelayed]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"xmin", "\[Equal]", "0"}], "||", 
                    RowBox[{"xmax", "\[Equal]", "0"}]}], ",", "2", ",", "1"}],
                   "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Automatic", "\[RuleDelayed]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Automatic", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                 "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                  RowBox[{
                   RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldContourPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldFunction", "[", 
           RowBox[{"spec", ",", "prop"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"projections", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "RH", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "LH", "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"reg", "=", 
            RowBox[{"Apply", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "Annulus", 
                ",", "Disk"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "range", 
                  ",", 
                  RowBox[{"range", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"projections", "[", "RH", "]"}], "&&", 
                   RowBox[{"projections", "[", "LH", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"projections", "[", "RH", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", "True", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"projections", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Element", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", "reg"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Thin", ",", "White", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                  "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "\[Rule]", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Automatic", "\[RuleDelayed]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"xmin", "\[Equal]", "0"}], "||", 
                    RowBox[{"xmax", "\[Equal]", "0"}]}], ",", "2", ",", "1"}],
                   "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Automatic", "\[RuleDelayed]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Automatic", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                 "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                  RowBox[{
                   RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Options", "[", "ContourPlot", "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"9f9a3481-7dd5-4bca-9aef-b8a912e003a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a V123 Schematic Model Figure", "Subsection",ExpressionUUID->"b373c471-03c3-4f52-8ee5-455c0dbafaf1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "V123FigMeshPlot", ",", "V123FigDensityPlot", ",", "V123FigContourPlot", 
    ",", "SchiraMeshPlot", ",", "SchiraDensityPlot", ",", 
    "SchiraContourPlot"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigMeshPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldMeshPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "V123FigLines", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"VisualArea", "\[Rule]", "_"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "V123FigLines", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "Automatic"}]}], "}"}]}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"VisualArea", "\[Rule]", "_"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "V123FigLines", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"VisualArea", "\[Rule]", "_"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SchiraMeshPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigMeshPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SchiraDensityPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigDensityPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SchiraContourPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigContourPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigMeshPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123angs", "=", 
               RowBox[{"$V123Model", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"v123eccs", "=", 
               RowBox[{"$V123Model", "[", "\"\<Eccentricity\>\"", "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"v123lbls", "=", 
               RowBox[{"$V123Model", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"v123crds", "=", 
               RowBox[{"$V123Model", "[", "\"\<Coordinates\>\"", "]"}]}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"idcs0", "=", 
                 RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"xy", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                  "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"pts", "=", 
                   RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"cfn", "=", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"cfnScale", "=", 
                   RowBox[{"TrueQ", "@", 
                    RowBox[{
                    "OptionValue", "[", "ColorFunctionScaling", "]"}]}]}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"msh", "=", 
                    RowBox[{"DelaunayMesh", "[", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"VertexColors", "\[Rule]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{"cfn", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"cfnScale", ",", "Rescale", ",", "Identity"}], 
                    "]"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", "1"}], "]"}]}]}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigMeshPlot", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123angs", "=", 
               RowBox[{"$V123Model", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"v123eccs", "=", 
               RowBox[{"$V123Model", "[", "\"\<Eccentricity\>\"", "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"v123lbls", "=", 
               RowBox[{"$V123Model", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"v123crds", "=", 
               RowBox[{"$V123Model", "[", "\"\<Coordinates\>\"", "]"}]}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"idcs0", "=", 
                 RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"xy", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                  "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"pts", "=", 
                  RowBox[{"Join", "@@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ListDensityPlot", "[", "\[IndentingNewLine]", 
                 RowBox[{"pts", ",", "\[IndentingNewLine]", 
                  RowBox[{"ColorFunctionScaling", "\[Rule]", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ColorFunction", "\[Rule]", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListDensityPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V123FigContourPlot", "[", 
     RowBox[{"spec_", ",", "prop_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"projections", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"VisualFieldFunction", "[", 
              RowBox[{"spec", ",", "prop", ",", 
               RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
           "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"mpp", "=", 
         RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"plotFn", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
               RowBox[{"v123angs", "=", 
                RowBox[{"$V123Model", "[", "\"\<PolarAngle\>\"", "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"v123eccs", "=", 
                RowBox[{"$V123Model", "[", "\"\<Eccentricity\>\"", "]"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"v123lbls", "=", 
                RowBox[{"$V123Model", "[", "\"\<VisualArea\>\"", "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"v123crds", "=", 
                RowBox[{"$V123Model", "[", "\"\<Coordinates\>\"", "]"}]}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"idcs0", "=", 
                  RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"xy", "=", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                   "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"pts", "=", 
                   RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ListContourPlot", "[", "\[IndentingNewLine]", 
                  RowBox[{"pts", ",", "\[IndentingNewLine]", 
                   RowBox[{"ColorFunctionScaling", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListContourPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"projections", ",", 
            RowBox[{
             RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"projections", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
           RowBox[{
            RowBox[{"projections", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"plotFn", "[", "LH", "]"}], ",", 
            RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"plotFn", "[", "LH", "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "True", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchiraMeshPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"vfpts", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                 RowBox[{"List", ",", "\[IndentingNewLine]", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "180", ",", "5"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"mpp", "/", "36"}], ")"}]}]}], "]"}], "^", 
                    "3.5"}]}]}]}], "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123angs", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Pi", "/", "180"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"90", "-", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}]}], 
                    "&"}], "@", 
                    RowBox[{"vfpts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"v123eccs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}], "&"}], 
                  "@", 
                  RowBox[{"vfpts", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123lbls", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
                    RowBox[{"Length", "[", "vfpts", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123crds", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{
                   RowBox[{"VisualFieldToCorticalMap", "[", 
                    RowBox[{"$SchiraModelUnrotated", ",", "vfpts"}], "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"idcs0", "=", 
                   RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"xy", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"pts", "=", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"cfn", "=", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"cfnScale", "=", 
                    RowBox[{"TrueQ", "@", 
                    RowBox[{
                    "OptionValue", "[", "ColorFunctionScaling", "]"}]}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"msh", "=", 
                    RowBox[{"DelaunayMesh", "[", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"VertexColors", "\[Rule]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{"cfn", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"cfnScale", ",", "Rescale", ",", "Identity"}], 
                    "]"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", "1"}], "]"}]}]}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "SchiraMeshPlot", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Graphics", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dmsh", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "15"}], ",", 
                    RowBox[{"-", "40"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "40"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"V123FigBoundary", "[", 
                    RowBox[{"15", ",", 
                    RowBox[{
                    "RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "White", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], "&"}], 
                    "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"MeshCoordinates", "[", "dmsh", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"dmsh", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
             "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchiraDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"vfpts", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                 RowBox[{"List", ",", "\[IndentingNewLine]", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "180", ",", "5"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", "=", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"mpp", "/", "36"}], ")"}]}]}], "]"}], "^", 
                    "3.5"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "r", "]"}], "\[NotEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"r", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "r"}], 
                    "]"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123angs", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Pi", "/", "180"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"90", "-", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}]}], 
                    "&"}], "@", 
                    RowBox[{"vfpts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"v123eccs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}], "&"}], 
                  "@", 
                  RowBox[{"vfpts", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123lbls", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
                    RowBox[{"Length", "[", "vfpts", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123crds", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{
                   RowBox[{"VisualFieldToCorticalMap", "[", 
                    RowBox[{"$SchiraModelUnrotated", ",", "vfpts"}], "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"idcs0", "=", 
                   RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "v123eccs", "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"xy", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"pts", "=", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ListDensityPlot", "[", "\[IndentingNewLine]", 
                    RowBox[{"pts", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunctionScaling", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListDensityPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Graphics", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"msh", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "15"}], ",", 
                    RowBox[{"-", "40"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "40"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"V123FigBoundary", "[", 
                    RowBox[{"15", ",", 
                    RowBox[{
                    "RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "White", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], "&"}], 
                    "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchiraContourPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"vfpts", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                 RowBox[{"List", ",", "\[IndentingNewLine]", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "180", ",", "5"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", "=", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"mpp", "/", "36"}], ")"}]}]}], "]"}], "^", 
                    "3.5"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "r", "]"}], "\[NotEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"r", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "r"}], 
                    "]"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123angs", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Pi", "/", "180"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"90", "-", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}]}], 
                    "&"}], "@", 
                    RowBox[{"vfpts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"v123eccs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}], "&"}], 
                  "@", 
                  RowBox[{"vfpts", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123lbls", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
                    RowBox[{"Length", "[", "vfpts", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123crds", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{
                   RowBox[{"VisualFieldToCorticalMap", "[", 
                    RowBox[{"$SchiraModelUnrotated", ",", "vfpts"}], "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"idcs0", "=", 
                   RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "v123eccs", "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"xy", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"pts", "=", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ListContourPlot", "[", "\[IndentingNewLine]", 
                    RowBox[{"pts", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunctionScaling", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$MagRatioBlendColors", ",", "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListContourPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Graphics", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"msh", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "15"}], ",", 
                    RowBox[{"-", "40"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "40"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"V123FigBoundary", "[", 
                    RowBox[{"15", ",", 
                    RowBox[{
                    "RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "White", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], "&"}], 
                    "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"046e5aa3-0180-4b59-9e09-bb103efdcb08"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting Subject Paths/Contours on the Cortical Surface", "Subsection",ExpressionUUID->"11b59c04-6873-4149-8bab-81d2824b0be0"],

Cell["\<\
This function, SubjectContours, returns a GraphicsComplex that will plot an \
overlay of contours and lines.\
\>", "Text",ExpressionUUID->"9309d20f-7a77-4dd5-87b9-426667d0ba9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SubjectContours", ",", "VisualAreaStyleFunction"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "::", "badarg"}], "=", 
   "\"\<Bad argument given to SubjectContours: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualAreaStyleFunction", "::", "usage"}], "=", 
   "\"\<VisualAreasStyleFunction is an option to SubjectContours.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectContours", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EccentricityLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "1.25", ",", "2.5", ",", "5", ",", "10", ",", "20", ",", "40", ",", 
          "80"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"EccentricityStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90", ",", "180"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreas", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreaStyleFunction", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BoundaryStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Mesh", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VertexCoordinates", "\[Rule]", "Automatic"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "SubjectMap", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Xarg", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{
              RowBox[{"Length", "[", "m", "]"}], "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}]}]}], "\[RuleDelayed]", 
            RowBox[{"Transpose", "[", "m", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{"1", "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}], "<", "4"}]}], 
            "\[RuleDelayed]", "m"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Automatic", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"_", "\[RuleDelayed]", 
            RowBox[{"Message", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SubjectContours", "::", "badarg"}], ",", 
              "\[IndentingNewLine]", 
              "\"\<VertexCoordinates must be an n x 2 or n x 3 matrix or \
Automatic\>\""}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pre0", "=", 
         RowBox[{"Fold", "[", "\[IndentingNewLine]", 
          RowBox[{"Replace", ",", "\[IndentingNewLine]", 
           RowBox[{"OptionValue", "[", "Mesh", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"s_String", "\[RuleDelayed]", 
              RowBox[{"ToLowerCase", "[", "s", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s_String", "\[RuleDelayed]", 
                RowBox[{"WithOptions", "[", 
                 RowBox[{
                  RowBox[{"SubjectMesh", "[", 
                   RowBox[{"sub", ",", "hemi", ",", "s", ",", "ds"}], "]"}], 
                  ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Xarg", "===", "Automatic"}], ",", 
                  RowBox[{"WithOptions", "[", 
                   RowBox[{
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "opts"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "Xarg", "]"}]}], "\[Equal]", "2"}], 
                  ",", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "ds"}], 
                    "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "ds"}], 
                    "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<VertexCoordinates do not match a mesh size\>\""}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "}"}]}], "}"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pre", "=", 
            RowBox[{"pre0", "/.", 
             RowBox[{"\"\<PredictedVisualArea\>\"", "\[Rule]", 
              RowBox[{"MapVertices", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0", "<", "#PredictedVisualArea", "<", "4"}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", "#PredictedPolarAngle", "]"}], "<", 
                    "90"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"-", "#PredictedVisualArea"}], ",", 
                   "\[IndentingNewLine]", "#PredictedVisualArea"}], "]"}]}], 
                ",", "\[IndentingNewLine]", "pre0"}], "]"}]}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"elines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "1.25", ",", "2.5", ",", "5", ",", "10", ",", "20", ",", 
                   "40", ",", "80"}], "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<EccentricityLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"estyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", "Black", "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"plines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "90"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<PolarAngleLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"pstyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", 
                   RowBox[{"Thick", ",", "White"}], "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3"}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Full", "|", "All"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4",
                    ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}]}]}], 
               "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"astyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreaStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Round", "@", 
                    RowBox[{"Abs", "[", "#", "]"}]}], ",", 
                    "\[IndentingNewLine]", "1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Blue"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Green"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "3", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Red"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "_", ",", "None"}], "]"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"bstyle", "=", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "BoundaryStyle", "]"}], ",", 
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"idxFix", "=", 
              RowBox[{"Function", "@", 
               RowBox[{"VertexIndex", "[", 
                RowBox[{"pre", ",", "#"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"inRangeQ", "=", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"All", "|", "Full"}], "\[Rule]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"emax_", "?", "NumericQ"}], "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a0_", "?", "NumericQ"}], ",", 
                    RowBox[{"amax_", "?", "NumericQ"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    "a0", "\[LessEqual]", "#1", "\[LessEqual]", "amax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}]}]}],
                  "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"angleDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedPolarAngle\>\""}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"eccenDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedEccentricity\>\""}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"areasDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedVisualArea\>\""}], "]"}]}]}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"checkfn", "=", 
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"a", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"IntegerQ", "[", "#1", "]"}], ",", 
                    RowBox[{"{", "#1", "}"}], ",", "#1"}], "]"}]}], ",", 
                    RowBox[{"e", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"e", "===", "None"}], ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"Round", "[", "#PredictedVisualArea", "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"a", "===", "None"}], ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#PredictedEccentricity", "<", "e"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"Round", "[", "#PredictedVisualArea", "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"#PredictedEccentricity", "<", "e"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}]}], 
                   "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"bound", "=", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"bound0", "=", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"a", ",", "None"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "rotate", " ", "it", " ", "so", " ", "that", " ", "the", 
                    " ", "start", " ", "is", " ", "the", " ", "fovea"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"RotateLeft", "[", 
                    RowBox[{"bound0", ",", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Ordering", "[", 
                    RowBox[{
                    RowBox[{"eccenDat", "[", 
                    RowBox[{"[", "bound0", "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "-", "1"}]}], "]"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], 
                   ",", 
                   RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"VertexCoordinates", "[", "pre", "]"}]}]}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"Okay", ",", " ", 
                   RowBox[{
                    RowBox[{
                    "the", " ", "rest", " ", "will", " ", "be", " ", "done", 
                    " ", "somewhat", " ", "procedurally"}], "..."}]}], " ", 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"First", "@", 
                  RowBox[{"Last", "@", 
                   RowBox[{"Reap", "[", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"First", ",", " ", 
                    RowBox[{
                    RowBox[{
                    "find", " ", "the", " ", "areas", " ", "and", " ", 
                    "render", " ", "them"}], "..."}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"astyle", "[", "a", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"a", ",", "None"}], "]"}]}], "]"}]}], "]"}]}]}]}],
                     "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Next", ",", " ", 
                    RowBox[{"we", " ", "do", " ", "eccentricity"}]}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"estyle", "[", "e", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"None", ",", "e"}], "]"}]}], "]"}]}], "]"}]}]}]}],
                     "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", "elines"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"Then", " ", "polar", " ", "angle"}], "..."}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"pstyle", "[", "p", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "]"}]}], 
                    "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", "#"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", "None"}], "]"}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "180"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "3"}]}], "}"}], ",", "None"}], "]"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "90"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", "None"}], "]"}], ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"-", "2"}], "}"}], ",", "None"}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"0", "<", "p", "<", "90"}], ",", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cf12", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", "None"}], "]"}]}], 
                    ",", 
                    RowBox[{"cf23", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", "None"}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf12", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf23", "[", "#", "]"}], "&&", 
                    RowBox[{"#PredictedPolarAngle", "\[LessEqual]", "p"}]}], 
                    ")"}], "&"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"90", "<", "p", "<", "180"}], ",", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cf12", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}], ",", "None"}], "]"}]}], ",", 
                    
                    RowBox[{"cf23", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "3"}]}], "}"}], ",", "None"}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf12", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf23", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "plines"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Last", ",", " ", 
                    RowBox[{
                    RowBox[{"do", " ", "the", " ", "boundary"}], "..."}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bstyle", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "bstyle", "]"}], ",", "bstyle", ",", 
                    RowBox[{"{", "bstyle", "}"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", "bound", "]"}]}], "]"}]}]}], "]"}]}],
                     "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
       "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"da7a34b1-536e-4793-\
80d9-f982d7d71a95"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a figure row with models and fields", "Subsection",ExpressionUUID->"e03b4835-c822-488b-84b6-6ba07d43e78f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "ModelFieldRow", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ModelFieldRow", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"Labeled", "\[Rule]", "True"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelFieldRow", "[", 
    RowBox[{"v123Figs_", ",", "fieldFigs_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"imsz", "=", 
        RowBox[{"{", 
         RowBox[{"3.25", ",", "1.75"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"labQ", "=", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Labeled", "]"}], ",", 
           RowBox[{"Automatic", "\[Rule]", "True"}]}], "]"}]}]}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1dx", "=", "0.275"}], ",", 
         RowBox[{"r1x0", "=", "0.12"}], ",", "\[IndentingNewLine]", 
         RowBox[{"fsz", "=", 
          RowBox[{"0.8", "*", "72"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"f0", "=", "0.5"}], ",", 
         RowBox[{"fldbdy", "=", 
          RowBox[{"0.1", "+", 
           RowBox[{"1", "/", 
            RowBox[{"imsz", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"sty", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"Style", "[", 
            RowBox[{"##", ",", 
             RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}]}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fieldFigs", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "f0"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.2"}], "}"}], "]"}], ",", "fsz"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fieldFigs", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], "]"}], ",", "fsz"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fieldFigs", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", "fsz"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"v123Figs", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"1", "*", "72"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"v123Figs", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"1", "*", "72"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"labQ", ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"y1", "=", "f0"}], ",", 
                 RowBox[{"y2", "=", "0.05"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V1\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.38", ",", "y1"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V2\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.26", ",", "y2"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V3\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.51", ",", "y2"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
                "}"}]}], "]"}], ",", "\[IndentingNewLine]", "Nothing"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"imsz", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", "72"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"imsz", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", "72"}]}], "}"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"imsz", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"c81e165e-6653-4c17-b420-04bdb62f3b8b"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Body", "Chapter",ExpressionUUID->"18d4fb76-9a7b-4e9d-a8fe-eaf1130f3db4"],

Cell["\<\
This section of the notebook contains code that actually creates and displays \
plots of the various data.\
\>", "Text",ExpressionUUID->"806d9f4c-1d5c-4650-b7d0-d5796c2d70a8"],

Cell[CellGroupData[{

Cell["Figures", "Subchapter",ExpressionUUID->"066117cd-5693-4899-9792-d5c6ad57efa3"],

Cell[CellGroupData[{

Cell["Summary of Methods", "Section",ExpressionUUID->"1b28c5d3-589c-4a68-b3b7-5a4d7fc818b9"],

Cell[CellGroupData[{

Cell["Boundaries on Surface", "Subsection",ExpressionUUID->"9f280b52-4b1c-4a0e-bf29-e7d4fb2aba8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FigBoundaryColors", ",", "$FigBoundaryColorsFull", ",", 
    "$SymHemiViewOpts", ",", "$WangTranslate", ",", "WangTranslate"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SymHemiViewOpts", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.03010569583836`", ",", 
        RowBox[{"-", "3.1877238108047945`"}], ",", 
        RowBox[{"-", "0.47675901819423566`"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ViewVertical", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.5169180898526714`", ",", 
        RowBox[{"-", "0.4069619588183383`"}], ",", "0.7531119786975949`"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ViewAngle", "\[Rule]", "0.16945365705350796`"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ViewCenter", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.48631941917358557`", ",", "0.47632696794794605`"}], 
         "}"}]}], "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigBoundaryColorsFull", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson14\>\"", ",", "1"}], "}"}], "\[Rule]", "Red"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson14\>\"", ",", "2"}], "}"}], "\[Rule]", "Yellow"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson14\>\"", ",", "3"}], "}"}], "\[Rule]", "Orange"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "1"}], "}"}], "\[Rule]", "Purple"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "2"}], "}"}], "\[Rule]", "Blue"}], ",", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "3"}], "}"}], "\[Rule]", "Cyan"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<V1\>\"", "\[Rule]", "White"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigBoundaryColors", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "1"}], "}"}], "\[Rule]", "White"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "2"}], "}"}], "\[Rule]", "White"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "3"}], "}"}], "\[Rule]", "White"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "4"}], "}"}], "\[Rule]", "White"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "5"}], "}"}], "\[Rule]", "White"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "6"}], "}"}], "\[Rule]", "White"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "7"}], "}"}], "\[Rule]", "White"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "8"}], "}"}], "\[Rule]", "White"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Schira\>\"", ",", "1"}], "}"}], "\[Rule]", "Black"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Schira\>\"", ",", "2"}], "}"}], "\[Rule]", "Black"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Schira\>\"", ",", "3"}], "}"}], "\[Rule]", "Black"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "1"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "2"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "3"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Other\>\"", "\[Rule]", "Green"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<V1\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$WangTranslate", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "1"}], ",", 
     RowBox[{"2", "\[Rule]", "1"}], ",", 
     RowBox[{"3", "\[Rule]", "2"}], ",", 
     RowBox[{"4", "\[Rule]", "2"}], ",", 
     RowBox[{"5", "\[Rule]", "3"}], ",", 
     RowBox[{"6", "\[Rule]", "3"}], ",", 
     RowBox[{"7", "\[Rule]", "4"}], ",", 
     RowBox[{"8", "\[Rule]", "5"}], ",", 
     RowBox[{"15", "\[Rule]", "6"}], ",", 
     RowBox[{"17", "\[Rule]", "7"}], ",", 
     RowBox[{"16", "\[Rule]", "8"}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WangTranslate", "[", "k_Integer", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$WangTranslate", ",", "k"}], "]"}], ",", 
     RowBox[{"$WangTranslate", "[", "k", "]"}], ",", "0"}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"0449f5ee-4f06-4638-88c0-bd58506e32d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Wang2015Atlas", ",", "$WangSymPathSub"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$WangSymPathSub", "=", "\"\<S1201\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Wang2015Atlas", ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h", "\[Rule]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f0", "=", 
            RowBox[{"Import", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"$DataRoot", ",", "\"\<wang2015\>\"", ",", 
                 RowBox[{
                  RowBox[{"ToLowerCase", "@", 
                   RowBox[{"ToString", "[", "h", "]"}]}], "<>", 
                  "\"\<.mgz\>\""}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", "WangTranslate", "]"}], "@", 
           RowBox[{"Round", "@", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"h", "===", "LH"}], ",", "\[IndentingNewLine]", "f0", 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CortexResample", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Cortex", "[", 
                 RowBox[{
                 "FSAverageSymSubject", ",", "LH", ",", "\"\<Sphere\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SubjectMesh", "[", 
                  RowBox[{
                  "$WangSymPathSub", ",", "RH", ",", "\"\<Sym\>\"", ",", 
                   "0"}], "]"}], "/.", 
                 RowBox[{"First", "@", 
                  RowBox[{"CortexResample", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "$WangSymPathSub", ",", "RH", ",", "\"\<FSAverage\>\"", 
                    ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Cortex", "[", 
                    RowBox[{
                    "FSAverageSubject", ",", "RH", ",", "\"\<Sphere\>\""}], 
                    "]"}], "/.", 
                    RowBox[{"\"\<W15\>\"", "\[Rule]", "f0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Method", "\[Rule]", "Nearest"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Properties", "\[Rule]", 
                    RowBox[{"{", "\"\<W15\>\"", "}"}]}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Method", "\[Rule]", "Nearest"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Properties", "\[Rule]", "\"\<W15\>\""}]}], "]"}]}], 
             "]"}]}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"h", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.706717521639674*^9, 3.7067175402693253`*^9}, {
   3.706717586079405*^9, 3.706717658301668*^9}, {3.706717815952169*^9, 
   3.7067178650607452`*^9}, {3.70671791415843*^9, 3.70671797441066*^9}, {
   3.7067188532481127`*^9, 3.70671885672672*^9}, {3.7067188948783903`*^9, 
   3.706718897902088*^9}, {3.7067189816536827`*^9, 3.706718982778612*^9}, {
   3.706720242910987*^9, 3.706720252558749*^9}, {3.7067208727940617`*^9, 
   3.7067209783388023`*^9}, {3.706721128065832*^9, 3.706721279291168*^9}, {
   3.706721339491145*^9, 3.706721384449091*^9}, 3.706721537178257*^9, {
   3.7067215715852633`*^9, 3.706721574310302*^9}, {3.706721728231761*^9, 
   3.706721767605568*^9}, {3.706721862358924*^9, 3.706721863558474*^9}, {
   3.706721919960855*^9, 3.706721983162675*^9}, {3.706722076299385*^9, 
   3.706722079602754*^9}, {3.706722371968266*^9, 3.7067225282091217`*^9}, {
   3.706722559444553*^9, 3.706722695101787*^9}, {3.706722953934659*^9, 
   3.706722955606769*^9}, {3.706723078121558*^9, 3.706723108408064*^9}, {
   3.706723171251403*^9, 3.706723171490943*^9}, {3.706723322165247*^9, 
   3.7067233228655987`*^9}, {3.706723424366609*^9, 3.706723429078018*^9}, {
   3.706723552108488*^9, 3.706723588707633*^9}, {3.706723630695374*^9, 
   3.706723635087216*^9}, {3.70672367668362*^9, 3.706723679274434*^9}, {
   3.7067237667957687`*^9, 
   3.7067237671227016`*^9}},ExpressionUUID->"8fc7f285-7870-4f0f-9ec0-\
e73060cd73b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"FigBoundariesPlots", ",", "FigBoundariesPlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FigBoundariesPlot", "[", "mdl_", "]"}], ":=", 
     RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"FigBoundariesPlots", "[", "mdl", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"Scaled", "[", 
         RowBox[{"-", "0.125"}], "]"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigBoundariesPlots", "[", "mdlArg_", "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mdls", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "[", "mdlArg", "]"}], ",", "mdlArg", ",", 
           RowBox[{"{", "mdlArg", "}"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"meshes", "=", 
           RowBox[{"Association", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"h", "\[Rule]", 
               RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Benson14Mesh", "[", "\"\<Inflated\>\"", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Join", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<Wang15\>\"", "\[Rule]", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"$Wang2015Atlas", "[", "h", "]"}]}]}], "}"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"m", "\[Rule]", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"Round", "@", 
                    RowBox[{
                    "VertexPropertyValues", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Benson14Mesh", "[", 
                    RowBox[{"\"\<Inflated\>\"", ",", 
                    RowBox[{"RetinotopyModel", "\[Rule]", "m"}], ",", 
                    RowBox[{"Clip", "\[Rule]", "12"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\"\<PredictedVisualArea\>\""}], 
                    "]"}]}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "mdls"}], "}"}]}], "]"}]}], "]"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"h", ",", 
                RowBox[{"Keys", "[", "$Wang2015Atlas", "]"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"h", "\[Rule]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"h", "===", "LH"}], ",", "#", ",", 
                   RowBox[{"ImageReflect", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Left", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], 
                "&"}], "@", 
               RowBox[{"Image", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], 
              "&"}], "@", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"meshes", "[", "h", "]"}], "/.", 
                   RowBox[{"\"\<Curvature\>\"", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"0.0053", "+", 
                    RowBox[{"(", 
                    RowBox[{"\"\<Curvature\>\"", "/.", 
                    RowBox[{"meshes", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Sequence", "@@", "$SymHemiViewOpts"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], "*", "72", "*", 
                    "5"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "@", 
                 RowBox[{"Join", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"$FigBoundaryColors", ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "area"}], "}"}]}], "]"}]}], "||", 
                    RowBox[{
                    RowBox[{"$FigBoundaryColors", "[", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "area"}], "}"}], "]"}], "===", 
                    "None"}]}], ",", "\[IndentingNewLine]", "Nothing", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"$FigBoundaryColors", "[", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "area"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"#", ",", "0.5"}], "]"}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Most", "@", "#"}], ",", 
                    RowBox[{"Rest", "@", "#"}]}], "}"}], "]"}], "&"}], "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "LabelBoundaryVertexCoordinates", "[", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"meshes", "[", "h", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Abs", "@", 
                    RowBox[{"Round", "[", 
                    RowBox[{"l", "/.", 
                    RowBox[{"meshes", "[", "h", "]"}]}], "]"}]}], ",", 
                    "area"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Method", "\[Rule]", "All"}]}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "\"\<Wang15\>\"", "}"}], ",", "mdls"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"area", ",", 
                    RowBox[{"Range", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"l", "\[Equal]", "\"\<Benson17\>\""}], ",", "8", 
                    ",", "3"}], "]"}]}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"$FigBoundaryColors", ",", "\"\<V1\>\""}], "]"}], 
                    "||", 
                    RowBox[{
                    RowBox[{"$FigBoundaryColors", "[", "\"\<V1\>\"", "]"}], "===",
                     "None"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$FigBoundaryColors", "[", "\"\<V1\>\"", "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"#", ",", "0.75"}], "]"}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Most", "@", "#"}], ",", 
                    RowBox[{"Rest", "@", "#"}]}], "}"}], "]"}], "&"}], "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    "LabelBoundaryVertexCoordinates", "[", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"meshes", "[", "h", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V1Label\>\"", "/.", 
                    RowBox[{"meshes", "[", "h", "]"}]}]}], "]"}]}]}], "]"}]}],
                     "}"}]}], "]"}]}], "]"}]}]}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
        "]"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"2755f7f5-\
be3d-47c9-bdfd-e6edc5ee1965"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isomorphism Display", "Subsection",ExpressionUUID->"ff4a5d88-e9e7-462e-9cfb-cf1070cf824d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$IsoFigSpec", ",", "$IsoFigMeshes", ",", "$IsoFigAreaColors"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$IsoFigSpec", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<S0904\>\"", ",", "All", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$IsoFigAreaColors", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[Rule]", 
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LightGray", ",", "#2"}], "}"}], ",", "0.5"}], "]"}]}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Yellow", ",", "LightGray", ",", "Cyan"}], "}"}]}], "}"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$IsoFigViewOpts", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LH", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ViewAngle", "\[Rule]", "0.0754688152953082`"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.9509056347491986`", ",", 
           RowBox[{"-", "2.4154093615965286`"}], ",", 
           RowBox[{"-", "1.3452749979895093`"}]}], "}"}]}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.3055024645934998`", ",", "0.5915460831222104`"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.7766117779965472`", ",", 
           RowBox[{"-", "0.4000746493608886`"}], ",", 
           "0.48663581990622473`"}], "}"}]}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"RH", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.950843846610356`"}], ",", 
           RowBox[{"-", "2.350124949880394`"}], ",", 
           RowBox[{"-", "1.4564068820532898`"}]}], "}"}]}], ",", 
        RowBox[{"ViewAngle", "\[Rule]", "0.07816178386491977`"}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.0963344892851972`"}], ",", 
           RowBox[{"-", "0.7391601485454268`"}], ",", "0.7396394788060017`"}],
           "}"}]}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.28224126799702853`"}], ",", 
             "0.5187200907823776`"}], "}"}]}], "}"}]}]}], "}"}]}]}], "|>"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$IsoFigMeshes", ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hemi", "\[Rule]", 
        RowBox[{"SubjectMesh", "@@", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Insert", "[", 
             RowBox[{"$IsoFigSpec", ",", "\"\<Inflated\>\"", ",", "3"}], 
             "]"}], "/.", 
            RowBox[{"All", "\[Rule]", "hemi"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Clip", "\[Rule]", "12"}]}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"hemi", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.706700240313455*^9, 3.706700398771488*^9}, {
  3.706701124306072*^9, 3.70670119359971*^9}, {3.706701235865953*^9, 
  3.706701238673724*^9}, {3.7067015752574167`*^9, 3.706701575975524*^9}, {
  3.706701686532748*^9, 3.7067016869713087`*^9}, {3.706703974092185*^9, 
  3.706703974632949*^9}, {3.706704012203368*^9, 3.706704013155003*^9}, {
  3.70670562140267*^9, 3.706705780946333*^9}, {3.706706454806814*^9, 
  3.706706456877742*^9}, {3.706706777346513*^9, 
  3.706706787147258*^9}},ExpressionUUID->"7844682a-d0d1-4904-9be9-\
c570c6266380"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$IsoFigCortexPlots", ",", "$IsoFigCortexPlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$IsoFigCortexPlots", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"hemi", "\[Rule]", 
           RowBox[{"Image", "[", 
            RowBox[{"#", ",", 
             RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], "&"}], 
         "@", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$IsoFigMeshes", "[", "hemi", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ColorFunction", "\[Rule]", 
               RowBox[{"Function", "@", 
                RowBox[{"If", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"TrueQ", "[", 
                   RowBox[{
                    RowBox[{"0", "<", "#PredictedVisualArea", "<", "4"}], "&&", 
                    RowBox[{"#PredictedEccentricity", "<", "12"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "CorticalCurvatureColor", "[", "#Curvature", "]"}], ",", 
                    RowBox[{
                    "$IsoFigAreaColors", "[", "#PredictedVisualArea", "]"}]}],
                     "}"}], ",", "\[IndentingNewLine]", "0.5"}], "]"}], ",", 
                  "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"$IsoFigViewOpts", "[", "hemi", "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "@", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"c", "=", 
                 RowBox[{"SubjectContours", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{"$IsoFigSpec", "/.", 
                    RowBox[{"All", "\[Rule]", "hemi"}]}], ")"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Mesh", "\[Rule]", "\"\<Inflated\>\""}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"EccentricityLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"PolarAngleLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "180", ",", "90"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PolarAngleStyleFunction", "\[Rule]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "\[Equal]", "90"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Dashed", ",", "Black"}], "}"}], ",", "Black"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"EccentricityStyleFunction", "\[Rule]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "//", 
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}]}],
                     ",", "\[IndentingNewLine]", "Thick"}], "]"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Range", "\[Rule]", "12"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Clip", "\[Rule]", "12"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"dec__", ",", 
                   RowBox[{"Line", "[", "x_", "]"}]}], "}"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"dec", ",", "\[IndentingNewLine]", 
                   RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "#"}], "]"}], "]"}], ",", "0.1"}], 
                    "]"}]}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Part", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Most", "[", "x", "]"}], ",", 
                    RowBox[{"Rest", "[", "x", "]"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "dec", "}"}], "]"}], ",", 
                    RowBox[{"Dotted", "|", "Dashed", "|", "_Dashing"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"1", ";;", "All", ";;", "2"}], ",", 
                    "\[IndentingNewLine]", "All"}], "]"}]}], "]"}]}], "]"}]}],
                   "}"}]}]}]}], "]"}]}]}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"hemi", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$IsoFigCortexPlot", ":=", 
     RowBox[{"GraphicsRow", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"$IsoFigCortexPlots", "[", "h", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"9b24df6b-b216-4aaa-8cc1-25593db8806f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$IsoFigSchiraLines", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$IsoFigSchiraLines", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lines", "=", 
        RowBox[{"SchiraLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{"$SchiraModelUnrotated", ",", "\[IndentingNewLine]", 
          RowBox[{"EccentricityLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Range", "\[Rule]", "12"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PolarAngleLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "90", ",", "180"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PolarAngleStyleFunction", "\[Rule]", 
           RowBox[{"Function", "@", 
            RowBox[{"List", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"0", "<", "#", "<", "180"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", "Dashed"}], "}"}], ",", "Black"}], 
               "]"}], ",", "\[IndentingNewLine]", "Thin"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
          RowBox[{"EccentricityStyleFunction", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "12"}], ",", "\[IndentingNewLine]", 
                "Black", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], "[", 
                 RowBox[{"<|", 
                  RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                 "]"}]}], "]"}]}], "}"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"LH", "\[Rule]", "lines"}], ",", "\[IndentingNewLine]", 
        RowBox[{"RH", "\[Rule]", 
         RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lines", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"x_", ",", "y_"}], "}"}]}], ")"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "x"}], ",", "y"}], "}"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"1", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"lines", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x_", "?", "NumericQ"}], ",", 
                 RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], ")"}]}]}], 
          "]"}]}]}], "|>"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID\
->"fba23452-2b56-4485-acf9-292e3c104ad3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$IsoFigSchiraBG", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$IsoFigSchiraBG", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plot", "=", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SchiraParametricPlot", "[", "\[IndentingNewLine]", 
            RowBox[{"$SchiraModelUnrotated", ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"Function", "@", 
               RowBox[{"$IsoFigAreaColors", "[", "a", "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"VisualAreas", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"a", ",", 
                RowBox[{"-", "a"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Range", "\[Rule]", "12"}], ",", "\[IndentingNewLine]", 
             RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"Frame", "\[Rule]", "None"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "}"}]}], "]"}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"LH", "\[Rule]", "plot"}], ",", "\[IndentingNewLine]", 
        RowBox[{"RH", "\[Rule]", 
         RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ReplaceAll", "[", 
            RowBox[{"plot", ",", 
             RowBox[{
              RowBox[{"HoldPattern", "[", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"xs_", ",", "ys_"}], "}"}]}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "xs"}], ",", "ys"}], "}"}]}], ")"}]}]}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"1", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"plot", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x_", "?", "NumericQ"}], ",", 
                 RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], ")"}]}]}], 
          "]"}]}]}], "|>"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID\
->"076b53ae-2812-4431-b174-0e67adc51c8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$IsoFigSchiraPlots", ",", "$IsoFigSchiraPlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$IsoFigSchiraPlots", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"h", "\[Rule]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"$IsoFigSchiraBG", "[", "h", "]"}], ",", 
             RowBox[{"$IsoFigSchiraLines", "[", "h", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"Identity", "[", 
             RowBox[{"PlotRange", "/.", 
              RowBox[{"Options", "[", 
               RowBox[{"$IsoFigSchiraLines", "[", "h", "]"}], "]"}]}], 
             "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"h", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$IsoFigSchiraPlot", ":=", 
     RowBox[{"GraphicsRow", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"$IsoFigSchiraPlots", "[", "h", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"2e54feee-f818-4488-acf5-47678169b6b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$IsoFigFieldsPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$IsoFigFieldsPlot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "=", "0.24"}], ",", "\[IndentingNewLine]", 
        RowBox[{"txtpos", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"180", ",", "1.75"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "125"}], ",", "2.0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "30"}], ",", "2.25"}], "}"}]}], "}"}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Opacity", "[", 
             RowBox[{"0", ",", "White"}], "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.25"}], ",", 
                RowBox[{"-", "0.3"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", "1.15"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x0", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "va", "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"r", "+", "0.01"}], ",", 
                    RowBox[{"1", "-", "r", "-", "0.01"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", "r", "-", "0.04"}], ",", 
                    RowBox[{"r", "+", "0.04"}], ",", 
                    RowBox[{"r", "+", "0.04"}]}], "}"}]}], "}"}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"$IsoFigAreaColors", "[", "va", "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{"x0", ",", "r"}], "]"}], ",", "Black", ",", "Thin",
                   ",", 
                  RowBox[{"Circle", "[", 
                   RowBox[{"x0", ",", "r"}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Text", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<V\>\"", "<>", 
                   RowBox[{"ToString", "[", "va", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"x0", "+", 
                    RowBox[{
                    RowBox[{"txtpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"va", ",", "2"}], "]"}], "]"}], "*", "r", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"#", "*", 
                    RowBox[{"Pi", "/", "180"}]}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"#", "*", 
                    RowBox[{"Pi", "/", "180"}]}], "]"}]}], "}"}]}]}], "&"}], 
                   "@", 
                   RowBox[{"txtpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"va", ",", "1"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ImageScaled", "[", 
                   RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", "Thin", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x0", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "r"}], "}"}]}], ",", 
                    RowBox[{"x0", "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "r"}], "}"}]}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Dashing", "[", "0.01", "]"}], ",", "Thin", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x0", "-", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "0"}], "}"}]}], ",", 
                    RowBox[{"x0", "+", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "0"}], "}"}]}]}], "}"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "e"}], "|>"}], 
                    "]"}], ",", "\[IndentingNewLine]", "Thin", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{"x0", ",", 
                    RowBox[{"r", "*", 
                    RowBox[{"e", "/", "12"}]}]}], "]"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"e", ",", 
                    RowBox[{"{", 
                    RowBox[{"1.5", ",", "3", ",", "6"}], "}"}]}], "}"}]}], 
                 "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"va", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.25"}], ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.3"}], ",", "1.15"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "72"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"e2f092e1-f153-4cd9-a7ad-e0257782f762"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$IsoFigPlot", ",", "$IsoFigPlotSize"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$IsoFigPlotSize", "=", 
   RowBox[{"{", 
    RowBox[{"3.5", ",", "1.6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$IsoFigPlot", ":=", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "@", 
           RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ParametricPlot", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.55", ",", "0.5"}], "}"}], "+", 
                RowBox[{"0.35", "*", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1.25", "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"t", "*", "Degree"}], "]"}]}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"t", "*", "Degree"}], "]"}]}], "}"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"t", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
              RowBox[{"Sequence", "[", 
               RowBox[{
                RowBox[{"Arrowheads", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.075"}], ",", "0.075"}], "}"}], "]"}], ",", 
                
                RowBox[{"Arrow", "[", "x", "]"}]}], "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"100", ",", "135"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"225", ",", "260"}], "}"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "@", 
         RowBox[{"List", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"White", ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Inset", "[", 
              RowBox[{"$IsoFigSchiraPlot", ",", 
               RowBox[{"{", 
                RowBox[{"0.75", ",", "1"}], "}"}], ",", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
               RowBox[{"0.7", "*", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0.75"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"$IsoFigFieldsPlot", ",", 
               RowBox[{"{", 
                RowBox[{"0.02", ",", "0.5"}], "}"}], ",", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.5"}], "}"}], "]"}], ",", 
               RowBox[{"0.5", "*", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{"$IsoFigCortexPlot", ",", 
               RowBox[{"{", 
                RowBox[{"0.75", ",", "0"}], "}"}], ",", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
               RowBox[{"0.55", "*", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0.75"}], "}"}]}]}], "]"}]}], "}"}]}], 
          "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1.05"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"$IsoFigPlotSize", "*", "72"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{
        RowBox[{"$IsoFigPlotSize", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", 
        RowBox[{"$IsoFigPlotSize", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"21c19c6d-bfbd-4715-9dc8-eb8e30aa8dd2"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Retinotopic Maps", "Section",ExpressionUUID->"186bafb3-7500-4476-ad2f-8b66c904c57b"],

Cell["\<\
This section constructs the main results figure, which shows polar angle, \
eccentricity, and an analysis of error for the model fits.\
\>", "Text",ExpressionUUID->"d7bd7c39-af47-4ff7-8437-4c0f72d86566"],

Cell[CellGroupData[{

Cell["The Polar Angle and Eccentricity", "Subsection",ExpressionUUID->"81aefa67-1f99-4949-9bd2-3fbbd7c85109"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"RetinotopyV123Figs", ",", "RetinotopyFields"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RetinotopyV123Figs", "]"}], "=", 
   RowBox[{"Options", "[", "SchiraDensityPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RetinotopyFields", "]"}], "=", 
   RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RetinotopyV123Figs", "[", 
      RowBox[{
       RowBox[{"data", ":", 
        RowBox[{
        "\"\<Data\>\"", "|", "\"\<Model\>\"", "|", "\"\<Predicted\>\"", "|", 
         "\"\<Anatomy\>\""}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llines", "=", 
          RowBox[{
           RowBox[{"Graphics", "@*", "Join"}], "@@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"V123FigLines", "[", 
              RowBox[{"e", ",", 
               RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"e", ",", 
               RowBox[{"{", 
                RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
              "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"rlines", "=", 
          RowBox[{"Graphics", "@", 
           RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Join", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"V123FigLines", "[", 
                 RowBox[{"e", ",", 
                  RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"e", ",", 
                  RowBox[{"{", 
                   RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
                 "}"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], "]"}]}]}]}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{"{", 
               RowBox[{"llines", ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "llines"}], "}"}], 
              "]"}], ",", 
             RowBox[{"Show", "[", 
              RowBox[{"{", 
               RowBox[{"rlines", ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "rlines"}], "}"}], 
              "]"}]}], "}"}], "&"}], "@", 
          RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SchiraDensityPlot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"All", ",", "All", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"data", "\[Equal]", "\"\<Data\>\""}], ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"data", "\[Equal]", "\"\<Model\>\""}], ",", 
                 "\"\<Predicted\>\"", ",", "\"\<Gold\>\""}], "]"}], "<>", 
               "type"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Projection", "\[Rule]", 
               RowBox[{"Switch", "[", 
                RowBox[{"data", ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<Model\>\"", "|", "\"\<Predicted\>\""}], ",", 
                 "\"\<Predicted\>\"", ",", "\[IndentingNewLine]", 
                 "\"\<Data\>\"", ",", "\"\<SemiEmpirical\>\"", ",", 
                 "\[IndentingNewLine]", "\"\<Anatomy\>\"", ",", 
                 "\"\<Benson14\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Weights", "\[Rule]", "\"\<GoldVarianceExplained\>\""}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"ColorFunction", "\[Rule]", "type"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Range", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "12"}], "}"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"type", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
            "}"}]}], "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RetinotopyFields", "[", 
      RowBox[{
       RowBox[{"data", ":", 
        RowBox[{
        "\"\<Data\>\"", "|", "\"\<Model\>\"", "|", "\"\<Predicted\>\"", "|", 
         "\"\<Anatomy\>\""}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"VisualFieldDensityPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"All", ",", "All", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"data", "\[Equal]", "\"\<Data\>\""}], ",", 
               RowBox[{"-", "1"}], ",", "0"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"data", "\[Equal]", "\"\<Model\>\""}], ",", 
              "\"\<Predicted\>\"", ",", "\"\<Gold\>\""}], "]"}], "<>", 
            "type"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Projection", "\[Rule]", 
            RowBox[{"Switch", "[", 
             RowBox[{"data", ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<Model\>\"", "|", "\"\<Predicted\>\""}], ",", 
              "\"\<Predicted\>\"", ",", "\[IndentingNewLine]", "\"\<Data\>\"",
               ",", "\"\<SemiEmpirical\>\"", ",", "\[IndentingNewLine]", 
              "\"\<Anatomy\>\"", ",", "\"\<Benson14\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", "type"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Weights", "\[Rule]", "\"\<GoldVarianceExplained\>\""}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"VisualArea", "\[Rule]", "area"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Range", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "12"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", "opts"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"type", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
          "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"area", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"4c1643bf-3df0-4524-8135-\
4f4221b42e8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$RetinotopyDataV123Figs", ",", "$RetinotopyModelV123Figs", ",", 
    "$RetinotopyDataFields", ",", "$RetinotopyModelFields", ",", 
    "$RetinotopyAnatomyV123Figs", ",", "$RetinotopyAnatomyFields", ",", 
    "$RetinotopyPredictedV123Figs", ",", "$RetinotopyPredictedFields"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$RetinotopyDataV123Figs", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<fig-retinotopy_data_v123\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyV123Figs", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Data\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyModelV123Figs", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig-retinotopy_model_v123\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyV123Figs", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Model\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyPredictedV123Figs", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<fig-retinotopy_pred_v123\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyV123Figs", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Predicted\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyAnatomyV123Figs", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<fig-retinotopy_anat_v123\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyV123Figs", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Anatomy\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyDataFields", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<fig-retinotopy_data_fields\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyFields", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Data\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyModelFields", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<fig-retinotopy_model_fields\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyFields", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Model\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyPredictedFields", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<fig-retinotopy_pred_fields\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyFields", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Predicted\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyAnatomyFields", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<fig-retinotopy_anat_fields\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"RetinotopyFields", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Anatomy\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"MaxPlotPoints", "\[Rule]", "1000"}]}], "]"}]}], "]"}]}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"e4988929-1974-4710-a5c9-\
964e00a203a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RetinotopyFigAngleLegend", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RetinotopyFigAngleLegend", "[", 
     RowBox[{"ang", ":", 
      RowBox[{"\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\""}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ai", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ang", "\[Equal]", "\"\<PolarAngle\>\""}], ",", "1", ",", 
          "2"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"GraphicsRow", "@", 
       RowBox[{"List", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"RetinotopyV123Figs", "[", "\"\<Model\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"ai", ",", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RetinotopyFields", "[", "\"\<Model\>\"", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RetinotopyV123Figs", "[", "\"\<Model\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"ai", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.706541558038102*^9, 
  3.706541703337376*^9}},ExpressionUUID->"ca5fa427-4eb5-468b-97b2-\
0dfcfe737e2c"]
}, Closed]],

Cell[CellGroupData[{

Cell["The combined Figure", "Subsection",ExpressionUUID->"243c6273-6536-4228-8ac7-8c3f1485b2f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "$RetinotopyCanvas", ",", "$RetinotopyCanvasRowTops", ",", 
     "$RetinotopyFieldsSize", ",", "InsetRetinotopyCanvasRow", ",", 
     "$RetinotopyModelScaleFactor"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyCanvas", "=", 
   RowBox[{"Canvas", "[", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"3.25", ",", "3.65"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyCanvasRowTops", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"$CanvasTop", "+", "0.15"}], ",", 
     RowBox[{
      RowBox[{"$CanvasCenter", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", "0.15"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyFieldsSize", "=", 
   RowBox[{"{", 
    RowBox[{"0.675", ",", "0.675"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyV123FigSize", "=", 
   RowBox[{"N", "[", 
    RowBox[{"{", 
     RowBox[{"1.1", ",", "1.5"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$RetinotopyModelScaleFactor", "=", "0.35"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "InsetRetinotopyCanvasRow", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InsetRetinotopyCanvasRow", "[", "\[IndentingNewLine]", 
     RowBox[{
     "dataFigs_", ",", "dataFields_", ",", "modelFigs_", ",", "modelFields_", 
      ",", "rowTop_"}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mfigsz", "=", 
         RowBox[{
         "$RetinotopyModelScaleFactor", "*", "$RetinotopyV123FigSize"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"mfldsz", "=", 
         RowBox[{"$RetinotopyModelScaleFactor", "*", 
          RowBox[{"Min", "[", "$RetinotopyV123FigSize", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"figsz", "=", "$RetinotopyV123FigSize"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"fldsz", "=", "$RetinotopyFieldsSize"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rad", "=", "0.45"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
        RowBox[{"$RetinotopyCanvas", ",", 
         RowBox[{"dataFigs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"$CanvasLeft", ",", 
           RowBox[{"rowTop", "-", "0.15"}]}], "}"}], ",", 
         RowBox[{"ImageScaled", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "figsz"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
        RowBox[{"$RetinotopyCanvas", ",", 
         RowBox[{"dataFigs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"$CanvasRight", ",", 
           RowBox[{"rowTop", "-", "0.15"}]}], "}"}], ",", 
         RowBox[{"ImageScaled", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", "figsz"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
            RowBox[{"$RetinotopyCanvas", ",", 
             RowBox[{"dataFields", "[", 
              RowBox[{"[", "#1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"$CanvasCenter", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "#2"}], ",", 
               RowBox[{"rowTop", "-", "#3", "-", "0.1"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
             "$RetinotopyFieldsSize"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
            RowBox[{"$RetinotopyCanvas", ",", 
             RowBox[{"\"\<V\>\"", "<>", 
              RowBox[{"ToString", "[", "#1", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"$CanvasCenter", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "#2", "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"#2", ">", "0"}], ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "]"}], "*", "0.25"}]}], ",", 
               RowBox[{"rowTop", "-", "#3"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"-", "0.8"}], "*", "rad"}], ",", 
             RowBox[{"0.8", "*", "rad"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"1.3", "*", "rad"}], ",", 
             RowBox[{"1.3", "*", "rad"}]}], "}"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"The", " ", 
         RowBox[{"Model", "/", 
          RowBox[{"Legend", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
        RowBox[{"$RetinotopyCanvas", ",", 
         RowBox[{"modelFigs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"$CanvasCenter", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"mfldsz", "/", "2"}]}], ",", 
           RowBox[{"rowTop", "-", 
            RowBox[{"figsz", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "0.1"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageScaled", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0.5"}], "}"}], "]"}], ",", "mfigsz"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
        RowBox[{"$RetinotopyCanvas", ",", 
         RowBox[{"modelFields", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$CanvasCenter", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"rowTop", "-", 
            RowBox[{"figsz", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "0.1"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageScaled", "[", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", "mfigsz"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
        RowBox[{"$RetinotopyCanvas", ",", 
         RowBox[{"modelFigs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"$CanvasCenter", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", 
            RowBox[{"mfldsz", "/", "2"}]}], ",", 
           RowBox[{"rowTop", "-", 
            RowBox[{"figsz", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "0.1"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageScaled", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5"}], "}"}], "]"}], ",", "mfigsz"}], 
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Panel", " ", 
    RowBox[{"A", ":", " ", 
     RowBox[{"Polar", " ", "Angle"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
   RowBox[{"$RetinotopyCanvas", ",", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<A. Polar Angle\>\"", ",", 
      RowBox[{"FontWeight", "\[Rule]", "\"\<Normal\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"$CanvasLeft", ",", "$CanvasTop"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InsetRetinotopyCanvasRow", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$RetinotopyDataV123Figs", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"$RetinotopyDataFields", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"$RetinotopyModelV123Figs", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"$RetinotopyModelFields", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     "$CanvasTop"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Panel", " ", 
    RowBox[{"B", ":", " ", "Eccentricity"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
   RowBox[{"$RetinotopyCanvas", ",", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<B. Eccentricity\>\"", ",", 
      RowBox[{"FontWeight", "\[Rule]", "\"\<Normal\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"$CanvasLeft", ",", 
      RowBox[{"$CanvasCenter", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InsetRetinotopyCanvasRow", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$RetinotopyDataV123Figs", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"$RetinotopyDataFields", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"$RetinotopyModelV123Figs", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"$RetinotopyModelFields", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"$CanvasTop", "/", "2"}]}], "]"}], ";"}]}], "Input",ExpressionUUID\
->"a9eff2bd-b564-40e4-bb06-ae529c5e94f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "[", "\"\<retinotopic_maps\>\"", "]"}], ":=", 
   RowBox[{"Graphics", "[", "$RetinotopyCanvas", "]"}]}], ";"}]], "Input",Expr\
essionUUID->"8013ecb1-1d88-4b05-ba2f-909fc66b1d2f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantified Error", "Section",ExpressionUUID->"7152e3a2-4a9b-43a6-a935-800f89d4e793"],

Cell[CellGroupData[{

Cell["Comparison of Errors", "Subsection",ExpressionUUID->"d416b245-7d24-49b0-b7b5-d56b3abcf68f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "FigErrorPanel", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FigErrorPanel", "]"}], "=", 
   RowBox[{"Options", "[", "ErrorSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FigErrorPanel", "[", 
     RowBox[{"fopts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"imsz", "=", 
         RowBox[{"{", 
          RowBox[{"3.25", ",", "2.25"}], "}"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"errs", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"ErrorSummaries", "[", "]"}], ",", "fopts"}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"qfn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", "=", "#1"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Quantile", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "t", "]"}], "[", 
                   "\"\<AnglePerPRFRadius\>\"", "]"}], "[", "\"\<Mean\>\"", 
                  "]"}], ")"}], "&"}], "/@", "#2"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "0.1", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.9"}], 
               "}"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Training", " ", "time", " ", "versus", " ", "GoldStandard"}],
         ";", " ", 
        RowBox[{"prediction", " ", 
         RowBox[{"errors", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"trainingQs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"qfn", "[", 
              RowBox[{"\"\<Training\>\"", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{"errs", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"$SubjectDatasets", "[", "#Subject", "]"}]}], "<", 
                  "9"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SubjectDatasetCoverage", "[", 
                RowBox[{"#Subject", ",", "#Dataset"}], "]"}], "&"}]}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"predictedQs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"qfn", "[", 
              RowBox[{"\"\<Predicted\>\"", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{"errs", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"$SubjectDatasets", "[", "#Subject", "]"}]}], "<", 
                  "9"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SubjectDatasetCoverage", "[", 
                RowBox[{"#Subject", ",", "#Dataset"}], "]"}], "&"}]}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"anatomicalQs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"qfn", "[", 
              RowBox[{"\"\<Anatomical\>\"", ",", "#"}], "]"}], "&"}], "@", 
            RowBox[{"Select", "[", "\[IndentingNewLine]", 
             RowBox[{"errs", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"$SubjectDatasets", "[", "#Subject", "]"}]}], "<", 
                 "9"}], "&&", 
                RowBox[{"#Dataset", "\[Equal]", "1"}]}], "&"}]}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"mark", "=", 
           RowBox[{"Function", "@", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"clr", "=", "#1"}], ",", 
                RowBox[{"x", "=", "#2"}], ",", "\[IndentingNewLine]", 
                RowBox[{"min", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"q1", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"mu", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                RowBox[{"q3", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], ",", 
                RowBox[{"max", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"FaceForm", "@", 
                   RowBox[{"Lighter", "[", 
                    RowBox[{"clr", ",", "0.5"}], "]"}]}], ",", 
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Black"}], "}"}], "]"}], ",", 
                  RowBox[{"Rectangle", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "0.06"}], ",", "q1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "0.06"}], ",", "q3"}], "}"}]}], "]"}]}],
                  "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"clr", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "min"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "max"}], "}"}]}], "}"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Darker", "[", "clr", "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "mu"}], "}"}], ",", 
                    RowBox[{"0.06", "*", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "}"}]}], 
               "}"}]}], "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"trainMdls", "=", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "c1", ",", "c2"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Function\>\"", "]"}], "&"}], "@", 
                  RowBox[{"Quiet", "@", 
                   RowBox[{"NonlinearModelFit", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"5", "*", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "trainingQs", "]"}]}]}], ",", 
                    RowBox[{"trainingQs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "k"}], "]"}], "]"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"c1", "+", 
                    RowBox[{"c2", "/", 
                    RowBox[{"(", "x", ")"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c2", ",", "1"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "x"}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
                "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"predMdls", "=", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "c1", ",", "c2", ",", "c3"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Function\>\"", "]"}], "&"}], "@", 
                  RowBox[{"Quiet", "@", 
                   RowBox[{"NonlinearModelFit", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"5", "*", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "predictedQs", "]"}]}], "]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"predictedQs", ",", "anatomicalQs"}], "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "k"}], "]"}], "]"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"c1", "+", 
                    RowBox[{"c2", "/", 
                    RowBox[{"(", 
                    RowBox[{"x", "+", "c3"}], ")"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c2", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c3", ",", "1"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "x"}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
                "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"ar", "=", 
             RowBox[{
              RowBox[{"imsz", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "/", 
              RowBox[{"imsz", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"opts", "=", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FrameTicksStyle", "\[Rule]", 
                 RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AspectRatio", "\[Rule]", "ar"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Axes", "\[Rule]", "None"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.85"}], ",", "3.3"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.1"}], ",", "2.6"}], "}"}]}], "}"}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"imsz", "*", "72"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Epilog", "\[Rule]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Data Alone\>\"", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Helvetica Neue\>\""}], ",", 
                    
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Prior Alone\>\"", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Helvetica Neue\>\""}], ",", 
                    
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Cyan", "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "0.94"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Data + Prior\>\"", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Helvetica Neue\>\""}], ",", 
                    
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "0.88"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}]}], 
                  "}"}]}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"{", 
                RowBox[{"#2", ",", "#1", ",", "#2"}], "}"}], "]"}], "&"}], 
             "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Plot", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"trainMdls", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"trainMdls", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"trainMdls", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"predMdls", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"predMdls", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"predMdls", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0", ",", "3.5"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Gray"}], "}"}], ",", 
                   "Black", ",", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Gray"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Pink"}], "}"}], ",", 
                   "Red", ",", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Pink"}], "}"}]}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Filling", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "3", "}"}]}], ",", 
                   RowBox[{"4", "\[Rule]", 
                    RowBox[{"{", "6", "}"}]}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FillingStyle", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "LightGray", "}"}]}], ",", 
                   RowBox[{"4", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Lighter", "[", "Pink", "]"}], "}"}]}]}], "}"}]}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Sequence", "@@", "opts"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Join", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"mark", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"q", "-", "0.1"}], ",", 
                    RowBox[{"trainingQs", "[", 
                    RowBox[{"[", "q", "]"}], "]"}], ",", "ar"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "1", ",", 
                    RowBox[{"Length", "[", "trainingQs", "]"}]}], "}"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"mark", "[", 
                    RowBox[{"Red", ",", 
                    RowBox[{"q", "+", "0.1"}], ",", 
                    RowBox[{"predictedQs", "[", 
                    RowBox[{"[", "q", "]"}], "]"}], ",", "ar"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "1", ",", 
                    RowBox[{"Length", "[", "predictedQs", "]"}]}], "}"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"mark", "[", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Cyan", "]"}], ",", "0", ",", 
                    "anatomicalQs", ",", "ar"}], "]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.35"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0.35"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DataRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "15"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "AxisLabel", "\[Rule]", "\"\<Scan Time [minutes]\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"AxisLabelSpacing", "\[Rule]", "2.5"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TickLengths", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.08", ",", "0.04"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TickSide", "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Ticks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "5", ",", "10", ",", "15"}], "}"}], ",",
                     "4"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.2"}], ",", "0.5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.2"}], ",", "2.5"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "AxisLabel", "\[Rule]", "\"\<Error [pRF radii]\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TickSide", "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"TickLengths", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.08", ",", "0.04"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Ticks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0.5", ",", "1.0", ",", "1.5", ",", "2.0", ",", "2.5"}], 
                    "}"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"LabelFunction", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "&"}], ")"}]}]}],
                     "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",Express\
ionUUID->"3ee979b8-a4f5-463a-ad43-3de4da64f074"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "FigErrorInset", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FigErrorInset", "]"}], "=", 
   RowBox[{"Options", "[", "ErrorSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FigErrorInset", "[", 
     RowBox[{"fopts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"prange", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.75"}], ",", "3.75"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.75"}], ",", "3.75"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"modality", "=", "\"\<AnglePerPRFRadius\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"errs", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"ErrorSummaries", "[", "]"}], ",", "fopts"}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"dd", "=", "0.6"}], ",", "\[IndentingNewLine]", 
        RowBox[{"hbound", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"List", "[", "\[IndentingNewLine]", 
           RowBox[{"Thin", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{"#2", ",", 
                    RowBox[{"-", "0.2"}]}], "}"}]}], ",", 
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{"#2", ",", "0.2"}], "}"}]}]}], "}"}], "]"}], ","}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#1", "-", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", "0"}], "}"}]}], ",", 
               RowBox[{"#1", "+", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", "0"}], "}"}]}]}], "}"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{"#2", ",", 
                   RowBox[{"-", "0.2"}]}], "}"}]}], ",", 
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{"#2", ",", "0.2"}], "}"}]}]}], "}"}], "]"}]}], 
            "*)"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"vbound", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"List", "[", "\[IndentingNewLine]", 
           RowBox[{"Thin", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.2"}], ",", "#2"}], "}"}]}], ",", 
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{"0.2", ",", "#2"}], "}"}]}]}], "}"}], "]"}], ","}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#1", "-", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "#2"}], "}"}]}], ",", 
               RowBox[{"#1", "+", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "#2"}], "}"}]}]}], "}"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.2"}], ",", "#2"}], "}"}]}], ",", 
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{"0.2", ",", "#2"}], "}"}]}]}], "}"}], "]"}]}], 
            "*)"}], "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ar", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"prange", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"prange", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"prange", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"prange", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"dmd", "=", 
           RowBox[{"Function", "@", 
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0.09", ",", "0"}], "}"}]}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.09"}], "}"}]}]}], ",", 
               RowBox[{"#", "-", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0.09", ",", "0"}], "}"}]}]}], ",", 
               RowBox[{"#", "-", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.09"}], "}"}]}]}]}], "}"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"tri", "=", 
           RowBox[{"Function", "@", 
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.1"}], "}"}]}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0.08", ",", 
                   RowBox[{"-", "0.05"}]}], "}"}]}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.08"}], ",", 
                   RowBox[{"-", "0.05"}]}], "}"}]}]}]}], "}"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"dsk", "=", 
           RowBox[{"Function", "@", 
            RowBox[{"Disk", "[", 
             RowBox[{"#", ",", 
              RowBox[{"dd", "*", "0.07"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"wdg", "=", 
           RowBox[{"Function", "@", 
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "0.1"}]}], "}"}]}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0.08", ",", "0.05"}], "}"}]}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.08"}], ",", "0.05"}], "}"}]}]}]}], "}"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"lft", "=", 
           RowBox[{"Function", "@", 
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.1"}], ",", "0"}], "}"}]}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0.05", ",", "0.08"}], "}"}]}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"dd", "*", 
                 RowBox[{"{", 
                  RowBox[{"0.05", ",", 
                   RowBox[{"-", "0.08"}]}], "}"}]}]}]}], "}"}], "]"}]}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"opts", "=", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"8", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica Neue\>\""}],
                   ",", 
                  RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                  RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FrameStyle", "\[Rule]", 
                RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FrameTicksStyle", "\[Rule]", 
                RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Axes", "\[Rule]", "None"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Frame", "\[Rule]", "False"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AspectRatio", "\[Rule]", "ar"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "prange"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Prolog", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Dashed", ",", "Gray", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Epilog", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Prior Alone\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.33", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Data + Prior\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Red"}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.33", ",", "0.93"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}]}], "}"}]}],
                  ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"1.4", "*", "72"}]}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"bySub", "=", 
             RowBox[{"Transpose", "/@", 
              RowBox[{"Map", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"List", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<Training\>\"", "]"}], "[", 
                    "modality", "]"}], "[", "\"\<Mean\>\"", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<Predicted\>\"", "]"}], "[", 
                    "modality", "]"}], "[", "\"\<Mean\>\"", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<Anatomical\>\"", "]"}], "[", 
                    "modality", "]"}], "[", "\"\<Mean\>\"", "]"}]}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"GatherBy", "[", 
                 RowBox[{"errs", ",", 
                  RowBox[{"#Subject", "&"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", "2", "}"}]}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"subShapes", "=", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                  RowBox[{"dmd", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                  RowBox[{"tri", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                  RowBox[{"wdg", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                  RowBox[{"dsk", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                  RowBox[{"lft", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                  RowBox[{"dmd", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                  RowBox[{"tri", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                  RowBox[{"wdg", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                  RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                  RowBox[{"dsk", "[", "#2", "]"}]}], "}"}], "&"}]}], 
              "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Map", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"mu", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sd", "=", 
                    RowBox[{"StandardDeviation", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}]}], "}"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
                    RowBox[{"hbound", "[", 
                    RowBox[{"mu", ",", 
                    RowBox[{"sd", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"bySub", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"mu", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"#1", "[", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Cyan", "]"}], ",", "mu"}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"subShapes", ",", 
                  RowBox[{"bySub", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Map", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"mu", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sd", "=", 
                    RowBox[{"StandardDeviation", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}]}], "}"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"Red", ",", "\[IndentingNewLine]", 
                    RowBox[{"hbound", "[", 
                    RowBox[{"mu", ",", 
                    RowBox[{"sd", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"vbound", "[", 
                    RowBox[{"mu", ",", 
                    RowBox[{"sd", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", "bySub"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"mu", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"#1", "[", 
                    RowBox[{"Red", ",", "mu"}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"subShapes", ",", "bySub"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0.4"}], "}"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                  "AxisLabel", "\[Rule]", "\"\<Meas.Err. [pRF radii]\>\""}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Ticks", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"TickLengths", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0.15", ",", "0.075"}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"LabelSpacing", "\[Rule]", "0.75"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"TickSide", "\[Rule]", 
                   RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AxisLabelSpacing", "\[Rule]", "2.25"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.4", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.4", ",", "3"}], "}"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                  "AxisLabel", "\[Rule]", "\"\<Pred.Err. [pRF radii]\>\""}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Ticks", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "1"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"TickLengths", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0.15", ",", "0.075"}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"LabelSpacing", "\[Rule]", "2"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"TickSide", "\[Rule]", 
                   RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AxisLabelSpacing", "\[Rule]", "1.5"}]}], "]"}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"c7990fff-7feb-4400-\
9538-48a52fae710b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "FigError", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FigError", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "FigErrorPanel", "]"}], ",", 
     RowBox[{"Options", "[", "FigErrorInset", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FigError", "[", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w", "=", 
         RowBox[{"3.25", "*", "72"}]}], ",", 
        RowBox[{"h", "=", 
         RowBox[{"2.6", "*", "72"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"f3a", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"FigErrorPanel", "[", "]"}], ",", "opts"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"f3b", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"FigErrorInset", "[", "]"}], ",", "opts"}], "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FaceForm", "@", 
             RowBox[{"Opacity", "[", 
              RowBox[{"0", ",", "White"}], "]"}]}], ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"w", ",", "h"}], "}"}], "/", "72"}]}], "]"}]}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Inset", "[", 
           RowBox[{"f3a", ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Inset", "[", 
           RowBox[{"f3b", ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"w", "/", "72"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "h"}], "}"}], "/", "72"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"w", ",", "h"}], "}"}]}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.707167124599882*^9, 3.7071672403339653`*^9}, {
  3.707167278916367*^9, 
  3.7071673843975563`*^9}},ExpressionUUID->"6e0d6df9-6d90-4905-a581-\
bc3bb9f776bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clipped Eccentricity Plots", "Subsection",
 CellChangeTimes->{{3.706471220491892*^9, 
  3.706471223613875*^9}},ExpressionUUID->"5d0f7a48-a474-4bdf-8906-\
8608887f6ada"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "ClippedEccenData", ",", "ClippedEccenStats", ",", "ClippedEccenPlot", ",",
     "$ClippedEccenColors"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ClippedEccenColors", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"3", "\[Rule]", 
      RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
     RowBox[{"6", "\[Rule]", "Red"}], ",", 
     RowBox[{"12", "\[Rule]", "Black"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ClippedEccenData", "[", 
      RowBox[{
       RowBox[{"clip", ":", 
        RowBox[{"3", "|", "6", "|", "12"}]}], ",", 
       RowBox[{"mdl_String:", "\"\<Benson17\>\""}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<clipped-eccen-data_clip=\>\"", "<>", 
        RowBox[{"ToString", "[", "clip", "]"}], "<>", "\"\<_model=\>\"", "<>", 
        RowBox[{"ToLowerCase", "[", "mdl", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"maxecc", "=", "14"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Join", ",", "#"}], "]"}], "&"}], "@", 
          RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"map", "=", 
                 RowBox[{"SubjectMap", "[", 
                  RowBox[{"sub", ",", "hemi", ",", "ds", ",", 
                   RowBox[{"RetinotopyModel", "\[Rule]", "mdl"}], ",", 
                   RowBox[{"Clip", "\[Rule]", "clip"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"gs", "=", 
                 RowBox[{"SubjectMap", "[", 
                  RowBox[{"sub", ",", "hemi", ",", "ds", ",", 
                   RowBox[{"RetinotopyModel", "\[Rule]", "mdl"}], ",", 
                   RowBox[{"Clip", "\[Rule]", "12"}]}], "]"}]}]}], "}"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"gsvexpl", "=", 
                   RowBox[{"\"\<VarianceExplained\>\"", "/.", "gs"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"gseccen", "=", 
                   RowBox[{"\"\<Eccentricity\>\"", "/.", "gs"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"gpeccen", "=", 
                   RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "gs"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"gpvarea", "=", 
                   RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "gs"}]}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"preccen", "=", 
                   RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "map"}]}]}],
                  "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"idcs", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"gpeccen", "-", "maxecc"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", "gpvarea", "]"}], ",", 
                    RowBox[{"1", "|", "2", "|", "3"}]}], "]"}]}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"gseccen", ",", "preccen", ",", "gsvexpl"}], 
                    "}"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "idcs"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"hemi", ",", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ds", ",", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
                  RowBox[{"#", ">", "0"}]}], "&"}]}], "]"}]}], "}"}]}], 
           "]"}]}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClippedEccenStats", "[", 
      RowBox[{
       RowBox[{"clip", ":", 
        RowBox[{"3", "|", "6", "|", "12"}]}], ",", 
       RowBox[{"mdl_String:", "\"\<Benson17\>\""}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<clipped-eccen-stats_clip=\>\"", "<>", 
        RowBox[{"ToString", "[", "clip", "]"}], "<>", "\"\<_model=\>\"", "<>", 
        RowBox[{"ToLowerCase", "[", "mdl", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d", "=", 
            RowBox[{"Transpose", "@", 
             RowBox[{"ClippedEccenData", "[", 
              RowBox[{"clip", ",", "\"\<Schira\>\""}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"dx", "=", "1"}], ",", 
           RowBox[{"x0", "=", "0.5"}], ",", 
           RowBox[{"xx", "=", "12"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xbins", "=", 
             RowBox[{"N", "@", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"Log", "[", 
                 RowBox[{"2", ",", "x0"}], "]"}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"2", ",", "xx"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "xx"}], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "x0"}], "]"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"xx", "-", "x0"}], ")"}], "/", "dx"}], ")"}]}]}], 
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b", "=", 
                RowBox[{
                 RowBox[{"BinLists", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", "^", "xbins"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "12"}], "}"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100"}], "}"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1", ",", "1", ",", "All", ",", 
                   RowBox[{"2", ";;", "3"}]}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"x", "=", 
                RowBox[{"Mean", "/@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Most", "[", "xbins", "]"}], ",", 
                    RowBox[{"Rest", "[", "xbins", "]"}]}], "}"}], "]"}]}]}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mu", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "/", 
                    RowBox[{"Total", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", "b"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"n", "=", 
                  RowBox[{"Length", "/@", "b"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"var", "=", 
                   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "-", "#2"}], 
                    ")"}], "^", "2"}], ",", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "/", 
                    RowBox[{"Total", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "mu"}], "}"}]}], "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"<|", 
                  RowBox[{
                   RowBox[{"\"\<Bins\>\"", "\[Rule]", "xbins"}], ",", 
                   RowBox[{"\"\<Xs\>\"", "\[Rule]", "x"}], ",", 
                   RowBox[{"\"\<Means\>\"", "\[Rule]", "mu"}], ",", 
                   RowBox[{"\"\<Variances\>\"", "\[Rule]", "var"}]}], 
                  "|>"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClippedEccenPlot", "[", 
      RowBox[{
       RowBox[{"clip", ":", 
        RowBox[{"3", "|", "6", "|", "12"}]}], ",", 
       RowBox[{"mdl_String:", "\"\<Benson17\>\""}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", "=", 
          RowBox[{"ClippedEccenStats", "[", 
           RowBox[{"clip", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"dx", "=", "1"}], ",", 
         RowBox[{"x0", "=", "0.5"}], ",", 
         RowBox[{"xx", "=", "12"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xbins", "=", 
            RowBox[{"d", "[", "\"\<Bins\>\"", "]"}]}], ",", 
           RowBox[{"mu", "=", 
            RowBox[{"d", "[", "\"\<Means\>\"", "]"}]}], ",", 
           RowBox[{"var", "=", 
            RowBox[{"d", "[", "\"\<Variances\>\"", "]"}]}], ",", 
           RowBox[{"x", "=", 
            RowBox[{"d", "[", "\"\<Xs\>\"", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ErrorListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}], ",", 
                RowBox[{"ErrorBar", "[", "#3", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "+", 
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"clip", "\[Equal]", "12"}], ",", "0.1", ",", 
                  RowBox[{"clip", "\[Equal]", "6"}], ",", "0", ",", 
                  RowBox[{"clip", "\[Equal]", "3"}], ",", 
                  RowBox[{"-", "0.1"}]}], "]"}]}], ",", "\[IndentingNewLine]",
                "mu", ",", 
               RowBox[{"Sqrt", "[", "var", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MinMax", "[", "xbins", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "xx"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", 
               RowBox[{"$ClippedEccenColors", "[", "clip", "]"}]}], "}"}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7064729340689383`*^9, 3.706472964806498*^9}, {
   3.7065105192479267`*^9, 3.706510627257657*^9}, {3.706513165088323*^9, 
   3.7065131684055777`*^9}, {3.7065143390941133`*^9, 3.706514491807968*^9}, 
   3.706516983383507*^9, {3.706520112440321*^9, 3.7065201132679577`*^9}, {
   3.706537420148151*^9, 
   3.7065374517882147`*^9}},ExpressionUUID->"e747ab69-0e9b-4bbf-87fe-\
aca29600c7c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ClippedEccenPanel", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClippedEccenPanel", "[", 
     RowBox[{"mdl_String:", "\"\<Schira\>\""}], "]"}], ":=", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", "Black", ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3.25", ",", "3.25"}], "}"}]}], "}"}], "]"}]}], "}"}],
           "]"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ClippedEccenPlot", "[", 
             RowBox[{"k", ",", "mdl"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "6", ",", "12"}], "}"}]}], "}"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], ",", 
              RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "/;", 
            RowBox[{"y", ">", "0"}]}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"2", ",", "y"}], "]"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Graphics", "@", 
           RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1.5"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{"-", "1.5"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"LabelFunction", "\[Rule]", 
              RowBox[{"Function", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"2", "^", "#"}], "<", "1"}], ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{"2", "^", "#"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"2", "^", "#"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "AxisLabel", "\[Rule]", "\"\<Validation Eccen. [deg]\>\""}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"AxisLabelSpacing", "\[Rule]", "2.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"TickSide", "\[Rule]", 
              RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"TickLengths", "\[Rule]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.05", ",", "0.025"}], "}"}], "/", "0.25"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Ticks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "2", ",", 
                  "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.322", ",", "0.585", ",", "0.807"}], "}"}]}], 
               "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "@", 
           RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1.25"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1.25"}], ",", "3"}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"LabelFunction", "\[Rule]", 
              RowBox[{"Function", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"2", "^", "#"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "AxisLabel", "\[Rule]", "\"\<Inferred Eccen. [deg]\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AxisLabelSpacing", "\[Rule]", "3.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"LabelSpacing", "\[Rule]", "0.75"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"TickSide", "\[Rule]", 
              RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"TickLengths", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0.05", ",", "0.025"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Ticks", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "2", ",", 
                  "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.322", ",", "0.585", ",", "0.807"}], "}"}]}], 
               "}"}]}]}], "]"}]}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Text", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Fit with \!\(\*
StyleBox[\"\[Rho]\",
FontSlant->\"Italic\"]\) \[LessEqual] 3\[Degree]\>\"", ",", 
             RowBox[{"FontColor", "\[Rule]", 
              RowBox[{"$ClippedEccenColors", "[", "3", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "3"}], "}"}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Fit with \!\(\*
StyleBox[\"\[Rho]\",
FontSlant->\"Italic\"]\) \[LessEqual] 6\[Degree]\>\"", ",", 
             RowBox[{"FontColor", "\[Rule]", 
              RowBox[{"$ClippedEccenColors", "[", "6", "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2.5"}], "}"}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Fit with \!\(\*
StyleBox[\"\[Rho]\",
FontSlant->\"Italic\"]\) \[LessEqual] 12\[Degree]\>\"", ",", 
             RowBox[{"FontColor", "\[Rule]", 
              RowBox[{"$ClippedEccenColors", "[", "12", "]"}]}]}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2"}], "}"}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}]}], "}"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.1"}], ",", "3.4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3.1"}], ",", "3.5"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"3.25", "*", "72"}]}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.707218179458889*^9, 
  3.707218211947914*^9}},ExpressionUUID->"f1cf6012-62df-4e69-b2d2-\
f4f347160cbe"]
}, Closed]],

Cell[CellGroupData[{

Cell["Messy Plot", "Subsection",ExpressionUUID->"8ebe2741-af2c-464e-8dbf-bdc0a687e383"],

Cell[CellGroupData[{

Cell["Messy Plot Disks and Visual Field", "Subsubsection",
 CellChangeTimes->{{3.7064781514220543`*^9, 3.706478156141756*^9}, {
  3.7065556218444033`*^9, 
  3.706555624109915*^9}},ExpressionUUID->"ca35ebb6-6cc8-4615-b9bb-\
72e6babbd549"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$MessPlotDisks", ",", "$MessPlotVisualField"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MessPlotDisks", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Red", ",", "Brown", ",", 
            RowBox[{"Darker", "@", "Green"}], ",", "Blue", ",", "Purple"}], 
           "}"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"t", "/", "225"}], "*", "5"}], "]"}]}], "]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"4", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"t", "*", 
                 RowBox[{"Pi", "/", "180"}]}]}], "]"}], ",", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"t", "*", 
                 RowBox[{"Pi", "/", "180"}]}]}], "]"}]}], "}"}]}], ",", 
           "1.25"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"-", "135"}], ",", "180", ",", "45"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MessPlotVisualField", "=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LightGray", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "12"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "12"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "12"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "12"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "12"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"12", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Values", "[", "$MessPlotDisks", "]"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.706477066059559*^9, 3.706477208263812*^9}, {
   3.706477243654866*^9, 3.706477318683165*^9}, {3.70647740625604*^9, 
   3.706477554035681*^9}, {3.706477599132386*^9, 3.706477635462922*^9}, 
   3.706477683059057*^9, {3.706477771210747*^9, 3.7064778302789793`*^9}, {
   3.706477880161648*^9, 3.7064780299044333`*^9}, {3.706478115210575*^9, 
   3.706478123760236*^9}, {3.706478157152293*^9, 3.706478169327128*^9}, {
   3.706543217274971*^9, 
   3.706543255669071*^9}},ExpressionUUID->"4bfa9bce-1dd5-42f2-897e-\
8bd337ddbeba"]
}, Closed]],

Cell[CellGroupData[{

Cell["Messy Plot V123 Figs", "Subsubsection",
 CellChangeTimes->{{3.706478291798492*^9, 3.706478295164578*^9}, {
  3.706555628677289*^9, 
  3.706555635926071*^9}},ExpressionUUID->"3e3e13b2-09d4-4aa6-9eae-\
e368839f5dd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$MessPlotSubSpec", ",", "MessPlotSubField"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MessPlotSubSpec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<S0903\>\"", ",", "LH", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<S0903\>\"", ",", "RH", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MessPlotSubField", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMap", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MessPlotSubField", "[", "\[IndentingNewLine]", 
     RowBox[{"sub_", ",", "hemi_", ",", "ds_", ",", 
      RowBox[{"type", ":", 
       RowBox[{"\"\<Predicted\>\"", "|", "\"\<Measured\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"hemi", "===", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MessPlotSubField", "[", 
         RowBox[{"sub", ",", "#", ",", "ds", ",", "type", ",", "opts"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"LH", ",", "RH"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectMesh", "[", 
             RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "ds"}], 
             "]"}], ",", "opts"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pa", "=", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<Predicted\>\""}], ",", 
                "\"\<PredictedPolarAngle\>\"", ",", "\"\<PolarAngle\>\""}], 
               "]"}], "/.", "m"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"ec", "=", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<Predicted\>\""}], ",", 
                "\"\<PredictedEccentricity\>\"", ",", 
                "\"\<Eccentricity\>\""}], "]"}], "/.", "m"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ws", "=", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<Predicted\>\""}], ",", 
                "\"\<PredictedVisualArea\>\"", ",", 
                "\"\<VarianceExplained\>\""}], "]"}], "/.", "m"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "=", 
               RowBox[{
                RowBox[{"Pi", "/", "180"}], "*", 
                RowBox[{"(", 
                 RowBox[{"90", "-", 
                  RowBox[{"Abs", "[", "pa", "]"}]}], ")"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"w", "=", 
               RowBox[{"Unitize", "[", 
                RowBox[{"1", "+", 
                 RowBox[{"Sign", "[", 
                  RowBox[{"ws", "-", "0.1"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vfcoords", "=", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ec", "*", 
                    RowBox[{"Cos", "[", "a", "]"}]}], ",", 
                   RowBox[{"ec", "*", 
                    RowBox[{"Sin", "[", "a", "]"}]}]}], "}"}], "]"}]}], "}"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"-", "45"}], "+", 
               RowBox[{"w", "*", 
                RowBox[{"Total", "@", 
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"45", "+", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "@", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"RegionDistance", "[", 
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "vfcoords"}], 
                    "]"}], "]"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", 
                    RowBox[{"Normal", "[", "$MessPlotDisks", "]"}]}], "}"}]}],
                   "]"}]}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
    "]"}], ";"}]}], "Input",ExpressionUUID->"949cc270-4601-4a4a-8751-\
75dd979e9e32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "MessPlotProjPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MessPlotProjPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigContourPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MessPlotProjPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spec", ":", 
       RowBox[{"{", 
        RowBox[{"sub_", ",", "hemi_", ",", "ds_"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"type", ":", 
       RowBox[{"\"\<Measured\>\"", "|", "\"\<Predicted\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], "\[Equal]", 
            "\"\<Schira\>\""}], ",", "\[IndentingNewLine]", "SchiraMeshPlot", 
           ",", "\[IndentingNewLine]", "V123FigMeshPlot"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"field", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"MessPlotSubField", "[", 
            RowBox[{"sub", ",", "hemi", ",", "ds", ",", "type"}], "]"}], ",", 
           "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tx", "=", 
         RowBox[{"Association", "@", "Thread"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fig", "=", 
           RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"f", "[", "\[IndentingNewLine]", 
              RowBox[{"spec", ",", 
               RowBox[{"field", "+", "45"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Threshold", "\[Rule]", 
                RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"MaxPlotPoints", "\[Rule]", "5000"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Range", "\[Rule]", "12"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ColorFunction", "\[Rule]", 
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"k", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "45"}], ")"}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"k", "\[GreaterEqual]", "0"}], "&&", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"$MessPlotDisks", ",", "k"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MessPlotDisks", "[", "k", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "LightGray"}], "]"}]}], 
                  "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "opts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"lines", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "@", 
              RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"V123FigLines", "[", 
                 RowBox[{"12", ",", 
                  RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"h", "===", "LH"}], ",", 
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x_", "?", "NumericQ"}], ",", 
                    RowBox[{"y_", "?", "NumericQ"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"h", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", 
             RowBox[{"fig", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fig", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"lines", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", 
             RowBox[{"fig", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fig", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"lines", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
         "}"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.706538861957098*^9, 3.7065388631943007`*^9}, {
   3.706539556861681*^9, 3.706539597714326*^9}, {3.706539786229734*^9, 
   3.706539786475472*^9}, {3.7065399342101583`*^9, 3.7065399544649067`*^9}, {
   3.7065403013686047`*^9, 3.7065403015278263`*^9}, {3.706540815711385*^9, 
   3.70654086177131*^9}, {3.706540972186256*^9, 3.706540978147694*^9}, {
   3.7065410384395103`*^9, 3.706541060432362*^9}, {3.706541148413866*^9, 
   3.706541149595764*^9}, {3.706541227743862*^9, 3.7065412342377567`*^9}, 
   3.706542802532201*^9, {3.706542844311487*^9, 3.706542918347289*^9}, {
   3.7065430504783688`*^9, 3.706543052300242*^9}, {3.706543125715054*^9, 
   3.706543171244233*^9}, {3.7065444117460327`*^9, 3.70654441646065*^9}, {
   3.7065446258596992`*^9, 3.706544626241325*^9}, {3.706544901179035*^9, 
   3.706544901544943*^9}, {3.706545038661128*^9, 3.70654503968365*^9}, {
   3.706545541082662*^9, 3.706545543744033*^9}, {3.706547634565001*^9, 
   3.706547654797299*^9}, {3.706547875132347*^9, 3.706547881980082*^9}, {
   3.706548089207057*^9, 3.706548150036092*^9}, {3.7065482651091757`*^9, 
   3.70654847280897*^9}, {3.706548538447146*^9, 3.7065485447915487`*^9}, {
   3.706548590871887*^9, 3.706548618918969*^9}, {3.706548662112732*^9, 
   3.706548670857415*^9}},ExpressionUUID->"4255fd0e-ee28-4f16-984e-\
d3b509f82ed7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Messy Plot Panel", "Subsubsection",
 CellChangeTimes->{{3.706555640116941*^9, 
  3.706555646574168*^9}},ExpressionUUID->"76a161a7-ca6b-4282-98a2-\
fa90c7a0e5d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$MessPlot", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
  RowBox[{"$MessPlot", ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v123figs", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"MessPlotProjPlot", "[", "\[IndentingNewLine]", 
             RowBox[{"spec", ",", "type", ",", "\[IndentingNewLine]", 
              RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"type", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Measured\>\"", ",", "\"\<Predicted\>\""}], "}"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"spec", ",", "$MessPlotSubSpec"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"field", "=", "$MessPlotVisualField"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FaceForm", "@", 
            RowBox[{"Opacity", "[", 
             RowBox[{"0", ",", "White"}], "]"}]}], ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Function", "@", 
            RowBox[{"Inset", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"{", 
               RowBox[{"#2", ",", "1"}], "}"}], ",", 
              RowBox[{"ImageScaled", "[", 
               RowBox[{"{", 
                RowBox[{"#3", ",", "1"}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.2125", ",", "0.85"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Transpose", "@", 
            RowBox[{"List", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123figs", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0", ",", "0"}],
                "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123figs", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "0.375", ",", 
                "1"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123figs", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "0.625", ",", 
                "0"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123figs", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "1", ",", "1"}],
                "}"}]}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Inset", "[", 
          RowBox[{"field", ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", "1"}], "}"}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.2125", ",", "0.85"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", "\[IndentingNewLine]", 
          RowBox[{"\"\<Gold-Standard Data\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0.1875", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", "\[IndentingNewLine]", 
          RowBox[{"\"\<Prediction\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", "0.1875"}], ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.706481997434497*^9, 3.706482030972898*^9}, {
   3.706482800097569*^9, 3.7064828027057343`*^9}, {3.706483501286374*^9, 
   3.706483520851143*^9}, {3.706483821901482*^9, 3.706483831480245*^9}, 
   3.70654722560184*^9, {3.706547272518309*^9, 3.7065472812588797`*^9}, {
   3.706547434247101*^9, 3.7065474381421957`*^9}, {3.706552761012158*^9, 
   3.706552762354397*^9}, {3.706552795233692*^9, 3.706552833382702*^9}, {
   3.706552885140172*^9, 3.70655291229771*^9}, {3.706553050505911*^9, 
   3.7065530520010777`*^9}, {3.706553132451227*^9, 3.7065531327289877`*^9}, {
   3.7065533283597*^9, 3.706553342269566*^9}, {3.706553383399466*^9, 
   3.706553386460112*^9}, {3.706553420476519*^9, 3.706553612602191*^9}, 
   3.706554546270874*^9, {3.706554581251376*^9, 3.7065546862192*^9}, {
   3.70655471990177*^9, 3.7065547483587523`*^9}, {3.7065548273275146`*^9, 
   3.706554866832921*^9}, {3.706554902643744*^9, 3.7065549441920223`*^9}, {
   3.70655498528261*^9, 3.706555011209037*^9}, {3.7065550519071093`*^9, 
   3.7065550552372828`*^9}, {3.706555093475647*^9, 3.706555097723275*^9}, {
   3.706555134601448*^9, 3.706555213603652*^9}, {3.70655529082553*^9, 
   3.706555307494069*^9}, {3.706555339915539*^9, 3.7065553453303337`*^9}, {
   3.7065554698449717`*^9, 3.7065555296347523`*^9}, {3.706555585289179*^9, 
   3.706555609549341*^9}},ExpressionUUID->"9cbfc249-9a73-4185-9b5e-\
985cd54b4baa"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["The Canvas and Figure", "Subsection",
 CellChangeTimes->{{3.706471271910459*^9, 3.7064712741559877`*^9}, {
  3.706537516763979*^9, 
  3.706537518754562*^9}},ExpressionUUID->"705b3f67-7468-4509-915b-\
dc4bffd56831"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$ErrorCanvas", "=", 
    RowBox[{"Canvas", "[", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"3.25", ",", "6.225"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Panel", " ", 
    RowBox[{"A", ":", " ", "Comparison"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
   RowBox[{"$ErrorCanvas", ",", "\[IndentingNewLine]", 
    RowBox[{"FigError", "[", 
     RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$CanvasCenter", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"$CanvasTop", "-", "0.2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
    RowBox[{"$ErrorCanvas", ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<A. Summary of Errors\>\"", ",", 
       RowBox[{"FontWeight", "\[Rule]", "\"\<Normal\>\""}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageScaled", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageScaled", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Panel", " ", 
    RowBox[{"B", ":", " ", 
     RowBox[{"Clipped", " ", "Eccentricity"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
   RowBox[{"$ErrorCanvas", ",", "\[IndentingNewLine]", 
    RowBox[{"ClippedEccenPanel", "[", "\"\<Schira\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$CanvasCenter", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"$CanvasBottom", "+", "1.2"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3.25", ",", "Automatic"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
    RowBox[{"$ErrorCanvas", ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<B. Eccentricity Prediction Accuracy\>\"", ",", 
       RowBox[{"FontWeight", "\[Rule]", "\"\<Normal\>\""}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageScaled", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.525"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"ImageScaled", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Panel", " ", 
    RowBox[{"C", ":", " ", "Mess"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
   RowBox[{
   "$ErrorCanvas", ",", "\[IndentingNewLine]", "$MessPlot", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$CanvasCenter", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "$CanvasBottom"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3.25", ",", "0.975"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
   RowBox[{"$ErrorCanvas", ",", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<C. Projection from Visual Field to Cortex\>\"", ",", 
      RowBox[{"FontWeight", "\[Rule]", "\"\<Normal\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"$CanvasLeft", ",", 
      RowBox[{"$CanvasBottom", "+", "0.975"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}], ";"}]}], "Input",Express\
ionUUID->"966d2bc6-5bff-4ee8-b482-f0778d4fd973"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "[", "\"\<quantitative_error\>\"", "]"}], ":=", 
   RowBox[{"Graphics", "[", "$ErrorCanvas", "]"}]}], ";"}]], "Input",Expressio\
nUUID->"6c1114c9-20af-4e09-899e-617f0e717942"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cortical Magnification", "Section",ExpressionUUID->"46c1895b-0798-486f-b6c0-9b8ac02bd7ce"],

Cell[CellGroupData[{

Cell["Radial and Tangential Cortical Magnification (separately)", "Subsection",ExpressionUUID->"2bae5b80-c272-417a-8f24-990de61b2e47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$CMagFigureLines", ",", "$CMagFigureV123Figs", ",", "$CMagFigureFields"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$CMagFigureV123Figs", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llines", "=", 
          RowBox[{
           RowBox[{"Graphics", "@*", "Join"}], "@@", 
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"V123FigLines", "[", 
               RowBox[{"#", ",", 
                RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
               "]"}], "&"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"rlines", "=", 
          RowBox[{"Graphics", "@", 
           RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Join", "@@", 
              RowBox[{"Map", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"V123FigLines", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}],
                   "]"}], "&"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], "]"}]}]}]}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "llines"}], "}"}], 
              "]"}], ",", 
             RowBox[{"Show", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "rlines"}], "}"}], 
              "]"}]}], "}"}], "&"}], "@", 
          RowBox[{"V123FigDensityPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"All", ",", "All", ",", "0"}], "}"}], ",", 
            RowBox[{"\"\<MagnificationWhite\>\"", "<>", "type"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"type", "\[Equal]", "\"\<Areal\>\""}], ",", 
               "\"\<MagnificationSquared\>\"", ",", "\"\<Magnification\>\""}],
               "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Range", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "12"}], "}"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"type", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", 
             "\"\<Tangential\>\""}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$CMagFigureLines", ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"adat", "=", 
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Prepend", "[", 
                RowBox[{
                 RowBox[{"2", "*", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"Rest", "[", "#", "]"}], "/", "Pi"}], "]"}]}], 
                 ",", 
                 RowBox[{"First", "[", "#", "]"}]}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CMagSummary", "[", 
               RowBox[{"All", ",", "area", ",", "\"\<Areal\>\""}], "]"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"rdat", "=", 
            RowBox[{"CMagSummary", "[", 
             RowBox[{"All", ",", "area", ",", "\"\<Radial\>\""}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"tdat", "=", 
            RowBox[{"CMagSummary", "[", 
             RowBox[{"All", ",", "area", ",", "\"\<Tangential\>\""}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"dat", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
               
               RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "#"}], 
                    "}"}], "]"}], "&"}], "/@", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"2", ";;", "All"}]}], "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "11"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "30"}], "}"}]}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AspectRatio", "\[Rule]", 
                  RowBox[{"1", "/", "1.9"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c", ",", "Thin"}], "}"}], ",", 
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "Thin"}], "}"}]}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Filling", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "2", "}"}]}], ",", 
                    RowBox[{"3", "\[Rule]", 
                    RowBox[{"{", "2", "}"}]}]}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Axes", "\[Rule]", "None"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Frame", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"FrameTicksStyle", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"area", ">", "1"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
                    "Automatic"}], "]"}], ",", "None"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"FrameTicks", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4", ",", "16"}], "}"}], ",", "None"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "4", ",", "8"}], "}"}], ",", 
                    "None"}], "}"}]}], "}"}]}]}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"adat", ",", "rdat", ",", "tdat"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Red", ",", "Blue"}], "}"}]}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1.075", ",", "0.85"}], "}"}], "*", "72"}]}]}], "]"}]}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"area", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$CMagFigureFields", ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VisualFieldDensityPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"All", ",", "All", ",", "0"}], "}"}], ",", 
         RowBox[{"\"\<MagnificationWhite\>\"", "<>", "type"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"VisualArea", "\[Rule]", "area"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"type", "\[Equal]", "\"\<Areal\>\""}], ",", 
            "\"\<MagnificationSquared\>\"", ",", "\"\<Magnification\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Range", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"area", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"type", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", "\"\<Tangential\>\""}],
           "}"}]}], "}"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID\
->"71d74ded-c77b-4b20-bed0-f2a969744548"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$CMagFigureABC", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CMagFigureABC", ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v123Figs", "=", "$CMagFigureV123Figs"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"lineFigs", "=", "$CMagFigureLines"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fieldFigs", "=", "$CMagFigureFields"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"imsz", "=", 
         RowBox[{"{", 
          RowBox[{"3.25", ",", "4.6"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rows0", "=", 
            RowBox[{"{", 
             RowBox[{"0.97", ",", "0.78", ",", "0.39"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"r1dx", "=", "0.275"}], ",", 
           RowBox[{"r1x0", "=", "0.12"}], ",", "\[IndentingNewLine]", 
           RowBox[{"fsz", "=", 
            RowBox[{"0.8", "*", "72"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"fldtdy", "=", "0.11"}], ",", 
           RowBox[{"fldbdy", "=", 
            RowBox[{"0.1", "+", 
             RowBox[{"1", "/", 
              RowBox[{"imsz", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sty", "=", 
            RowBox[{"Function", "@", 
             RowBox[{"Style", "[", 
              RowBox[{"##", ",", 
               RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}]}]}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{"Row", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"lineFigs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"r1x0", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.05", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"lineFigs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"r1x0", "+", "r1dx"}], ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.05", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"lineFigs", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"r1x0", "+", 
                    RowBox[{"2", "*", "r1dx"}]}], ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.05", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"sty", "[", 
                  RowBox[{"\"\<C.Mag.\\n[mm/deg]\>\"", ",", 
                   RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                   RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Gray", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"sty", "[", 
                  RowBox[{"\"\<Eccentricity [deg]\>\"", ",", 
                   RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                   RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Gray", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.6", ",", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.145"}]}], "}"}], 
                  "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"sty", "[", 
                  RowBox[{"\"\<Radial\>\"", ",", 
                   RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.445", ",", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.04"}]}], "}"}], 
                  "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"sty", "[", 
                  RowBox[{"\"\<Tangential\>\"", ",", 
                   RowBox[{"FontColor", "\[Rule]", "Blue"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.445", ",", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.065"}]}], "}"}], 
                  "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Rows", " ", "2", " ", "and", " ", "3"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"List", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Inset", "[", 
                   RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"#3", "-", "fldtdy"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.67"}], "}"}], "]"}], ",", "fsz"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Inset", "[", 
                   RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"#3", "-", "fldbdy"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.33"}], "}"}], "]"}], ",", "fsz"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Inset", "[", 
                   RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"#3", "-", "fldbdy"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.33"}], "}"}], "]"}], ",", "fsz"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Inset", "[", 
                   RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#3"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"1", "*", "72"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Inset", "[", 
                   RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "#3"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"1", "*", "72"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"sty", "[", "#4", "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "#3"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "1.25"}], "}"}], "]"}]}], "]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v123Figs", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", "1", "}"}], "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Transpose", "[", "fieldFigs", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"{", "1", "}"}], "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"rows0", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", "\"\<Areal\>\"", "}"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"y1", "=", 
                  RowBox[{
                   RowBox[{"rows0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "fldtdy", "-", 
                   "0.075"}]}], ",", 
                 RowBox[{"y2", "=", 
                  RowBox[{
                   RowBox[{"rows0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "fldbdy", "-", 
                   "0.025"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V1\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.38", ",", "y1"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V2\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.26", ",", "y2"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V3\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.51", ",", "y2"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
                "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", "Labels", " ", "*)"}], "\[IndentingNewLine]", 
             
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "@", 
                  RowBox[{"Text", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
                    RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#2"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\""}],
                     "}"}], ",", 
                   RowBox[{"rows0", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.05", ",", "0.05"}], "}"}]}]}], 
                  "}"}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Add", " ", "a", " ", "legend", " ", "for", " ", 
               "magnification"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Inset", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"DensityPlot", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"2", "^", "y"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y", ",", "0", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "64"}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AspectRatio", "\[Rule]", "7"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"0.3", "*", "72"}]}], ",", "\[IndentingNewLine]", 
                   
                   RowBox[{"Frame", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\"\<1\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "\"\<4\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "\"\<16\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "\"\<64\>\""}], "}"}]}], "}"}], ",", 
                    "None"}], "}"}], ",", "None"}], "}"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0.275"}], "}"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<C.Mag.\\n[mm/deg]\>\"", ",", 
                   RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                   RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.805", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.15", ",", "1"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"imsz", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", "72"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"imsz", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", "72"}]}], "}"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"imsz", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",ExpressionUUID->"061e5e84-df78-4e27-925f-\
037a7466dc32"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cortical Magnification Ratio", "Subsection",ExpressionUUID->"1d8786b2-03e8-4da9-965c-12663bf086b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$CMagRatioFigureV123Figs", ",", "$CMagRatioFigureFields", ",", 
    "$CMagRatioFigureLegend", ",", "$CMagRatioFigure"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$CMagRatioFigureV123Figs", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llines", "=", 
          RowBox[{"Graphics", "@", 
           RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Join", "@@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"V123FigLines", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"RetinotopyModel", "\[Rule]", "\"\<V123\>\""}]}], 
                  "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "4", ",", "8", ",", "15"}], "}"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", "White"}], "]"}]}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"rlines", "=", 
          RowBox[{"Graphics", "@", 
           RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "@@", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"V123FigLines", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"RetinotopyModel", "\[Rule]", "\"\<V123\>\""}]}], 
                   "]"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "4", ",", "8", ",", "15"}], "}"}]}], 
                "]"}]}], "/.", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[RuleDelayed]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], ",", 
             "\[IndentingNewLine]", "White"}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "llines"}], "}"}], "]"}], 
           ",", 
           RowBox[{"Show", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "rlines"}], "}"}], 
            "]"}]}], "}"}], "&"}], "@", 
        RowBox[{"V123FigDensityPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"All", ",", "All", ",", "0"}], "}"}], ",", 
          "\"\<MagRatioWhiteTangentialRadial\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", "\"\<MagRatioInv\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Contours", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.4", ",", "0.6", ",", "0.8", ",", "1.25", ",", 
               RowBox[{"1", "/", "0.6"}], ",", "2.5"}], "}"}]}], ","}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Range", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "15"}], "}"}]}]}], "]"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$CMagRatioFigureFields", ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VisualFieldDensityPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"All", ",", "All", ",", "0"}], "}"}], ",", 
         "\"\<MagRatioWhiteTangentialRadial\>\"", ",", "\[IndentingNewLine]", 
         
         RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"VisualArea", "\[Rule]", "area"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<MagRatioInv\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Contours", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "0.6", ",", "0.8", ",", "1.25", ",", 
              RowBox[{"1", "/", "0.6"}], ",", "2.5"}], "}"}]}], ","}], "*)"}],
          "\[IndentingNewLine]", 
         RowBox[{"Range", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"area", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$CMagRatioFigureLegend", ":=", 
     RowBox[{"ArrayPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"3", "^", 
           RowBox[{"{", 
            RowBox[{"k", ",", "k"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "0.005"}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"Function", "@", 
         RowBox[{"Blend", "[", 
          RowBox[{"$MagRatioBlendColors", ",", "#"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "7"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "10"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"1.1", "*", "72"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"False", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<R:T Mag. Ratio\>\"", ",", 
          RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "1", ",", "\"\<\!\(\*FractionBox[\(1\), \(3\)]\)\>\""}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{
               "2", ",", "\"\<\!\(\*FractionBox[\(1\), \(2\)]\)\>\""}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{
               "3", ",", "\"\<\!\(\*FractionBox[\(2\), \(3\)]\)\>\""}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "\"\<1\>\""}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "5", ",", "\"\<\!\(\*FractionBox[\(3\), \(2\)]\)\>\""}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{
               "6", ",", "\"\<\!\(\*FractionBox[\(2\), \(1\)]\)\>\""}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{
               "7", ",", "\"\<\!\(\*FractionBox[\(3\), \(1\)]\)\>\""}], 
               "}"}]}], "}"}], ",", "None"}], "}"}]}], "}"}]}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$CMagRatioFigure", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"imsz", "=", 
          RowBox[{"{", 
           RowBox[{"3.25", ",", "2.4"}], "}"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"fig", "=", 
          RowBox[{"ModelFieldRow", "[", 
           RowBox[{
           "$CMagRatioFigureV123Figs", ",", "$CMagRatioFigureFields"}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", 
              RowBox[{"0", ",", "White"}], "]"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "imsz"}], "]"}]}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"fig", ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"$CMagRatioFigureLegend", ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0"}], "}"}], "]"}]}], "]"}]}], "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"imsz", "*", "72"}]}]}], "]"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"75553961-4b02-4686-ac40-73500035f411"]
}, Closed]],

Cell[CellGroupData[{

Cell["Combined Figure", "Subsection",ExpressionUUID->"3057e9d4-9583-4ec5-b7a3-dc75ef48d1b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "[", "\"\<cortical_magnification\>\"", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imsz", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3.25", ",", "7"}], "}"}], "*", "72"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Opacity", "[", 
            RowBox[{"0", ",", "White"}], "]"}], ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "imsz"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Inset", "[", 
          RowBox[{"$CMagFigureABC", ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Inset", "[", 
          RowBox[{"$CMagRatioFigure", ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "imsz"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"24e03818-d4ac-48df-b458-72ee00bfb738"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Errors for Areas Beyond V1-V3", "Section",ExpressionUUID->"d4ffc394-d204-43b4-8cba-b0d7ec96934c"],

Cell[CellGroupData[{

Cell["The Plots that make up the figure", "Subsection",
 CellChangeTimes->{{3.7065225765852537`*^9, 
  3.706522583952096*^9}},ExpressionUUID->"d7007824-6dec-4efa-9f33-\
662de7a0ef5c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$AllAreasErrorScatterPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$AllAreasErrorScatterPlot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"errorMetric", "=", "\"\<AnglePerPRFRadius\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"esd", "=", 
         RowBox[{"ErrorSummaryDataset", "[", "\"\<Benson17\>\"", "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gb", "=", 
           RowBox[{"GroupBy", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"Association", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<ID\>\"", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"#Subject", ",", "#VisualArea"}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<Dataset\>\"", "\[Rule]", "#Dataset"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<MeasurementError\>\"", "\[Rule]", 
                   RowBox[{
                    RowBox[{"#MeasurementError", "[", "errorMetric", "]"}], 
                    "[", "\"\<Mean\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"\"\<PredictionError\>\"", "\[Rule]", 
                   RowBox[{
                    RowBox[{"#PredictionError", "[", "errorMetric", "]"}], 
                    "[", "\"\<Mean\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"\"\<Benson14Error\>\"", "\[Rule]", 
                   RowBox[{
                    RowBox[{"#Benson14Error", "[", "errorMetric", "]"}], "[", 
                    "\"\<Mean\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<Error\>\"", "\[Rule]", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"k", "<>", "\"\<Error\>\""}], "]"}], "[", 
                    "errorMetric", "]"}], "[", "\"\<Mean\>\"", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Measurement\>\"", ",", "\"\<Prediction\>\"", ",", 
                    "\"\<Benson14\>\""}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Normal", "[", "esd", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"#ID", "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"clrs", "=", 
           RowBox[{"{", 
            RowBox[{"Black", ",", "Red", ",", "Blue", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", "Gray", ",", 
             RowBox[{"Darker", "[", "Magenta", "]"}], ",", 
             RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
             RowBox[{"Darker", "[", "Yellow", "]"}], ",", "Brown"}], 
            "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ids", "=", 
             RowBox[{"Keys", "[", "gb", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"cmap", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Association", "@", 
                RowBox[{"Thread", "[", 
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"clrs", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}]}], 
                 "]"}]}], "&"}], "@", 
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "gb", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"sumdat", "=", 
             RowBox[{"Association", "@", 
              RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"q", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#MeasurementError", ",", "#PredictionError"}], 
                    "}"}], "&"}], "/@", "#2"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"#1", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", "q", "]"}], ",", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Variance", "[", "q", "]"}], "/", 
                    RowBox[{"Length", "[", "q", "]"}]}], "]"}]}], "}"}]}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", "gb"}], "]"}]}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"nms", "=", 
             RowBox[{
             "$Benson17Model", "[", "\"\<VisualAreaNames\>\"", "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sumdat", "[", "id", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"id", ",", "ids"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"cmap", "[", 
                 RowBox[{"id", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"id", ",", "ids"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotMarkers", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"$SubjectSymbols", "[", 
                RowBox[{"id", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"id", ",", "ids"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "4"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "4"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Pred. Error [pRF Radii]\>\"", ",", "None"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Meas. Error [pRF Radii]\>\"", ",", "None"}], 
                "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Prolog", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Black", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3.5", ",", "3.5"}], "}"}]}], "}"}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"nms", "[", "id", "]"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"cmap", "[", "id", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.5", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"id", "-", "1"}], ",", "4"}], "]"}], "-", "1.5"}],
                     ")"}], "*", "0.1"}]}], ",", 
                    RowBox[{"0.9", "-", 
                    RowBox[{"0.05", "*", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"id", "-", "1"}], ")"}], "/", "4"}], "]"}]}]}]}], 
                    "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"id", ",", 
                   RowBox[{"ids", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.706448785284422*^9, 3.706448815909066*^9}, {
   3.706448987316283*^9, 3.706449030688423*^9}, {3.7064491902476673`*^9, 
   3.706449209031261*^9}, {3.706449376935062*^9, 3.7064494737622547`*^9}, 
   3.706449535754786*^9, {3.706449617686923*^9, 3.7064497175485897`*^9}, {
   3.70644985837542*^9, 3.706449865487053*^9}, {3.7064499058430767`*^9, 
   3.706449912690982*^9}, {3.7064499484052563`*^9, 3.706449953045617*^9}, {
   3.706450182396248*^9, 3.706450368665954*^9}, {3.706450455254594*^9, 
   3.70645057319289*^9}, {3.706450603288068*^9, 3.706450923038988*^9}, {
   3.706450971132567*^9, 3.706450983500348*^9}, {3.706451367016388*^9, 
   3.706451384758456*^9}, {3.706451791032362*^9, 3.7064518014571457`*^9}, {
   3.7064528543602123`*^9, 3.7064528545906553`*^9}, {3.7065083331127367`*^9, 
   3.706508398455455*^9}, {3.706508475673976*^9, 3.706508491474102*^9}, {
   3.706509377309811*^9, 3.7065096143288927`*^9}, {3.706509650257061*^9, 
   3.706509787169454*^9}, {3.706509854438745*^9, 3.706510047674478*^9}, {
   3.706510088689979*^9, 3.70651011272112*^9}, {3.7065110415114813`*^9, 
   3.706511042047611*^9}, {3.706522550175126*^9, 3.706522572271942*^9}, {
   3.706522852573203*^9, 3.706522852829178*^9}, {3.7065248915265503`*^9, 
   3.706524915004198*^9}},ExpressionUUID->"a3f94e9f-0cb1-437f-b5e4-\
9b3ab4735cc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$AllAreasErrorPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$AllAreasErrorPlot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"errorMetric", "=", "\"\<AnglePerPRFRadius\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"esd", "=", 
         RowBox[{"ErrorSummaryDataset", "[", "\"\<Benson17\>\"", "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"ar", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gb", "=", 
           RowBox[{"GroupBy", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"Association", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<ID\>\"", "\[Rule]", 
                   RowBox[{"{", "#VisualArea", "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<Dataset\>\"", "\[Rule]", "#Dataset"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<MeasurementError\>\"", "\[Rule]", 
                   RowBox[{
                    RowBox[{"#MeasurementError", "[", "errorMetric", "]"}], 
                    "[", "\"\<Mean\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"\"\<PredictionError\>\"", "\[Rule]", 
                   RowBox[{
                    RowBox[{"#PredictionError", "[", "errorMetric", "]"}], 
                    "[", "\"\<Mean\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                  
                  RowBox[{"\"\<Benson14Error\>\"", "\[Rule]", 
                   RowBox[{
                    RowBox[{"#Benson14Error", "[", "errorMetric", "]"}], "[", 
                    "\"\<Mean\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<Error\>\"", "\[Rule]", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"k", "<>", "\"\<Error\>\""}], "]"}], "[", 
                    "errorMetric", "]"}], "[", "\"\<Mean\>\"", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Measurement\>\"", ",", "\"\<Prediction\>\"", ",", 
                    "\"\<Benson14\>\""}], "}"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Normal", "[", "esd", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"#ID", "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"clrs", "=", 
           RowBox[{"{", 
            RowBox[{"Black", ",", "Red", ",", "Blue", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", "Gray", ",", 
             RowBox[{"Darker", "[", "Magenta", "]"}], ",", 
             RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
             RowBox[{"Darker", "[", "Yellow", "]"}], ",", "Brown"}], 
            "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ids", "=", 
             RowBox[{"Keys", "[", "gb", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"cmap", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Association", "@", 
                RowBox[{"Thread", "[", 
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"clrs", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}]}], 
                 "]"}]}], "&"}], "@", 
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "gb", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"sumdat", "=", 
             RowBox[{"Association", "@", 
              RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"q", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#MeasurementError", "/", "#PredictionError"}], 
                    ")"}], "&"}], "/@", "#2"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"#1", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", "q", "]"}], ",", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"Variance", "[", "q", "]"}], "]"}]}], "}"}]}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", "gb"}], "]"}]}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"bsumdat", "=", 
             RowBox[{"Association", "@", 
              RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"q", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#MeasurementError", "/", "#Benson14Error"}], 
                    ")"}], "&"}], "/@", "#2"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"#1", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", "q", "]"}], ",", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"Variance", "[", "q", "]"}], "]"}]}], "}"}]}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", "gb"}], "]"}]}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"nms", "=", 
             RowBox[{
             "$Benson17Model", "[", "\"\<VisualAreaNames\>\"", "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"dat", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"SortBy", "[", 
                  RowBox[{"#", ",", "First"}], "]"}], "&"}], "@", 
                RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Function", "@", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"y", "=", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"e", "=", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "y"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"y", "-", "e"}], ",", 
                    RowBox[{"y", "+", "e"}]}], "}"}]}]}], "}"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", "sumdat"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"bdat", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"SortBy", "[", 
                  RowBox[{"#", ",", "First"}], "]"}], "&"}], "@", 
                RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Function", "@", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"y", "=", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"e", "=", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "y"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"y", "-", "e"}], ",", 
                    RowBox[{"y", "+", "e"}]}], "}"}]}]}], "}"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", "bsumdat"}], "]"}]}]}]}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "Red", "}"}], ",", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.1"}], ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"0.1", "*", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "ar"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.1"}], ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.1"}], ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "dat"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Darker", "[", "Cyan", "]"}], "}"}], ",", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "0.1"}], ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"0.1", "*", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "ar"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "0.1"}], ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "0.1"}], ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", "bdat"}], "}"}]}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
              RowBox[{"AxesOrigin", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0.8", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Epilog", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<Data + Prior\>\"", ",", 
                    RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<Prior Alone\>\"", ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Cyan", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.9"}], "}"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Higher \>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[CurlyEpsilon]", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<meas\>\"", ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}]}], "]"}]}], 
                    "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"3.75", ",", "1.25"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Higher \>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[CurlyEpsilon]", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<pred\>\"", ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}]}], "]"}]}], 
                    "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"2.25", ",", 
                    RowBox[{"-", "1.25"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nms", "[", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "+", "0.1"}], 
                    ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"d", ",", "dat"}], "}"}]}], "]"}]}], "}"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "9"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "\[Rule]", "ar"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"True", ",", "False"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"TraditionalForm", "@", 
                    RowBox[{"Defer", "@", 
                    RowBox[{"Log", "[", "\[IndentingNewLine]", 
                    RowBox[{"2", ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[CurlyEpsilon]", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<meas\>\"", ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}]}], "]"}], 
                    ",", "\"\</\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[CurlyEpsilon]", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<pred\>\"", ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                   "None"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzHkow3EABfC1CFMrZRYLEZOjyFHT3Ik/WGwJK4vmWu5jQu7IH9SEH0mz
mtocRU2OJUQhuVOOlpT7ioaSa9j7/vH69N4fz01aKsql02g0T3PgvcLRTjn0
GJ3JlrJhV8mmO0zeY/jDYAkVDDtNwhKoamRVwnxOOVEXZKyGgqqgZsidV7bD
h4SzKUhfEy3AmLWWJRiotN2GgyFWB1DdvXNI/lcFx9DC+UumRmfziyCl5atg
/1M88b3Y+xrO/k7dwuWOLyPUTEa9Qbow9gOe6Rdshs0qZBks6DHDdYCMz0wn
uOJscoO3lz9caGQwfWH6QHYAnK7sDIHrZfpwqPdrS4IFhu9UOL7YlwYp3Z2E
7JacPCjnKGrgZNwRUZD+3AC5qtdWqKv1UEBpkrwXMnsOVPDk+UoNy/leWpgi
lRAN8sj8EbOROWLiKSUrha7iWeLrbl0DNFQUNcHzLE0b5NlMEJlhpmu4Lgx9
hxc3cxajZvdfwqxhmbvJHooLx1iQt0FxoI/LhCvU+nR7wcb4AR6srf6LgP7F
djFw6y0wEdZHRwngP24IQ9g=
  
  "],ExpressionUUID->"dbdc325c-7a2c-4664-b6a5-1b12600e45fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$AllFieldsPlots", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$AllFieldsPlots", ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"VisualFieldDensityPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"All", ",", "All", ",", "\"\<Training\>\""}], "}"}], ",", 
        "type", ",", "\[IndentingNewLine]", 
        RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Benson17\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ColorFunction", "\[Rule]", "type"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Range", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
        RowBox[{"VisualArea", "\[Rule]", "k"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"type", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "8"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.706520769919237*^9, 3.70652077159156*^9}, {
  3.706521050689268*^9, 3.7065216924479094`*^9}, {3.7065218345999517`*^9, 
  3.706521920006472*^9}, {3.706525247074197*^9, 
  3.7065252613593693`*^9}},ExpressionUUID->"35d05dea-d48b-402c-ab7e-\
62fd4755ccea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$AllFieldsPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$AllFieldsPlot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"csize", "=", "0.225"}], ",", 
        RowBox[{"rows", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", "1", ",", "0"}], "}"}], "/", "4"}], 
          "+", "0.125", "+", 
          RowBox[{"0.025", "*", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
            RowBox[{"FaceForm", "@", 
             RowBox[{"Opacity", "[", 
              RowBox[{"0", ",", "White"}], "]"}]}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Inset", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"$AllFieldsPlots", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "id"}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"id", "-", "1"}], ",", "4"}], "]"}], ")"}], "/", 
                    "4"}], "+", "0.125"}], ",", 
                  RowBox[{"rows", "[", 
                   RowBox[{"[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"id", "<", "5"}], ",", "1", ",", "3"}], "]"}], 
                    "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageScaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"0.225", "*", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Inset", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"$AllFieldsPlots", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "id"}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"id", "-", "1"}], ",", "4"}], "]"}], ")"}], "/", 
                    "4"}], "+", "0.125"}], ",", 
                  RowBox[{"rows", "[", 
                   RowBox[{"[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"id", "<", "5"}], ",", "2", ",", "4"}], "]"}], 
                    "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageScaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"0.225", "*", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "$Benson17Model", "[", "\"\<VisualAreaNames\>\"", "]"}], "[",
                  "id", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageScaled", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"id", "-", "1"}], ",", "4"}], "]"}], "/", "4"}], 
                   ",", 
                   RowBox[{"Mean", "@", 
                    RowBox[{"rows", "[", 
                    RowBox[{"[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"id", "<", "5"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}]}]}],
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageScaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.5"}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"id", ",", "8"}], "}"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7065219298002653`*^9, 3.7065219323758383`*^9}, {
   3.706522053570681*^9, 3.706522067310498*^9}, {3.7065221286457*^9, 
   3.70652216064176*^9}, {3.706522210273411*^9, 3.706522263278984*^9}, {
   3.706522327662575*^9, 3.706522415141234*^9}, 
   3.706522875955484*^9},ExpressionUUID->"88519357-c8b8-4346-af42-\
ee174132080c"]
}, Closed]],

Cell[CellGroupData[{

Cell["The Figure Itself", "Subsection",
 CellChangeTimes->{{3.706522589840579*^9, 
  3.70652259283267*^9}},ExpressionUUID->"a6cc0130-1a0a-41b7-b129-\
ec6c404b44ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$ExtendedErrorsCanvas", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$ExtendedErrorsCanvas", "=", 
    RowBox[{"Canvas", "[", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"3.25", ",", "5.25"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
   RowBox[{
   "$ExtendedErrorsCanvas", ",", "\[IndentingNewLine]", "$AllAreasErrorPlot", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$CanvasCenter", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"$CanvasTop", "-", "0.2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3.25", ",", "1.75"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
   RowBox[{"$ExtendedErrorsCanvas", ",", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<A. Ratios of Measurement to Prediction Error\>\"", ",", 
      RowBox[{"FontWeight", "\[Rule]", "\"\<Normal\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"$CanvasLeft", ",", "$CanvasTop"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasInset", "[", "\[IndentingNewLine]", 
   RowBox[{
   "$ExtendedErrorsCanvas", ",", "\[IndentingNewLine]", "$AllFieldsPlot", ",",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$CanvasCenter", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "$CanvasBottom"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3.25", ",", "3.25"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CanvasText", "[", "\[IndentingNewLine]", 
   RowBox[{"$ExtendedErrorsCanvas", ",", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<B. Measured Retinotopy Visual Field Projections\>\"", ",", 
      RowBox[{"FontWeight", "\[Rule]", "\"\<Normal\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"$CanvasLeft", ",", 
      RowBox[{"3.25", "+", "0.2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.706522600000299*^9, 3.7065228088900843`*^9}, {
   3.706522888848102*^9, 3.706523126659564*^9}, 
   3.7065249972536573`*^9},ExpressionUUID->"b276c9ab-0b1a-4aeb-9a7a-\
802727165aad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "[", "\"\<extended_predictions\>\"", "]"}], ":=", 
   RowBox[{"Graphics", "[", "$ExtendedErrorsCanvas", "]"}]}], ";"}]], "Input",\
ExpressionUUID->"81d8efb9-7c48-4b4a-bfdb-6d6b56d56d01"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plots of All Subject Boundaries", "Section",ExpressionUUID->"bb668512-4fa3-422b-aeac-8eb033a0a439"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectBoundaryMapPlots", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectBoundaryMapPlots", "[", 
     RowBox[{"sub_", ",", "ds_", ",", "mdl_", ",", 
      RowBox[{"clip_:", "12"}]}], "]"}], ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"map", "=", 
          RowBox[{"SubjectMap", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds", ",", 
            RowBox[{"RetinotopyModel", "\[Rule]", "mdl"}], ",", 
            RowBox[{"Clip", "\[Rule]", "clip"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
         RowBox[{"map", ",", "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"RetinotopyColor", "[", "type", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"SubjectContours", "[", "\[IndentingNewLine]", 
            RowBox[{"sub", ",", "hemi", ",", "ds", ",", "\[IndentingNewLine]", 
             RowBox[{"RetinotopyModel", "\[Rule]", "mdl"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Clip", "\[Rule]", "clip"}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"Mesh", "\[Rule]", "map"}], ",", "\[IndentingNewLine]", 
             RowBox[{"VisualAreas", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Range", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"EccentricityLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PolarAngleStyleFunction", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
                RowBox[{"White", "&"}], ",", 
                RowBox[{"Black", "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"EccentricityStyleFunction", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
                RowBox[{"Black", "&"}], ",", 
                RowBox[{"White", "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"BoundaryStyle", "\[Rule]", "White"}]}], "]"}]}]}], 
         "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"type", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"hemi", ",", 
        RowBox[{"{", 
         RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7003328290445538`*^9, 
  3.7003328737869177`*^9}},ExpressionUUID->"aba05889-83c0-4d2b-9523-\
0629110ae50b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SFigGoldBoundaries", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SFigGoldBoundaries", "[", 
     RowBox[{"mdl", ":", 
      RowBox[{"\"\<Schira\>\"", "|", "\"\<Benson17\>\""}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plots", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SubjectBoundaryMapPlots", "[", 
             RowBox[{"sub", ",", "0", ",", "mdl", ",", "12"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Spacings", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Text", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"sub", ",", 
                 RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"sub", ",", "$Subjects"}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"plots", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7.5", ",", "7.5"}], "}"}], "*", "72"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"069ca976-3f12-4f67-b2a9-421e119347a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectAllBoundaryPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectAllBoundaryPlot", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"mdl", ":", 
       RowBox[{"\"\<Benson17\>\"", "|", "\"\<Schira\>\""}]}], ",", 
      RowBox[{"clip_:", "12"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"plots", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"SubjectBoundaryMapPlots", "[", 
              RowBox[{"sub", ",", "ds", ",", "mdl", ",", "clip"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"ds", ",", 
             RowBox[{"RotateLeft", "@", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                "IntegerQ"}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"txt", "=", 
         RowBox[{"Graphics", "@", 
          RowBox[{"Text", "@", 
           RowBox[{"Style", "[", 
            RowBox[{"sub", ",", 
             RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
             RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}]}]}]}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "plots", "]"}], "\[Equal]", "8"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"4", ";;", "6"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"plots", "[", 
               RowBox[{"[", "7", "]"}], "]"}], ",", "txt", ",", 
              RowBox[{"plots", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Length", "[", "plots", "]"}], "\[Equal]", "22"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "5"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"6", ";;", "10"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"11", ";;", "15"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"16", ";;", "20"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"plots", "[", 
               RowBox[{"[", "21", "]"}], "]"}], ",", 
              RowBox[{"Graphics", "[", "]"}], ",", "txt", ",", 
              RowBox[{"Graphics", "[", "]"}], ",", 
              RowBox[{"plots", "[", 
               RowBox[{"[", "22", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "True", ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "7"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"15", ";;", "21"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"22", ";;", "28"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"29", ";;", "35"}], "]"}], "]"}], ",", 
            RowBox[{"plots", "[", 
             RowBox[{"[", 
              RowBox[{"36", ";;", "42"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"plots", "[", 
               RowBox[{"[", 
                RowBox[{"43", ";;", "45"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"txt", ",", 
                RowBox[{"plots", "[", 
                 RowBox[{"[", "46", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7.5", ",", "7.5"}], "}"}], "*", "72"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"a7d7b44d-9ef4-40f2-b54c-def1e7b2e0c8"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{971, 747},
WindowMargins->{{Automatic, 38}, {Automatic, 30}},
TrackCellChangeTimes->False,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Chapter"], CellFrame -> {{False, False}, {False, True}}], 
   Cell[
    StyleData["Subchapter"], CellMargins -> {{48, Inherited}, {8, 20}}], 
   Cell[
    StyleData["Section"], CellFrame -> {{0, 0}, {0, 0}}, CellDingbat -> 
    "\[GraySquare]", CellMargins -> {{51, Inherited}, {8, 18}}, FontSize -> 
    24, FontColor -> 
    RGBColor[0.7529411764705882, 0.15294117647058825`, 
      0.12156862745098039`]]}, Visible -> False, FrontEndVersion -> 
  "11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 127, 3, 148, "Title", "ExpressionUUID" -> \
"8d4e763a-023f-4955-bab5-41368eb985c1"],
Cell[710, 27, 1329, 37, 153, "Chapter", "ExpressionUUID" -> \
"53abb8f0-427e-41cf-a18a-2373101a7a0a"],
Cell[CellGroupData[{
Cell[2064, 68, 80, 0, 63, "Chapter", "ExpressionUUID" -> \
"22e3e616-22a0-4d44-b329-2e5f6c36aab0"],
Cell[2147, 70, 554, 9, 144, "Text", "ExpressionUUID" -> \
"cc710ea1-b471-4a37-9e59-5adda0d67774"],
Cell[CellGroupData[{
Cell[2726, 83, 89, 0, 63, "Subchapter", "ExpressionUUID" -> \
"e7e7ff45-d5c6-45bf-b6a5-946d1d516f8f"],
Cell[CellGroupData[{
Cell[2840, 87, 86, 0, 55, "Section", "ExpressionUUID" -> \
"c865ccc4-87cf-43da-8ced-b782821d42f0"],
Cell[2929, 89, 172, 3, 54, "Input", "ExpressionUUID" -> \
"1a59d6d9-0721-4ea4-a7bf-1bd215ee3e8d"]
}, Closed]],
Cell[CellGroupData[{
Cell[3138, 97, 79, 0, 41, "Section", "ExpressionUUID" -> \
"2d83157c-2445-47bc-a4df-ca5ed1b9d327"],
Cell[3220, 99, 436, 6, 68, "Text", "ExpressionUUID" -> \
"48921840-01bd-4d50-b387-14c57db6aefd"],
Cell[3659, 107, 2226, 51, 369, "Input", "ExpressionUUID" -> \
"673cb347-00ca-437d-8bfd-174cb5c89235"],
Cell[5888, 160, 148, 2, 30, "Text", "ExpressionUUID" -> \
"376e780c-9366-41a2-92fd-88a766d36bae"],
Cell[6039, 164, 2384, 60, 348, "Input", "ExpressionUUID" -> \
"532b5e3a-bf9d-4a30-b93d-26ed995e4127"],
Cell[8426, 226, 115, 0, 30, "Text", "ExpressionUUID" -> \
"ff27e4fa-1a4e-4748-9817-038011652e97"],
Cell[8544, 228, 388, 10, 54, "Input", "ExpressionUUID" -> \
"b1ab3cf7-5b82-4f3d-9a57-167951ace5f5"],
Cell[8935, 240, 148, 1, 30, "Text", "ExpressionUUID" -> \
"096e146a-1c3e-4848-b0b2-9d4ebd930a87"],
Cell[9086, 243, 654, 15, 117, "Input", "ExpressionUUID" -> \
"b0408970-f60f-4633-ac49-25f60d0017f5"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[9789, 264, 91, 0, 47, "Subchapter", "ExpressionUUID" -> \
"dd463ddd-83c9-4728-bc73-cabc33e4c4b5"],
Cell[9883, 266, 224, 3, 49, "Text", "ExpressionUUID" -> \
"0188cd34-0261-447d-8333-00e1244f5c7d"],
Cell[CellGroupData[{
Cell[10132, 273, 94, 0, 55, "Section", "ExpressionUUID" -> \
"a3ef7226-5bd7-48e3-af8d-243257829892"],
Cell[10229, 275, 2128, 53, 285, "Input", "ExpressionUUID" -> \
"5ff26971-3209-4f3e-8c32-e91e88bdfb1e"],
Cell[12360, 330, 171, 3, 30, "Text", "ExpressionUUID" -> \
"7aee201c-f5b6-425c-80dd-928ef35241db"],
Cell[12534, 335, 1655, 44, 180, "Input", "ExpressionUUID" -> \
"15acbdbd-b790-48fc-beab-ad6e33a7be9e"]
}, Closed]],
Cell[CellGroupData[{
Cell[14226, 384, 109, 0, 41, "Section", "ExpressionUUID" -> \
"915cc7ed-f753-4751-b2b2-06aef3e4794d"],
Cell[CellGroupData[{
Cell[14360, 388, 120, 0, 44, "Subsection", "ExpressionUUID" -> \
"15c6cef9-af7a-43ae-837c-e0f1c8237e9e"],
Cell[14483, 390, 7394, 171, 999, "Input", "ExpressionUUID" -> \
"bd46d951-0891-4679-b5ce-5eb6b217feb1"]
}, Closed]],
Cell[CellGroupData[{
Cell[21914, 566, 110, 0, 36, "Subsection", "ExpressionUUID" -> \
"c78ba169-4b66-4674-b3d5-e147155f8224"],
Cell[22027, 568, 13311, 307, 1713, "Input", "ExpressionUUID" -> \
"0ef92fd6-0de6-4743-94cc-8826659080ee"],
Cell[35341, 877, 1381, 37, 159, "Input", "ExpressionUUID" -> \
"3b496899-6d5b-46a4-a600-084895a6757c"],
Cell[36725, 916, 2352, 59, 327, "Input", "ExpressionUUID" -> \
"59cf4f16-8281-4b65-a299-1ab6693d35b4"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39126, 981, 102, 0, 41, "Section", "ExpressionUUID" -> \
"0e3f1085-9dee-4227-a6d7-86441afe6954"],
Cell[CellGroupData[{
Cell[39253, 985, 115, 0, 44, "Subsection", "ExpressionUUID" -> \
"110c9e12-9379-4f79-bcad-0c0a9113819d"],
Cell[39371, 987, 196, 3, 30, "Text", "ExpressionUUID" -> \
"aae2ec8b-88aa-4b72-a71e-7cb3f1a79a36"],
Cell[39570, 992, 31924, 687, 3761, "Input", "ExpressionUUID" -> \
"b20248dc-ad96-4538-ba15-66857ccda745"]
}, Closed]],
Cell[CellGroupData[{
Cell[71531, 1684, 118, 0, 36, "Subsection", "ExpressionUUID" -> \
"6ea778a1-be85-4233-9da7-9868a116d90d"],
Cell[71652, 1686, 121, 0, 30, "Text", "ExpressionUUID" -> \
"71e2d094-3e94-4dd6-99da-9096cfa338e6"],
Cell[71776, 1688, 475, 11, 75, "Input", "ExpressionUUID" -> \
"38be62a3-af4d-45fe-8ac8-6d3e84442b66"],
Cell[72254, 1701, 168, 3, 30, "Text", "ExpressionUUID" -> \
"24f13436-2ba7-43fc-9102-b666f64039e8"],
Cell[72425, 1706, 1394, 36, 159, "Input", "ExpressionUUID" -> \
"4d3307c0-2a44-48d9-9902-6f5b51858a4c"],
Cell[73822, 1744, 278, 4, 49, "Text", "ExpressionUUID" -> \
"d79eb474-a227-41d2-a06b-508306878b89"],
Cell[74103, 1750, 4891, 120, 642, "Input", "ExpressionUUID" -> \
"c7081acd-42e3-465e-bdc2-3b524487352f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[79043, 1876, 114, 0, 41, "Section", "ExpressionUUID" -> \
"5397d0a1-1a23-464b-a89a-f24a87ff7eaf"],
Cell[79160, 1878, 13510, 299, 70, "Input", "ExpressionUUID" -> \
"80625b0d-3bd2-4972-8579-c096b870955f"],
Cell[92673, 2179, 3763, 87, 70, "Input", "ExpressionUUID" -> \
"a17cab02-7d2f-4014-99a0-40a0e24de91b"],
Cell[96439, 2268, 4407, 103, 70, "Input", "ExpressionUUID" -> \
"e9ccdb23-d437-49d1-a442-feff5af52dbe"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[100895, 2377, 195, 3, 47, "Subchapter", "ExpressionUUID" -> \
"4c83839d-e39b-4e27-a90a-8a322170b2b3"],
Cell[CellGroupData[{
Cell[101115, 2384, 203, 4, 55, "Section", "ExpressionUUID" -> \
"ad840763-fbc9-4d1c-abd7-460f26883deb"],
Cell[CellGroupData[{
Cell[101343, 2392, 103, 0, 44, "Subsection", "ExpressionUUID" -> \
"d6f0bb22-45e9-4f6e-92d7-d365389f07e3"],
Cell[101449, 2394, 918, 23, 159, "Input", "ExpressionUUID" -> \
"ac0f1697-6ec7-4c09-8d61-d54a94e791ca"],
Cell[102370, 2419, 470, 11, 96, "Input", "ExpressionUUID" -> \
"7670f440-3eec-4b29-9ad8-da885b215a4b"],
Cell[102843, 2432, 1066, 22, 222, "Input", "ExpressionUUID" -> \
"b8d1e1fa-7772-4ae4-8192-03c7a6544e5b"]
}, Closed]],
Cell[CellGroupData[{
Cell[103946, 2459, 225, 4, 36, "Subsection", "ExpressionUUID" -> \
"38341fdb-c3f0-4017-b9c2-cca874d2e052"],
Cell[104174, 2465, 4507, 120, 600, "Input", "ExpressionUUID" -> \
"feaa8ba1-f80c-4112-9ab5-1acfd9f79c19"]
}, Closed]],
Cell[CellGroupData[{
Cell[108718, 2590, 106, 0, 36, "Subsection", "ExpressionUUID" -> \
"d79c90f1-3ddf-43ae-97b4-b94e7cd81756"],
Cell[108827, 2592, 376, 6, 68, "Text", "ExpressionUUID" -> \
"5684d721-995d-48e9-9357-f026c17de0d7"],
Cell[109206, 2600, 6362, 157, 915, "Input", "ExpressionUUID" -> \
"f5f242e6-1ff8-407f-be32-42cd0869763f"]
}, Closed]],
Cell[CellGroupData[{
Cell[115605, 2762, 163, 3, 36, "Subsection", "ExpressionUUID" -> \
"af822b92-4514-429c-9542-8624001eeb01"],
Cell[115771, 2767, 26870, 623, 3656, "Input", "ExpressionUUID" -> \
"a1e9957a-85e8-426a-868f-8d003f42b7d1"]
}, Closed]],
Cell[CellGroupData[{
Cell[142678, 3395, 188, 3, 36, "Subsection", "ExpressionUUID" -> \
"09f24c71-cb48-4382-ad87-8f9c8b3b7223"],
Cell[142869, 3400, 6209, 163, 70, "Input", "ExpressionUUID" -> \
"c57cd5f6-6b13-4a64-9fff-039bf27b4a34"]
}, Closed]],
Cell[CellGroupData[{
Cell[149115, 3568, 92, 0, 36, "Subsection", "ExpressionUUID" -> \
"361dfdf9-7674-4dfa-91b5-3487092ab9ef"],
Cell[149210, 3570, 174, 3, 30, "Text", "ExpressionUUID" -> \
"1897b273-8c92-433a-b255-3f6e2e280cca"],
Cell[149387, 3575, 1128, 30, 139, "Input", "ExpressionUUID" -> \
"310eeeb8-a6ef-4850-b1fc-f6ef202e65b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[150552, 3610, 107, 0, 36, "Subsection", "ExpressionUUID" -> \
"d05b912a-82dd-4182-9d91-6b77945ace80"],
Cell[CellGroupData[{
Cell[150684, 3614, 159, 2, 35, "Subsubsection", "ExpressionUUID" -> \
"2ce2f043-6c4b-4956-9abd-f3e526529791"],
Cell[150846, 3618, 11724, 268, 70, "Input", "ExpressionUUID" -> \
"e12cd5a6-e823-422f-bda3-9b115d82dcce"]
}, Closed]],
Cell[CellGroupData[{
Cell[162607, 3891, 101, 0, 29, "Subsubsection", "ExpressionUUID" -> \
"a27c6ea1-9b90-41fe-a611-b88e5d60e72b"],
Cell[162711, 3893, 131, 0, 30, "Text", "ExpressionUUID" -> \
"bca084cf-95a7-44f0-9b62-3fdf76a99152"],
Cell[162845, 3895, 2587, 63, 233, "Input", "ExpressionUUID" -> \
"bde3cbe7-368d-4af0-8992-a4faf1533aa3"],
Cell[165435, 3960, 110, 0, 30, "Text", "ExpressionUUID" -> \
"b245438d-34fa-4483-a3a1-137d405743da"],
Cell[165548, 3962, 5809, 133, 611, "Input", "ExpressionUUID" -> \
"4fa30373-5c3b-4801-9610-4b08f9b3ca3b"],
Cell[171360, 4097, 131, 0, 30, "Text", "ExpressionUUID" -> \
"6164d0b9-5d90-45ca-bd3e-e9767cbfc800"],
Cell[171494, 4099, 6030, 136, 653, "Input", "ExpressionUUID" -> \
"90500fe3-e953-454e-ac11-b95c6c5ca83e"],
Cell[177527, 4237, 97, 0, 30, "Text", "ExpressionUUID" -> \
"11b2335a-fc0f-488c-a8e3-a1a3ec5dd668"],
Cell[177627, 4239, 1349, 35, 149, "Input", "ExpressionUUID" -> \
"5de752c6-62a1-4704-bfde-88b7dc238a43"],
Cell[178979, 4276, 121, 0, 30, "Text", "ExpressionUUID" -> \
"e436b776-c0a4-468e-93e5-718058654fe8"],
Cell[179103, 4278, 24316, 569, 2648, "Input", "ExpressionUUID" -> \
"c366d373-00f1-4167-8f0f-90a4efc4c873"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[203480, 4854, 94, 0, 41, "Section", "ExpressionUUID" -> \
"4c0516a3-6250-4ed5-9999-c09da9736816"],
Cell[203577, 4856, 17134, 391, 1682, "Input", "ExpressionUUID" -> \
"439d35e7-67ee-4246-9f7e-f6d36228ef24"],
Cell[220714, 5249, 6140, 135, 821, "Input", "ExpressionUUID" -> \
"f754a305-d725-4d70-bc13-739aec031f0e"],
Cell[226857, 5386, 3641, 80, 579, "Input", "ExpressionUUID" -> \
"bf977e38-7466-4e44-9129-c8d0d1391917"]
}, Closed]],
Cell[CellGroupData[{
Cell[230535, 5471, 112, 0, 41, "Section", "ExpressionUUID" -> \
"740216cd-e0eb-47b0-942d-56f32658b2b8"],
Cell[230650, 5473, 6241, 130, 70, "Input", "ExpressionUUID" -> \
"14b33c91-cac7-4ded-ae85-93871d70cbea"],
Cell[236894, 5605, 9073, 212, 70, "Input", "ExpressionUUID" -> \
"cb43c9a7-6bb8-45ec-81f5-56cab25f49e0"]
}, Closed]],
Cell[CellGroupData[{
Cell[246004, 5822, 143, 2, 41, "Section", "ExpressionUUID" -> \
"48084d53-3837-481c-8283-4d013c0d6266"],
Cell[246150, 5826, 286, 4, 49, "Text", "ExpressionUUID" -> \
"db03362c-b47b-4887-9069-01118e09ed97"],
Cell[CellGroupData[{
Cell[246461, 5834, 103, 0, 44, "Subsection", "ExpressionUUID" -> \
"7d3ad60a-7a80-409c-a8a2-04393eccf467"],
Cell[246567, 5836, 157, 2, 30, "Text", "ExpressionUUID" -> \
"247c33b9-128a-413d-8f62-cc9068472ad0"],
Cell[246727, 5840, 10646, 252, 1472, "Input", "ExpressionUUID" -> \
"28029415-8ef1-4c8b-9c92-2d2671fd32cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[257410, 6097, 113, 0, 36, "Subsection", "ExpressionUUID" -> \
"d58ed629-e2d9-4aa0-9120-28d81b18f4e7"],
Cell[257526, 6099, 321, 5, 68, "Text", "ExpressionUUID" -> \
"44aab93c-c7bd-4d55-b4f7-58f68f13efd4"],
Cell[257850, 6106, 44205, 951, 3677, "Input", "ExpressionUUID" -> \
"62469fef-f688-4433-bd2f-3466e0048f20"]
}, Closed]],
Cell[CellGroupData[{
Cell[302092, 7062, 111, 0, 36, "Subsection", "ExpressionUUID" -> \
"960ea701-bcc8-49a1-a77d-318e741a64f8"],
Cell[302206, 7064, 25201, 565, 2501, "Input", "ExpressionUUID" -> \
"9f9a3481-7dd5-4bca-9aef-b8a912e003a4"]
}, Closed]],
Cell[CellGroupData[{
Cell[327444, 7634, 115, 0, 36, "Subsection", "ExpressionUUID" -> \
"b373c471-03c3-4f52-8ee5-455c0dbafaf1"],
Cell[327562, 7636, 100465, 2192, 8675, "Input", "ExpressionUUID" -> \
"046e5aa3-0180-4b59-9e09-bb103efdcb08"]
}, Closed]],
Cell[CellGroupData[{
Cell[428064, 9833, 132, 0, 36, "Subsection", "ExpressionUUID" -> \
"11b59c04-6873-4149-8bab-81d2824b0be0"],
Cell[428199, 9835, 187, 3, 30, "Text", "ExpressionUUID" -> \
"9309d20f-7a77-4dd5-87b9-426667d0ba9a"],
Cell[428389, 9840, 36835, 787, 3645, "Input", "ExpressionUUID" -> \
"da7a34b1-536e-4793-80d9-f982d7d71a95"]
}, Closed]],
Cell[CellGroupData[{
Cell[465261, 10632, 121, 0, 36, "Subsection", "ExpressionUUID" -> \
"e03b4835-c822-488b-84b6-6ba07d43e78f"],
Cell[465385, 10634, 7012, 168, 579, "Input", "ExpressionUUID" -> \
"c81e165e-6653-4c17-b420-04bdb62f3b8b"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[472470, 10810, 78, 0, 74, "Chapter", "ExpressionUUID" -> \
"18d4fb76-9a7b-4e9d-a8fe-eaf1130f3db4"],
Cell[472551, 10812, 185, 3, 30, "Text", "ExpressionUUID" -> \
"806d9f4c-1d5c-4650-b7d0-d5796c2d70a8"],
Cell[CellGroupData[{
Cell[472761, 10819, 84, 0, 63, "Subchapter", "ExpressionUUID" -> \
"066117cd-5693-4899-9792-d5c6ad57efa3"],
Cell[CellGroupData[{
Cell[472870, 10823, 92, 0, 55, "Section", "ExpressionUUID" -> \
"1b28c5d3-589c-4a68-b3b7-5a4d7fc818b9"],
Cell[CellGroupData[{
Cell[472987, 10827, 98, 0, 44, "Subsection", "ExpressionUUID" -> \
"9f280b52-4b1c-4a0e-bf29-e7d4fb2aba8b"],
Cell[473088, 10829, 5217, 146, 443, "Input", "ExpressionUUID" -> \
"0449f5ee-4f06-4638-88c0-bd58506e32d2"],
Cell[478308, 10977, 4823, 98, 443, "Input", "ExpressionUUID" -> \
"8fc7f285-7870-4f0f-9ec0-e73060cd73b6"],
Cell[483134, 11077, 10688, 235, 1073, "Input", "ExpressionUUID" -> \
"2755f7f5-be3d-47c9-bdfd-e6edc5ee1965"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493859, 11317, 96, 0, 44, "Subsection", "ExpressionUUID" -> \
"ff4a5d88-e9e7-462e-9cfb-cf1070cf824d"],
Cell[493958, 11319, 4687, 117, 506, "Input", "ExpressionUUID" -> \
"7844682a-d0d1-4904-9be9-c570c6266380"],
Cell[498648, 11438, 7065, 153, 800, "Input", "ExpressionUUID" -> \
"9b24df6b-b216-4aaa-8cc1-25593db8806f"],
Cell[505716, 11593, 3601, 83, 443, "Input", "ExpressionUUID" -> \
"fba23452-2b56-4485-acf9-292e3c104ad3"],
Cell[509320, 11678, 3097, 72, 422, "Input", "ExpressionUUID" -> \
"076b53ae-2812-4431-b174-0e67adc51c8c"],
Cell[512420, 11752, 1575, 40, 191, "Input", "ExpressionUUID" -> \
"2e54feee-f818-4488-acf5-47678169b6b0"],
Cell[513998, 11794, 6914, 165, 548, "Input", "ExpressionUUID" -> \
"e2f092e1-f153-4cd9-a7ad-e0257782f762"],
Cell[520915, 11961, 5205, 128, 464, "Input", "ExpressionUUID" -> \
"21c19c6d-bfbd-4715-9dc8-eb8e30aa8dd2"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[526169, 12095, 90, 0, 55, "Section", "ExpressionUUID" -> \
"186bafb3-7500-4476-ad2f-8b66c904c57b"],
Cell[526262, 12097, 213, 3, 30, "Text", "ExpressionUUID" -> \
"d7bd7c39-af47-4ff7-8437-4c0f72d86566"],
Cell[CellGroupData[{
Cell[526500, 12104, 109, 0, 44, "Subsection", "ExpressionUUID" -> \
"81aefa67-1f99-4949-9bd2-3fbbd7c85109"],
Cell[526612, 12106, 7948, 185, 915, "Input", "ExpressionUUID" -> \
"4c1643bf-3df0-4524-8135-4f4221b42e8c"],
Cell[534563, 12293, 3924, 75, 936, "Input", "ExpressionUUID" -> \
"e4988929-1974-4710-a5c9-964e00a203a7"],
Cell[538490, 12370, 1454, 35, 180, "Input", "ExpressionUUID" -> \
"ca5fa427-4eb5-468b-97b2-0dfcfe737e2c"]
}, Closed]],
Cell[CellGroupData[{
Cell[539981, 12410, 96, 0, 36, "Subsection", "ExpressionUUID" -> \
"243c6273-6536-4228-8ac7-8c3f1485b2f8"],
Cell[540080, 12412, 10898, 266, 1514, "Input", "ExpressionUUID" -> \
"a9eff2bd-b564-40e4-bb06-ae529c5e94f4"],
Cell[550981, 12680, 234, 5, 43, "Input", "ExpressionUUID" -> \
"8013ecb1-1d88-4b05-ba2f-909fc66b1d2f"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[551264, 12691, 90, 0, 55, "Section", "ExpressionUUID" -> \
"7152e3a2-4a9b-43a6-a935-800f89d4e793"],
Cell[CellGroupData[{
Cell[551379, 12695, 97, 0, 44, "Subsection", "ExpressionUUID" -> \
"d416b245-7d24-49b0-b7b5-d56b3abcf68f"],
Cell[551479, 12697, 24701, 544, 2175, "Input", "ExpressionUUID" -> \
"3ee979b8-a4f5-463a-ad43-3de4da64f074"],
Cell[576183, 13243, 25913, 595, 2207, "Input", "ExpressionUUID" -> \
"c7990fff-7feb-4400-9538-48a52fae710b"],
Cell[602099, 13840, 3301, 88, 296, "Input", "ExpressionUUID" -> \
"6e0d6df9-6d90-4905-a581-bc3bb9f776bb"]
}, Closed]],
Cell[CellGroupData[{
Cell[605437, 13933, 174, 3, 36, "Subsection", "ExpressionUUID" -> \
"5d0f7a48-a474-4bdf-8906-8608887f6ada"],
Cell[605614, 13938, 14398, 328, 1230, "Input", "ExpressionUUID" -> \
"e747ab69-0e9b-4bbf-87fe-aca29600c7c1"],
Cell[620015, 14268, 9070, 220, 915, "Input", "ExpressionUUID" -> \
"f1cf6012-62df-4e69-b2d2-f4f347160cbe"]
}, Closed]],
Cell[CellGroupData[{
Cell[629122, 14493, 87, 0, 36, "Subsection", "ExpressionUUID" -> \
"8ebe2741-af2c-464e-8dbf-bdc0a687e383"],
Cell[CellGroupData[{
Cell[629234, 14497, 237, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"ca35ebb6-6cc8-4615-b9bb-72e6babbd549"],
Cell[629474, 14503, 3343, 89, 222, "Input", "ExpressionUUID" -> \
"4bfa9bce-1dd5-42f2-897e-8bd337ddbeba"]
}, Closed]],
Cell[CellGroupData[{
Cell[632854, 14597, 220, 4, 29, "Subsubsection", "ExpressionUUID" -> \
"3e3e13b2-09d4-4aa6-9eae-e368839f5dd2"],
Cell[633077, 14603, 5304, 130, 485, "Input", "ExpressionUUID" -> \
"949cc270-4601-4a4a-8751-75dd979e9e32"],
Cell[638384, 14735, 7543, 165, 758, "Input", "ExpressionUUID" -> \
"4255fd0e-ee28-4f16-984e-d3b509f82ed7"]
}, Closed]],
Cell[CellGroupData[{
Cell[645964, 14905, 167, 3, 29, "Subsubsection", "ExpressionUUID" -> \
"76a161a7-ca6b-4282-98a2-fa90c7a0e5d8"],
Cell[646134, 14910, 6794, 148, 716, "Input", "ExpressionUUID" -> \
"9cbfc249-9a73-4185-9b5e-985cd54b4baa"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[652977, 15064, 220, 4, 36, "Subsection", "ExpressionUUID" -> \
"705b3f67-7468-4509-915b-dc4bffd56831"],
Cell[653200, 15070, 4412, 114, 842, "Input", "ExpressionUUID" -> \
"966d2bc6-5bff-4ee8-b482-f0778d4fd973"],
Cell[657615, 15186, 231, 5, 43, "Input", "ExpressionUUID" -> \
"6c1114c9-20af-4e09-899e-617f0e717942"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[657895, 15197, 96, 0, 55, "Section", "ExpressionUUID" -> \
"46c1895b-0798-486f-b6c0-9b8ac02bd7ce"],
Cell[CellGroupData[{
Cell[658016, 15201, 134, 0, 44, "Subsection", "ExpressionUUID" -> \
"2bae5b80-c272-417a-8f24-990de61b2e47"],
Cell[658153, 15203, 11657, 274, 1157, "Input", "ExpressionUUID" -> \
"71d74ded-c77b-4b20-bed0-f2a969744548"],
Cell[669813, 15479, 20618, 451, 1535, "Input", "ExpressionUUID" -> \
"061e5e84-df78-4e27-925f-037a7466dc32"]
}, Closed]],
Cell[CellGroupData[{
Cell[690468, 15935, 105, 0, 36, "Subsection", "ExpressionUUID" -> \
"1d8786b2-03e8-4da9-965c-12663bf086b9"],
Cell[690576, 15937, 10258, 256, 1056, "Input", "ExpressionUUID" -> \
"75553961-4b02-4686-ac40-73500035f411"]
}, Closed]],
Cell[CellGroupData[{
Cell[700871, 16198, 92, 0, 36, "Subsection", "ExpressionUUID" -> \
"3057e9d4-9583-4ec5-b7a3-dc75ef48d1b1"],
Cell[700966, 16200, 1742, 45, 159, "Input", "ExpressionUUID" -> \
"24e03818-d4ac-48df-b458-72ee00bfb738"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[702757, 16251, 103, 0, 55, "Section", "ExpressionUUID" -> \
"d4ffc394-d204-43b4-8cba-b0d7ec96934c"],
Cell[CellGroupData[{
Cell[702885, 16255, 183, 3, 44, "Subsection", "ExpressionUUID" -> \
"d7007824-6dec-4efa-9f33-662de7a0ef5c"],
Cell[703071, 16260, 11911, 256, 1010, "Input", "ExpressionUUID" -> \
"a3f94e9f-0cb1-437f-b5e4-9b3ab4735cc8"],
Cell[714985, 16518, 21741, 471, 2018, "Input", "ExpressionUUID" -> \
"dbdc325c-7a2c-4664-b6a5-1b12600e45fe"],
Cell[736729, 16991, 1547, 35, 275, "Input", "ExpressionUUID" -> \
"35d05dea-d48b-402c-ab7e-62fd4755ccea"],
Cell[738279, 17028, 6199, 149, 548, "Input", "ExpressionUUID" -> \
"88519357-c8b8-4346-af42-ee174132080c"]
}, Closed]],
Cell[CellGroupData[{
Cell[744515, 17182, 164, 3, 36, "Subsection", "ExpressionUUID" -> \
"a6cc0130-1a0a-41b7-b129-ec6c404b44ac"],
Cell[744682, 17187, 2952, 74, 548, "Input", "ExpressionUUID" -> \
"b276c9ab-0b1a-4aeb-9a7a-802727165aad"],
Cell[747637, 17263, 242, 5, 43, "Input", "ExpressionUUID" -> \
"81d8efb9-7c48-4b4a-bfdb-6d6b56d56d01"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[747928, 17274, 105, 0, 55, "Section", "ExpressionUUID" -> \
"bb668512-4fa3-422b-aeac-8eb033a0a439"],
Cell[748036, 17276, 3297, 72, 464, "Input", "ExpressionUUID" -> \
"aba05889-83c0-4d2b-9523-0629110ae50b"],
Cell[751336, 17350, 2187, 51, 359, "Input", "ExpressionUUID" -> \
"069ca976-3f12-4f67-b2a9-421e119347a6"],
Cell[753526, 17403, 5238, 128, 506, "Input", "ExpressionUUID" -> \
"a7d7b44d-9ef4-40f2-b54c-def1e7b2e0c8"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

