(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    987266,      22853]
NotebookOptionsPosition[    960142,      22211]
NotebookOutlinePosition[    961235,      22244]
CellTagsIndexPosition[    961192,      22241]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Bayesian Retinotopic Maps in V1-V3:
Visualization\
\>", "Title",ExpressionUUID->"8d4e763a-023f-4955-bab5-41368eb985c1"],

Cell[TextData[{
 "Noah C. Benson",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]],ExpressionUUID->
  "ff154506-5578-4f2b-ac40-a98a7d0ec16c"],
 ", Jonathan Winawer",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", 
    RowBox[{"1", ",", "2"}]], TraditionalForm]],ExpressionUUID->
  "bd4a7a2d-5696-479c-bd18-467cac4e22e9"],
 "\[LineSeparator]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]],
  FontSize->18,ExpressionUUID->"f7cad2f5-bf7e-4660-bb89-643604859e4d"],
 StyleBox["Department of Psychology, New York University, New York, NY, USA\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "2"], TraditionalForm]],
  FontSize->18,ExpressionUUID->"728df6d5-a032-4aa8-bfdc-6eeab1aa3acc"],
 StyleBox["Center for Neural Sciences, New York University, New York, NY, USA",
  FontSize->18]
}], "Chapter",ExpressionUUID->"53abb8f0-427e-41cf-a18a-2373101a7a0a"],

Cell[CellGroupData[{

Cell["Header", "Chapter",ExpressionUUID->"22e3e616-22a0-4d44-b329-2e5f6c36aab0"],

Cell["\<\
This section includes all code that:
  (a) defines a piece of data
  (b) configures the environment
  (c) constructs a library of tools for visualization and analysis
All code in this section should either run very quickly or should be defined \
using MemoizeSafe and AutoCache so as to run immediately and load data or \
perform calculations lazily when requested. Accordingly, this section should \
evaluate quickly, much like loading a project library.\
\>", "Text",ExpressionUUID->"cc710ea1-b471-4a37-9e59-5adda0d67774"],

Cell[CellGroupData[{

Cell["Introduction", "Subchapter",ExpressionUUID->"e7e7ff45-d5c6-45bf-b6a5-946d1d516f8f"],

Cell[CellGroupData[{

Cell["Dependencies", "Section",ExpressionUUID->"c865ccc4-87cf-43da-8ced-b782821d42f0"],

Cell[BoxData[{
 RowBox[{"<<", "ErrorBarPlots`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Neurotica`"}]}], "Input",ExpressionUUID->"1a59d6d9-0721-4ea4-\
a7bf-1bd215ee3e8d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Paths", "Section",ExpressionUUID->"2d83157c-2445-47bc-a4df-ca5ed1b9d327"],

Cell["\<\
This notebook expects to be able to access data in the V123 data root, the \
contents of which can be downloaded from the open science framework \
(http://osf.io/). If you have the V123_DATA_ROOT environment variable set \
correctly, or if this notebook is in the root, then this cell should find the \
root fine; otherwise, you may need to set it manually.\
\>", "Text",ExpressionUUID->"48921840-01bd-4d50-b387-14c57db6aefd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$DataRoot", ",", "$V123VisualizationNotebookDirectory"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$V123VisualizationNotebookDirectory", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$DataRoot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"env", "=", 
         RowBox[{"Environment", "[", "\"\<V123_DATA_ROOT\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"loc", "=", "$V123VisualizationNotebookDirectory"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"env", "=!=", "$Failed"}], ",", "env", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<analyses\>\""}], "}"}], "]"}], ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<freesurfer_subjects\>\""}], "}"}], 
              "]"}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "loc", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "True", ",", "$Failed"}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"673cb347-00ca-437d-8bfd-\
174cb5c89235"],

Cell["\<\
These data simply define directories in terms of the above data root:\
\>", "Text",ExpressionUUID->"376e780c-9366-41a2-92fd-88a766d36bae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FreeSurferRoot", ",", "$AnalysesRoot", ",", "$RetinotopyRoot", ",", 
    "$FigureRoot", ",", "$ModelRoot", ",", "$HCPRoot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FreeSurferRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<freesurfer_subjects\>\""}], "}"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AnalysesRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<analyses\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<retinotopy\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<figures\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ModelRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<models\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HCPRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<HCP\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"532b5e3a-bf9d-4a30-b93d-26ed995e4127"],

Cell["We want to make sure we can find FreeSurfer:", "Text",ExpressionUUID->"ff27e4fa-1a4e-4748-9817-038011652e97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"$FreeSurferSubjectsDirectories", ",", "$FreeSurferRoot"}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"AddFreeSurferSubjectsDirectory", "[", "$FreeSurferRoot", "]"}]}],
    "]"}], ";"}]], "Input",ExpressionUUID->"b1ab3cf7-5b82-4f3d-9a57-\
167951ace5f5"],

Cell["We also want to correctly set Neurotica\[CloseCurlyQuote]s cache \
directory:", "Text",ExpressionUUID->"096e146a-1c3e-4848-b0b2-9d4ebd930a87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CacheDirectory", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$CacheDirectory", ":=", 
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", ":", 
        RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"s", ",", "\"\<cache\>\""}], "}"}], "]"}]}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"b0408970-f60f-4633-ac49-\
25f60d0017f5"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing Data", "Subchapter",ExpressionUUID->"dd463ddd-83c9-4728-bc73-cabc33e4c4b5"],

Cell["\<\
In this section of the notebook, we import the data from the retinotopy and \
analyses directories; we setup subject datasets according to these \
\>", "Text",ExpressionUUID->"0188cd34-0261-447d-8333-00e1244f5c7d"],

Cell[CellGroupData[{

Cell["The Retinotopy Models", "Section",ExpressionUUID->"b3999b89-ac20-4187-9858-e1b30d628597"],

Cell[CellGroupData[{

Cell["\<\
Code to generate conversion functions from cortical map to visual field\
\>", "Subsection",ExpressionUUID->"2ce2f043-6c4b-4956-9abd-f3e526529791"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "FMMFunctions", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FMMFunctions", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"tx0_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mesh", "=", 
        RowBox[{"data", "[", "\"\<Mesh\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"coords", "=", 
        RowBox[{"data", "[", "\"\<Coordinates\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "=", 
        RowBox[{
         RowBox[{"data", "[", "\"\<FMM\>\"", "]"}], "[", "\"\<Triangles\>\"", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"angle", "=", 
        RowBox[{"data", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eccen", "=", 
        RowBox[{"data", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"iregions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "@", 
         RowBox[{"data", "[", "\"\<VisualAreaKey\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tx", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tx0", "===", "Automatic"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"AffineTransform", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", ";;", "2"}], ",", 
                  RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", 
                  RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}], 
            "&"}], "@", 
           RowBox[{"Replace", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"data", "[", "\"\<FMM\>\"", "]"}], "[", 
               "\"\<Header\>\"", "]"}], "[", "\"\<Transform\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\"\<None\>\"", "|", "None"}], ")"}], "\[Rule]", 
              RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tx0", "===", "None"}], ",", "Identity", ",", 
          "\[IndentingNewLine]", "True", ",", "tx0"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"field", "=", 
          RowBox[{"eccen", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", "*", "angle"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ifieldAll", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"coords", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", "I", "}"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"itx", "=", 
          RowBox[{"InverseFunction", "[", "tx", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xy", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "[", "field", "]"}], ",", 
               RowBox[{"Im", "[", "field", "]"}]}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"bounds", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"id", "<>", "\"\<BoundaryMesh\>\""}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"id", ",", "iregions"}], "}"}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"near", "=", 
             RowBox[{"Association", "@", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"id", "\[Rule]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{"Pick", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "coords", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sign", "@", 
                    RowBox[{"SignedRegionDistance", "[", 
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"id", "<>", "\"\<BoundaryMesh\>\""}], "]"}], ",", 
                    "coords"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "\[Rule]", "idcs"}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"id", ",", "iregions"}], "}"}]}], "]"}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{"data", ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<Options\>\"", "\[Rule]", 
                RowBox[{"<|", 
                 RowBox[{"\"\<AffineTransform\>\"", "\[Rule]", "tx"}], 
                 "|>"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<CorticalMapToVisualField\>\"", "\[Rule]", 
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"datAndPost", "=", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], ",", "Identity"}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", "#1", "]"}]}], "]"}]}], "}"}], 
                    "]"}], ",", "Identity"}], "}"}], ",", 
                    "\[IndentingNewLine]", " ", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                    ",", "Identity"}], "}"}], ",", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "##", "}"}], "}"}], ",", "First"}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], 
                    ",", "#", ",", 
                    RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], ",", 
                    "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"VectorQ", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "#", "}"}], ",", "First"}], "}"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "Identity"}], "}"}]}], "]"}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dat", "=", 
                    RowBox[{"itx", "[", 
                    RowBox[{"datAndPost", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"post", "=", 
                    RowBox[{"datAndPost", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"post", "@", 
                    RowBox[{"ReIm", "@", 
                    RowBox[{"MeshRegionInterpolate", "[", 
                    RowBox[{"mesh", ",", "field", ",", "dat", ",", 
                    RowBox[{"Chop", "\[Rule]", "0.1"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SparseArray", "@", 
                    RowBox[{"post", "@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Boole", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"RegionMember", "[", 
                    RowBox[{"b", ",", "dat"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "bounds"}], "}"}]}], "]"}]}]}]}]}]}], 
                    "}"}]}], "]"}]}], "]"}]}]}]}], "|>"}]}], "]"}]}], "]"}]}],
         "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->\
"e12cd5a6-e823-422f-bda3-9b115d82dcce"]
}, Closed]],

Cell[CellGroupData[{

Cell["The models themselves", "Subsection",ExpressionUUID->"a27c6ea1-9b90-41fe-a611-b88e5d60e72b"],

Cell["\<\
This block defines how we import the models (LH or RH) from the $ModelRoot \
directory.\
\>", "Text",ExpressionUUID->"ce8ed4ac-c1d4-49eb-9e99-b635d7b8f517"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "RetinotopyModel", ",", "ToRetinotopyModel", ",", "Benson17Model", ",", 
     "SchiraModelRotated", ",", "SchiraModelUnrotated"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RetinotopyModel", "::", "usage"}], "=", 
    "\"\<RetinotopyModel[name, hemi] yields a retinotopy model object of the \
given name and for the given hemisphere.\nRetinotopyModel is also a keyword \
and option to SubjectData, SubjectMesh, SubjectMap, and similar; it specifies \
that either the \\\"Benson17\\\" (Automatic) or \\\"Schira\\\" model should \
be used.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RetinotopyModel", "[", 
       RowBox[{"name_", ",", 
        RowBox[{"hemi", ":", 
         RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dat", "=", 
          RowBox[{"Import", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FileNameJoin", "@", 
             RowBox[{"List", "[", 
              RowBox[{"$ModelRoot", ",", 
               RowBox[{"ToLowerCase", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<.\>\"", "<>",
                  "name", "<>", "\"\<.fmm.gz\>\""}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<GZIP\>\"", ",", "\"\<FMM\>\""}], "}"}]}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"regs", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Association", "@", 
                RowBox[{"Thread", "[", 
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"Range", "@", 
                   RowBox[{"Length", "[", "#", "]"}]}]}], "]"}]}], "&"}], "[", 
              RowBox[{
               RowBox[{"dat", "[", "\"\<Header\>\"", "]"}], "[", 
               "\"\<AreaNames\>\"", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"mapPts", "=", 
             RowBox[{
              RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"vfPts", "=", 
             RowBox[{
              RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2", ",", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"lbls", "=", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"dat", "[", "\"\<Points\>\"", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"regNames", "=", 
              RowBox[{"Association", "[", 
               RowBox[{"Reverse", "/@", 
                RowBox[{"Normal", "[", "regs", "]"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FMMFunctions", "@", 
             RowBox[{"Association", "@", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"MeshRegion", "[", 
                  RowBox[{"mapPts", ",", 
                   RowBox[{"Triangle", "/@", 
                    RowBox[{"dat", "[", "\"\<Triangles\>\"", "]"}]}]}], "]"}],
                  "//", 
                 RowBox[{"Function", "@", 
                  RowBox[{"List", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\"\<Mesh\>\"", "\[Rule]", "#"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<BoundaryMesh\>\"", "\[Rule]", 
                    RowBox[{"BoundaryMesh", "[", "#", "]"}]}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
                   RowBox[{"vfPts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
                   RowBox[{"vfPts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "mapPts"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<VisualArea\>\"", "\[Rule]", "lbls"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<VisualAreaKey\>\"", "\[Rule]", "regs"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<VisualAreaNames\>\"", "\[Rule]", "regNames"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<FMM\>\"", "\[Rule]", "dat"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"regNames", ",", "k"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "Nothing", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"regNames", "[", "k", "]"}], "<>", 
                    "\"\<BoundaryMesh\>\""}], ")"}], "\[Rule]", 
                    RowBox[{"BoundaryMesh", "@", 
                    RowBox[{"MeshRegion", "[", "\[IndentingNewLine]", 
                    RowBox[{"mapPts", ",", "\[IndentingNewLine]", 
                    RowBox[{"Triangle", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"dat", "[", "\"\<Triangles\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"lbls", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "k"}], "]"}], 
                    "&"}]}], "]"}]}]}], "]"}]}]}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"Union", "[", "lbls", "]"}]}], "}"}]}], "]"}]}], 
               "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Benson17Model", "[", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
      RowBox[{"RetinotopyModel", "[", 
       RowBox[{"\"\<Benson17\>\"", ",", "hemi"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SchiraModelRotated", "[", "LH", "]"}], ":=", 
      RowBox[{"SchiraModel", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SchiraModelRotated", "[", "RH", "]"}], ":=", 
      RowBox[{"SchiraModel", "[", 
       RowBox[{"Scale", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
          "$DefaultSchiraScale"}], ")"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SchiraModelUnrotated", "[", "LH", "]"}], ":=", 
      RowBox[{"SchiraModel", "[", 
       RowBox[{"\[CapitalPsi]", "\[Rule]", "0"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SchiraModelUnrotated", "[", "RH", "]"}], ":=", 
      RowBox[{"SchiraModel", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "\[Rule]", "0"}], ",", 
        RowBox[{"Scale", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
           "$DefaultSchiraScale"}], ")"}]}]}], "]"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToRetinotopyModel", "[", 
    RowBox[{
     RowBox[{"mdl_String", "/;", 
      RowBox[{"!", 
       RowBox[{"StringStartsQ", "[", 
        RowBox[{
         RowBox[{"ToLowerCase", "[", "mdl", "]"}], ",", "\"\<schira\>\""}], 
        "]"}]}]}], ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyModel", "[", 
    RowBox[{"mdl", ",", "hemi"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToRetinotopyModel", "[", 
    RowBox[{"\"\<Schira\>\"", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"SchiraModelRotated", "[", "hemi", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToRetinotopyModel", "[", 
    RowBox[{
     RowBox[{"\"\<SchiraUnrotated\>\"", "|", "\"\<Schira*\>\""}], ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"SchiraModelUnrotated", "[", "hemi", "]"}]}], ";"}]}], "Input",Expr\
essionUUID->"39aa1918-a59f-4b5b-b8a7-c0c24519db44"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ModelVisualAreas", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", 
    RowBox[{"mdl_", "?", "AssociationQ"}], "]"}], ":=", 
   RowBox[{"mdl", "[", "\"\<VisualAreaNames\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", "mdl_SchiraModelObject", "]"}], ":=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "\"\<V1\>\""}], ",", 
     RowBox[{"2", "\[Rule]", "\"\<V2\>\""}], ",", 
     RowBox[{"3", "\[Rule]", "\"\<V3\>\""}], ",", 
     RowBox[{"4", "\[Rule]", "\"\<xV4v\>\""}], ",", 
     RowBox[{"5", "\[Rule]", "\"\<xV4d\>\""}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", "\"\<Schira\>\"", "]"}], ":=", 
   RowBox[{"ModelVisualAreas", "[", 
    RowBox[{"SchiraModelUnrotated", "[", "LH", "]"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"ModelVisualAreas", "[", 
    RowBox[{
     RowBox[{"s_String", "/;", 
      RowBox[{
       RowBox[{"ToLowerCase", "[", "s", "]"}], "\[NotEqual]", 
       "\"\<schira\>\""}]}], ",", 
     RowBox[{"h", ":", "LH"}]}], "]"}], ":=", 
   RowBox[{"ModelVisualAreas", "@", 
    RowBox[{"RetinotopyModel", "[", 
     RowBox[{"s", ",", "h"}], "]"}]}]}], ";"}]}], "Input",ExpressionUUID->\
"5de752c6-62a1-4704-bfde-88b7dc238a43"]
}, Closed]],

Cell[CellGroupData[{

Cell["Model Lines/Plotting Functions", "Subsection",ExpressionUUID->"fbc2a41d-469f-448b-9286-648a1eea5195"],

Cell["These functions generate lines for use in figures.", "Text",ExpressionUUID->"e436b776-c0a4-468e-93e5-718058654fe8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"FMMIsoEccenLinePoints", ",", "FMMHVMLinePoints"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FMMIsoEccenLinePoints", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"VisualAreas", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FMMHVMLinePoints", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"VisualAreas", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FMMIsoEccenLinePoints", "[", 
    RowBox[{
     RowBox[{"mdl_", "?", "AssociationQ"}], ",", "ecc_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mesh", "=", 
        RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"angs", "=", 
        RowBox[{"mdl", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eccs", "=", 
        RowBox[{"mdl", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"lbls", "=", 
        RowBox[{"mdl", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"vas", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"All", "|", "Full"}], "\[RuleDelayed]", 
             RowBox[{"Union", "[", 
              RowBox[{"mdl", "[", "\"\<VisualArea\>\"", "]"}], "]"}]}]}], 
           "}"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Fs", "=", 
         RowBox[{
          RowBox[{"MeshCells", "[", 
           RowBox[{"mesh", ",", "2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Es", "=", 
            RowBox[{
             RowBox[{"Union", "@*", 
              RowBox[{"Map", "[", "Sort", "]"}], "@*", "Join"}], "@@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Fs", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "ii"}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"inqs", "=", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"Unitize", "@*", "Times"}], "@@", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sign", "[", 
                 RowBox[{"lbls", "-", "va"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"va", ",", "vas"}], "}"}]}], "]"}]}]}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ee", "=", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Pick", "[", "\[IndentingNewLine]", 
                RowBox[{"Es", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"inqs", "[", 
                   RowBox[{"[", 
                    RowBox[{"Es", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                  "*", 
                  RowBox[{"inqs", "[", 
                   RowBox[{"[", 
                    RowBox[{"Es", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
                  "*", 
                  RowBox[{"Sign", "[", 
                   RowBox[{
                    RowBox[{"eccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"Es", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    "-", "ecc"}], "]"}], "*", 
                  RowBox[{"Sign", "[", 
                   RowBox[{
                    RowBox[{"eccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"Es", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
                    "-", "ecc"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"X", "=", 
              RowBox[{"MeshCoordinates", "[", "mesh", "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Mean", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"ee", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"ee", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
            "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FMMHVMLinePoints", "[", 
    RowBox[{
     RowBox[{"mdl_", "?", "AssociationQ"}], ",", 
     RowBox[{"maxEcc_:", "12"}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ang", "=", 
        RowBox[{"Sign", "@", 
         RowBox[{"mdl", "[", "\"\<PolarAngle\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ecc", "=", 
        RowBox[{"Clip", "[", 
         RowBox[{
          RowBox[{"Sign", "[", 
           RowBox[{"maxEcc", "-", 
            RowBox[{"mdl", "[", "\"\<Eccentricity\>\"", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"lbl", "=", 
        RowBox[{"1", "-", 
         RowBox[{"Times", "@@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Unitize", "[", 
             RowBox[{
              RowBox[{"mdl", "[", "\"\<VisualArea\>\"", "]"}], "-", "va"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"va", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Automatic", "|", "123", "|", "\"\<V123\>\""}], 
                   "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
                  RowBox[{"i_Integer", "\[RuleDelayed]", 
                   RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
           "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"MeshCoordinates", "@", 
         RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"es", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"MeshCells", "[", 
           RowBox[{
            RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"eangs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ang", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "es"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"eeccs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ecc", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "es"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"elbls", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"lbl", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "es"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "es"}], "]"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ii", "=", 
           RowBox[{"Indices", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sign", "@", 
              RowBox[{"Times", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"eeccs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"eeccs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"elbls", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"elbls", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"eangs", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "*", 
                 RowBox[{"eangs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "1"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "First"}], "]"}]}], "]"}]}],
       "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"e7505a84-4962-4093-\
b645-743165b9b1bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "V123FigLines", ",", "V123FigBoundary", ",", "FigToVisualFieldFn", ",", 
     "VisualFieldFnToV123FigFn", ",", "V123FigLinesFMM", ",", 
     "V123FigLinesSchira", ",", "V123FigBoundaryFMM", ",", 
     "V123FigBoundarySchira"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigLines", "::", "usage"}], "=", 
   "\"\<V123FigLines[maxEccentricity] yields a Graphics object of the lines \
for a typical plot of V1-V3 on a model schematic.\n\nOptions:\n  * \
RetinotopyModel (default: \\\"Benson17\\\") specifies the model of retinotopy \
to use; may be an instance of a SchiraModel, an association specifying a Flat \
Mesh Model (FMM), or one of the following strings: \\\"Schira\\\", the Schira \
model instance in $SchiraModel; \\\"Benson17\\\", the FMM stored in \
$Benson17Model.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V123FigLines", "::", "badmdl"}], "=", 
    "\"\<Unrecognized RetinotopyModel argument: `1`\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigLines", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Benson17\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigBoundary", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigLines", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "VisualFieldFnToV123FigFn", "]"}], "=", 
    RowBox[{"Options", "[", "V123FigLines", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"V123FigLinesFMM", "[", 
       RowBox[{"maxEcc_", ",", "mdl_"}], "]"}], ":=", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vbs", "=", 
           RowBox[{"mdl", "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<V1BoundaryMesh\>\"", ",", "\"\<V2BoundaryMesh\>\"", ",", 
              "\"\<V3BoundaryMesh\>\""}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ecc", "=", 
           RowBox[{"mdl", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"msh", "=", 
           RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"outer", "=", 
             RowBox[{"ConvexHullMesh", "@", 
              RowBox[{"Pick", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Sign", "[", 
                 RowBox[{"ecc", "-", "maxEcc"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"0", "|", 
                 RowBox[{"-", "1"}]}]}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"iidcs", "=", 
             RowBox[{"Pick", "[", 
              RowBox[{
               RowBox[{"Range", "@", 
                RowBox[{"Length", "[", "ecc", "]"}]}], ",", 
               RowBox[{"Sign", "[", 
                RowBox[{"ecc", "-", "maxEcc"}], "]"}], ",", 
               RowBox[{"0", "|", 
                RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"X", "=", 
             RowBox[{"MeshCoordinates", "[", "msh", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"v1b", "=", 
             RowBox[{"vbs", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"v2b", "=", 
             RowBox[{"RegionUnion", "[", 
              RowBox[{
               RowBox[{"vbs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"vbs", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"v3b", "=", 
             RowBox[{"RegionUnion", "@@", "vbs"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hulls", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ConvexHullMesh", "[", 
                   RowBox[{"X", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Pick", "[", "\[IndentingNewLine]", 
                  RowBox[{"iidcs", ",", "\[IndentingNewLine]", 
                   RowBox[{"Sign", "@", 
                    RowBox[{"SignedRegionDistance", "[", 
                    RowBox[{"reg", ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"[", "iidcs", "]"}], "]"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"reg", ",", 
                  RowBox[{"{", 
                   RowBox[{"v1b", ",", "v2b", ",", "v3b"}], "}"}]}], "}"}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Join", "@@", 
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", "=", 
                    RowBox[{"MeshCoordinates", "[", "#", "]"}]}], "}"}], ",", 
                  
                  RowBox[{
                   RowBox[{"MeshCells", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "/.", 
                   RowBox[{
                    RowBox[{"Line", "[", "i_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"Line", "[", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], "&"}],
                ",", "\[IndentingNewLine]", "hulls"}], "]"}]}]}], "]"}]}], 
         "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V123FigLinesSchira", "[", 
       RowBox[{"maxEcc_", ",", "mdl_"}], "]"}], ":=", 
      RowBox[{"Cases", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"SchiraLinePlot", "[", "\[IndentingNewLine]", 
          RowBox[{"mdl", ",", "\[IndentingNewLine]", 
           RowBox[{"Range", "\[Rule]", "maxEcc"}], ",", "\[IndentingNewLine]", 
           RowBox[{"EccentricityLines", "\[Rule]", 
            RowBox[{"{", "maxEcc", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PolarAngleLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "90", ",", "180"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Line", "[", "___", "]"}], ",", "\[IndentingNewLine]", 
        "Infinity"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V123FigBoundarySchira", "[", 
       RowBox[{"maxEcc_", ",", "mdl_SchiraModelObject"}], "]"}], ":=", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"boundLines", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Cases", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"SchiraLinePlot", "[", "\[IndentingNewLine]", 
                RowBox[{"mdl", ",", "\[IndentingNewLine]", 
                 RowBox[{"Range", "\[Rule]", "maxEcc"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"EccentricityLines", "\[Rule]", 
                  RowBox[{"lns", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PolarAngleLines", "\[Rule]", 
                  RowBox[{"lns", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"VisualAreas", "\[Rule]", 
                  RowBox[{"lns", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Line", "[", "___", "]"}], ",", "\[IndentingNewLine]", 
              "\[Infinity]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"lns", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "maxEcc", "}"}], ",", "None", ",", 
                  "Automatic"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", 
                  RowBox[{"{", "0", "}"}], ",", 
                  RowBox[{"-", "3"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"None", ",", 
                  RowBox[{"{", "180", "}"}], ",", "3"}], "}"}]}], "}"}]}], 
             "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"path", "=", 
            RowBox[{"Join", "@@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"First", "@", 
                    RowBox[{"FindCurvePath", "[", "#", "]"}]}]}], "]"}], 
                 "&"}], "@", 
                RowBox[{"Cases", "[", 
                 RowBox[{"l", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x_", "?", "NumericQ"}], ",", 
                    RowBox[{"y_", "?", "NumericQ"}]}], "}"}], ",", 
                  "Infinity"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"l", ",", "boundLines"}], "}"}]}], "]"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"BoundaryMeshRegion", "[", 
           RowBox[{"path", ",", 
            RowBox[{"Line", "@", 
             RowBox[{"First", "@", 
              RowBox[{"FindCurvePath", "[", "path", "]"}]}]}]}], "]"}]}], 
         "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V123FigBoundaryFMM", "[", 
       RowBox[{"maxEcc_", ",", 
        RowBox[{"mdl", ":", 
         RowBox[{"Except", "[", "_SchiraModelObject", "]"}]}]}], "]"}], ":=", 
      
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ConvexHullMesh", "@*", "Union", "@*", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "&"}], "@*", "Join"}], 
       "@@", 
       RowBox[{"V123FigLines", "[", "maxEcc", "]"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigLines", "[", 
    RowBox[{
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", "maxEcc_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Automatic", "\[RuleDelayed]", 
        RowBox[{"V123FigLinesFMM", "[", 
         RowBox[{"maxEcc", ",", 
          RowBox[{"Benson17Model", "[", "hemi", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Schira\>\"", "\[RuleDelayed]", 
        RowBox[{"V123FigLinesSchira", "[", 
         RowBox[{"maxEcc", ",", 
          RowBox[{"SchiraModelUnrotated", "[", "hemi", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"s_String", "\[RuleDelayed]", 
        RowBox[{"V123FigLinesFMM", "[", 
         RowBox[{"maxEcc", ",", 
          RowBox[{"RetinotopyModel", "[", 
           RowBox[{"s", ",", "hemi"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"mdl_SchiraModelObject", "\[RuleDelayed]", 
        RowBox[{"V123FigLinesSchira", "[", 
         RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"mdl_", "?", "AssociationQ"}], "\[RuleDelayed]", 
        RowBox[{"V123FigLinesFMM", "[", 
         RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"mdl_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"V123FigLines", "::", "badmdl"}], ",", "mdl"}], "]"}]}]}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V123FigBoundary", "[", 
     RowBox[{
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "maxEcc_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Automatic", "\[RuleDelayed]", 
         RowBox[{"V123FigBoundaryFMM", "[", 
          RowBox[{"maxEcc", ",", 
           RowBox[{"Benson17Model", "[", "hemi", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Schira\>\"", "\[RuleDelayed]", 
         RowBox[{"V123FigBoundarySchira", "[", 
          RowBox[{"maxEcc", ",", 
           RowBox[{"SchiraModelUnrotated", "[", "hemi", "]"}]}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"s_String", "\[RuleDelayed]", 
         RowBox[{"V123FigBoundaryFMM", "[", 
          RowBox[{"maxEcc", ",", 
           RowBox[{"RetinotopyModel", "[", 
            RowBox[{"s", ",", "hemi"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"mdl_SchiraModelObject", "\[RuleDelayed]", 
         RowBox[{"V123FigBoundarySchira", "[", 
          RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mdl_", "?", "AssociationQ"}], "\[RuleDelayed]", 
         RowBox[{"V123FigBoundaryFMM", "[", 
          RowBox[{"maxEcc", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"mdl_", "\[RuleDelayed]", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"V123FigLines", "::", "badmdl"}], ",", "mdl"}], "]"}]}]}], 
       "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigToVisualFieldFn", "[", 
    RowBox[{
     RowBox[{"s_String", "/;", 
      RowBox[{"!", 
       RowBox[{"StringStartsQ", "[", 
        RowBox[{
         RowBox[{"ToLowerCase", "[", "s", "]"}], ",", "\"\<schira\>\""}], 
        "]"}]}]}], ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RetinotopyModel", "[", 
     RowBox[{"s", ",", "hemi"}], "]"}], "[", 
    "\"\<CorticalMapToVisualField\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigToVisualFieldFn", "[", 
    RowBox[{
     RowBox[{
     "\"\<Schira\>\"", "|", "\"\<Schira*\>\"", "|", 
      "\"\<SchiraUnrotated\>\""}], ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"Function", "@", 
    RowBox[{"CorticalMapToVisualField", "[", 
     RowBox[{
      RowBox[{"SchiraModelUnrotated", "[", "hemi", "]"}], ",", "##"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigToVisualFieldFn", "[", 
    RowBox[{"\"\<SchiraRotated\>\"", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"Function", "@", 
    RowBox[{"CorticalMapToVisualField", "[", 
     RowBox[{
      RowBox[{"SchiraModelRotated", "[", "hemi", "]"}], ",", "##"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FigToVisualFieldFn", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
    RowBox[{"Function", "@", 
     RowBox[{"CorticalMapToVisualField", "[", 
      RowBox[{"x", ",", "##"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFnToV123FigFn", "[", 
    RowBox[{
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", "f_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"retmdl", "=", 
       RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fns", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ListQ", "[", "f", "]"}], ",", "f", ",", 
              RowBox[{"{", "f", "}"}]}], "]"}], ",", 
            RowBox[{"Length", "@", 
             RowBox[{"ModelVisualAreas", "[", "retmdl", "]"}]}], ",", 
            "None"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"frommap", "=", 
          RowBox[{"FigToVisualFieldFn", "[", 
           RowBox[{"retmdl", ",", "hemi"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "@", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"datPost", "=", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ListQ", "[", 
                  RowBox[{
                   RowBox[{"{", "##", "}"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{
                   RowBox[{"{", "##", "}"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", "##", "}"}], "]"}], ",", "Identity"}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"ListQ", "[", 
                 RowBox[{
                  RowBox[{"{", "##", "}"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", "#1", "]"}]}], "]"}]}], "}"}], 
                   "]"}], ",", "Identity"}], "}"}], " ", ",", 
                RowBox[{"ListQ", "[", 
                 RowBox[{
                  RowBox[{"{", "##", "}"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                  ",", "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
                "True", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", "##", "}"}], "}"}], ",", "First"}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"MatrixQ", "[", "#", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], 
                  ",", "#", ",", 
                  RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], ",", 
                "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"VectorQ", "[", "#", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", "First"}], "}"}], ",", "True", 
              ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "Identity"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"dat", "=", 
               RowBox[{"datPost", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"post", "=", 
               RowBox[{"datPost", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ptsAndAreas", "=", 
                RowBox[{"frommap", "[", "dat", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"pts", "=", 
                   RowBox[{"ptsAndAreas", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"areas", "=", 
                   RowBox[{"1", "+", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"ptsAndAreas", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Missing", "[", "_", "]"}], "\[RuleDelayed]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_Integer", "/;", 
                    RowBox[{
                    RowBox[{"0", "<", "x", "\[LessEqual]", 
                    RowBox[{"Length", "[", "fns", "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"fns", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "=!=", "None"}]}]}], 
                    "}"}], "\[RuleDelayed]", "x"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"_", "\[Rule]", "0"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"fs", "=", 
                   RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "===", "None"}], ",", 
                    RowBox[{"Indeterminate", "&"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indeterminate", "&"}]}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"post", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fs", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], "[", "#2", "]"}], "&"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"areas", ",", "pts"}], "}"}]}], "]"}]}]}], 
               "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"c366d373-00f1-4167-8f0f-90a4efc4c873"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["The Subjects", "Section",ExpressionUUID->"a3ef7226-5bd7-48e3-af8d-243257829892"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Subjects", ",", "$SubjectDatasets"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Subjects", ":=", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"$RetinotopyRoot", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<S1201\>\"", ",", "\"\<S1202\>\"", ",", "\"\<S1203\>\"", ",", 
          "\"\<S1204\>\"", ",", "\"\<S1205\>\"", ",", "\"\<S1206\>\"", ",", 
          "\"\<S1207\>\"", ",", "\"\<S1208\>\""}], "}"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"FileNames", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$RetinotopyRoot", ",", "\"\<S*\>\""}], "}"}], "]"}]}], 
       "*)"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$SubjectDatasets", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "\[Rule]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fs", "=", 
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FileNames", "@", 
                RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                  "$RetinotopyRoot", ",", "sub", ",", 
                   "\"\<lh_*_angle.mgz\>\""}], "}"}], "]"}]}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Union", "@", 
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "5"}], "}"}]}], "]"}], "&"}], "/@", 
              "fs"}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"sub", ",", "$Subjects"}], "}"}]}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"5ff26971-3209-4f3e-8c32-e91e88bdfb1e"],

Cell["\<\
Simple function to return the fraction of total scans that went into a \
particular dataset.\
\>", "Text",ExpressionUUID->"7aee201c-f5b6-425c-80dd-928ef35241db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SubjectScanCount", ",", "SubjectDatasetCoverage"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectScanCount", "[", "sub_", "]"}], ":=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"StringTake", "[", 
     RowBox[{"sub", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectDatasetCoverage", "[", 
    RowBox[{"sub_", ",", "99"}], "]"}], "=", "12"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectDatasetCoverage", "[", 
    RowBox[{"sub_", ",", "ds_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"scans", "=", 
        RowBox[{"SubjectScanCount", "[", "sub", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fnm", "=", 
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "@", 
          RowBox[{"First", "@", 
           RowBox[{"FileNames", "@", 
            RowBox[{"FileNameJoin", "@", 
             RowBox[{"List", "[", "\[IndentingNewLine]", 
              RowBox[{
              "$RetinotopyRoot", ",", "sub", ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<lh_\>\"", "<>", 
                RowBox[{"IntegerString", "[", 
                 RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                "\"\<:*_angle.mgz\>\""}]}], "]"}]}]}]}]}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"StringTake", "[", 
       RowBox[{"fnm", ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "8"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"15acbdbd-b790-48fc-beab-ad6e33a7be9e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading Benson14 group-average data", "Section",ExpressionUUID->"915cc7ed-f753-4751-b2b2-06aef3e4794d"],

Cell[CellGroupData[{

Cell["Load the raw data into nice data structures", "Subsection",ExpressionUUID->"15c6cef9-af7a-43ae-837c-e0f1c8237e9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "Benson14Data", ",", "Benson14AnalysesData", ",", 
    "Benson14RetinotopyData"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Benson14AnalysesData", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RetinotopyModel", "\[Rule]", "None"}], ",", 
     RowBox[{"MaxSteps", "\[Rule]", "2500"}], ",", 
     RowBox[{"Scale", "\[Rule]", "20.0"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Benson14Data", "]"}], "=", 
   RowBox[{"Options", "[", "Benson14AnalysesData", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Benson14RetinotopyData", "[", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
     RowBox[{"Association", "[", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"#2", "\[Rule]", 
          RowBox[{"Import", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "$RetinotopyRoot", ",", "\"\<fsaverage\>\"", ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ToLowerCase", "[", 
                 RowBox[{"ToString", "[", "hemi", "]"}], "]"}], "<>", 
                "\"\<_\>\"", "<>", "#1", "<>", "\"\<.mgz\>\""}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
         "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<vexpl\>\"", ",", 
            "\"\<prfsz\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<VarianceExplained\>\"", ",", "\"\<PRFSize\>\""}], "}"}]}], 
         "}"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Benson14AnalysesData", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mdlString", "=", 
          RowBox[{"ToLowerCase", "[", "\[IndentingNewLine]", 
           RowBox[{"Replace", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Automatic", "|", "None", "|", "\"\<Benson17\>\""}], 
                "\[Rule]", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
               RowBox[{"s_String", "\[RuleDelayed]", 
                RowBox[{
                 RowBox[{"ToLowerCase", "[", "s", "]"}], "<>", 
                 "\"\<_\>\""}]}]}], "}"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"steps", "=", 
          RowBox[{"OptionValue", "[", "MaxSteps", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"scale", "=", 
          RowBox[{"OptionValue", "[", "Scale", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tag", "=", 
           RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"mdlString", ",", "\"\<steps=\>\"", ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{"steps", ",", "10", ",", "5"}], "]"}], ",", 
              "\"\<_scale=\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"scale", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2"}], "}"}], ",", 
                 RowBox[{"NumberPadding", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              "\"\<_clip=12_prior=retinotopy\>\""}], "}"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Append", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "[", "\[IndentingNewLine]", 
               RowBox[{"#2", "\[Rule]", 
                RowBox[{"Import", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    "$AnalysesRoot", ",", "\"\<fsaverage\>\"", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "[", 
                    RowBox[{"ToString", "[", "hemi", "]"}], "]"}], ",", 
                    "\"\<.01.\>\"", ",", "#1", ",", "\"\<_\>\"", ",", "tag", 
                    ",", "\"\<.mgz\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                 "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<varea\>\"", 
                  ",", "\"\<sigma\>\""}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                  "\"\<VisualArea\>\"", ",", "\"\<PRFSize\>\""}], "}"}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<Registration\>\"", "\[Rule]", 
             RowBox[{"VertexCoordinates", "@", 
              RowBox[{"Import", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                  "$AnalysesRoot", ",", "\"\<fsaverage\>\"", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ToLowerCase", "[", 
                    RowBox[{"ToString", "[", "hemi", "]"}], "]"}], "<>", 
                    "\"\<.01.retinotopy_\>\"", "<>", "tag", "<>", 
                    "\"\<.sphere.reg\>\""}]}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", "\"\<FreeSurferSurface\>\""}], 
               "]"}]}]}]}], "]"}]}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Benson14Data", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rdata", "=", 
          RowBox[{"Benson14RetinotopyData", "[", "hemi", "]"}]}], ",", 
         RowBox[{"adata", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"Benson14AnalysesData", "[", "hemi", "]"}], ",", "opts"}],
            "]"}]}]}], "}"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{"rdata", ",", 
         RowBox[{"Association", "[", 
          RowBox[{"KeyValueMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\"\<Predicted\>\"", "<>", "#1"}], "\[Rule]", "#2"}], 
             "&"}], ",", "adata"}], "]"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}],
   ";"}]}], "Input",ExpressionUUID->"bd46d951-0891-4679-b5ce-5eb6b217feb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Apply the data to meshes and maps", "Subsection",ExpressionUUID->"c78ba169-4b66-4674-b3d5-e147155f8224"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "MapTemplate", ",", "MiniMapTemplate", ",", "MiniMapCenter", ",", 
     "$MiniMapRadius", ",", "ToMap", ",", "ToMiniMap"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"These", " ", "used", " ", "to", " ", "be", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[PlusMinus]", "18"}], ",", " ", "12"}], "}"}], " ", "but", 
     " ", "I", " ", "re"}], "-", 
    RowBox[{"centered", " ", "them", " ", "on", " ", "the", " ", "V123"}], 
    "-", 
    RowBox[{"model", " ", "to", " ", "10", "\[Degree]", " ", 
     RowBox[{"eccen", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MiniMapCenter", "[", "LH", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"18", ",", "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MiniMapCenter", "[", "RH", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "18"}], ",", "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$MiniMapRadius", "=", "50"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MapTemplate", "[", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"CorticalMapQ", "[", "#", "]"}]}], ",", "$Failed", ",", 
          "#"}], "]"}], "&"}], "@", 
       RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"$FreeSurferSubjects", "[", "\"\<fsaverage\>\"", "]"}], 
           ",", "hemi", ",", "\"\<Sphere\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"RetinotopyModel", "[", 
                RowBox[{"\"\<Benson17\>\"", ",", "hemi"}], "]"}], "[", 
               "\"\<FMM\>\"", "]"}], "[", "\"\<Header\>\"", "]"}], "[", 
             "\"\<Center\>\"", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"RetinotopyModel", "[", 
                RowBox[{"\"\<Benson17\>\"", ",", "hemi"}], "]"}], "[", 
               "\"\<FMM\>\"", "]"}], "[", "\"\<Header\>\"", "]"}], "[", 
             "\"\<OnXAxis\>\"", "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"Method", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Radius", "\[Rule]", 
          RowBox[{"Quantity", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Pi", "/", "2.5"}], "]"}], ",", "\"\<Radians\>\""}], 
           "]"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MiniMapTemplate", "[", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mesh", "=", 
          RowBox[{"\"\<SphericalMesh\>\"", "/.", 
           RowBox[{"Options", "[", 
            RowBox[{
             RowBox[{"MapTemplate", "[", "hemi", "]"}], ",", 
             "MetaInformation"}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"CorticalMapQ", "[", "#", "]"}]}], ",", "$Failed", ",", 
            "#"}], "]"}], "&"}], "@", 
         RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
          RowBox[{"mesh", ",", "\[IndentingNewLine]", 
           RowBox[{"Center", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{
              RowBox[{"MapTemplate", "[", "hemi", "]"}], ",", "Center"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{
              RowBox[{"MapTemplate", "[", "hemi", "]"}], ",", "Method"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Radius", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{
              RowBox[{"MapTemplate", "[", "hemi", "]"}], ",", "Radius"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Exclusions", "\[Rule]", 
            RowBox[{"Complement", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"VertexList", "[", "mesh", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"SelectVertices", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"MapTemplate", "[", "hemi", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{"#VertexCoordinates", "-", 
                    RowBox[{"MiniMapCenter", "[", "hemi", "]"}]}], "]"}], "<",
                   "$MiniMapRadius"}], "&"}]}], "]"}]}], "]"}]}]}], "]"}]}]}],
        "]"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToMap", "[", 
    RowBox[{"mesh_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}], ":", "LH"}], ",", 
     RowBox[{"tmpl", ":", 
      RowBox[{"Except", "[", "MiniMapTemplate", "]"}], ":", "MapTemplate"}]}],
     "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"template", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"CorticalMapQ", "[", "tmpl", "]"}], ",", "tmpl", ",", 
         RowBox[{"tmpl", "[", "hemi", "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\"\<fsaverage\>\"", "\[Equal]", 
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "@", 
          RowBox[{"Path", "[", 
           RowBox[{"\"\<Subject\>\"", "/.", 
            RowBox[{"MetaInformation", "[", "mesh", "]"}]}], "]"}]}]}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
          RowBox[{"template", ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"u", "=", 
               RowBox[{"VertexList", "[", "template", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"p", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "/.", "mesh"}], ")"}], "[", 
                  RowBox[{"[", "u", "]"}], "]"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"p", ",", 
                 RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"VertexPropertyList", "[", "mesh", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Except", "[", 
                    RowBox[{
                    "\"\<VertexIndex\>\"", "|", "\"\<VertexCoordinates\>\"", 
                    "|", "\"\<VertexNormals\>\""}], "]"}]}], "]"}]}], "}"}]}],
               "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"MetaInformation", "\[Rule]", 
          RowBox[{"MetaInformation", "[", "mesh", "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
        RowBox[{"mesh", ",", "\[IndentingNewLine]", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"Options", "[", 
           RowBox[{"template", ",", "Center"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"Options", "[", 
           RowBox[{"template", ",", "Method"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Radius", "\[Rule]", 
          RowBox[{"Options", "[", 
           RowBox[{"template", ",", "Radius"}], "]"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToMap", "[", 
     RowBox[{"mesh_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}], ":", "LH"}], ",", 
      RowBox[{"tmpl", ":", "MiniMapTemplate"}]}], "]"}], ":=", 
    RowBox[{"ToMiniMap", "[", 
     RowBox[{"mesh", ",", "hemi"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToMiniMap", "[", 
    RowBox[{"mesh_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}], ":", "LH"}]}], "]"}], ":=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<fsaverage\>\"", "\[Equal]", 
      RowBox[{"Last", "@", 
       RowBox[{"FileNameSplit", "@", 
        RowBox[{"Path", "[", 
         RowBox[{"\"\<Subject\>\"", "/.", 
          RowBox[{"MetaInformation", "[", "mesh", "]"}]}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", "=", 
             RowBox[{"VertexList", "@", 
              RowBox[{"MiniMapTemplate", "[", "hemi", "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"p", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p", "/.", "mesh"}], ")"}], "[", 
                RowBox[{"[", "u", "]"}], "]"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p", ",", 
               RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"VertexPropertyList", "[", "mesh", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Except", "[", 
                  RowBox[{
                  "\"\<VertexIndex\>\"", "|", "\"\<VertexCoordinates\>\"", 
                   "|", "\"\<VertexNormals\>\""}], "]"}]}], "]"}]}], "}"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MetaInformation", "\[Rule]", 
        RowBox[{"MetaInformation", "[", "mesh", "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"map1", "=", 
         RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
          RowBox[{"mesh", ",", "\[IndentingNewLine]", 
           RowBox[{"Center", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{
              RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "Center"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{
              RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "Method"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Radius", "\[Rule]", 
            RowBox[{"Options", "[", 
             RowBox[{
              RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "Radius"}], 
             "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
        RowBox[{"mesh", ",", "\[IndentingNewLine]", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"Options", "[", 
           RowBox[{
            RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "Center"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"Options", "[", 
           RowBox[{
            RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "Method"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Radius", "\[Rule]", 
          RowBox[{"Options", "[", 
           RowBox[{
            RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "Radius"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Exclusions", "\[Rule]", 
          RowBox[{"Complement", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VertexList", "[", "mesh", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"SelectVertices", "[", "\[IndentingNewLine]", 
             RowBox[{"map1", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"#VertexCoordinates", "-", 
                  RowBox[{"MiniMapCenter", "[", "hemi", "]"}]}], "]"}], "<", 
                "$MiniMapRadius"}], "&"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"0ef92fd6-0de6-4743-\
94cc-8826659080ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Benson14Mesh", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Benson14Mesh", "]"}], "=", 
   RowBox[{"Options", "[", "Benson14Data", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Benson14Mesh", "[", 
     RowBox[{
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", 
      RowBox[{"surf", ":", 
       RowBox[{"Except", "[", "\"\<Retinotopy\>\"", "]"}], ":", 
       "\"\<Inflated\>\""}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdat", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"Benson14Data", "[", "hemi", "]"}], ",", "opts"}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"msh", "=", 
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"$FreeSurferSubjects", "[", "\"\<fsaverage\>\"", "]"}], 
           ",", "hemi", ",", "surf"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVertexProperties", "[", 
       RowBox[{"msh", ",", 
        RowBox[{"Normal", "[", "sdat", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"3b496899-6d5b-46a4-a600-084895a6757c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "Benson14Map", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "Benson14Map", "]"}], "=", 
    RowBox[{"Options", "[", "Benson14Mesh", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Benson14Map", "[", 
     RowBox[{
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}], ":", "LH"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mesh", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"Benson14Mesh", "[", 
           RowBox[{"hemi", ",", "\"\<Sphere\>\""}], "]"}], ",", "opts"}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"map0", "=", 
           RowBox[{"ToMap", "[", 
            RowBox[{"mesh", ",", "hemi"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"reg", "=", 
           RowBox[{"\"\<PredictedRegistration\>\"", "/.", "mesh"}]}]}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
         RowBox[{"map0", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<PredictedRegistration\>\"", "\[Rule]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x0", "=", 
               RowBox[{"VertexCoordinates", "@", 
                RowBox[{"Reproject", "[", 
                 RowBox[{"map0", ",", "reg"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"hemi", "===", "LH"}], ",", "x0", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
                 RowBox[{"Transpose", "[", "x0", "]"}]}], "]"}]}], "]"}]}], 
            "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",Expr\
essionUUID->"59cf4f16-8281-4b65-a299-1ab6693d35b4"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading Subject Data", "Section",ExpressionUUID->"0e3f1085-9dee-4227-a6d7-86441afe6954"],

Cell[CellGroupData[{

Cell["Load the raw data into data structures", "Subsection",ExpressionUUID->"110c9e12-9379-4f79-bcad-0c0a9113819d"],

Cell["\<\
These first cells are for constructing cortical magnification data out of the \
various retinotopy data.\
\>", "Text",ExpressionUUID->"dcdf2e91-6323-4ea1-ad56-e278b537d46a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "SubjectVisualFields", ",", "SubjectMagnificationFunction", ",", 
    "SubjectMagnification"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectVisualFields", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VisualAreas", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
       RowBox[{"MinValue", "\[Rule]", "0.1"}], ",", 
       RowBox[{"Range", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "15"}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "SubjectAnalysesData", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectMagnificationFunction", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectVisualFields", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Scale", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"1", "/", "3"}], ")"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectMagnification", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMagnificationFunction", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubjectVisualFields", "[", 
      RowBox[{"sub_", ",", "ds_", ",", 
       RowBox[{"type_String:", "\"\<\>\""}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"AssociationMap", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"WithOptions", "[", 
              RowBox[{
               RowBox[{"SubjectRetinotopyData", "[", 
                RowBox[{"sub", ",", "#", ",", "ds"}], "]"}], ",", "opts"}], 
              "]"}], "&"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LH", ",", "RH"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"anl", "=", 
          RowBox[{"AssociationMap", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"WithOptions", "[", 
              RowBox[{
               RowBox[{"SubjectAnalysesData", "[", 
                RowBox[{"sub", ",", "#", ",", "ds"}], "]"}], ",", "opts"}], 
              "]"}], "&"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LH", ",", "RH"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"wva", "=", 
          RowBox[{"Join", "@@", 
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\"\<WhiteVertexArea\>\"", "/.", 
                RowBox[{"Cortex", "[", 
                 RowBox[{
                  RowBox[{"Subject", "[", "sub", "]"}], ",", "#", ",", 
                  "\"\<Sphere\>\""}], "]"}]}], ")"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"LH", ",", "RH"}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"minw", "=", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "MinValue", "]"}], ",", 
            RowBox[{"Automatic", "\[Rule]", "0.1"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rng", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"areas", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"All", "|", "Full"}], "\[Rule]", 
               RowBox[{"Range", "[", "12", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"x_Integer", "\[RuleDelayed]", 
               RowBox[{"{", "x", "}"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"prop", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", "[", "LH", "]"}], "[", "#2", "]"}], ",", 
                RowBox[{
                 RowBox[{"#1", "[", "RH", "]"}], "[", "#2", "]"}]}], "]"}], 
              "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"dat", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"type", "\[Equal]", "\"\<\>\""}], ",", "ret", ",", 
              "anl"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ang", "=", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Pi", "/", "180"}], "*", 
                RowBox[{"(", 
                 RowBox[{"90", "-", 
                  RowBox[{"prop", "[", 
                   RowBox[{"dat", ",", "\"\<PolarAngle\>\""}], "]"}]}], 
                 ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ecc", "=", 
              RowBox[{"prop", "[", 
               RowBox[{"dat", ",", "\"\<Eccentricity\>\""}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"lbl", "=", 
              RowBox[{"prop", "[", 
               RowBox[{"anl", ",", "\"\<VisualArea\>\""}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"vxp", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"dat", "===", "ret"}], ",", "\[IndentingNewLine]", 
                RowBox[{"prop", "[", 
                 RowBox[{"ret", ",", "\"\<VarianceExplained\>\""}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Unitize", "@", 
                 RowBox[{"prop", "[", 
                  RowBox[{"anl", ",", "\"\<VisualArea\>\""}], "]"}]}]}], 
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "=", 
                RowBox[{"ecc", "*", 
                 RowBox[{"Cos", "[", "ang", "]"}]}]}], ",", 
               RowBox[{"y", "=", 
                RowBox[{"ecc", "*", 
                 RowBox[{"Sin", "[", "ang", "]"}]}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociationMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ii", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"vxp", "-", "minw"}], "]"}], ",", "1"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ecc", "-", 
                    RowBox[{"rng", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "1"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"rng", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "ecc"}], "]"}], ",", 
                    "1"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"lbl", ",", "#"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "@", 
                    RowBox[{"Chop", "[", "wva", "]"}]}], ",", "1"}], "]"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Nearest", "@", 
                   RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    RowBox[{"y", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}]}], "}"}], "]"}], 
                    "\[Rule]", 
                    RowBox[{"wva", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
               ",", "\[IndentingNewLine]", "areas"}], "]"}]}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectMagnificationFunction", "[", 
      RowBox[{"sub_", ",", "ds_", ",", 
       RowBox[{"type_String:", "\"\<\>\""}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vfs", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectVisualFields", "[", 
             RowBox[{"sub", ",", "ds", ",", "type"}], "]"}], ",", "opts"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"scale", "=", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Scale", "]"}], ",", 
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"1", "/", "3"}], ")"}]}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"vfs", ",", "#1"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rad", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Norm", "[", "#2", "]"}], "*", "scale"}], ",", 
                  "0.5"}], "}"}], "]"}]}], ",", 
              RowBox[{"vf", "=", 
               RowBox[{"vfs", "[", "#1", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Total", "@", 
               RowBox[{"vf", "[", 
                RowBox[{"#2", ",", 
                 RowBox[{"{", 
                  RowBox[{"Infinity", ",", "rad"}], "}"}]}], "]"}]}], ")"}], 
             "/", 
             RowBox[{"(", 
              RowBox[{"Pi", "*", 
               RowBox[{
                RowBox[{"(", "rad", ")"}], "^", "2"}]}], ")"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", "0"}], "]"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectMagnification", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_", ",", 
       RowBox[{"type_String:", "\"\<\>\""}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rng", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"areas", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"All", "|", "Full"}], "\[Rule]", 
               RowBox[{"Range", "[", "12", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"x_Integer", "\[RuleDelayed]", 
               RowBox[{"{", "x", "}"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<cmag\>\"", ",", 
            RowBox[{"sub", "<>", "\"\<_\>\"", "<>", 
             RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<_\>\"", "<>", 
             
             RowBox[{"ToString", "[", "ds", "]"}], "<>", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"type", "\[Equal]", "\"\<\>\""}], ",", "\"\<\>\"", ",", 
               RowBox[{"\"\<_\>\"", "<>", "type"}]}], "]"}]}]}], "}"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ret", "=", 
              RowBox[{"WithOptions", "[", 
               RowBox[{
                RowBox[{"SubjectRetinotopyData", "[", 
                 RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"anl", "=", 
              RowBox[{"WithOptions", "[", 
               RowBox[{
                RowBox[{"SubjectAnalysesData", "[", 
                 RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"f", "=", 
              RowBox[{"WithOptions", "[", 
               RowBox[{
                RowBox[{"SubjectMagnificationFunction", "[", 
                 RowBox[{"sub", ",", "ds", ",", "type"}], "]"}], ",", 
                "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ang", "=", 
                RowBox[{
                 RowBox[{"Pi", "/", "180"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"90", "-", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"type", "\[Equal]", "\"\<\>\""}], ",", "ret", ",",
                     "anl"}], "]"}], "[", "\"\<PolarAngle\>\"", "]"}]}], 
                  ")"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"ecc", "=", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"type", "\[Equal]", "\"\<\>\""}], ",", "ret", ",", 
                   "anl"}], "]"}], "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"lbl", "=", 
                RowBox[{"anl", "[", "\"\<VisualArea\>\"", "]"}]}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ii", "=", 
                 RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", "#"}], "]"}], "&"}], "/@", "lbl"}], 
                    ",", "True"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ecc", "-", 
                    RowBox[{"rng", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "1"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"rng", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "ecc"}], "]"}], ",", 
                    "1"}], "]"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x", "=", 
                    RowBox[{"ecc", "*", 
                    RowBox[{"Cos", "[", "ang", "]"}]}]}], ",", 
                   RowBox[{"y", "=", 
                    RowBox[{"ecc", "*", 
                    RowBox[{"Sin", "[", "ang", "]"}]}]}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"mag", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lbl", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}]}], "}"}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "ecc", "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"ii", "\[Rule]", "mag"}], "]"}]}], "]"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"380027be-e9a6-46a6-\
b46d-cd3050269425"],

Cell["\<\
These cells just import the mgz files in the analyses directory and organize \
them into a convenient data structure.\
\>", "Text",ExpressionUUID->"aae2ec8b-88aa-4b72-a71e-7cb3f1a79a36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "SubjectRetinotopyData", ",", "SubjectAnalysesData", ",", 
     "SubjectBenson14Data", ",", "SubjectBenson17Data", ",", "SubjectData", 
     ",", "SubjectWideFieldRetinotopyData"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectAnalysesData", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Benson17\>\""}], ",", 
     RowBox[{"Clip", "\[Rule]", "12"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SubjectData", "]"}], "=", 
    RowBox[{"Options", "[", "SubjectAnalysesData", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubjectRetinotopyData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ds", "\[Equal]", "99"}], ",", "\[IndentingNewLine]", 
               RowBox[{"FileNameJoin", "[", 
                RowBox[{"{", 
                 RowBox[{"$RetinotopyRoot", ",", "sub", ",", 
                  RowBox[{
                   RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
                   "\"\<_\>\"", "<>", "#1", "<>", "\"\<.mgz\>\""}]}], "}"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"First", "@", 
                RowBox[{"FileNames", "@", 
                 RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                   "$RetinotopyRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"StringJoin", "@", 
                    RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                    "\"\<:*\>\""}], ",", 
                    RowBox[{"#1", "<>", "\"\<.mgz\>\""}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\"\<_\>\""}], "]"}]}]}], "}"}], 
                  "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<prfsz\>\"", ",", 
            "\"\<vexpl\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<PRFSize\>\"", ",", "\"\<VarianceExplained\>\""}], "}"}]}], 
         "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectWideFieldRetinotopyData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"path", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"$RetinotopyRoot", ",", "sub"}], "}"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", "\"\<lh_widef_angle.mgz\>\""}], "}"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "@", 
             RowBox[{"Rule", "[", "\[IndentingNewLine]", 
              RowBox[{"#2", ",", "\[IndentingNewLine]", 
               RowBox[{"Import", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"FileNames", "@", 
                   RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"path", ",", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
                    "\"\<_widef_\>\"", "<>", "#1", "<>", "\"\<.mgz\>\""}]}], 
                    "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<prfsz\>\"", 
                ",", "\"\<vexpl\>\""}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<WidePolarAngle\>\"", ",", "\"\<WideEccentricity\>\"", 
                ",", "\"\<WidePRFSize\>\"", ",", 
                "\"\<WideVarianceExplained\>\""}], "}"}]}], "}"}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"<|", "|>"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectAnalysesData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mdlName", "=", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
            RowBox[{
             RowBox[{"Automatic", "|", "None"}], "\[Rule]", 
             "\"\<Benson17\>\""}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"clipString", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Clip", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k_Integer", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"\"\<_clip=\>\"", "<>", 
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"k", ",", "10", ",", "2"}], "]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"None", "|", "Automatic"}], "\[Rule]", 
               "\"\<_clip=12\>\""}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mdlString", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToLowerCase", "[", "mdlName", "]"}], "\[Equal]", 
              "\"\<benson17\>\""}], ",", "\"\<\>\"", ",", 
             RowBox[{
              RowBox[{"ToLowerCase", "[", "mdlName", "]"}], "<>", 
              "\"\<_\>\""}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "@", 
              RowBox[{"Rule", "[", "\[IndentingNewLine]", 
               RowBox[{"#2", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"hemi", "===", "RH"}], "&&", 
                    RowBox[{"#1", "\[Equal]", "\"\<angle\>\""}]}], ",", 
                   RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
                 RowBox[{"Import", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    RowBox[{"StringJoin", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    "\"\<.\>\"", ",", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], ",", 
                    "\"\<.\>\"", ",", "mdlString", ",", "\[IndentingNewLine]",
                     "#1", ",", "\"\<_steps=02500_scale=20.00\>\"", ",", 
                    "clipString", ",", "\"\<_prior=retinotopy.mgz\>\""}], 
                    "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                  "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<varea\>\"", 
                 ",", "\"\<sigma\>\""}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                 "\"\<VisualArea\>\"", ",", "\"\<PRFSize\>\""}], "}"}]}], 
              "}"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectBenson14Data", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"hemi", "===", "RH"}], "&&", 
               RowBox[{"#1", "\[Equal]", "\"\<angle\>\""}]}], ",", 
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
            RowBox[{"Import", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FileNameJoin", "@", 
               RowBox[{"List", "[", "\[IndentingNewLine]", 
                RowBox[{"$AnalysesRoot", ",", "sub", ",", 
                 RowBox[{
                  RowBox[{"ToLowerCase", "@", 
                   RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
                  "\"\<.\>\"", "<>", "#1", "<>", "\"\<_benson14\>\""}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", "\"\<FreeSurferCurv\>\"", "}"}]}], "]"}]}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<varea\>\"", ",", 
            "\"\<sigma\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<VisualArea\>\"", ",", "\"\<PRFSize\>\""}], "}"}]}], "}"}]}], 
       "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectBenson17Data", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"hemi", "===", "RH"}], "&&", 
               RowBox[{"#1", "\[Equal]", "\"\<angle\>\""}]}], ",", 
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
            RowBox[{"Import", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FileNameJoin", "@", 
               RowBox[{"List", "[", "\[IndentingNewLine]", 
                RowBox[{"$AnalysesRoot", ",", "sub", ",", 
                 RowBox[{
                  RowBox[{"ToLowerCase", "@", 
                   RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
                  "\"\<.\>\"", "<>", "#1", "<>", "\"\<_benson17.mgz\>\""}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
             "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<varea\>\"", ",", 
            "\"\<sigma\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<VisualArea\>\"", ",", "\"\<PRFSize\>\""}], "}"}]}], "}"}]}], 
       "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rdat", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"adat", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectAnalysesData", "[", 
             RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"rgs", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ags", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectAnalysesData", "[", 
             RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}], ",", "opts"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"b14", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectBenson14Data", "[", 
             RowBox[{"sub", ",", "hemi"}], "]"}], ",", "opts"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"b17", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectBenson17Data", "[", 
             RowBox[{"sub", ",", "hemi"}], "]"}], ",", "opts"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"schiraQ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StringQ", "[", "#", "]"}], "&&", 
              RowBox[{
               RowBox[{"ToLowerCase", "[", "#", "]"}], "\[Equal]", 
               "\"\<schira\>\""}]}], ")"}], "&"}], "@", 
           RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"mdlnm", "=", 
          RowBox[{"ToLowerCase", "@", 
           RowBox[{"ToString", "@", 
            RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"clip", "=", 
          RowBox[{"OptionValue", "[", "Clip", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"filt", "=", 
            RowBox[{"If", "[", 
             RowBox[{"schiraQ", ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"idcs", "=", 
                  RowBox[{"Indices", "[", 
                   RowBox[{
                    RowBox[{"adat", "[", "\"\<VisualArea\>\"", "]"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"Not", "[", 
                    RowBox[{"0", "<", 
                    RowBox[{"Abs", "[", "x", "]"}], "<", "4"}], "]"}]}]}], 
                   "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Function", "@", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"idcs", "\[Rule]", "0"}], "]"}]}], "]"}]}]}], 
               "]"}], ",", "\[IndentingNewLine]", "Identity"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"clipString", "=", 
            RowBox[{"\"\<_clip=\>\"", "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"clip", "===", "None"}], "||", 
                  RowBox[{"clip", "===", "Automatic"}]}], ",", "12", ",", 
                 "clip"}], "]"}], ",", "10", ",", "2"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"mdlString", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"mdlnm", "\[Equal]", "\"\<benson17\>\""}], ",", 
              "\"\<\>\"", ",", 
              RowBox[{"mdlnm", "<>", "\"\<_\>\""}]}], "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PRFSize\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<VarianceExplained\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"\"\<Weight\>\"", "\[Rule]", 
               RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"\"\<Magnification\>\"", "\[Rule]", 
               RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SubjectMagnification", "[", 
                  RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                 "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson14PolarAngle\>\"", "\[Rule]", 
               RowBox[{"b14", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson14Eccentricity\>\"", "\[Rule]", 
               RowBox[{"b14", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson14VisualArea\>\"", "\[Rule]", 
               RowBox[{"b14", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson14PRFSize\>\"", "\[Rule]", 
               RowBox[{"b14", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson17PolarAngle\>\"", "\[Rule]", 
               RowBox[{"b17", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson17Eccentricity\>\"", "\[Rule]", 
               RowBox[{"b17", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson17VisualArea\>\"", "\[Rule]", 
               RowBox[{"b17", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Benson17PRFSize\>\"", "\[Rule]", 
               RowBox[{"b17", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedPolarAngle\>\"", "\[Rule]", 
               RowBox[{"filt", "@", 
                RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedEccentricity\>\"", "\[Rule]", 
               RowBox[{"filt", "@", 
                RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedPRFSize\>\"", "\[Rule]", 
               RowBox[{"filt", "@", 
                RowBox[{"adat", "[", "\"\<PRFSize\>\"", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedVisualArea\>\"", "\[Rule]", 
               RowBox[{"filt", "@", 
                RowBox[{"Abs", "@", 
                 RowBox[{"adat", "[", "\"\<VisualArea\>\"", "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedRegistration\>\"", "\[Rule]", 
               RowBox[{"VertexCoordinates", "@", 
                RowBox[{"Import", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"FileNameJoin", "@", 
                   RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "\"\<lh\>\"", ",", 
                    "\"\<rh\>\""}], "]"}], ",", "\"\<.\>\"", ",", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], ",", 
                    "\"\<.\>\"", ",", "mdlString", ",", 
                    "\"\<retinotopy_steps=02500_scale=20.00\>\"", ",", 
                    "clipString", ",", 
                    "\"\<_prior=retinotopy.sphere.reg\>\""}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  "\"\<FreeSurferSurface\>\""}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<PredictedMagnification\>\"", "\[Rule]", 
               RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SubjectMagnification", "[", 
                  RowBox[{
                  "sub", ",", "hemi", ",", "ds", ",", "\"\<Predicted\>\""}], 
                  "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<ResidualPolarAngle\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}], "-", 
                 RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], ")"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<ResidualEccentricity\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}], "-", 
                 RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}], ")"}]}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<ResidualAngle\>\"", "\[Rule]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pang", "=", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"pecc", "=", 
                    RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"gang", "=", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"gecc", "=", 
                    RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pxy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pecc", "*", 
                    RowBox[{"Cos", "[", "pang", "]"}]}], ",", 
                    RowBox[{"pecc", "*", 
                    RowBox[{"Sin", "[", "pang", "]"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"gxy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"gecc", "*", 
                    RowBox[{"Cos", "[", "gang", "]"}]}], ",", 
                    RowBox[{"gecc", "*", 
                    RowBox[{"Sin", "[", "gang", "]"}]}]}], "}"}]}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"ColumnNorms", "[", 
                    RowBox[{"gxy", "-", "pxy"}], "]"}]}], "]"}]}], "]"}]}], 
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldPolarAngle\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldEccentricity\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldPRFSize\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldVarianceExplained\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldWeight\>\"", "\[Rule]", 
               RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GoldMagnification\>\"", "\[Rule]", 
               RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SubjectMagnification", "[", 
                  RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}], ",", 
                 "\[IndentingNewLine]", "opts"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Normal", "@", 
             RowBox[{"SubjectWideFieldRetinotopyData", "[", 
              RowBox[{"sub", ",", "hemi"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"b20248dc-ad96-4538-\
ba15-66857ccda745"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectFSAverageData", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectFSAverageData", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"prefix", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$AnalysesRoot", ",", "sub", ",", 
           RowBox[{"\"\<fs-\>\"", "<>", 
            RowBox[{"ToLowerCase", "@", 
             RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", "\"\<.\>\""}]}], 
          "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Association", "@", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"#2", "\[Rule]", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{
               "prefix", "<>", "\"\<all_\>\"", "<>", "#1", "<>", 
                "\"\<.mgz\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
              "]"}]}], "&"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<sigma\>\"", 
               ",", "\"\<vexpl\>\""}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
               "\"\<PRFSize\>\"", ",", "\"\<VarianceExplained\>\""}], "}"}]}],
             "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Association", "@", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\"\<Predicted\>\"", "<>", "#2"}], ")"}], "\[Rule]", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{
               "prefix", "<>", "\"\<all_inf_\>\"", "<>", "#1", "<>", 
                "\"\<.mgz\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
              "]"}]}], "&"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<sigma\>\"", 
               ",", "\"\<varea\>\""}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
               "\"\<PRFSize\>\"", ",", "\"\<VisualArea\>\""}], "}"}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Association", "@", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"#2", "\[Rule]", 
             RowBox[{"VertexCoordinates", "@", 
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{"prefix", "<>", "#1", "<>", "\"\<.sphere.reg\>\""}], 
                ",", "\"\<FreeSurferSurface\>\""}], "]"}]}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<native\>\"", ",", "\"\<retinotopy\>\"", ",", 
               "\"\<ideal_retinotopy\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<NativeCoordinates\>\"", ",", 
               "\"\<RetinotopyCoordinates\>\"", ",", 
               "\"\<IdealCoordinates\>\""}], "}"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{"\"\<PriorCoordinates\>\"", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
            RowBox[{"Benson14Mesh", "[", 
             RowBox[{"hemi", ",", "\"\<Sphere\>\""}], "]"}]}], ")"}]}], 
         "|>"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->\
"abce13b6-88be-4fef-abdf-a7ccc3c85762"]
}, Closed]],

Cell[CellGroupData[{

Cell["Apply the data to subject meshes and maps", "Subsection",ExpressionUUID->"6ea778a1-be85-4233-9da7-9868a116d90d"],

Cell["Here we just cache the FreeSurfer subject objects.", "Text",ExpressionUUID->"71e2d094-3e94-4dd6-99da-9096cfa338e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Subject", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Subject", "[", "sub_String", "]"}], ":=", 
    RowBox[{"FreeSurferSubject", "@", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"$FreeSurferRoot", ",", "sub"}], "}"}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"38be62a3-af4d-45fe-8ac8-6d3e84442b66"],

Cell["\<\
Here, we create a subject mesh and apply all the subject\[CloseCurlyQuote]s \
data to it.\
\>", "Text",ExpressionUUID->"24f13436-2ba7-43fc-9102-b666f64039e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectMesh", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectMesh", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectData", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectMesh", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "surf_String", ",", "ds_Integer", 
      ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdat", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectData", "[", 
            RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"msh", "=", 
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"Subject", "[", "sub", "]"}], ",", "hemi", ",", "surf"}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SetVertexProperties", "[", 
       RowBox[{"msh", ",", 
        RowBox[{"Normal", "[", "sdat", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"4d3307c0-2a44-48d9-9902-6f5b51858a4c"],

Cell["\<\
This cell creates a template map projection that is a duplicate of the one \
found in the standard.ffm.gz file distributed with the Neuropythy library \
(this is the V123 model used in registration).\
\>", "Text",ExpressionUUID->"d79eb474-a227-41d2-a06b-508306878b89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SubjectMap", ",", "SubjectMiniMap"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectMap", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMesh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SubjectMiniMap", "]"}], "=", 
    RowBox[{"Options", "[", "SubjectMesh", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubjectMap", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ToMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{
            "sub", ",", "hemi", ",", "\"\<Registered\>\"", ",", "ds"}], "]"}],
            ",", "opts"}], "]"}], ",", "\[IndentingNewLine]", "hemi"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"map0", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"SubjectMap", "[", 
               RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}], ",", "opts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"sdat", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"SubjectData", "[", 
               RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"reg", "=", 
            RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
             RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SubjectMesh", "[", 
                RowBox[{
                "sub", ",", "hemi", ",", "\"\<Registered\>\"", ",", "ds"}], 
                "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}]}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"idcs", "=", 
             RowBox[{"VertexList", "[", "map0", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
            RowBox[{"map0", ",", "\[IndentingNewLine]", 
             RowBox[{"Append", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "idcs"}], "]"}], "]"}]}], "&"}], "/@", 
                RowBox[{"Normal", "[", "sdat", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<PredictedRegistration\>\"", "\[Rule]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x0", "=", 
                    RowBox[{"VertexCoordinates", "@", 
                    RowBox[{"Reproject", "[", 
                    RowBox[{"map0", ",", "reg"}], "]"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "x0", ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
                    RowBox[{"Transpose", "[", "x0", "]"}]}], "]"}]}], "]"}]}],
                  "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectMiniMap", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ToMiniMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{
            "sub", ",", "hemi", ",", "\"\<Registered\>\"", ",", "ds"}], "]"}],
            ",", "opts"}], "]"}], ",", "\[IndentingNewLine]", "hemi"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"map0", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"SubjectMiniMap", "[", 
               RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}], ",", "opts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"sdat", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"SubjectData", "[", 
               RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", "opts"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"reg", "=", 
            RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
             RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SubjectMesh", "[", 
                RowBox[{
                "sub", ",", "hemi", ",", "\"\<Registered\>\"", ",", "ds"}], 
                "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}]}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"idcs", "=", 
             RowBox[{"VertexList", "[", "map0", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
            RowBox[{"map0", ",", "\[IndentingNewLine]", 
             RowBox[{"Append", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "idcs"}], "]"}], "]"}]}], "&"}], "/@", 
                RowBox[{"Normal", "[", "sdat", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<PredictedRegistration\>\"", "\[Rule]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x0", "=", 
                    RowBox[{"VertexCoordinates", "@", 
                    RowBox[{"Reproject", "[", 
                    RowBox[{"map0", ",", "reg"}], "]"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "x0", ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
                    RowBox[{"Transpose", "[", "x0", "]"}]}], "]"}]}], "]"}]}],
                  "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"c7081acd-42e3-465e-bdc2-\
3b524487352f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading HCP Data", "Section",ExpressionUUID->"86b1d656-5762-4650-94a3-50e105f21cca"],

Cell[CellGroupData[{

Cell["The subjects", "Subsection",ExpressionUUID->"0e1731a0-f763-4c62-b06d-19c7e6dddc01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HCPSubjects", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$HCPRoot", ",", "\"\<subjects.txt\>\""}], "}"}], "]"}], ",", 
      "\"\<Table\>\""}], "]"}]}]}], ";"}]], "Input",ExpressionUUID->"7146a2f2-\
77bc-4358-9b4d-4c19bd8d1c77"]
}, Closed]],

Cell[CellGroupData[{

Cell["Load the registrations", "Subsection",ExpressionUUID->"6ad825cb-dfbe-4998-9b32-0cf33026fc3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"HCPRetinotopyReg", ",", "HCPFSAverageReg"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HCPRetinotopyReg", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"Import", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"List", "[", "\[IndentingNewLine]", 
       RowBox[{"$HCPRoot", ",", 
        RowBox[{"ToString", "[", "sub", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
         "\"\<.MSMAll_retinotopy.native.sphere.reg\>\""}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\"\<FreeSurferSurface\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HCPFSAverageReg", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"Import", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"List", "[", "\[IndentingNewLine]", 
       RowBox[{"$HCPRoot", ",", 
        RowBox[{"ToString", "[", "sub", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
         "\"\<.sphere.reg\>\""}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\"\<FreeSurferSurface\>\""}], "]"}]}], ";"}]}], "Input",ExpressionUUID->\
"564ad5b8-a778-4231-9013-d148f81761a9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Load the inferred retinotopic maps", "Subsection",ExpressionUUID->"848f34ad-ccbf-4898-ac44-9e317691c4db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$HCPRetinotopyTr", ",", "HCPNativeRetinotopy", ",", "HCPRetinotopy"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HCPRetinotopyTr", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "\"\<angle\>\""}], ",", 
     RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "\"\<eccen\>\""}], ",", 
     RowBox[{"\"\<VisualArea\>\"", "\[Rule]", "\"\<varea\>\""}], ",", 
     RowBox[{"\"\<PRFSize\>\"", "\[Rule]", "\"\<sigma\>\""}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HCPNativeRetinotopy", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
    RowBox[{"Map", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "@", 
       RowBox[{"Import", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"List", "[", "\[IndentingNewLine]", 
           RowBox[{"$HCPRoot", ",", 
            RowBox[{"ToString", "[", "sub", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ToLowerCase", "@", 
              RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
             "\"\<.inf-MSMAll_\>\"", "<>", "#", "<>", 
             "\"\<.native.mgz\>\""}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", "$HCPRetinotopyTr"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", ":", " ", 
     RowBox[{
      RowBox[{"these", " ", "are", " ", "auto"}], "-", 
      RowBox[{
      "cached", " ", "but", " ", "not", " ", "memoized", " ", "because", " ", 
       "we", " ", "want", " ", "the", " ", "load"}], "-", 
      RowBox[{
      "time", " ", "to", " ", "be", " ", "relatively", " ", "fast"}]}]}], ",",
     " ", 
    RowBox[{"but", " ", "we", " ", 
     RowBox[{"don", "'"}], "t", " ", "want", " ", "the", " ", "memory", " ", 
     "requirements", " ", "of", " ", "processing", " ", "all", " ", "the", 
     " ", "subjects", " ", "to", " ", "be", " ", "very", " ", "high"}]}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HCPRetinotopy", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<hcp/\>\"", "<>", 
      RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<-\>\"", "<>", 
      RowBox[{"ToString", "[", "sub", "]"}], "<>", "\"\<-retinotopy\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reg", "=", 
         RowBox[{
          RowBox[{"HCPFSAverageReg", "[", 
           RowBox[{"sub", ",", "hemi"}], "]"}], "/.", 
          RowBox[{"Normal", "@", 
           RowBox[{"HCPNativeRetinotopy", "[", 
            RowBox[{"sub", ",", "hemi"}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"CortexResample", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"reg", "\[Rule]", 
          RowBox[{"Cortex", "[", 
           RowBox[{"FSAverageSubject", ",", "hemi", ",", "\"\<Sphere\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Properties", "\[Rule]", 
          RowBox[{"Keys", "[", "$HCPRetinotopyTr", "]"}]}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"29623af9-eced-4d53-\
b183-6a3bcd00a570"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate the Warp Fields", "Subsection",ExpressionUUID->"f2424fab-7e52-48b2-ae65-529fd0c74f75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "HCPWarpField", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HCPWarpField", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<hcp/\>\"", "<>", 
      RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<-\>\"", "<>", 
      RowBox[{"ToString", "[", "sub", "]"}], "<>", "\"\<-warp\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X0", "=", 
         RowBox[{"VertexCoordinates", "@", 
          RowBox[{"Cortex", "[", 
           RowBox[{"FSAverageSubject", ",", "hemi", ",", "\"\<Sphere\>\""}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"addr", "=", 
           RowBox[{"CortexAddress", "[", 
            RowBox[{
             RowBox[{"HCPFSAverageReg", "[", 
              RowBox[{"sub", ",", "hemi"}], "]"}], ",", "X0"}], "]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X1", "=", 
              RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
               RowBox[{"Benson14Mesh", "[", 
                RowBox[{"hemi", ",", "\"\<Sphere\>\""}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"X2", "=", 
              RowBox[{"CortexLookup", "[", 
               RowBox[{
                RowBox[{"HCPRetinotopyReg", "[", 
                 RowBox[{"sub", ",", "hemi"}], "]"}], ",", "addr"}], 
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Xm1", "=", 
                RowBox[{"VertexCoordinates", "@", 
                 RowBox[{"Reproject", "[", 
                  RowBox[{
                   RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "X1"}],
                   "]"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Xm2", "=", 
                RowBox[{"VertexCoordinates", "@", 
                 RowBox[{"Reproject", "[", 
                  RowBox[{
                   RowBox[{"MiniMapTemplate", "[", "hemi", "]"}], ",", "X2"}],
                   "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Xm2", "-", "Xm1"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"92617289-e2d1-4830-\
8a85-e0e3544d4d02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "WarpFieldAll", ",", "WarpFieldMatrix", ",", "WarpFieldPCA", ",", 
    "WarpFieldWeights", ",", "WarpFieldVariances", ",", "WarpField"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WarpFieldAll", "[", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<hcp/warp-field-allmtx-\>\"", "<>", 
        RowBox[{"ToString", "[", "hemi", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HCPWarpField", "[", 
          RowBox[{"sub", ",", "hemi"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"sub", ",", "$HCPSubjects"}], "}"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WarpFieldMatrix", "[", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<hcp/warp-field-matrix-\>\"", "<>", 
        RowBox[{"ToString", "[", "hemi", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Join", "@@@", 
        RowBox[{"WarpFieldAll", "[", "hemi", "]"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WarpFieldMeans", "[", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<hcp/warp-field-mean-\>\"", "<>", 
        RowBox[{"ToString", "[", "hemi", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Mean", "@", 
        RowBox[{"WarpFieldMatrix", "[", "hemi", "]"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WarpFieldPCA", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", 
       RowBox[{"number_Integer:", "1"}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<hcp/warp-field-pca-\>\"", "<>", 
        RowBox[{"ToString", "[", "hemi", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"KarhunenLoeveDecomposition", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"WarpFieldMatrix", "[", "hemi", "]"}]}], ",", 
         RowBox[{"Standardized", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WarpFieldWeights", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", 
       RowBox[{"number_:", "1"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pca", "=", 
         RowBox[{
          RowBox[{"WarpFieldPCA", "[", "hemi", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "number"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "number", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", "pca", "]"}]}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{"pca", ",", "2"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WarpFieldVariances", "[", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
     RowBox[{"Variance", "@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"First", "@", 
        RowBox[{"WarpFieldPCA", "[", "hemi", "]"}]}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WarpField", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", 
       RowBox[{"number_:", "1"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pca", "=", 
         RowBox[{
          RowBox[{"WarpFieldPCA", "[", "hemi", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "number"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "number", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", "pca", "]"}]}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{"pca", ",", "2"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"6ae5ceaf-dd4a-47c0-b501-9cbb58fb389c"],

Cell["For plotting warp-fields:", "Text",ExpressionUUID->"34681644-1332-4ce3-9827-798aac894ae7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "CortexWarpPlot", ",", "CortexWarpPlot`ColorFunction", ",", "WarpPlots"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CortexWarpPlot", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TransformationFunction", "\[Rule]", "None"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Opacity", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"ColorFunction", "\[Rule]", "Automatic"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CortexWarpPlot`ColorFunction", "[", "opts___", "]"}], ":=", 
   RowBox[{"Fold", "[", "\[IndentingNewLine]", 
    RowBox[{
    "Replace", ",", "\[IndentingNewLine]", "ColorFunction", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "opts", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ColorFunction", "\[Rule]", "Automatic"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"True", "|", "Automatic"}], "\[Rule]", 
         RowBox[{"Function", "@", 
          RowBox[{"Blend", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", "Red", "]"}], ",", 
              RowBox[{"Lighter", "[", "Yellow", "]"}], ",", 
              RowBox[{"Darker", "[", "Green", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Lighter", "[", "Cyan", "]"}], ",", 
              RowBox[{"Darker", "[", "Blue", "]"}], ",", 
              RowBox[{"Lighter", "[", "Magenta", "]"}], ",", 
              RowBox[{"Darker", "[", "Red", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"4", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"0.25", "-", 
                    RowBox[{"#", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "Pi"}], ")"}]}], "+", "0.5"}], ",", 
                    "1"}], "]"}], "-", "0.5"}], "]"}], "-", "0.25"}], "]"}]}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"#", "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", "Pi"}], ")"}]}], ",", "1"}], "]"}]}], 
           "]"}]}]}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CortexWarpPlot", "[", 
    RowBox[{
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", 
     RowBox[{"num_Integer:", "1"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"map", "=", 
        RowBox[{"MiniMapTemplate", "[", "hemi", "]"}]}], ",", 
       RowBox[{"w", "=", 
        RowBox[{"WarpField", "[", 
         RowBox[{"hemi", ",", "num"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"cfn", "=", 
        RowBox[{"CortexWarpPlot`ColorFunction", "[", "opts", "]"}]}]}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tr", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TransformationFunction", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "Identity", "|", "None", "|", "Automatic", "|", "False"}], 
              "\[RuleDelayed]", 
              RowBox[{"RowNorms", "[", "w", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"l_List", "/;", 
               RowBox[{
                RowBox[{"Length", "[", "l", "]"}], "\[Equal]", 
                RowBox[{"Length", "[", "w", "]"}]}]}], "\[RuleDelayed]", 
              "l"}], ",", "\[IndentingNewLine]", 
             RowBox[{"f_", "\[RuleDelayed]", 
              RowBox[{"f", "@", 
               RowBox[{"RowNorms", "[", "w", "]"}]}]}]}], "}"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"opac", "=", 
           RowBox[{"Replace", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Opacity", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Automatic", "|", "True", "|", "Rescale", "|", "MinMax"}], 
                "\[RuleDelayed]", 
                RowBox[{"Rescale", "[", "tr", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Max", "\[RuleDelayed]", 
                RowBox[{"Rescale", "[", 
                 RowBox[{"tr", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Max", "[", "tr", "]"}]}], "}"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"None", "|", "Identity", "|", "False"}], 
                "\[RuleDelayed]", "tr"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"mx_", "?", "NumericQ"}], "\[RuleDelayed]", 
                RowBox[{"Rescale", "[", 
                 RowBox[{"tr", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "mx"}], "}"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"mn_", "?", "NumericQ"}], ",", 
                  RowBox[{"mx_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
                RowBox[{"Rescale", "[", 
                 RowBox[{"tr", ",", 
                  RowBox[{"{", 
                   RowBox[{"mn", ",", "mx"}], "}"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"l_List", "/;", 
                 RowBox[{
                  RowBox[{"Length", "[", "l", "]"}], "\[Equal]", 
                  RowBox[{"Length", "[", "w", "]"}]}]}], "\[RuleDelayed]", 
                "l"}], ",", "\[IndentingNewLine]", 
               RowBox[{"f_", "\[RuleDelayed]", 
                RowBox[{"f", "[", "tr", "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rng", "=", 
             RowBox[{"Replace", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"OptionValue", "[", "PlotRange", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Automatic", "|", "Max"}], "\[RuleDelayed]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Max", "@", 
                    RowBox[{"RowNorms", "[", "opac", "]"}]}]}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "x"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"mn_", ",", "mx_"}], "}"}], "\[RuleDelayed]", 
                  RowBox[{"{", 
                   RowBox[{"mn", ",", "mx"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Full", "|", "All", "|", "MinMax"}], 
                  "\[RuleDelayed]", 
                  RowBox[{"MinMax", "[", "opac", "]"}]}]}], "}"}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
            RowBox[{"map", ",", "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"Function", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"opac", "[", 
                   RowBox[{"[", "#VertexIndex", "]"}], "]"}], "\[LessEqual]", 
                  
                  RowBox[{"rng", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"CorticalCurvatureColor", "[", "#Curvature", "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "CorticalCurvatureColor", "[", "#Curvature", "]"}], ",", 
                    RowBox[{"cfn", "[", 
                    RowBox[{"ArcTan", "@@", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "#VertexIndex", "]"}], "]"}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Rescale", "[", 
                    RowBox[{
                    RowBox[{"opac", "[", 
                    RowBox[{"[", "#VertexIndex", "]"}], "]"}], ",", "rng"}], 
                    "]"}]}], "]"}]}], "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "WarpPlots", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "CortexWarpPlot", "]"}], ",", 
     RowBox[{"Options", "[", "GraphicsRow", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WarpPlots", "[", 
    RowBox[{
     RowBox[{"num_:", "1"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cfn", "=", 
       RowBox[{"CortexWarpPlot`ColorFunction", "[", "opts", "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"CortexWarpPlot", "[", 
              RowBox[{"h", ",", "n"}], "]"}], ",", "opts"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "[", "num", "]"}], ",", "num", ",", 
               RowBox[{"{", "num", "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"h", ",", 
             RowBox[{"{", 
              RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"Inset", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ParametricPlot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"r", "*", 
                 RowBox[{"Cos", "[", "t", "]"}]}], ",", 
                RowBox[{"r", "*", 
                 RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "0", ",", "1"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Mesh", "\[Rule]", "False"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "None"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ColorFunction", "\[Rule]", 
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "=", "#1"}], ",", 
                    RowBox[{"y", "=", "#2"}], ",", 
                    RowBox[{"t", "=", "#3"}], ",", 
                    RowBox[{"r", "=", "#4"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"CorticalCurvatureColor", "@", 
                    RowBox[{"Times", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"x", "+", "0.125"}], ",", "0.25"}], "]"}], "-", 
                    "0.125"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"y", "+", "0.125"}], ",", "0.25"}], "]"}], "-", 
                    "0.125"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"cfn", "[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "Pi"}], ",", 
                    RowBox[{"2", "*", "Pi"}]}], "]"}], "-", "Pi"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", "r"}], "]"}]}], 
                 "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageScaled", "[", "0.15", "]"}]}], "]"}]}]}], "]"}], 
       ",", "\[IndentingNewLine]", "opts"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"8aac0e9c-c5b6-4cc7-9375-34de5382600d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "WarpFieldPCPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WarpFieldPCPlot", "[", 
   RowBox[{
    RowBox[{"hemi", ":", 
     RowBox[{"LH", "|", "RH"}]}], ",", 
    RowBox[{"xax_Integer:", "1"}], ",", 
    RowBox[{"yax_Integer:", "2"}]}], "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pts", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"WarpFieldPCA", "[", "hemi", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"xax", ",", "yax"}], "}"}]}], "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lbl1", "=", 
       RowBox[{"\"\<PC\>\"", "<>", 
        RowBox[{"ToString", "[", "xax", "]"}]}]}], ",", 
      RowBox[{"lbl2", "=", 
       RowBox[{"\"\<PC\>\"", "<>", 
        RowBox[{"ToString", "[", "yax", "]"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdk", "=", 
         RowBox[{"SmoothKernelDistribution", "[", "pts", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"plot0", "=", 
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{"pts", ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"lbl2", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"lbl1", ",", "None"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}]}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"prng", "=", 
          RowBox[{"PlotRange", "/.", 
           RowBox[{"AbsoluteOptions", "[", 
            RowBox[{"plot0", ",", "PlotRange"}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"plot0", ",", "\[IndentingNewLine]", 
           RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"PDF", "[", 
              RowBox[{"sdk", ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"prng", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"prng", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"prng", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"prng", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Contours", "\[Rule]", "12"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"Function", "@", 
               RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"Lighter", "[", "Blue", "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", "#"}], "]"}]}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "plot0"}], "}"}], "]"}]}], "]"}]}], "]"}]}],
    "]"}]}]}], "Input",ExpressionUUID->"07908459-5814-4b9f-b280-6fe25c8fae42"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting/Analysis Code", "Subchapter",
 CellChangeTimes->{{3.662807324689231*^9, 3.662807328992319*^9}, 
   3.6628132807895737`*^9},ExpressionUUID->"4c83839d-e39b-4e27-a90a-\
8a322170b2b3"],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.658508587333959*^9, 3.658508589721416*^9}, {
  3.662853387814995*^9, 
  3.662853389412607*^9}},ExpressionUUID->"ad840763-fbc9-4d1c-abd7-\
460f26883deb"],

Cell[CellGroupData[{

Cell["Default Styles for Figures", "Subsection",ExpressionUUID->"d6f0bb22-45e9-4f6e-92d7-d365389f07e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FontFamily", ",", "$FontWeight", ",", "$FontSize", ",", "$FontColor", 
    ",", "$BaseStyle"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontFamily", "=", "\"\<Helvetica Neue\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontWeight", "=", "\"\<Thin\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontSize", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontColor", "=", "Black"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$BaseStyle", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FontSize", "\[Rule]", "$FontSize"}], ",", 
     RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}], ",", 
     RowBox[{"FontColor", "\[Rule]", "$FontColor"}]}], "}"}]}], 
  ";"}]}], "Input",ExpressionUUID->"ac0f1697-6ec7-4c09-8d61-d54a94e791ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$FigureSmallWidth", ",", "$FigureLargeWidth", ",", "$FigureDPI"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureSmallWidth", "=", "3.35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureLargeWidth", "=", "6.93"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureDPI", "=", "600"}], ";"}]}], "Input",ExpressionUUID->\
"7670f440-3eec-4b29-9ad8-da885b215a4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$SubjectSymbols", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<S0901\>\"", "\[Rule]", "\[FilledDiamond]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0902\>\"", "\[Rule]", "\[FilledCircle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0903\>\"", "\[Rule]", "\[FilledSquare]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0904\>\"", "\[Rule]", "\[FilledUpTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0905\>\"", "\[Rule]", "\[FilledDownTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0906\>\"", "\[Rule]", "\[FilledRightTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S0907\>\"", "\[Rule]", "\[FilledLeftTriangle]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S1201\>\"", "\[Rule]", "\[FivePointedStar]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<S1901\>\"", "\[Rule]", "\[SixPointedStar]"}]}], "|>"}]}], 
  ";"}]], "Input",ExpressionUUID->"b8d1e1fa-7772-4ae4-8192-03c7a6544e5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auto-Cache Exported Images", "Subsection",
 CellChangeTimes->{{3.662845319835968*^9, 3.6628453308192596`*^9}, {
  3.662853392948634*^9, 
  3.662853395036529*^9}},ExpressionUUID->"38341fdb-c3f0-4017-b9c2-\
cca874d2e052"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "AutoCachePNG", ",", "AutoCachePDF", ",", "AutoCacheImageFileName"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoCacheImageFileName", "[", 
    RowBox[{"name_", ",", "\"\<PNG\>\""}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"#", ",", 
          RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.png\>\""}], ",", "#",
        ",", 
       RowBox[{"#", "<>", "\"\<.png\>\""}]}], "]"}], "&"}], "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"Prepend", "[", 
        RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoCacheImageFileName", "[", 
     RowBox[{"name_", ",", "\"\<PDF\>\""}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"#", ",", 
           RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.pdf\>\""}], ",", 
        "#", ",", 
        RowBox[{"#", "<>", "\"\<.pdf\>\""}]}], "]"}], "&"}], "@", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"Prepend", "[", 
         RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePNG", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoCachePNG", "[", 
     RowBox[{"name_", ",", "code_", ",", 
      RowBox[{"imRes_:", "600"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flnm", "=", 
        RowBox[{"AutoCacheImageFileName", "[", 
         RowBox[{"name", ",", "\"\<PNG\>\""}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"img", "=", 
            RowBox[{"Image", "[", 
             RowBox[{"code", ",", 
              RowBox[{"ImageResolution", "\[Rule]", "imRes"}]}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{"flnm", ",", "img", ",", "\"\<PNG\>\"", ",", 
             RowBox[{"ImageResolution", "\[Rule]", "imRes"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePDF", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoCachePDF", "[", 
    RowBox[{"name_", ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"flnm", "=", 
       RowBox[{"AutoCacheImageFileName", "[", 
        RowBox[{"name", ",", "\"\<PDF\>\""}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"img", "=", "code"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"flnm", ",", "img", ",", "\"\<PDF\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"feaa8ba1-f80c-4112-9ab5-1acfd9f79c19"]
}, Closed]],

Cell[CellGroupData[{

Cell["Declaring a figure and canvas", "Subsection",ExpressionUUID->"d79c90f1-3ddf-43ae-97b4-b94e7cd81756"],

Cell["\<\
This code allows us to declare a figure; figures can be queried and saved in \
a programmatic way. Figures are given a name which must be a string or a list \
of strings (where earlier strings in the list are essentially figure \
categories/sub-categories).
Figures are auto-cached when displayed.\
\>", "Text",ExpressionUUID->"5684d721-995d-48e9-9357-f026c17de0d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"Figure", ",", "SFigure"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "::", "usage"}], "=", 
   "\"\<Figure is a convenience form for tracking figures produced by the \
notebook. A Figure can be declared by simply defining it using a SetDelayed \
form (Figure[name] := code). The code should produce a graphics object that \
can be exported either as a PNG file or as a PDF file (in which case, \
(Figure[name, \\\"PDF\\\"] := code) should be used). The figure will be \
automatically saved to the $FiguresRoot directory when it is first displayed \
and will be loaded from disk for future display.\n\nOnce a figure has been \
defined, a number of methods can be used:\n  * Show@Figure[name] displays the \
figure.\n  * Graphics@Figure[name] yields the raw graphics object (this may \
require running the code, even if the figure has been previously cached).\n  \
* FileName@Figure[name] yields the figure's filename.\n  * FileType[name] \
yields the figure's file format (\\\"PNG\\\" or \\\"PDF\\\").\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SFigure", "::", "usage"}], "=", 
    "\"\<SFigure[name] is an alias for Figure[{\\\"supplemental\\\", name}]; \
note that name may be a list.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Figure", "/:", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"Figure", "[", 
      RowBox[{"name_", ",", 
       RowBox[{"fmt", ":", 
        RowBox[{"\"\<PNG\>\"", "|", "\"\<PDF\>\""}], ":", "\"\<PNG\>\""}]}], 
      "]"}], ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sym", "=", 
       RowBox[{"TemporarySymbol", "[", "\"\<fig\>\"", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Figure", "[", "name", "]"}], "=", "sym"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "name", "]"}], "&&", 
         RowBox[{
          RowBox[{"First", "[", "name", "]"}], "\[Equal]", 
          "\"\<supplemental\>\""}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"sname", "=", 
            RowBox[{"Rest", "[", "name", "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"SFigure", "[", "sname", "]"}], "=", "sym"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sym", "/:", 
       RowBox[{"FileType", "[", "sym", "]"}], "=", "fmt"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sym", "/:", 
       RowBox[{"Graphics", "[", "sym", "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{"sym", "/:", 
         RowBox[{"Graphics", "[", "sym", "]"}], "=", "code"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sym", "/:", 
       RowBox[{"FileName", "[", "sym", "]"}], ":=", 
       RowBox[{"AutoCacheImageFileName", "[", 
        RowBox[{"name", ",", "fmt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ToLowerCase", "[", "fmt", "]"}], "\[Equal]", 
         "\"\<png\>\""}], ",", 
        RowBox[{"sym", "/:", 
         RowBox[{"Show", "[", "sym", "]"}], ":=", 
         RowBox[{"TagSet", "[", "\[IndentingNewLine]", 
          RowBox[{"sym", ",", 
           RowBox[{"Show", "[", "sym", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AutoCachePNG", "[", 
            RowBox[{"name", ",", 
             RowBox[{"Graphics", "[", "sym", "]"}]}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToLowerCase", "[", "fmt", "]"}], "\[Equal]", 
         "\"\<pdf\>\""}], ",", 
        RowBox[{"sym", "/:", 
         RowBox[{"Show", "[", "sym", "]"}], ":=", 
         RowBox[{"TagSet", "[", "\[IndentingNewLine]", 
          RowBox[{"sym", ",", 
           RowBox[{"Show", "[", "sym", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AutoCachePDF", "[", 
            RowBox[{"name", ",", 
             RowBox[{"Graphics", "[", "sym", "]"}]}], "]"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", "sym"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Figure", "/:", 
    RowBox[{"FileName", "[", 
     RowBox[{"f", ":", 
      RowBox[{"Figure", "[", "__", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sym", "=", "f"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "sym", "]"}], "===", "Figure"}], ",", "$Failed",
         ",", 
        RowBox[{"FileName", "[", "sym", "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SFigure", "[", "sname_", "]"}], ":=", 
   RowBox[{"Figure", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "sname", "]"}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"sname", ",", "\"\<supplemental\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<supplemental\>\"", ",", "sname"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SFigure", "/:", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"SFigure", "[", 
      RowBox[{"sname_", ",", 
       RowBox[{"fmt_:", "\"\<PNG\>\""}]}], "]"}], ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"name", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "sname", "]"}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{"sname", ",", "\"\<supplemental\>\""}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<supplemental\>\"", ",", "sname"}], "}"}]}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"SetDelayed", "@@", 
      RowBox[{"Hold", "[", 
       RowBox[{
        RowBox[{"Figure", "[", 
         RowBox[{"name", ",", "fmt"}], "]"}], ",", "code"}], "]"}]}]}], 
    "]"}]}], ";"}]}], "Input",ExpressionUUID->"f5f242e6-1ff8-407f-be32-\
42cd0869763f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Color Functions", "Subsection",
 CellChangeTimes->{{3.676117055363916*^9, 
  3.676117057478757*^9}},ExpressionUUID->"af822b92-4514-429c-9542-\
8624001eeb01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "RetinotopyColor", ",", "$PolarAngleBlendColors", ",", 
     "$EccentricityBlendColors", ",", "$CMagBlendColors", ",", 
     "$PRFBlendColors"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RetinotopyColor", "::", "usage"}], "=", 
    "\"\<RetinotopyColor[\\\"PolarAngle\\\"] and \
RetinotopyColor[\\\"Eccentricity\\\"] both yield functions appropriate for \
use with CortexPlot and CortexPlot3D which deduce whether the map/mesh is a \
raw data or predicted mesh and color it appropriately. Color schemas \
\\\"Magnification\\\" and \\\"PRFSize\\\" also plot the appropriate data.\n\
RetinotopyColor[name -> \\\"PolarAngle\\\"] can alternately be used to tell \
RetinotopyColor that the property with the given name should be colored as if \
it were PolarAngle.\n\nThe following options may be used:\n * Range (default: \
Automatic) specifies that only the eccentricity range given will be plotted; \
this may be given as a single max eccentricity or as {min, max}.\n * \
Eccentricity, VisualArea, and Weights may all be given strings, which change \
the default name of the property used in determining whether a vertex should \
be plotted and its transparency.\n * Method (default: (2*#&)) specifies how \
the weights should be interpreted. If simply \\\"Opacity\\\" or \
\\\"Cutoff\\\" then uses the weight values as opacity values or uses a cutoff \
of 0.1, respectively; alternately may be specified as a function that takes \
the weight as input and outputs the opacity value.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "RetinotopyColor", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Eccentricity", "\[Rule]", "\"\<Eccentricity\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VisualArea", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Weights", "\[Rule]", "\"\<VarianceExplained\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "#"}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Hemi", "\[Rule]", "All"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$PolarAngleBlendColors", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"All", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "180"}], ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "135"}], ",", 
           RowBox[{"Lighter", "[", "Yellow", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "90"}], ",", 
           RowBox[{"Darker", "@", "Green"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "45"}], ",", 
           RowBox[{"Lighter", "[", "Cyan", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Darker", "@", "Blue"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"45", ",", 
           RowBox[{"Lighter", "@", "Cyan"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"90", ",", 
           RowBox[{"Darker", "@", "Green"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"135", ",", 
           RowBox[{"Lighter", "@", "Yellow"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"180", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LH", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "180"}], ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "135"}], ",", 
           RowBox[{"Lighter", "@", 
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Red", ",", "Magenta"}], "}"}], ",", "0.5"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "90"}], ",", 
           RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "45"}], ",", 
           RowBox[{"Lighter", "@", 
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Magenta"}], "}"}], ",", "0.5"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Darker", "@", "Blue"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"45", ",", 
           RowBox[{"Lighter", "@", "Cyan"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"90", ",", 
           RowBox[{"Darker", "@", "Green"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"135", ",", 
           RowBox[{"Lighter", "@", "Yellow"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"180", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RH", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "180"}], ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "135"}], ",", 
           RowBox[{"Lighter", "[", "Yellow", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "90"}], ",", 
           RowBox[{"Darker", "@", "Green"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "45"}], ",", 
           RowBox[{"Lighter", "[", "Cyan", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Darker", "@", "Blue"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"45", ",", 
           RowBox[{"Lighter", "@", 
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Magenta"}], "}"}], ",", "0.5"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"90", ",", 
           RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"135", ",", 
           RowBox[{"Lighter", "@", 
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Red", ",", "Magenta"}], "}"}], ",", "0.5"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"180", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}]}], "|>"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EccentricityBlendColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"LH", "\[Rule]", "#"}], ",", 
       RowBox[{"RH", "\[Rule]", "#"}], ",", 
       RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.5", ",", 
        RowBox[{"Lighter", "[", "Magenta", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"Darker", "[", "Red", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"6", ",", 
        RowBox[{"Lighter", "[", "Yellow", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"12", ",", 
        RowBox[{"Darker", "[", "Green", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"24", ",", 
        RowBox[{"Lighter", "[", "Cyan", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"48", ",", 
        RowBox[{"Darker", "[", "Gray", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"90", ",", "White"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CMagBlendColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"LH", "\[Rule]", "#"}], ",", 
       RowBox[{"RH", "\[Rule]", "#"}], ",", 
       RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.0", ",", 
        RowBox[{"Darker", "[", "Red", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"2.0", ",", 
        RowBox[{"Lighter", "[", "Yellow", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"4.0", ",", 
        RowBox[{"Darker", "[", "Green", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"8.0", ",", 
        RowBox[{"Lighter", "[", "Cyan", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"16.0", ",", "White"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PRFBlendColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"LH", "\[Rule]", "#"}], ",", 
       RowBox[{"RH", "\[Rule]", "#"}], ",", 
       RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.0", ",", "White"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.0", ",", 
        RowBox[{"Lighter", "[", "Cyan", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"2.0", ",", 
        RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"3.0", ",", 
        RowBox[{"Lighter", "[", "Magenta", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"4.0", ",", 
        RowBox[{"Darker", "[", "Red", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"5.0", ",", "Black"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PolarAngleErrorBlendColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"LH", "\[Rule]", "#"}], ",", 
       RowBox[{"RH", "\[Rule]", "#"}], ",", 
       RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "30.0"}], ",", "White"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "20.0"}], ",", "Yellow"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10.0"}], ",", "Red"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"10.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"20.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"30.0", ",", "White"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EccentricityErrorBlendColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"LH", "\[Rule]", "#"}], ",", 
       RowBox[{"RH", "\[Rule]", "#"}], ",", 
       RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.5"}], ",", "White"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.0"}], ",", "Yellow"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.5", ",", "White"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AngleErrorBlendColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"LH", "\[Rule]", "#"}], ",", 
       RowBox[{"RH", "\[Rule]", "#"}], ",", 
       RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3.0"}], ",", "White"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.0"}], ",", "Yellow"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.0"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"2.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"3.0", ",", "White"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MagRatioBlendColors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"LH", "\[Rule]", "#"}], ",", 
       RowBox[{"RH", "\[Rule]", "#"}], ",", 
       RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.5", ",", "1", ",", "1"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", "Cyan"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", "Blue"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"2", ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"3", ",", "Yellow"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "1", ",", "0.5"}], "]"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$MagRatioBlendColors", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"LH", "\[Rule]", "#"}], ",", 
        RowBox[{"RH", "\[Rule]", "#"}], ",", 
        RowBox[{"All", "\[Rule]", "#"}]}], "|>"}], "&"}], "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.5", ",", "1", ",", "1"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "3"}], ",", "Cyan"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", "Blue"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"3", ",", "Yellow"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"4", ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", "1", ",", "0.5"}], "]"}]}], "}"}]}], "}"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"s_String", "/;", 
      RowBox[{"StringStartsQ", "[", 
       RowBox[{"s", ",", "\"\<Predicted\>\""}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "\[Rule]", 
      RowBox[{"StringTake", "[", 
       RowBox[{"s", ",", 
        RowBox[{"10", ";;", "All"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "opts", ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "\"\<PredictedVisualArea\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Eccentricity", "\[Rule]", "\"\<PredictedEccentricity\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "None"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"s_String", "/;", 
      RowBox[{"StringStartsQ", "[", 
       RowBox[{"s", ",", "\"\<Gold\>\""}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "\[Rule]", 
      RowBox[{"StringTake", "[", 
       RowBox[{"s", ",", 
        RowBox[{"5", ";;", "All"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "opts", ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Eccentricity", "\[Rule]", "\"\<GoldEccentricity\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "\"\<GoldVarianceExplained\>\""}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", ":", 
      RowBox[{
      "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
       "\"\<Magnification\>\"", "|", "\"\<CMag\>\"", "|", "\"\<PRFSize\>\"", 
       "|", "\"\<MagRatio\>\""}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"type", "\[Rule]", "type"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prop_String", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"type", ":", 
        RowBox[{
        "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
         "\"\<Magnification\>\"", "|", "\"\<MagnificationSquared\>\"", "|", 
         "\"\<PRFSize\>\"", "|", "\"\<MagRatio\>\""}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hemi", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Hemi", "]"}], ",", 
          RowBox[{
           RowBox[{"None", "|", "Automatic"}], "\[Rule]", "All"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "90"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"n_", "?", "NumberQ"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "n"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eccenName", "=", 
        RowBox[{"OptionValue", "[", "Eccentricity", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"areasName", "=", 
        RowBox[{"OptionValue", "[", "VisualArea", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"weightName", "=", 
        RowBox[{"OptionValue", "[", "Weights", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"mtd", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Method", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Opacity\>\"", "\[Rule]", "Identity"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Cutoff\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0.1"}], ",", "0.8", ",", "0"}], "]"}], 
               "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Cutoff\>\"", ",", "x_"}], "}"}], "\[RuleDelayed]", 
             
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "x"}], ",", "0.8", ",", "0"}], "]"}], 
               "&"}], ")"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vertexOkayFn", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"!", 
               RowBox[{"KeyExistsQ", "[", 
                RowBox[{"#", ",", "eccenName"}], "]"}]}], "||", 
              RowBox[{"!", 
               RowBox[{"NumberQ", "[", 
                RowBox[{"#", "[", "eccenName", "]"}], "]"}]}]}], ",", "False",
              ",", "\[IndentingNewLine]", 
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"range", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
                RowBox[{"#", "[", "eccenName", "]"}], "\[LessEqual]", 
                RowBox[{"range", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", "False", ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"areasName", "=!=", "None"}], "&&", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"NumberQ", "@", 
                  RowBox[{"#", "[", "areasName", "]"}]}]}], "||", 
                RowBox[{
                 RowBox[{"#", "[", "areasName", "]"}], "\[Equal]", "0"}]}], 
               ")"}]}], ",", "False", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"weightName", "=!=", "None"}], "&&", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", "weightName", "]"}], "\[LessEqual]", "0"}]}],
              ",", "False", ",", "\[IndentingNewLine]", "True", ",", "True"}],
             "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"wgt", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringQ", "[", "weightName", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"StringEndsQ", "[", 
               RowBox[{"weightName", ",", "\"\<VisualArea\>\""}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Function", "@", 
               RowBox[{"mtd", "@", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                  RowBox[{"Unitize", "[", 
                   RowBox[{"#", "[", "weightName", "]"}], "]"}], ",", "0.8"}],
                  "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Function", "@", 
               RowBox[{"mtd", "@", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                  RowBox[{"#", "[", "weightName", "]"}], ",", "0.8"}], 
                 "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Function", "@", 
             RowBox[{"mtd", "@", 
              RowBox[{"Part", "[", 
               RowBox[{"weightName", ",", 
                RowBox[{"#", "[", "\"\<VertexIndex\>\"", "]"}]}], "]"}]}]}]}],
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<CMag\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<Magnification\>\""}]}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{
                  RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"wgt", "[", "#", "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<CMag2\>\"", ",", "\"\<Magnification2\>\"", ",", 
             "\"\<MagnificationSquared\>\"", ",", "\"\<CMagSquared\>\""}], 
            "}"}], ",", "type"}], "]"}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{
                  RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"#", "[", "prop", "]"}], "]"}]}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"wgt", "[", "#", "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<MagRatio\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<MagnificationRatio\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<CMagRatio\>\""}]}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"vertexOkayFn", "[", "#", "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\"\<Curvature\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{
                  RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"wgt", "[", "#", "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<PRFSize\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{
                  RowBox[{"$PRFBlendColors", "[", "hemi", "]"}], ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"wgt", "[", "#", "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<PolarAngleError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"mtd", "@", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                    RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                   
                   RowBox[{"#", "[", "weightName", "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"$PolarAngleErrorBlendColors", "[", "hemi", "]"}],
                     ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<EccentricityError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"mtd", "@", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                    RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                   
                   RowBox[{"#", "[", "weightName", "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{
                    "$EccentricityErrorBlendColors", "[", "hemi", "]"}], ",", 
                    
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<AngleError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"mtd", "@", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                    RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                   
                   RowBox[{"#", "[", "weightName", "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"$AngleErrorBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "===", "\"\<PolarAngle\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"mtd", "@", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                    RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                   
                   RowBox[{"#", "[", "weightName", "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "===", "\"\<Eccentricity\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"mtd", "@", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                    RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                   
                   RowBox[{"#", "[", "weightName", "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}], 
                    ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Function", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\[IndentingNewLine]", "\"\<Curvature\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"mtd", "@", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                    RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                    RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                   
                   RowBox[{"#", "[", "weightName", "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"CorticalColorData", "[", "type", "]"}], "[", 
                   RowBox[{"<|", 
                    RowBox[{"type", "\[Rule]", 
                    RowBox[{"#", "[", "prop", "]"}]}], "|>"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUU\
ID->"a1e9957a-85e8-426a-868f-8d003f42b7d1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a Direction Compass on the Maps", "Subsection",
 CellChangeTimes->{{3.676119297276575*^9, 
  3.676119301843574*^9}},ExpressionUUID->"09f24c71-cb48-4382-ad87-\
8f9c8b3b7223"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "MapCompass", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapCompass", "::", "usage"}], "=", 
    "\"\<MapCompass[hemi] yields a Graphics object that represents the \
appropriate directions compass (dorsal/ventral, medial/lateral indicator) for \
the given hemisphere's map projections.\nMapCompass[hemi, style] uses the \
given style for the compass arrows.\nMapCompass accepts all the options \
appropriate for Graphics as well as the Style option, which may be a list of \
any options appropriate for Style; these are used to format the text.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MapCompass", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Options", "[", "Graphics", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Scale", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Center", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapCompass", "[", 
    RowBox[{
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", 
     RowBox[{"style_:", 
      RowBox[{"{", "White", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sty", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Style", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
            RowBox[{"FontSize", "\[Rule]", "$FontSize"}], ",", 
            RowBox[{"FontColor", "\[Rule]", "White"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}]}], "}"}]}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Scale", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", "10"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"medlat", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"center", "=", 
        RowBox[{"OptionValue", "[", "Center", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
         RowBox[{"{", "style", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"center", "+", 
             RowBox[{"xy", "*", "scale", "*", "0.9"}]}]}], "}"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"xy", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<D\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", "scale"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<V\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "scale"}]}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<L\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", 
               RowBox[{"-", "scale"}]}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "+", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<M\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", "scale"}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "-", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID\
->"c57cd5f6-6b13-4a64-9fff-039bf27b4a34"]
}, Closed]],

Cell[CellGroupData[{

Cell["Common Patterns", "Subsection",ExpressionUUID->"361dfdf9-7674-4dfa-91b5-3487092ab9ef"],

Cell["\<\
These variables are common patterns that we want to be used commonly \
throughout the notebook.\
\>", "Text",ExpressionUUID->"1897b273-8c92-433a-b255-3f6e2e280cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$EmpiricalPattern", ",", "$GoldPattern", ",", "$PredictedPattern", ",", 
    "$AnatomyPattern", ",", "$SemiEmpiricalPattern"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EmpiricalPattern", "=", 
   RowBox[{
   "\"\<Empirical\>\"", "|", "\"\<Measured\>\"", "|", "\"\<PRF\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$GoldPattern", "=", 
   RowBox[{
   "\"\<Gold\>\"", "|", "\"\<GoldStandard\>\"", "|", "\"\<Validation\>\""}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PredictedPattern", "=", 
   RowBox[{
   "\"\<Predicted\>\"", "|", "\"\<Prediction\>\"", "|", "\"\<Fit\>\"", "|", 
    "\"\<Model\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AnatomyPattern", "=", 
   RowBox[{
   "\"\<Anatomy\>\"", "|", "\"\<Anatomical\>\"", "|", "\"\<Benson14\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SemiEmpiricalPattern", "=", 
   RowBox[{"\"\<SemiEmpirical\>\"", "|", "\"\<GoldEmpirical\>\""}]}], 
  ";"}]}], "Input",ExpressionUUID->"310eeeb8-a6ef-4850-b1fc-f6ef202e65b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Putting the Wang Atlas on a subject", "Subsection",ExpressionUUID->"6f6f9a10-cd95-4b1d-8b38-1a368e2f5c6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Wang2015Atlas", ",", "$WangTranslate", ",", "WangTranslate"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$WangTranslate", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "1"}], ",", 
     RowBox[{"2", "\[Rule]", "1"}], ",", 
     RowBox[{"3", "\[Rule]", "2"}], ",", 
     RowBox[{"4", "\[Rule]", "2"}], ",", 
     RowBox[{"5", "\[Rule]", "3"}], ",", 
     RowBox[{"6", "\[Rule]", "3"}], ",", 
     RowBox[{"7", "\[Rule]", "4"}], ",", 
     RowBox[{"8", "\[Rule]", "5"}], ",", 
     RowBox[{"15", "\[Rule]", "6"}], ",", 
     RowBox[{"17", "\[Rule]", "7"}], ",", 
     RowBox[{"16", "\[Rule]", "8"}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WangTranslate", "[", "k_Integer", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$WangTranslate", ",", "k"}], "]"}], ",", 
     RowBox[{"$WangTranslate", "[", "k", "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Wang2015Atlas", ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h", "\[Rule]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f0", "=", 
            RowBox[{"Import", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"$DataRoot", ",", "\"\<wang2015\>\"", ",", 
                 RowBox[{
                  RowBox[{"ToLowerCase", "@", 
                   RowBox[{"ToString", "[", "h", "]"}]}], "<>", 
                  "\"\<.mgz\>\""}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WangTranslate", "/@", 
           RowBox[{"Round", "[", "f0", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"h", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"8fc7f285-7870-4f0f-9ec0-e73060cd73b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectWangAtlas", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectWangAtlas", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"Subject", "[", "sub", "]"}], ",", "hemi", ",", 
           "\"\<Registered\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{
          RowBox[{"Cortex", "[", 
           RowBox[{"FSAverageSubject", ",", "hemi", ",", "\"\<Sphere\>\""}], 
           "]"}], "/.", 
          RowBox[{"\"\<Wang15\>\"", "\[Rule]", 
           RowBox[{"$Wang2015Atlas", "[", "hemi", "]"}]}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"CortexResample", "[", 
       RowBox[{
        RowBox[{"w", "\[Rule]", "m"}], ",", 
        RowBox[{"Properties", "\[Rule]", "\"\<Wang15\>\""}], ",", 
        RowBox[{"Method", "\[Rule]", "Nearest"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"6614d31b-a683-4eae-afdf-3e72ee1e29a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clipped Weight for plots without transparency", "Subsection",ExpressionUUID->"a28ef6ca-0cf2-4208-98d4-81a773b8d48c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"ClippedWeight", ",", "WithClippedWeight"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClippedWeight", "[", 
    RowBox[{"mesh_", ",", 
     RowBox[{"cutoff_:", "0.2"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"VertexPropertyList", "[", "mesh", "]"}], ",", 
           "\"\<Weight\>\""}], "]"}], ",", "\"\<Weight\>\"", ",", 
         "\"\<VarianceExplained\>\""}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Unitize", "@", 
      RowBox[{"Clip", "[", 
       RowBox[{
        RowBox[{"w", "/.", "mesh"}], ",", 
        RowBox[{"{", 
         RowBox[{"cutoff", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WithClippedWeight", "[", 
    RowBox[{"mesh_", ",", 
     RowBox[{"val_:", "0.85"}], ",", 
     RowBox[{"cutoff_:", "0.2"}]}], "]"}], ":=", 
   RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
    RowBox[{"mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Weight\>\"", "\[Rule]", 
      RowBox[{"val", "*", 
       RowBox[{"ClippedWeight", "[", 
        RowBox[{"mesh", ",", "cutoff"}], "]"}]}]}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"e6e30776-b5ca-46e9-b1e8-905f3d176046"]
}, Closed]],

Cell[CellGroupData[{

Cell["Standard set of views for inflated hemispheres", "Subsection",ExpressionUUID->"6da88d4d-8561-43c0-9d6f-23991cc83a43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"StandardInflatedPlots", ",", "$OpenHemiViewOpts"}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$OpenHemiViewOpts", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LH", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ViewAngle", "\[Rule]", "0.2517950348275977`"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.3342217531666056`", ",", 
           RowBox[{"-", "1.8836311128322343`"}], ",", 
           RowBox[{"-", "2.474224352023766`"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.7905610802428452`", ",", 
           RowBox[{"-", "0.5951181205159447`"}], ",", 
           "0.14438698361983796`"}], "}"}]}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.48036276790694277`", ",", "0.43151657059112225`"}], 
            "}"}]}], "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"RH", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ViewAngle", "\[Rule]", "0.2492979472157374`"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.407344520964481`"}], ",", 
           RowBox[{"-", "2.12920840640889`"}], ",", 
           RowBox[{"-", "2.211388294358611`"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.6954053466903031`"}], ",", 
           RowBox[{"-", "0.6588168576371126`"}], ",", 
           "0.28700479418940034`"}], "}"}]}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5015219057633856`", ",", "0.43291425534582917`"}], 
            "}"}]}], "}"}]}]}], "}"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StandardInflatedPlots", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMesh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StandardInflatedPlots", "[", 
     RowBox[{"sub_", ",", "ds_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hemi", ",", "type"}], "}"}], "\[Rule]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"imsh", "=", 
             RowBox[{"WithOptions", "[", 
              RowBox[{
               RowBox[{"SubjectMesh", "[", 
                RowBox[{
                "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "ds"}], 
                "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"smsh", "=", 
             RowBox[{"WithOptions", "[", 
              RowBox[{
               RowBox[{"SubjectMesh", "[", 
                RowBox[{
                "sub", ",", "hemi", ",", "\"\<Sphere\>\"", ",", "ds"}], "]"}],
                ",", "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"msh", "=", 
              RowBox[{"CorticalMesh", "[", "\[IndentingNewLine]", 
               RowBox[{"imsh", ",", "\[IndentingNewLine]", 
                RowBox[{"VertexCoordinates", "\[Rule]", 
                 RowBox[{"Total", "[", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.75", "*", 
                    RowBox[{"VertexCoordinates", "[", "imsh", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0.25", "*", 
                    RowBox[{"VertexCoordinates", "[", "smsh", "]"}]}]}], 
                   "}"}], "]"}]}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
                RowBox[{"msh", ",", "\[IndentingNewLine]", 
                 RowBox[{"ColorFunction", "\[Rule]", 
                  RowBox[{"RetinotopyColor", "[", 
                   RowBox[{"type", ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", ">", "0.1"}], ",", "0.9", ",", "0"}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"$OpenHemiViewOpts", "[", "hemi", "]"}]}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Graphics3D", "@", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"emask", "=", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"12", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"pref", "<>", "\"\<Eccentricity\>\""}], "/.", 
                    "msh"}], ")"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"amask", "=", 
                    RowBox[{"Unitize", "@", 
                    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"pref", "<>", "\"\<VisualArea\>\""}], "/.", 
                    "msh"}], ")"}], "-", "area"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"area", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"vmasks", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"pref", "<>", "\"\<VisualArea\>\""}], "/.", 
                    "msh"}], ")"}], "-", "area"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"area", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ecc", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"pref", "<>", "\"\<Eccentricity\>\""}], "/.", 
                    "msh"}], ")"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ecc", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0.75", ",", "1.5", ",", "3", ",", "6", ",", "12"}], 
                    "}"}]}], "}"}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"pref", "\[Equal]", "\"\<Predicted\>\""}], ",", 
                    "White", ",", "Black"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", "=", 
                    RowBox[{
                    "LabelBoundaryVertexCoordinates", "[", 
                    "\[IndentingNewLine]", 
                    RowBox[{"msh", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VertexList", "[", "msh", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"#", "*", "emask", "*", "amask"}], ",", "1"}], 
                    "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2"}], "}"}], ",", "0.5"}], "]"}], 
                    "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Most", "[", "x", "]"}], ",", 
                    RowBox[{"Rest", "[", "x", "]"}]}], "}"}]}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", "vmasks"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"pref", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Benson14\>\"", ",", "\"\<Predicted\>\""}], 
                    "}"}]}], "}"}]}], "]"}]}]}], "}"}], "]"}]}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"type", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
          "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"hemi", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"8ae224b1-7421-4dde-9f41-f15407f00435"]
}, Closed]],

Cell[CellGroupData[{

Cell["Legends of the VisualField", "Subsection",ExpressionUUID->"efb50789-2533-4ab9-8b95-e30bd8df2b67"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldLegend", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldLegend", "[", 
    RowBox[{"\"\<PolarAngle\>\"", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
   RowBox[{"RegionPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}]}], "<", 
      RowBox[{"12", "^", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "12"}], ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "12"}], ",", "12"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"Function", "@", 
       RowBox[{"Blend", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"90", "-", 
             RowBox[{
              RowBox[{"180", "/", "Pi"}], "*", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}]}], "+", "180"}], ",", "360"}],
            "]"}], "-", "180"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldLegend", "[", 
    RowBox[{"\"\<Eccentricity\>\"", ",", 
     RowBox[{"max_:", "12"}]}], "]"}], ":=", 
   RowBox[{"RegionPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}]}], "<", 
      RowBox[{"max", "^", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Frame", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"Function", "@", 
       RowBox[{"Blend", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"$EccentricityBlendColors", "[", "RH", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Norm", "[", 
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2"}], "}"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"5f5e97d6-3704-44a8-a15b-d7aac7fef307"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Residuals and Errors", "Section",ExpressionUUID->"4c0516a3-6250-4ed5-9999-c09da9736816"],

Cell[CellGroupData[{

Cell["Summaries of Error", "Subsection",ExpressionUUID->"7384ed12-bf48-4646-806b-4644acb12e47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "SubjectErrorSummary", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectErrorSummary", "::", "usage"}], "=", 
   "\"\<SubjectErrorSummary[sub,hemi,dataset,type] yields a summary of the \
error for the appropriate subject, hemisphere, and dataset; the summary is a \
nested association containing error data calculated as the weighted mean of \
the difference between the datatype in the given dataset and the \
gold-standard (weight is the gold-standard variance explained). The type \
argument may be \\\"Predicted\\\", \\\"Training\\\", or \\\"Anatomical\\\".\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectErrorSummary", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectMesh", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Masking", "\[Rule]", "\"\<V123\>\""}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectErrorSummary", "[", 
     RowBox[{"sub_", ",", "hemi_", ",", "ds_", ",", "type_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"msh", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{
            "sub", ",", "hemi", ",", "\"\<Registered\>\"", ",", "ds"}], "]"}],
            ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"gs", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<Registered\>\"", ",", "0"}],
             "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tname", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ToLowerCase", "@", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ListQ", "[", "type", "]"}], ",", 
              RowBox[{"First", "[", "type", "]"}], ",", "type"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "\"\<predict\>\"", "|", "\"\<predicted\>\"", "|", 
               "\"\<prediction\>\""}], "\[Rule]", "\"\<Predicted\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "\"\<empirical\>\"", "|", "\"\<measured\>\"", "|", 
               "\"\<train\>\"", "|", "\"\<training\>\""}], "\[Rule]", 
              "\"\<\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "\"\<anatomical\>\"", "|", "\"\<anatomy\>\"", "|", 
               "\"\<benson14\>\""}], "\[Rule]", "\"\<Benson14\>\""}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tarea", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", "type", "]"}], ",", 
             RowBox[{"Last", "[", "type", "]"}], ",", "All"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"All", "|", "Full"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"1", "|", "2", "|", "3"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"x", ":", 
               RowBox[{"1", "|", "2", "|", "3"}]}], "\[RuleDelayed]", "x"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"x_List", "\[RuleDelayed]", 
              RowBox[{"Apply", "[", 
               RowBox[{"Alternatives", ",", "x"}], "]"}]}]}], "}"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Full", "|", "All"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0.1", ",", "11"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"None", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{"OccipitalPole", "[", 
          RowBox[{
           RowBox[{"$FreeSurferSubjects", "[", "\"\<fsaverage\>\"", "]"}], 
           ",", "hemi", ",", "\"\<Sphere\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rescale", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s", "=", "#1"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Function", "@", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mu", "=", 
                 RowBox[{"Mean", "[", "#", "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"s", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "#", "]"}], "-", "mu"}], 
                   ")"}]}], "+", "mu"}], "]"}]}], "]"}]}]}], "]"}]}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"eccidcs", "=", 
           RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Indices", "[", 
              RowBox[{
               RowBox[{"\"\<GoldEccentricity\>\"", "/.", "msh"}], ",", 
               RowBox[{
                RowBox[{"x_", "?", "NumericQ"}], "/;", 
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<", 
                 RowBox[{"range", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Indices", "[", 
              RowBox[{
               RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "gs"}], ",", 
               RowBox[{
                RowBox[{"x_", "?", "NumericQ"}], "/;", 
                RowBox[{"0", "<", "x", "<", "12"}]}]}], "]"}]}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"vaidcs", "=", 
           RowBox[{"Replace", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Masking", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Automatic", "|", "\"\<V123\>\""}], "\[RuleDelayed]", 
                
                RowBox[{"Pick", "[", 
                 RowBox[{
                  RowBox[{"VertexList", "[", "gs", "]"}], ",", 
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "gs"}], ",", 
                  RowBox[{"1", "|", "2", "|", "3"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s_String", "/;", 
                 RowBox[{"StringMatchQ", "[", 
                  RowBox[{"s", ",", 
                   RowBox[{"\"\<V\>\"", "~~", "DigitCharacter"}]}], "]"}]}], 
                "\[RuleDelayed]", 
                RowBox[{"Indices", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "gs"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ToExpression", "@", 
                   RowBox[{"StringTake", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"v_Integer", "\[RuleDelayed]", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "gs"}], ",", 
                  "v"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"v", ":", 
                 RowBox[{"{", 
                  RowBox[{"_Integer", ".."}], "}"}]}], "\[RuleDelayed]", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "gs"}], ",", 
                  RowBox[{"Alternatives", "@@", "v"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"All", "|", "Full"}], "\[RuleDelayed]", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                  RowBox[{"Unitize", "[", 
                   RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "gs"}], "]"}],
                   ",", 
                  RowBox[{"1", "|", "2", "|", "3"}]}], "]"}]}]}], "}"}]}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"idcs", "=", 
            RowBox[{"Intersection", "[", 
             RowBox[{"eccidcs", ",", "vaidcs"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vals", "=", 
               RowBox[{"Part", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tname", "<>", "\"\<PolarAngle\>\""}], ")"}], "/.",
                     "msh"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tname", "<>", "\"\<Eccentricity\>\""}], ")"}], "/.",
                     "msh"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<PolarAngle\>\"", "/.", "gs"}], ",", 
                    RowBox[{"\"\<Eccentricity\>\"", "/.", "gs"}]}], "}"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", "All", ",", "All", ",", 
                 "idcs"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"w", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\"\<VarianceExplained\>\"", "/.", "gs"}], ")"}], 
                "[", 
                RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "=", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"vals", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"xys", "=", 
                 RowBox[{"Map", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pa", "=", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", "pa", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", "pa", "]"}]}]}], "}"}]}], "]"}]}], 
                   ",", "\[IndentingNewLine]", "vals"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"prfsz", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\"\<PRFSize\>\"", "/.", "gs"}], ")"}], "[", 
                  RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"eccen", "=", 
                 RowBox[{"vals", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"absang", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Abs", "@", "#"}], ",", 
                    RowBox[{"Arg", "@", "#"}]}], "}"}], "&"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "I"}], "}"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"scabs", "=", 
                   RowBox[{"Sqrt", "@", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
                    RowBox[{"{", 
                    RowBox[{"eccen", ",", "eccen"}], "}"}]}], ")"}], "^", 
                    "2"}], "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Association", "@", 
                 RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mean", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{"#2", ",", "w"}], "]"}], "/", 
                    RowBox[{"Total", "[", "w", "]"}]}], ")"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"<|", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<Mean\>\"", "\[Rule]", "mean"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<StandardDeviation\>\"", "\[Rule]", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#2", "-", "mean"}], ")"}], "^", "2"}], ",", 
                    "w"}], "]"}], "/", 
                    RowBox[{"Total", "[", "w", "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<RMSE\>\"", "\[Rule]", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{"#2", "^", "2"}], ",", "w"}], "]"}], "/", 
                    RowBox[{"Total", "[", "w", "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<Median\>\"", "\[Rule]", 
                    RowBox[{"Median", "[", "#2", "]"}]}]}], "|>"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                    "\"\<AbsAngle\>\"", ",", "\"\<ArgAngle\>\"", ",", 
                    "\"\<AnglePerPRFRadius\>\"", ",", "\[IndentingNewLine]", 
                    "\"\<ScaledAbsAngle\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "delta", ",", "absang", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Unitize", "[", "prfsz", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"absang", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"prfsz", "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", "prfsz", "]"}]}], ")"}]}], 
                    ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "scabs"}], 
                    "}"}]}], "]"}]}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",Express\
ionUUID->"439d35e7-67ee-4246-9f7e-f6d36228ef24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"ErrorSummaries", ",", "$ErrorSummaries"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ErrorSummaries", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectErrorSummary", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ErrorSummaries", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mdl", "=", 
          RowBox[{"ToLowerCase", "@", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
             RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"clip", "=", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Clip", "]"}], "/.", 
           RowBox[{"Automatic", "\[Rule]", "None"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"mask", "=", 
          RowBox[{"OptionValue", "[", "Masking", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rng", "=", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Full", "|", "All"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "11"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"None", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}]}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
          RowBox[{"\"\<error-summaries\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<_model=\>\"", "<>", "mdl"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<_clip=\>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"clip", "===", "None"}], ",", "\"\<none\>\"", ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{"clip", ",", "10", ",", "2"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<_mask=\>\"", "<>", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"StringQ", "[", "mask", "]"}], ",", "mask", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"IntegerQ", "[", "mask", "]"}], ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{"mask", ",", "10", ",", "2"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ListQ", "[", "mask", "]"}], ",", 
              RowBox[{"\"\<[\>\"", "<>", 
               RowBox[{"StringJoin", "@", 
                RowBox[{"Riffle", "[", 
                 RowBox[{
                  RowBox[{"ToString", "/@", 
                   RowBox[{"Sort", "[", "mask", "]"}]}], ",", "\"\<,\>\""}], 
                 "]"}]}], "<>", "\"\<]\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"mask", "===", "All"}], "||", 
               RowBox[{"mask", "===", "Full"}]}], ",", "\"\<all\>\"", ",", 
              "\[IndentingNewLine]", "True", ",", "\"\<??\>\""}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<_range=[\>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"First", "[", "rng", "]"}]}], "<>", "\"\<,\>\"", "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"Last", "[", "rng", "]"}]}], "<>", "\"\<]\>\""}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<Subject\>\"", "\[Rule]", "sub"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Hemi\>\"", "\[Rule]", "hemi"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Dataset\>\"", "\[Rule]", "ds"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Coverage\>\"", "\[Rule]", 
              RowBox[{"SubjectDatasetCoverage", "[", 
               RowBox[{"sub", ",", "ds"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<RetinotopyModel\>\"", "\[Rule]", 
              RowBox[{"Capitalize", "@", 
               RowBox[{"ToLowerCase", "[", "mdl", "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Clip\>\"", "\[Rule]", "clip"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Training\>\"", "\[Rule]", 
              RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"SubjectErrorSummary", "[", 
                 RowBox[{
                 "sub", ",", "hemi", ",", "ds", ",", "\"\<Training\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Predicted\>\"", "\[Rule]", 
              RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"SubjectErrorSummary", "[", 
                 RowBox[{
                 "sub", ",", "hemi", ",", "ds", ",", "\"\<Predicted\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Anatomical\>\"", "\[Rule]", 
              RowBox[{"WithOptions", "[", "\[IndentingNewLine]", " ", 
               RowBox[{
                RowBox[{"SubjectErrorSummary", "[", 
                 RowBox[{
                 "sub", ",", "hemi", ",", "0", ",", "\"\<Anatomical\>\""}], 
                 "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}]}], 
            "|>"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"hemi", ",", 
             RowBox[{"{", 
              RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"ds", ",", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
                 RowBox[{"0", "<", "#", "<", "99"}]}], "&"}]}], "]"}]}], 
            "}"}]}], "]"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$ErrorSummaries", ":=", 
     RowBox[{"ErrorSummaries", "[", "]"}]}]}], "]"}], ";"}]}], "Input",Express\
ionUUID->"f754a305-d725-4d70-bc13-739aec031f0e"]
}, Closed]],

Cell[CellGroupData[{

Cell["All-Vertex Error Dataset", "Subsection",ExpressionUUID->"f422aabe-3796-4000-8998-7bea0babe4ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ErrorData", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ErrorData", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMesh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ErrorData", "[", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mdl", "=", 
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
            RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], "]"}]}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"clip", "=", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Clip", "]"}], "/.", 
          RowBox[{"Automatic", "\[Rule]", "12"}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "\"\<errors_model=\>\"", "<>", "mdl", "<>", "\"\<_clip=\>\"", "<>", 
         RowBox[{"(", 
          RowBox[{"clip", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"None", "\[Rule]", "\"\<none\>\""}], ",", 
             RowBox[{"x_", "\[RuleDelayed]", 
              RowBox[{"IntegerString", "[", 
               RowBox[{"x", ",", "10", ",", "2"}], "]"}]}]}], "}"}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Dataset", "@", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cols", "=", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<Subject\>\"", ",", "\"\<Hemi\>\"", ",", "\"\<Dataset\>\"", 
               ",", "\"\<Coverage\>\"", ",", "\[IndentingNewLine]", 
               "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
               "\"\<PredictedPolarAngle\>\"", ",", 
               "\"\<PredictedEccentricity\>\"", ",", 
               "\"\<AnatomicalPolarAngle\>\"", ",", 
               "\"\<AnatomicalEccentricity\>\"", ",", 
               "\"\<GoldPolarAngle\>\"", ",", "\"\<GoldEccentricity\>\"", 
               ",", "\"\<VarianceExplained\>\"", ",", "\"\<VisualArea\>\"", 
               ",", "\"\<NativeCoordinates\>\"", ",", 
               "\"\<FSAverageCoordinates\>\"", ",", 
               "\"\<PriorCoordinates\>\"", ",", 
               "\"\<RetinotopyCoordinates\>\""}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", ",", "h", ",", "ds", ",", 
               RowBox[{"prog", "=", "0"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PrintTemporary", "@", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"$BaseStyle", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Helvetica Neue\>\""}], ",", 
                    
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "13"}]}], "}"}]}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Grid", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Processing subject datasets...\>\"", ",", 
                    "$BaseStyle"}], "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ProgressIndicator", "[", 
                    RowBox[{"Dynamic", "[", "prog", "]"}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Subject: \>\"", ",", "$BaseStyle"}], "]"}], 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "s", "]"}], ",", "$BaseStyle"}], 
                    "]"}], ",", "\"\<  \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Hemi: \>\"", ",", "$BaseStyle"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "h", "]"}], ",", "$BaseStyle"}], 
                    "]"}], ",", "\"\<  \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Dataset: \>\"", ",", "$BaseStyle"}], "]"}], 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "ds", "]"}], ",", "$BaseStyle"}], 
                    "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Background", "\[Rule]", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.95", ",", "0.98", ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.85", ",", "0.90", ",", "0.95"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacings", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Association", "@", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"cols", "\[Rule]", "#"}], "]"}]}], "&"}], "/@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "All", ",", "1"}], "]"}], "]"}], 
                  "]"}]}], "&"}], "@", 
               RowBox[{"Reap", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"s", ",", "h", ",", "\"\<Sphere\>\"", ",", "ds"}],
                     "]"}], ",", "opts"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"g", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "s", ",", "h", ",", "\"\<Registered\>\"", ",", "0"}], 
                    "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"b", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"Benson14Mesh", "[", 
                    RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}], ",", 
                    "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"\"\<Eccentricity\>\"", "/.", "g"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "x", "]"}], "&&", 
                    RowBox[{"0", "<", "x", "<", "12"}]}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "g"}], ",", 
                    RowBox[{"x_Integer", "/;", 
                    RowBox[{"x", ">", "0"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "g"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "x", "]"}], "&&", 
                    RowBox[{"x", "<", "12"}]}]}]}], "]"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Subject\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"h", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Hemi\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"ds", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Dataset\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"SubjectDatasetCoverage", "[", 
                    RowBox[{"s", ",", "ds"}], "]"}], ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Coverage\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "/.", "m"}], ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "p"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                    "\"\<PredictedPolarAngle\>\"", ",", 
                    "\"\<PredictedEccentricity\>\""}], "}"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<Benson14\>\"", "<>", "p"}], ")"}], "/.", 
                    "m"}], ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    RowBox[{"\"\<Anatomical\>\"", "<>", "p"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
                    "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "/.", "g"}], ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    RowBox[{"\"\<Gold\>\"", "<>", "p"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
                    "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "g"}], ")"}],
                     "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<VisualArea\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "g"}], ")"}], 
                    "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<VarianceExplained\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"VertexCoordinates", "[", "m", "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<NativeCoordinates\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"VertexCoordinates", "[", "g", "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<FSAverageCoordinates\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedRegistration\>\"", "/.", "m"}], 
                    ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<RetinotopyCoordinates\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "&"}], "@", 
                    RowBox[{"CortexLookup", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CorticalMesh", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"VertexCoordinates", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedRegistration\>\"", "/.", "b"}], 
                    ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"CortexAddress", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"VertexCoordinates", "[", "g", "]"}]}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    "\"\<PriorCoordinates\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"prog", "+=", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "$Subjects", "]"}], "*", "2", "*", 
                    "21"}], ")"}]}]}]}]}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", "$Subjects"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"h", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"ds", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"$SubjectDatasets", "[", "s", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
                    RowBox[{"0", "<", "#", "<", "99"}]}], "&"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", "cols", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Apply", "[", 
                   RowBox[{"Join", ",", "#2"}], "]"}], "&"}]}], "]"}]}]}]}], 
            "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",Expr\
essionUUID->"d95b5c38-0d67-400c-92f6-da128ee175c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["All-Vertex Errors Organized by Coverage (time in scanner)", "Subsection",ExpressionUUID->"8556b810-eb32-4ab2-8e55-d8536618358f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ErrorByCoverage", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ErrorByCoverage", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"VisualAreas", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "ErrorData", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ErrorByCoverage", "[", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vas", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Full", "|", "All"}], "\[Rule]", 
              RowBox[{"Range", "[", "12", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Automatic", "|", "\"\<V123\>\"", "|", "123"}], 
              "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"k_Integer", "\[RuleDelayed]", 
              RowBox[{"{", "k", "}"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"errs", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"ErrorData", "[", "]"}], ",", "opts"}], "]"}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"subdata", "=", 
          RowBox[{"errs", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"vas", ",", "#VisualArea"}], "]"}], "&"}], "]"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tang", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<PolarAngle\>\""}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"tecc", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<Eccentricity\>\""}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"gang", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<GoldPolarAngle\>\""}], "]"}]}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"gecc", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<GoldEccentricity\>\""}], "]"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"iang", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<PredictedPolarAngle\>\""}], "]"}]}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"iecc", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<PredictedEccentricity\>\""}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"aang", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<AnatomicalPolarAngle\>\""}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"aecc", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<AnatomicalEccentricity\>\""}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"vxpl", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<VarianceExplained\>\""}], "]"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"area", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<VisualArea\>\""}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"subs", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<Subject\>\""}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"sdss", "=", 
               RowBox[{"Normal", "@", 
                RowBox[{"subdata", "[", 
                 RowBox[{"All", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#Subject", ",", "#Dataset"}], "}"}], "&"}]}], 
                 "]"}]}]}], ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"covs", "=", 
             RowBox[{"Normal", "@", 
              RowBox[{"subdata", "[", 
               RowBox[{"All", ",", "\"\<Coverage\>\""}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"toXY", "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#2", "*", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"Pi", "/", "180"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"90", "-", "#1"}], ")"}]}], "]"}]}], ",", 
                RowBox[{"#2", "*", 
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"Pi", "/", "180"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"90", "-", "#1"}], ")"}]}], "]"}]}]}], "}"}], 
              "&"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"subidcs", "=", 
               RowBox[{"Association", "@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"k", "\[Rule]", 
                   RowBox[{"Indices", "[", 
                    RowBox[{"subs", ",", "k"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"Union", "[", "subs", "]"}]}], "}"}]}], "]"}]}]}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"txy", "=", 
               RowBox[{"toXY", "[", 
                RowBox[{"tang", ",", "tecc"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"gxy", "=", 
               RowBox[{"toXY", "[", 
                RowBox[{"gang", ",", "gecc"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ixy", "=", 
               RowBox[{"toXY", "[", 
                RowBox[{"iang", ",", "iecc"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"axy", "=", 
               RowBox[{"toXY", "[", 
                RowBox[{"aang", ",", "aecc"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"tses", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ColumnNorms", "[", 
                    RowBox[{"txy", "-", "gxy"}], "]"}], "/", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"gecc", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "Infinity"}], "}"}]}], "]"}]}], ")"}],
                   "^", "2"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"ises", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ColumnNorms", "[", 
                    RowBox[{"ixy", "-", "gxy"}], "]"}], "/", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"gecc", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "Infinity"}], "}"}]}], "]"}]}], ")"}],
                   "^", "2"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"ases", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ColumnNorms", "[", 
                    RowBox[{"axy", "-", "gxy"}], "]"}], "/", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"gecc", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "Infinity"}], "}"}]}], "]"}]}], ")"}],
                   "^", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"name", "\[Rule]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"snes", "=", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"name", "\[Equal]", "\"\<Training\>\""}], ",", 
                    "tses", ",", 
                    RowBox[{"name", "\[Equal]", "\"\<Inferred\>\""}], ",", 
                    "ises", ",", "True", ",", "ases"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cii", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"covs", ",", "cc"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"msnes", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", "=", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"cii", ",", "sii"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "ii", "]"}], "<", "2"}], ",", 
                    "\[IndentingNewLine]", "Nothing", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"snes", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ".", 
                    RowBox[{"vxpl", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}]}], "/", 
                    RowBox[{"Total", "[", 
                    RowBox[{"vxpl", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "]"}]}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"sii", ",", 
                    RowBox[{"Values", "[", "subidcs", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "msnes", "]"}], "<", "2"}], ",", 
                    "\[IndentingNewLine]", "Nothing", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", "msnes", "]"}], ",", 
                    RowBox[{
                    RowBox[{"StandardDeviation", "[", "msnes", "]"}], "/", 
                    RowBox[{"Sqrt", "@", 
                    RowBox[{"Length", "[", "msnes", "]"}]}]}]}], "}"}]}], 
                    "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"cc", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"name", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Training\>\"", ",", "\"\<Inferred\>\"", ",", 
                    "\"\<Anatomical\>\""}], "}"}]}], "}"}]}], "]"}]}]}], 
             "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"a7598d07-ba2f-4ca2-bb82-e609edf8a6b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$FoveaPeripheryData", ",", "$FoveaPeripherySummary"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$FoveaPeripheryData", ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fov-per-data\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"err0", "=", 
               RowBox[{
                RowBox[{"ErrorData", "[", "]"}], "[", "\[IndentingNewLine]", 
                RowBox[{"Select", "@", 
                 RowBox[{"Function", "@", 
                  RowBox[{"And", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"#Coverage", "\[Equal]", "cov"}], ",", 
                    RowBox[{"#PredictedEccentricity", "<", "14"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0", "<", "#VisualArea", "<", "4"}], ",", 
                    RowBox[{"#VarianceExplained", ">", "0"}]}], "]"}]}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"v2x", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#1", "*", 
                    RowBox[{"Cos", "[", "#2", "]"}]}], ",", 
                    RowBox[{"#1", "*", 
                    RowBox[{"Sin", "[", "#2", "]"}]}]}], "}"}], "&"}], "[", 
                 RowBox[{"#2", ",", 
                  RowBox[{
                   RowBox[{"Pi", "/", "180"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"90", "-", "#1"}], ")"}]}]}], "]"}], "&"}]}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"a", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<PolarAngle\>\""}], "]"}]}]}], 
                  ",", 
                  RowBox[{"e", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<Eccentricity\>\""}], "]"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"pa", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<PredictedPolarAngle\>\""}], 
                    "]"}]}]}], ",", 
                  RowBox[{"pe", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<PredictedEccentricity\>\""}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ga", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<GoldPolarAngle\>\""}], "]"}]}]}],
                   ",", 
                  RowBox[{"ge", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<GoldEccentricity\>\""}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"v", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<VarianceExplained\>\""}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"s", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<Subject\>\""}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"h", "=", 
                   RowBox[{"Normal", "@", 
                    RowBox[{"err", "[", 
                    RowBox[{"All", ",", "\"\<Hemi\>\""}], "]"}]}]}]}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{"v2x", "[", 
                    RowBox[{"a", ",", "e"}], "]"}]}], ",", 
                    RowBox[{"px", "=", 
                    RowBox[{"v2x", "[", 
                    RowBox[{"pa", ",", "pe"}], "]"}]}], ",", 
                    RowBox[{"gx", "=", 
                    RowBox[{"v2x", "[", 
                    RowBox[{"ga", ",", "ge"}], "]"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<Error\>\"", "\[Rule]", 
                    RowBox[{"x", "-", "gx"}]}], ",", 
                    RowBox[{"\"\<PredictedError\>\"", "\[Rule]", 
                    RowBox[{"px", "-", "gx"}]}], ",", 
                    RowBox[{"\"\<Weights\>\"", "\[Rule]", "v"}], ",", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "ge"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<Subject\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<Hemi\>\"", "\[Rule]", "h"}]}], "|>"}]}], 
                 "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"err", ",", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"err0", "@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"#GoldEccentricity", "<", "3.9"}], "&"}], "]"}]}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"err0", "@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"3.9", "<", "#GoldEccentricity", "<", "12"}], 
                    "&"}], "]"}]}]}], "}"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"cov", ",", "1", ",", "6"}], "}"}]}], "]"}]}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"$FoveaPeripherySummary", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"fov", "=", "#1"}], ",", 
             RowBox[{"per", "=", "#2"}], ",", 
             RowBox[{"key", "=", "#3"}]}], "}"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"key", "\[Rule]", 
            RowBox[{"Association", "@", 
             RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"fn1", "=", "#1"}], ",", 
                    RowBox[{"fn2", "=", "#2"}], ",", 
                    RowBox[{"nm", "=", "#3"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"nm", "\[Rule]", 
                   RowBox[{"Association", "@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", "\[IndentingNewLine]", 
                    RowBox[{"#2", "\[Rule]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"fn1", "@", 
                    RowBox[{"WeightedData", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"fn2", "@", 
                    RowBox[{"Divide", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ColumnNorms", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"pre", "<>", "\"\<Error\>\""}], "]"}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"#Eccentricity", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "Infinity"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ",",
                     "\[IndentingNewLine]", "#Weights"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"pre", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\"\<Predicted\>\""}], "}"}]}], 
                    "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"fov", ",", "per"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Fovea\>\"", ",", "\"\<Periphery\>\""}], 
                    "}"}]}], "}"}]}], "]"}]}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Mean", ",", 
                   RowBox[{"Sqrt", "@*", "Mean"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Identity", ",", 
                   RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<MAE\>\"", ",", "\"\<RMSE\>\""}], "}"}]}], 
                "}"}]}], "]"}]}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{"$FoveaPeripheryData", ",", 
          RowBox[{"Range", "[", "6", "]"}]}], "]"}]}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"a1ee7405-3eae-4d15-87f8-1a9bae844a8b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Deviation/Deformation Information", "Subsection",ExpressionUUID->"210f6cd2-37b1-42c2-b590-02a3dc0f3793"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"DeviationData", ",", "DeviationDataParseOptions"}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DeviationData", "]"}], "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "12"}], "}"}]}], ",", 
        RowBox[{"Masking", "\[Rule]", "\"\<V123\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Options", "[", "ErrorData", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeviationDataParseOptions", "[", 
     RowBox[{"OptionsPattern", "[", "DeviationData", "]"}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rng", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"Full", "|", "All"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "90"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"msk", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Masking", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<V123\>\"", "|", "Automatic", "|", "123"}], 
              "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
              RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"All", "\[Rule]", 
              RowBox[{"Range", "[", "12", "]"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"mdl", "=", 
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
            RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], "]"}]}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"clip", "=", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Clip", "]"}], ",", 
           RowBox[{"Automatic", "\[Rule]", "12"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"Range", "\[Rule]", "rng"}], ",", 
        RowBox[{"Masking", "\[Rule]", "msk"}], ",", 
        RowBox[{"RetinotopyModel", "\[Rule]", "mdl"}], ",", 
        RowBox[{"Clip", "\[Rule]", "clip"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AutoCache", "\[Rule]", 
         RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<deviations\>\"", ",", "\[IndentingNewLine]", "\"\<_model=\>\"",
            ",", "mdl", ",", "\[IndentingNewLine]", "\"\<_clip=\>\"", ",", 
           RowBox[{"ToString", "[", "clip", "]"}], ",", 
           "\[IndentingNewLine]", "\"\<_range=[\>\"", ",", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", "rng"}], ",", "\"\<,\>\""}], "]"}], 
           ",", "\"\<]\>\"", ",", "\[IndentingNewLine]", "\"\<_mask=[\>\"", 
           ",", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", "msk"}], ",", "\"\<,\>\""}], "]"}], 
           ",", "\"\<]\>\""}], "]"}]}]}], "|>"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeviationData", "[", 
     RowBox[{"opts0", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"opts", "=", 
        RowBox[{"DeviationDataParseOptions", "[", "opts0", "]"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"opts", "[", "AutoCache", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Dataset", "@", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"cols", "=", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
               "\"\<Subject\>\"", ",", "\"\<Hemi\>\"", ",", 
                "\[IndentingNewLine]", "\"\<PolarAngle\>\"", ",", 
                "\"\<Eccentricity\>\"", ",", "\"\<VarianceExplained\>\"", ",",
                 "\[IndentingNewLine]", "\"\<PredictedPolarAngle\>\"", ",", 
                "\"\<PredictedEccentricity\>\"", ",", "\"\<VisualArea\>\"", 
                ",", "\[IndentingNewLine]", "\"\<NativeCoordinates\>\"", ",", 
                "\"\<FSAverageCoordinates\>\"", ",", 
                "\"\<PriorCoordinates\>\"", ",", 
                "\"\<RetinotopyCoordinates\>\"", ",", 
                "\"\<IdealCoordinates\>\""}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"emin", "=", 
              RowBox[{
               RowBox[{"opts", "[", "Range", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"emax", "=", 
              RowBox[{
               RowBox[{"opts", "[", "Range", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ds", "=", "99"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Association", "@", 
                RowBox[{"Thread", "[", 
                 RowBox[{"cols", "\[Rule]", "#"}], "]"}]}], "&"}], "/@", 
              RowBox[{"Transpose", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "All", ",", "1"}], "]"}], "]"}], "]"}]}], 
             "&"}], "@", 
            RowBox[{"Reap", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"m", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"s", ",", "h", ",", "\"\<Sphere\>\"", ",", "ds"}],
                     "]"}], ",", "opts0"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"g", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "s", ",", "h", ",", "\"\<Registered\>\"", ",", "0"}], 
                    "]"}], ",", "opts0"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"b", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"Benson14Mesh", "[", 
                    RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}], ",", 
                    "opts0"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"\"\<Eccentricity\>\"", "/.", "g"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "x", "]"}], "&&", 
                    RowBox[{"emin", "<", "x", "<", "emax"}]}]}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "g"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "x", "]"}], "&&", 
                    RowBox[{"emin", "<", "x", "<", "emax"}]}]}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "g"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"x_Integer", "/;", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"opts", "[", "Masking", "]"}], ",", "x"}], 
                    "]"}]}]}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Subject\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"h", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Hemi\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "/.", "m"}], ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "p"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                    "\"\<PredictedPolarAngle\>\"", ",", 
                    "\"\<PredictedEccentricity\>\""}], "}"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "g"}], ")"}],
                     "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<VisualArea\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "g"}], ")"}], 
                    "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<VarianceExplained\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"VertexCoordinates", "[", "m", "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<NativeCoordinates\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"VertexCoordinates", "[", "g", "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<FSAverageCoordinates\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedRegistration\>\"", "/.", "m"}], 
                    ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<RetinotopyCoordinates\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "&"}], "@", 
                    RowBox[{"CortexLookup", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CorticalMesh", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"VertexCoordinates", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedRegistration\>\"", "/.", "b"}], 
                    ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"CortexAddress", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"VertexCoordinates", "[", "g", "]"}]}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    "\"\<PriorCoordinates\>\""}], "]"}]}]}], "]"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "$Subjects"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"h", ",", 
                  RowBox[{"{", 
                   RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "cols", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"Join", ",", "#2"}], "]"}], "&"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID-\
>"f1d3e145-bf1a-40fc-96a2-a11dbd6e4afd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"DeviationSummaries", ",", "$DeviationSummariesOrder"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$DeviationSummariesOrder", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Native\>\"", ",", "\"\<FSAverage\>\"", ",", "\"\<Prior\>\"", ",", 
     "\"\<Retinotopy\>\"", ",", "\"\<Ideal\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeviationSummaries", "]"}], "=", 
   RowBox[{"Options", "[", "DeviationData", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeviationSummaries", "[", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subs", "=", 
        RowBox[{"Normal", "@", 
         RowBox[{
          RowBox[{"DeviationData", "[", "]"}], "[", 
          RowBox[{"All", ",", "\"\<Subject\>\""}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"iis", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"s", "\[Rule]", 
              RowBox[{"Indices", "[", 
               RowBox[{"subs", ",", "s"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"Union", "[", "subs", "]"}]}], "}"}]}], "]"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"split", "=", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", "=", "#"}], "}"}], ",", 
               RowBox[{"Association", "@", 
                RowBox[{"KeyValueMap", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "&"}], ",", "iis"}], 
                 "]"}]}]}], "]"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"fsaX", "=", 
              RowBox[{"split", "@", 
               RowBox[{"Normal", "@", 
                RowBox[{
                 RowBox[{"DeviationData", "[", "]"}], "[", 
                 RowBox[{"All", ",", "\"\<FSAverageCoordinates\>\""}], 
                 "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"align", "=", 
                RowBox[{"Function", "@", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"AlignPoints3D", "[", 
                    RowBox[{
                    RowBox[{"fsaX", "[", "s", "]"}], ",", 
                    RowBox[{"#", "[", "s", "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"Keys", "[", "#", "]"}]}], "}"}]}], "]"}]}]}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"X", "=", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"align", "@", 
                    RowBox[{"split", "@", 
                    RowBox[{"Normal", "@", 
                    RowBox[{
                    RowBox[{"DeviationData", "[", "]"}], "[", 
                    RowBox[{"All", ",", 
                    RowBox[{"q", "<>", "\"\<Coordinates\>\""}]}], "]"}]}]}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "$DeviationSummariesOrder"}], "}"}]}], 
                   "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"dmtcs", "=", 
                    RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "@", 
                    RowBox[{"Total", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#1", "-", "#2"}], ")"}], "^", "2"}], "]"}]}]}], 
                    "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "s", "]"}], "&"}], "/@", "X"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "s", "]"}], "&"}], "/@", "X"}], ",", 
                    "1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"Keys", "[", "iis", "]"}]}], "}"}]}], "]"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Association", "@", 
                   RowBox[{"KeyValueMap", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"Mean", "[", "#2", "]"}]}], "&"}], ",", "dmtcs"}],
                     "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"6d7d9878-\
d7ed-4db7-9405-a48142149613"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Organizing PRF-Size and Cortical Magnification Data", "Section",ExpressionUUID->"740216cd-e0eb-47b0-942d-56f32658b2b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PRFSizeData", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PRFSizeData", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Range", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "12"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Options", "[", "SubjectMesh", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRFSizeData", "[", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mdl", "=", 
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], ",", 
            RowBox[{"Automatic", "\[Rule]", "\"\<benson17\>\""}]}], "]"}]}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"clip", "=", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Clip", "]"}], "/.", 
          RowBox[{"Automatic", "\[Rule]", "12"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rng", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"All", "|", "Full"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<prfSizeData\>\"", ",", "\[IndentingNewLine]", "\"\<_model=\>\"",
           ",", "mdl", ",", "\[IndentingNewLine]", "\"\<_clip=\>\"", ",", 
          RowBox[{"(", 
           RowBox[{"clip", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"None", "\[Rule]", "\"\<none\>\""}], ",", 
              RowBox[{"x_", "\[RuleDelayed]", 
               RowBox[{"IntegerString", "[", 
                RowBox[{"x", ",", "10", ",", "2"}], "]"}]}]}], "}"}]}], ")"}],
           ",", "\[IndentingNewLine]", "\"\<_range=[\>\"", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"rng", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<,\>\"", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"rng", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Dataset", "@", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cols", "=", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<Subject\>\"", ",", "\"\<Hemi\>\"", ",", "\"\<Dataset\>\"", 
               ",", "\"\<Coverage\>\"", ",", "\[IndentingNewLine]", 
               "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
               "\"\<PRFSize\>\"", ",", "\"\<PredictedPolarAngle\>\"", ",", 
               "\"\<PredictedEccentricity\>\"", ",", 
               "\"\<PredictedPRFSize\>\"", ",", "\"\<Magnification\>\"", ",", 
               "\"\<PredictedMagnification\>\"", ",", "\"\<GoldPRFSize\>\"", 
               ",", "\"\<GoldMagnification\>\"", ",", 
               "\"\<VarianceExplained\>\"", ",", "\"\<VisualArea\>\""}], 
              "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s", ",", "h", ",", "ds", ",", 
               RowBox[{"prog", "=", "0"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PrintTemporary", "@", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"$BaseStyle", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Helvetica Neue\>\""}], ",", 
                    
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "13"}]}], "}"}]}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Grid", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Processing subject datasets...\>\"", ",", 
                    "$BaseStyle"}], "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ProgressIndicator", "[", 
                    RowBox[{"Dynamic", "[", "prog", "]"}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Subject: \>\"", ",", "$BaseStyle"}], "]"}], 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "s", "]"}], ",", "$BaseStyle"}], 
                    "]"}], ",", "\"\<  \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Hemi: \>\"", ",", "$BaseStyle"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "h", "]"}], ",", "$BaseStyle"}], 
                    "]"}], ",", "\"\<  \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Dataset: \>\"", ",", "$BaseStyle"}], "]"}], 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "ds", "]"}], ",", "$BaseStyle"}], 
                    "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Background", "\[Rule]", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.95", ",", "0.98", ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.85", ",", "0.90", ",", "0.95"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacings", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Association", "@", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"cols", "\[Rule]", "#"}], "]"}]}], "&"}], "/@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "All", ",", "1"}], "]"}], "]"}], 
                  "]"}]}], "&"}], "@", 
               RowBox[{"Reap", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"s", ",", "h", ",", "\"\<Sphere\>\"", ",", "ds"}],
                     "]"}], ",", "opts"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"g", "=", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"s", ",", "h", ",", "\"\<Sphere\>\"", ",", "0"}], 
                    "]"}], ",", "opts"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "m"}], ",", 
                    RowBox[{"x_Integer", "/;", 
                    RowBox[{"x", ">", "0"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "m"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "x", "]"}], "&&", 
                    RowBox[{
                    RowBox[{"rng", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<", 
                    RowBox[{"rng", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], "]"}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Subject\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"h", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Hemi\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"ds", ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Dataset\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"SubjectDatasetCoverage", "[", 
                    RowBox[{"s", ",", "ds"}], "]"}], ",", 
                    RowBox[{"Length", "[", "ii", "]"}]}], "]"}], ",", 
                    "\"\<Coverage\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "/.", "m"}], ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "p"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<PRFSize\>\"", ",", 
                    "\"\<Eccentricity\>\"", ",", 
                    "\"\<PredictedPolarAngle\>\"", ",", 
                    "\"\<PredictedEccentricity\>\"", ",", 
                    "\"\<PredictedPRFSize\>\""}], "}"}]}], "}"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PRFSize\>\"", "/.", "g"}], ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<GoldPRFSize\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "m"}], ")"}],
                     "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<VisualArea\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "m"}], ")"}], 
                    "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<VarianceExplained\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<Magnification\>\"", "/.", "m"}], ")"}], "[", 
                    
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<Magnification\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<Magnification\>\"", "/.", "g"}], ")"}], "[", 
                    
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<GoldMagnification\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedMagnification\>\"", "/.", "m"}], 
                    ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<PredictedMagnification\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedMagnification\>\"", "/.", "g"}], 
                    ")"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", 
                    "\"\<GoldPredictedMagnification\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"prog", "+=", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "$Subjects", "]"}], "*", "2", "*", 
                    "22"}], ")"}]}]}]}]}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", "$Subjects"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"h", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"ds", ",", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"$SubjectDatasets", "[", "s", "]"}], ",", 
                    "IntegerQ"}], "]"}], ",", "99"}], "]"}]}], "}"}]}], "]"}],
                  ",", "\[IndentingNewLine]", "cols", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Apply", "[", 
                   RowBox[{"Join", ",", "#2"}], "]"}], "&"}]}], "]"}]}]}]}], 
            "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",Expr\
essionUUID->"c9040798-5dbc-4ee7-97ee-263aff501ec0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Plotting projections to the visual field and retinotopy model\
\>", "Section",ExpressionUUID->"48084d53-3837-481c-8283-4d013c0d6266"],

Cell["\<\
The functions defined in this section of the notebook allow one to plot data \
projected into the visual field; these projections can be based either on the \
individualized template fits or on the raw data.\
\>", "Text",ExpressionUUID->"db03362c-b47b-4887-9069-01118e09ed97"],

Cell[CellGroupData[{

Cell["Functions to Parse Options", "Subsection",ExpressionUUID->"7d3ad60a-7a80-409c-a8a2-04393eccf467"],

Cell["\<\
These functions parse options given to the various functions that follow them,\
\>", "Text",ExpressionUUID->"247c33b9-128a-413d-8f62-cc9068472ad0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldParseOption", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "::", "badopt"}], "=", 
   "\"\<Bad option given to VisualField option parser: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Range", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Projection", "\[Rule]", "\"\<Empirical\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "\"\<VarianceExplained\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Select", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Range", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Range", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"m_", "?", "NumericQ"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mm", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "\[RuleDelayed]", 
        "mm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"None", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Automatic", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Range should be a max eccentricity or a {min,max} list.\>\""}],
          "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Select", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Select", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"None", "|", "Automatic", "|", "False"}], "\[Rule]", "None"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"VisualArea", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "VisualArea", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"None", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"All", "|", "Full"}], "\[Rule]", 
        RowBox[{"Keys", "@", 
         RowBox[{
          RowBox[{"Benson17Model", "[", "LH", "]"}], "[", 
          "\"\<VisualAreaNames\>\"", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"x_Integer", "\[RuleDelayed]", 
        RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"x_String", "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Benson17Model", "[", "LH", "]"}], "[", 
           "\"\<VisualAreaKey\>\"", "]"}], "[", "x", "]"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{"VectorQ", "[", 
          RowBox[{"x", ",", "StringQ"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Benson17Model", "[", "LH", "]"}], "[", 
           "\"\<VisualAreaKey\>\"", "]"}], "/@", "x"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{"VectorQ", "[", 
          RowBox[{"x", ",", "IntegerQ"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Union", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<VisualArea must be an integer, a string, a list containing \
integers/strings, or All\>\""}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Projection", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$EmpiricalPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"$SemiEmpiricalPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"$GoldPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GoldPolarAngle\>\"", ",", "\"\<GoldEccentricity\>\""}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$PredictedPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<PredictedPolarAngle\>\"", ",", 
          "\"\<PredictedEccentricity\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$AnatomyPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Benson14PolarAngle\>\"", ",", "\"\<Benson14Eccentricity\>\""}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ang_String", ",", "ecc_String"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"inAllMeshes", "[", "ang", "]"}], "&&", 
           RowBox[{"inAllMeshes", "[", "ecc", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ang", ",", "ecc"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<polar angle/eccentricity properties were not present in all \
specified meshes\>\""}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m_", "?", "MatrixQ"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit angles can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Projection (\>\"", "<>", 
           RowBox[{"ToString", "@", 
            RowBox[{"OptionValue", "[", "Projection", "]"}]}], "<>", 
           "\"\<) should be Empirical or GoldStandard\>\""}]}], "]"}]}]}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Weights", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Weights", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"False", "|", "None"}], "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Weight\>\"", "\[Rule]", "\"\<Weight\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<VarianceExplained\>\"", "\[Rule]", "\"\<VarianceExplained\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"s_String", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inAllMeshes", "[", "s", "]"}], ",", "\[IndentingNewLine]", 
          "s", ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<weight property not present in all meshes\>\""}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m_List", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit weights can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Weights should be \\\"Weight\\\", \\\"VarianceExplained\\\", \
or None\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->\
"28029415-8ef1-4c8b-9c92-2d2671fd32cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Averaging data into the visual field", "Subsection",ExpressionUUID->"d58ed629-e2d9-4aa0-9120-28d81b18f4e7"],

Cell["\<\
Given a subject or group of subjects, a property to project, and polar \
angle/eccentricity properties (optionally weight), combine all the data into \
a single visual field mesh and return it.
The visual field mesh is returned as a function.\
\>", "Text",ExpressionUUID->"44aab93c-c7bd-4d55-b4f7-58f68f13efd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldFunction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldFunction", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectMesh", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "GaussianInterpolation", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "::", "badarg"}], "=", 
   "\"\<Bad argument given to VisualFieldFunction: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "[", 
    RowBox[{"who_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"allMeshes", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Outer", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub", "=", "#1"}], ",", 
                    RowBox[{"hem", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hem", ",", "\"\<Registered\>\"", ",", "#"}], 
                    "]"}], ",", "opts"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", "All"}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Empirical\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Measured\>\""}]}], ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "99"}], "&"}]}], "]"}], ",", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Training\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Train\>\""}]}], ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    RowBox[{
                    RowBox[{"0", "<", "#", "<", "99"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Gold\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<GoldStandard\>\""}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
                    "True", ",", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\"\<Unrecognized dataset arg\>\""}], "]"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "===", "All"}], ",", 
                 "$Subjects", ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "All"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "LR"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "1", ",", "1"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"Dimensions", "[", "who", "]"}]}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{"{", "who", "}"}], ",", "who"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"allMeshGolds", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Outer", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub", "=", "#1"}], ",", 
                    RowBox[{"hem", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"WithOptions", "[", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hem", ",", "\"\<Registered\>\"", ",", "0"}], 
                    "]"}], ",", "opts"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", "All"}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Empirical\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Measured\>\""}]}], ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "99"}], "&"}]}], "]"}], ",", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Training\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Train\>\""}]}], ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    RowBox[{
                    RowBox[{"0", "<", "#", "<", "99"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Gold\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<GoldStandard\>\""}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
                    "True", ",", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\"\<Unrecognized dataset arg\>\""}], "]"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "===", "All"}], ",", 
                 "$Subjects", ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "All"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "LR"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "1", ",", "1"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"Dimensions", "[", "who", "]"}]}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{"{", "who", "}"}], ",", "who"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sel", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Select", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"area", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "VisualArea", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nSubHems", "=", 
          RowBox[{"Length", "@", 
           RowBox[{"Union", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Subject\>\"", ",", "\"\<Hemisphere\>\""}], "}"}],
                "/.", 
               RowBox[{"Options", "[", 
                RowBox[{"msh", ",", "MetaInformation"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"msh", ",", "allMeshes"}], "}"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"meshes", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"hemi", "\[Rule]", 
              RowBox[{"Select", "[", 
               RowBox[{"allMeshes", ",", 
                RowBox[{
                 RowBox[{"hemi", "===", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Hemisphere\>\"", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"#", ",", "MetaInformation"}], "]"}]}], ")"}]}], 
                 "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"meshGolds", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"hemi", "\[Rule]", 
              RowBox[{"Select", "[", 
               RowBox[{"allMeshGolds", ",", 
                RowBox[{
                 RowBox[{"hemi", "===", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Hemisphere\>\"", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"#", ",", "MetaInformation"}], "]"}]}], ")"}]}], 
                 "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"inAllMeshes", "=", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "=", "#1"}], "}"}], ",", 
             RowBox[{"AllTrue", "[", 
              RowBox[{"allMeshes", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"VertexPropertyList", "[", "#", "]"}], ",", "x"}], 
                 "]"}], "&"}]}], "]"}]}], "]"}], "&"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"projAngleNames", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Projection", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"$AnatomyPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<Benson14VisualArea\>\"", "/.", "msh"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"$SemiEmpiricalPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshGolds", "[", "hemi", "]"}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"_", "\[Rule]", "None"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"weights", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Weights", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projAngle", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Pi", "/", "180.0"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90.0", "-", "#"}], ")"}]}], "&"}], "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "msh"}], ")"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "msh"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ws0", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"weights", "===", "None"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"VertexCount", "[", "msh", "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", "weights", "]"}], ",", "weights", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"weights", "===", "Automatic"}], ",", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$EmpiricalPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "msh"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$SemiEmpiricalPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "msh"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$GoldPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "\"\<GoldVarianceExplained\>\"", ")"}], "/.",
                     "msh"}], ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$AnatomyPattern", "\[RuleDelayed]", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"\"\<Benson14VisualArea\>\"", "/.", "msh"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"_", "\[RuleDelayed]", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<If Projection is explicit, weights must be explicit \
or None.\>\""}], "]"}]}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", "weights", "]"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"weights", "/.", "msh"}], ")"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<Could not understand Weights argument; should be \
\\\"VarianceExplained\\\", \\\"Weight\\\", or None\>\""}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"idcs", "=", 
               RowBox[{"Association", "@", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"hemi", "\[Rule]", 
                   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"allVtcs", "=", 
                    RowBox[{"Range", "@", 
                    RowBox[{"VertexCount", "[", "#1", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sel", "===", "None"}], ",", "allVtcs", ",", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"MapVertices", "[", 
                    RowBox[{"sel", ",", "#1"}], "]"}], ",", "True"}], "]"}]}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"e_", "/;", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "e", 
                    "\[LessEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"Sign", "[", "#3", "]"}], ",", "1"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"area", "===", "None"}], "||", 
                    RowBox[{"#4", "===", "None"}]}], ",", 
                    "\[IndentingNewLine]", "allVtcs", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{"#4", ",", "a"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "area"}], "}"}]}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"areas", "===", "None"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"None", "&"}], ")"}], "/@", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], ",", 
                    RowBox[{"areas", "[", "hemi", "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"coords", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ang", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"ecc", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ecc", "*", 
                    RowBox[{"Cos", "[", "ang", "]"}]}], ",", 
                    RowBox[{"ecc", "*", 
                    RowBox[{"Sin", "[", "ang", "]"}]}]}], "}"}], "]"}], "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"vals", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Part", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"StringQ", "[", "prop", "]"}], ",", 
                    RowBox[{"prop", "/.", "#1"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"VectorQ", "[", "prop", "]"}], ",", "prop", ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"prop", "[", "#1", "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "#2"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"ws", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"fs", "=", 
                   RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"coords", "[", "hemi", "]"}]}], "\[Equal]", "0"}],
                     ",", "\[IndentingNewLine]", "None", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"nulls", "=", 
                    RowBox[{"Pick", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", 
                    RowBox[{"vals", "[", "hemi", "]"}]}]}], ",", 
                    RowBox[{"NumericQ", "/@", 
                    RowBox[{"vals", "[", "hemi", "]"}]}], ",", "False"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "GaussianInterpolation", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Append", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", "hemi", "]"}], ",", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"vals", "[", "hemi", "]"}], ",", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"nulls", "\[Rule]", "0"}], "]"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Weights", "\[Rule]", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"ws", "[", "hemi", "]"}], ",", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"nulls", "\[Rule]", "0"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], "&&", 
                    RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}]}], ",", 
                   "$Failed", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "RH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "RH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "LH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fl", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], ",", 
                    RowBox[{"fr", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], "||", 
                    RowBox[{"#", "===", "RH"}]}], ",", "\[IndentingNewLine]", 
                    "True", ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dat", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], 
                    ",", "#", ",", 
                    RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", "#", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"hems", "=", 
                    RowBox[{"3", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ")"}]}],
                     ")"}], "/", "2"}], "+", 
                    RowBox[{"3", "/", "2"}]}], ")"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lidcs", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"hems", ",", "1"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ridcs", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"hems", ",", "2"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", "=", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"SparseArray", "@", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"lidcs", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"lidcs", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"fl", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", "lidcs", "]"}], "]"}], "]"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"ridcs", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ridcs", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"fr", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", "ridcs", "]"}], "]"}], "]"}]}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", "r", ",", 
                    RowBox[{"First", "[", "r", "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
   ";"}]}], "Input",ExpressionUUID->"62469fef-f688-4433-bd2f-3466e0048f20"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a Visual Field Projection", "Subsection",ExpressionUUID->"960ea701-bcc8-49a1-a77d-318e741a64f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "VisualFieldMeshPlot", ",", "VisualFieldDensityPlot", ",", 
    "VisualFieldContourPlot", ",", "$VisualFieldOptionDeltas"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$VisualFieldOptionDeltas", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "Automatic"}], ")"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ColorFunction", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ColorFunction", "\[Rule]", "Automatic"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Frame", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Frame", "\[Rule]", "None"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"AspectRatio", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BaseStyle", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PlotRange", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"WorkingPrecision", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"WorkingPrecision", "->", "MachinePrecision"}], ")"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldMeshPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "Graphics", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"$VisualFieldOptionDeltas", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "ContourPlot", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldFunction", "[", 
           RowBox[{"spec", ",", "prop"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
            "opts"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "x"}], "}"}]}]}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"projections", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "RH", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "LH", "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"regs", "=", 
            RowBox[{"Association", "@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"projections", "[", "h", "]"}]}], ",", 
                  "\[IndentingNewLine]", "None", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
                    "Annulus", ",", "Disk"}], "]"}], "[", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "range", 
                    ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"h", "===", "RH"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"h", ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"regs", "[", "h", "]"}], "===", "None"}], ",", 
                "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
                
                RowBox[{"DensityPlot", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"projections", "[", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Element", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                    RowBox[{"regs", "[", "h", "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Epilog", "\[Rule]", 
                   RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", "White", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                     "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AspectRatio", "\[Rule]", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[Rule]", "1"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ColorFunctionScaling", "\[Rule]", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ColorFunction", "\[Rule]", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "h", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "h", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "h", "]"}], ",", "#"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "h", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "h", "]"}], ",", "#"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "h", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "h", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "Full"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}]}], 
                   "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"h", ",", 
                RowBox[{"{", 
                 RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldContourPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldFunction", "[", 
           RowBox[{"spec", ",", "prop"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"projections", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "RH", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "LH", "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"regs", "=", 
            RowBox[{"Association", "@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"projections", "[", "h", "]"}]}], ",", 
                  "\[IndentingNewLine]", "None", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
                    "Annulus", ",", "Disk"}], "]"}], "[", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "range", 
                    ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"h", "===", "RH"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"h", ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"regs", "[", "h", "]"}], "===", "None"}], ",", 
               "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
               RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"projections", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Element", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                   RowBox[{"regs", "[", "h", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Epilog", "\[Rule]", 
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", "White", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                     "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"AspectRatio", "\[Rule]", 
                  RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xmin", "\[Equal]", "0"}], "||", 
                    RowBox[{"xmax", "\[Equal]", "0"}]}], ",", "2", ",", "1"}],
                     "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ColorFunctionScaling", "\[Rule]", 
                  RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ColorFunction", "\[Rule]", 
                  RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "h", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "h", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "h", "]"}], ",", "#"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "h", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "h", "]"}], ",", "#"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "h", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "h", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ContourPlot", "]"}]}], "]"}]}], 
                  "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"h", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}],
         "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->\
"9f9a3481-7dd5-4bca-9aef-b8a912e003a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a V123 Schematic Model Figure", "Subsection",ExpressionUUID->"b373c471-03c3-4f52-8ee5-455c0dbafaf1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "V123FigMeshPlot", ",", "V123FigDensityPlot", ",", "V123FigContourPlot", 
    ",", "SchiraMeshPlot", ",", "SchiraDensityPlot", ",", 
    "SchiraContourPlot"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigMeshPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldMeshPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "V123FigLines", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PlotRange", "|", "VisualArea"}], ")"}], "\[Rule]", "_"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "V123FigLines", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "Automatic"}]}], "}"}]}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PlotRange", "|", "VisualArea"}], ")"}], "\[Rule]", "_"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "V123FigLines", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PlotRange", "|", "VisualArea"}], ")"}], "\[Rule]", "_"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SchiraMeshPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigMeshPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SchiraDensityPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigDensityPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SchiraContourPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigContourPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigMeshPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123angs", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<PolarAngle\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123eccs", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<Eccentricity\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123lbls", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<VisualArea\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123crds", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<Coordinates\>\"", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"idcs0", "=", 
                 RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"xy", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                  "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"pts", "=", 
                   RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"cfn", "=", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",",
                     "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}], 
                    ",", "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "hemi", "]"}], ",", "#"}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"cfnScale", "=", 
                   RowBox[{"TrueQ", "@", 
                    RowBox[{
                    "OptionValue", "[", "ColorFunctionScaling", "]"}]}]}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"msh", "=", 
                    RowBox[{"DelaunayMesh", "[", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"VertexColors", "\[Rule]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{"cfn", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"cfnScale", ",", "Rescale", ",", "Identity"}], 
                    "]"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", "1"}], "]"}]}]}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigMeshPlot", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123angs", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<PolarAngle\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123eccs", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<Eccentricity\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123lbls", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<VisualArea\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"v123crds", "=", 
               RowBox[{
                RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                "\"\<Coordinates\>\"", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"idcs0", "=", 
                 RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"xy", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                  "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"pts", "=", 
                  RowBox[{"Join", "@@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ListDensityPlot", "[", "\[IndentingNewLine]", 
                 RowBox[{"pts", ",", "\[IndentingNewLine]", 
                  RowBox[{"ColorFunctionScaling", "\[Rule]", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ColorFunction", "\[Rule]", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",",
                     "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}], 
                    ",", "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "hemi", "]"}], ",", "#"}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListDensityPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V123FigContourPlot", "[", 
     RowBox[{"spec_", ",", "prop_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"projections", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"VisualFieldFunction", "[", 
              RowBox[{"spec", ",", "prop", ",", 
               RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
           "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"mpp", "=", 
         RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"plotFn", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
               RowBox[{"v123angs", "=", 
                RowBox[{
                 RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                 "\"\<PolarAngle\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"v123eccs", "=", 
                RowBox[{
                 RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                 "\"\<Eccentricity\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
               
               RowBox[{"v123lbls", "=", 
                RowBox[{
                 RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                 "\"\<VisualArea\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"v123crds", "=", 
                RowBox[{
                 RowBox[{"Benson17Model", "[", "#", "]"}], "[", 
                 "\"\<Coordinates\>\"", "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"idcs0", "=", 
                  RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"xy", "=", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                   "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"pts", "=", 
                   RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ListContourPlot", "[", "\[IndentingNewLine]", 
                  RowBox[{"pts", ",", "\[IndentingNewLine]", 
                   RowBox[{"ColorFunctionScaling", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",",
                     "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}], 
                    ",", "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "hemi", "]"}], ",", "#"}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListContourPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"projections", ",", 
            RowBox[{
             RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"projections", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
           RowBox[{
            RowBox[{"projections", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"plotFn", "[", "LH", "]"}], ",", 
            RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"plotFn", "[", "LH", "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "True", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchiraMeshPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"vfpts", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                 RowBox[{"List", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "===", "RH"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "180", ",", "5"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"mpp", "/", "36"}], ")"}]}]}], "]"}], "^", 
                    "3.5"}]}]}]}], "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123angs", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Pi", "/", "180"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"90", "-", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}]}], 
                    "&"}], "@", 
                    RowBox[{"vfpts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"v123eccs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}], "&"}], 
                  "@", 
                  RowBox[{"vfpts", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123lbls", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
                    RowBox[{"Length", "[", "vfpts", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123crds", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{
                   RowBox[{
                   "VisualFieldToCorticalMap", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SchiraModelUnrotated", "[", "LH", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
                    "vfpts"}], ",", "vfpts"}], "]"}]}], "\[IndentingNewLine]",
                     "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"idcs0", "=", 
                   RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"v123eccs", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"xy", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "@", 
                    RowBox[{"Abs", "[", "v123angs", "]"}]}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"pts", "=", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"cfn", "=", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",",
                     "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}], 
                    ",", "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "hemi", "]"}], ",", "#"}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"cfnScale", "=", 
                    RowBox[{"TrueQ", "@", 
                    RowBox[{
                    "OptionValue", "[", "ColorFunctionScaling", "]"}]}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"msh", "=", 
                    RowBox[{"DelaunayMesh", "[", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"VertexColors", "\[Rule]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{"cfn", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"cfnScale", ",", "Rescale", ",", "Identity"}], 
                    "]"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
                    "\[IndentingNewLine]", "1"}], "]"}]}]}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "SchiraMeshPlot", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Graphics", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dmsh", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "15"}], ",", 
                    RowBox[{"-", "40"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "40"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"V123FigBoundary", "[", 
                    RowBox[{"LH", ",", "15", ",", 
                    RowBox[{
                    "RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "White", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], "&"}], 
                    "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"MeshCoordinates", "[", "dmsh", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"dmsh", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
             "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchiraDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"vfpts", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                 RowBox[{"List", ",", "\[IndentingNewLine]", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "180", ",", "5"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", "=", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"mpp", "/", "36"}], ")"}]}]}], "]"}], "^", 
                    "3.5"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "r", "]"}], "\[NotEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"r", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "r"}], 
                    "]"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123angs", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Pi", "/", "180"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"90", "-", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}]}], 
                    "&"}], "@", 
                    RowBox[{"vfpts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"v123eccs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}], "&"}], 
                  "@", 
                  RowBox[{"vfpts", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123lbls", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
                    RowBox[{"Length", "[", "vfpts", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123crds", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{
                   RowBox[{"VisualFieldToCorticalMap", "[", 
                    RowBox[{
                    RowBox[{"SchiraModelUnrotated", "[", "LH", "]"}], ",", 
                    "vfpts"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"idcs0", "=", 
                   RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "v123eccs", "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"xy", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"pts", "=", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ListDensityPlot", "[", "\[IndentingNewLine]", 
                    RowBox[{"pts", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunctionScaling", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",",
                     "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}], 
                    ",", "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "hemi", "]"}], ",", "#"}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListDensityPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Graphics", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"msh", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "15"}], ",", 
                    RowBox[{"-", "40"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "40"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"V123FigBoundary", "[", 
                    RowBox[{"LH", ",", "15", ",", 
                    RowBox[{
                    "RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "White", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], "&"}], 
                    "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SchiraContourPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"hemi", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"vfpts", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                 RowBox[{"List", ",", "\[IndentingNewLine]", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "180", ",", "5"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", "=", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"mpp", "/", "36"}], ")"}]}]}], "]"}], "^", 
                    "3.5"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "r", "]"}], "\[NotEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"r", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "r"}], 
                    "]"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v123angs", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Pi", "/", "180"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"90", "-", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}]}], 
                    "&"}], "@", 
                    RowBox[{"vfpts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"v123eccs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Join", "@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}], "&"}], 
                  "@", 
                  RowBox[{"vfpts", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123lbls", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
                    RowBox[{"Length", "[", "vfpts", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"v123crds", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{
                   RowBox[{"VisualFieldToCorticalMap", "[", 
                    RowBox[{
                    RowBox[{"SchiraModelUnrotated", "[", "LH", "]"}], ",", 
                    "vfpts"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"idcs0", "=", 
                   RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "v123eccs", "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"xy", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Cos", "[", "v123angs", "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"v123eccs", "*", 
                    RowBox[{"Sin", "[", "v123angs", "]"}]}]}], "}"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"pts", "=", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "mpp"}], ",", 
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{"idcs0", ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"v123lbls", ",", "lbl"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"v123crds", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projections", "[", 
                    RowBox[{"[", "lbl", "]"}], "]"}], "[", 
                    RowBox[{"xy", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ListContourPlot", "[", "\[IndentingNewLine]", 
                    RowBox[{"pts", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunctionScaling", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",",
                     "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}], 
                    ",", "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$CMagBlendColors", "[", "hemi", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PRFBlendColors", "[", "hemi", "]"}], ",", "#"}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatio\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "#"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MagRatioInv\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MagRatioBlendColors", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"1.0", "/", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"0", "|", "0.0"}], "\[Rule]", "1.0"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListContourPlot", "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Graphics", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"msh", "=", 
                    RowBox[{"DiscretizeRegion", "@", 
                    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "15"}], ",", 
                    RowBox[{"-", "40"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "40"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"V123FigBoundary", "[", 
                    RowBox[{"LH", ",", "15", ",", 
                    RowBox[{
                    "RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "White", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], "&"}], 
                    "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"MeshCoordinates", "[", "msh", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"msh", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"046e5aa3-0180-4b59-9e09-bb103efdcb08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "V123DotLines", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V123DotLines", "[", 
   RowBox[{
    RowBox[{"hemi", ":", 
     RowBox[{"LH", "|", "RH"}]}], ",", 
    RowBox[{"maxEcc_:", "12"}]}], "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mdl", "=", 
      RowBox[{"Benson17Model", "[", "hemi", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mesh", "=", 
         RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"fs0", "=", 
         RowBox[{
          RowBox[{"MeshCells", "[", 
           RowBox[{
            RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}], ",", "2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"lbl", "=", 
         RowBox[{"mdl", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ang", "=", 
         RowBox[{
          RowBox[{"180", "/", "Pi"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pi", "/", "2"}], "-", 
            RowBox[{"mdl", "[", "\"\<PolarAngle\>\"", "]"}]}], ")"}]}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"ecc", "=", 
         RowBox[{"mdl", "[", "\"\<Eccentricity\>\"", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"es", "=", 
          RowBox[{"Union", "[", "\[IndentingNewLine]", 
           RowBox[{"Sort", "/@", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"fs0", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"fs0", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"fs0", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"FaceForm", "[", "White", "]"}], ",", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ec", "=", 
                    RowBox[{"ecc", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ",", 
                   RowBox[{"va", "=", 
                    RowBox[{"lbl", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Min", "[", "ec", "]"}], "<", "maxEcc"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", "va", "]"}], "<", "4"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "va", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "3"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Min", "[", "ec", "]"}], "<", "e0"}], "&&", 
                    RowBox[{
                    RowBox[{"Max", "[", "ec", "]"}], ">", "e0"}]}], ")"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{
                    RowBox[{"MeshCoordinates", "[", "mesh", "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", "0.3"}], 
                    "]"}], ",", "\[IndentingNewLine]", "Nothing"}], "]"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", "es"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"e0", ",", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
             "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FaceForm", "[", "Black", "]"}], ",", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "@", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ec", "=", 
                  RowBox[{"ecc", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], ",", 
                 RowBox[{"va", "=", 
                  RowBox[{"lbl", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], ",", 
                 RowBox[{"pa", "=", 
                  RowBox[{"ang", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"And", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Min", "[", "ec", "]"}], "<", "maxEcc"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", "va", "]"}], "<", "4"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "va", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "3"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Or", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Union", "@", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", "pa", "]"}], "-", "90"}], "]"}]}]}], 
                    "\[Equal]", "2"}], ")"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Union", "[", "va", "]"}]}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"va", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "2"}], "||", 
                    RowBox[{
                    RowBox[{"Mean", "[", "ec", "]"}], "<", "0.045"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Union", "[", "va", "]"}]}], "\[Equal]", "2"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Min", "[", "ec", "]"}], "<", "maxEcc"}], "&&", 
                    RowBox[{
                    RowBox[{"Max", "[", "ec", "]"}], ">", "maxEcc"}]}], 
                    ")"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Disk", "[", 
                  RowBox[{
                   RowBox[{"Mean", "[", 
                    RowBox[{
                    RowBox[{"MeshCoordinates", "[", "mesh", "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", "0.3"}], 
                  "]"}], ",", "\[IndentingNewLine]", "Nothing"}], "]"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", "es"}], "]"}]}], "}"}]}], 
       "]"}]}], "]"}]}], "]"}]}]}], "Input",ExpressionUUID->"0b5ad54b-e4cd-\
4544-91a7-56fd04d07940"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting Subject Paths/Contours on the Cortical Surface", "Subsection",ExpressionUUID->"11b59c04-6873-4149-8bab-81d2824b0be0"],

Cell["\<\
This function, SubjectContours, returns a GraphicsComplex that will plot an \
overlay of contours and lines.\
\>", "Text",ExpressionUUID->"9309d20f-7a77-4dd5-87b9-426667d0ba9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SubjectContours", ",", "VisualAreaStyleFunction"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "::", "badarg"}], "=", 
   "\"\<Bad argument given to SubjectContours: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualAreaStyleFunction", "::", "usage"}], "=", 
   "\"\<VisualAreasStyleFunction is an option to SubjectContours.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectContours", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EccentricityLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "1.5", ",", "3", ",", "6", ",", "12", ",", "24", ",", "48", ",", 
          "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"EccentricityStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90", ",", "180"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreas", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreaStyleFunction", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BoundaryStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Mesh", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VertexCoordinates", "\[Rule]", "Automatic"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "SubjectMap", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Xarg", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{
              RowBox[{"Length", "[", "m", "]"}], "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}]}]}], "\[RuleDelayed]", 
            RowBox[{"Transpose", "[", "m", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{"1", "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}], "<", "4"}]}], 
            "\[RuleDelayed]", "m"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Automatic", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"_", "\[RuleDelayed]", 
            RowBox[{"Message", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SubjectContours", "::", "badarg"}], ",", 
              "\[IndentingNewLine]", 
              "\"\<VertexCoordinates must be an n x 2 or n x 3 matrix or \
Automatic\>\""}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pre0", "=", 
         RowBox[{"Fold", "[", "\[IndentingNewLine]", 
          RowBox[{"Replace", ",", "\[IndentingNewLine]", 
           RowBox[{"OptionValue", "[", "Mesh", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"s_String", "\[RuleDelayed]", 
              RowBox[{"ToLowerCase", "[", "s", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s_String", "\[RuleDelayed]", 
                RowBox[{"WithOptions", "[", 
                 RowBox[{
                  RowBox[{"SubjectMesh", "[", 
                   RowBox[{"sub", ",", "hemi", ",", "s", ",", "ds"}], "]"}], 
                  ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Xarg", "===", "Automatic"}], ",", 
                  RowBox[{"WithOptions", "[", 
                   RowBox[{
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "opts"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "Xarg", "]"}]}], "\[Equal]", "2"}], 
                  ",", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "ds"}], 
                    "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "ds"}], 
                    "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<VertexCoordinates do not match a mesh size\>\""}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "}"}]}], "}"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pre", "=", 
            RowBox[{"pre0", "/.", 
             RowBox[{"\"\<PredictedVisualArea\>\"", "\[Rule]", 
              RowBox[{"MapVertices", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0", "<", "#PredictedVisualArea", "<", "4"}], "&&", 
                    RowBox[{
                    RowBox[{"Abs", "[", "#PredictedPolarAngle", "]"}], "<", 
                    "90"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"-", "#PredictedVisualArea"}], ",", 
                   "\[IndentingNewLine]", "#PredictedVisualArea"}], "]"}]}], 
                ",", "\[IndentingNewLine]", "pre0"}], "]"}]}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"elines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "1.25", ",", "2.5", ",", "5", ",", "10", ",", "20", ",", 
                   "40", ",", "80"}], "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<EccentricityLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"estyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", "Black", "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"plines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "90"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<PolarAngleLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"pstyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", 
                   RowBox[{"Thick", ",", "White"}], "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3"}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Full", "|", "All"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4",
                    ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}]}]}], 
               "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"astyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreaStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Round", "@", 
                    RowBox[{"Abs", "[", "#", "]"}]}], ",", 
                    "\[IndentingNewLine]", "1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Blue"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Green"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "3", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Red"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "_", ",", "None"}], "]"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"bstyle", "=", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "BoundaryStyle", "]"}], ",", 
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"idxFix", "=", 
              RowBox[{"Function", "@", 
               RowBox[{"VertexIndex", "[", 
                RowBox[{"pre", ",", "#"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"inRangeQ", "=", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"All", "|", "Full"}], "\[Rule]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"emax_", "?", "NumericQ"}], "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "areas", "]"}], ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "areas", "]"}], ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a0_", "?", "NumericQ"}], ",", 
                    RowBox[{"amax_", "?", "NumericQ"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    "a0", "\[LessEqual]", "#1", "\[LessEqual]", "amax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "areas", "]"}], ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}]}]}],
                  "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"angleDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedPolarAngle\>\""}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"eccenDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedEccentricity\>\""}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"areasDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedVisualArea\>\""}], "]"}]}]}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"checkfn", "=", 
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"a", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"IntegerQ", "[", "#1", "]"}], ",", 
                    RowBox[{"{", "#1", "}"}], ",", "#1"}], "]"}]}], ",", 
                    RowBox[{"e", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"e", "===", "None"}], ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"Round", "[", "#PredictedVisualArea", "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"a", "===", "None"}], ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#PredictedEccentricity", "<", "e"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"Round", "[", "#PredictedVisualArea", "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"#PredictedEccentricity", "<", "e"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}]}], 
                   "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"bound", "=", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"bound0", "=", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"a", ",", "None"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "rotate", " ", "it", " ", "so", " ", "that", " ", "the", 
                    " ", "start", " ", "is", " ", "the", " ", "fovea"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"RotateLeft", "[", 
                    RowBox[{"bound0", ",", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Ordering", "[", 
                    RowBox[{
                    RowBox[{"eccenDat", "[", 
                    RowBox[{"[", "bound0", "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "-", "1"}]}], "]"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], 
                   ",", 
                   RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"VertexCoordinates", "[", "pre", "]"}]}]}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"Okay", ",", " ", 
                   RowBox[{
                    RowBox[{
                    "the", " ", "rest", " ", "will", " ", "be", " ", "done", 
                    " ", "somewhat", " ", "procedurally"}], "..."}]}], " ", 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"First", "@", 
                  RowBox[{"Last", "@", 
                   RowBox[{"Reap", "[", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"First", ",", " ", 
                    RowBox[{
                    RowBox[{
                    "find", " ", "the", " ", "areas", " ", "and", " ", 
                    "render", " ", "them"}], "..."}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"astyle", "[", "a", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"a", ",", "None"}], "]"}]}], "]"}]}], "]"}]}]}]}],
                     "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Next", ",", " ", 
                    RowBox[{"we", " ", "do", " ", "eccentricity"}]}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"estyle", "[", "e", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"None", ",", "e"}], "]"}]}], "]"}]}], "]"}]}]}]}],
                     "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", "elines"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"Then", " ", "polar", " ", "angle"}], "..."}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"pstyle", "[", "p", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "]"}]}], 
                    "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", "#"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", "None"}], "]"}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "180"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "3"}]}], "}"}], ",", "None"}], "]"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "90"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", "None"}], "]"}], ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"-", "2"}], "}"}], ",", "None"}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"0", "<", "p", "<", "90"}], ",", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cf12", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", "None"}], "]"}]}], 
                    ",", 
                    RowBox[{"cf23", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", "None"}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf12", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf23", "[", "#", "]"}], "&&", 
                    RowBox[{"#PredictedPolarAngle", "\[LessEqual]", "p"}]}], 
                    ")"}], "&"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"90", "<", "p", "<", "180"}], ",", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cf12", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}], ",", "None"}], "]"}]}], ",", 
                    
                    RowBox[{"cf23", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "3"}]}], "}"}], ",", "None"}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf12", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf23", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "plines"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Last", ",", " ", 
                    RowBox[{
                    RowBox[{"do", " ", "the", " ", "boundary"}], "..."}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bstyle", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "bstyle", "]"}], ",", "bstyle", ",", 
                    RowBox[{"{", "bstyle", "}"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", "bound", "]"}]}], "]"}]}]}], "]"}]}],
                     "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
       "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"da7a34b1-536e-4793-\
80d9-f982d7d71a95"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a figure row with models and fields", "Subsection",ExpressionUUID->"e03b4835-c822-488b-84b6-6ba07d43e78f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "ModelFieldRow", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ModelFieldRow", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"Labeled", "\[Rule]", "True"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModelFieldRow", "[", 
    RowBox[{"v123Figs_", ",", "fieldFigs_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"imsz", "=", 
        RowBox[{"{", 
         RowBox[{"3.25", ",", "1.75"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"labQ", "=", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Labeled", "]"}], ",", 
           RowBox[{"Automatic", "\[Rule]", "True"}]}], "]"}]}]}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1dx", "=", "0.275"}], ",", 
         RowBox[{"r1x0", "=", "0.12"}], ",", "\[IndentingNewLine]", 
         RowBox[{"fsz", "=", 
          RowBox[{"0.8", "*", "72"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"f0", "=", "0.5"}], ",", 
         RowBox[{"fldbdy", "=", 
          RowBox[{"0.1", "+", 
           RowBox[{"1", "/", 
            RowBox[{"imsz", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"sty", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"Style", "[", 
            RowBox[{"##", ",", 
             RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}]}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fieldFigs", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "f0"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.2"}], "}"}], "]"}], ",", "fsz"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fieldFigs", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], "]"}], ",", "fsz"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fieldFigs", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", "fsz"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"v123Figs", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"1", "*", "72"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"v123Figs", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"1", "*", "72"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"labQ", ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"y1", "=", "f0"}], ",", 
                 RowBox[{"y2", "=", "0.05"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V1\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.38", ",", "y1"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V2\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.26", ",", "y2"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", "\"\<V3\>\"", "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.51", ",", "y2"}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
                "}"}]}], "]"}], ",", "\[IndentingNewLine]", "Nothing"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"imsz", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", "72"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"imsz", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", "72"}]}], "}"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"imsz", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"c81e165e-6653-4c17-b420-04bdb62f3b8b"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Body", "Chapter",ExpressionUUID->"18d4fb76-9a7b-4e9d-a8fe-eaf1130f3db4"],

Cell["\<\
This section of the notebook contains code that actually creates and displays \
plots of the various data. To prevent this notebook file from being enormous, \
none of the figures themselves are saved in the notebook, but the code below \
can reproduce all the plots in the paper Benson and Winawer (2018). Note \
that, like in the header, most of the code in this section runs immediately \
and declares a function/form for generating the relevant table/figure.\
\>", "Text",ExpressionUUID->"806d9f4c-1d5c-4650-b7d0-d5796c2d70a8"],

Cell[CellGroupData[{

Cell["Tables", "Subchapter",ExpressionUUID->"db372683-fc6a-4410-9a0a-0be4b95c1412"],

Cell[CellGroupData[{

Cell["Summary of Statistics for each Subject", "Section",ExpressionUUID->"51136743-ece1-4f22-a054-e4cd3cbb46af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$Table1Dataset", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Table1Dataset", ":=", 
    RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<table1_dataset\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dsno", "=", "99"}], ",", "\[IndentingNewLine]", 
          RowBox[{"b14", "=", 
           RowBox[{"Association", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"h", "\[Rule]", 
               RowBox[{"Benson14Mesh", "[", 
                RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"h", ",", 
                RowBox[{"{", 
                 RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"sdist2sdeg", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"180", "/", "Pi"}], "*", 
             RowBox[{"ArcCos", "[", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"#", "^", "2"}], "/", "20000"}]}], "]"}]}], "&"}]}]}],
          "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"reg", "=", 
            RowBox[{"Association", "@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "\[Rule]", " ", 
                RowBox[{"CorticalMesh", "[", 
                 RowBox[{
                  RowBox[{"b14", "[", "h", "]"}], ",", 
                  RowBox[{"VertexCoordinates", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
                    RowBox[{"b14", "[", "h", "]"}]}], ")"}]}]}], "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"h", ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dataset", "@", 
           RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"m0", "=", 
                  RowBox[{"SubjectMesh", "[", 
                   RowBox[{
                   "sub", ",", "h", ",", "\"\<Sphere\>\"", ",", "dsno"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"m1", "=", 
                  RowBox[{"SubjectMesh", "[", 
                   RowBox[{
                   "sub", ",", "h", ",", "\"\<Registered\>\"", ",", "dsno"}], 
                   "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x0", "=", 
                    RowBox[{"VertexCoordinates", "[", "m0", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"x1", "=", 
                    RowBox[{"VertexCoordinates", "[", "m1", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"x2", "=", 
                    RowBox[{"\"\<PredictedRegistration\>\"", "/.", "m1"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"eccidcs", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "m1"}], 
                    ")"}], "-", "12"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"idcs", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "m1"}], 
                    "]"}], ",", 
                    RowBox[{"1", "|", "2", "|", "3"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "eccidcs"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"v1idcs", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Round", "@", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "m1"}], 
                    "]"}]}], ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
                    "eccidcs"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ds", "=", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "-", 
                    RowBox[{"AlignPoints3D", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], ",", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "x1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x1", ",", "x2"}], "}"}]}], "}"}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"<|", 
                    RowBox[{
                    RowBox[{"\"\<Subject\>\"", "\[Rule]", "sub"}], ",", 
                    RowBox[{"\"\<Hemi\>\"", "\[Rule]", "h"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V1VertexArea\>\"", "\[Rule]", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<WhiteVertexArea\>\"", "/.", "m1"}], ")"}], 
                    "[", 
                    RowBox[{"[", "v1idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V1VertexVolume\>\"", "\[Rule]", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<VertexVolume\>\"", "/.", "m1"}], ")"}], "[", 
                    
                    RowBox[{"[", "v1idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<SphereToFSAverageDistance\>\"", "\[Rule]", 
                    RowBox[{"Mean", "@", 
                    RowBox[{"sdist2sdeg", "@", 
                    RowBox[{"RowNorms", "[", 
                    RowBox[{"ds", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<SphereToFSAverageDistanceStd\>\"", "\[Rule]", 
                    RowBox[{"StandardDeviation", "@", 
                    RowBox[{"sdist2sdeg", "@", 
                    RowBox[{"RowNorms", "[", 
                    RowBox[{"ds", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<SphereToFSAverageAngle\>\"", "\[Rule]", 
                    RowBox[{"Mean", "@", 
                    RowBox[{"ArcCos", "@", 
                    RowBox[{"Total", "@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Times", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"NormalizeRows", "[", 
                    RowBox[{"ds", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"NormalizeRows", "[", 
                    RowBox[{"ds", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}]}]}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<FSAverageToRetinotopyDistance\>\"", "\[Rule]", 
                    RowBox[{"Mean", "@", 
                    RowBox[{"sdist2sdeg", "@", 
                    RowBox[{"RowNorms", "[", 
                    RowBox[{"ds", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<FSAverageToRetinotopyDistanceStd\>\"", "\[Rule]", 
                    RowBox[{"StandardDeviation", "@", 
                    RowBox[{"sdist2sdeg", "@", 
                    RowBox[{"RowNorms", "[", 
                    RowBox[{"ds", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}]}], "|>"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"h", ",", 
               RowBox[{"{", 
                RowBox[{"RH", ",", "LH"}], "}"}]}], "}"}]}], "]"}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->\
"72b7d3cd-b46d-4a13-996e-0e5fb8157586"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figures", "Subchapter",ExpressionUUID->"066117cd-5693-4899-9792-d5c6ad57efa3"],

Cell[CellGroupData[{

Cell["Figure 2: Zoomed Comparison Plots", "Section",ExpressionUUID->"1a501746-110e-49d1-a90b-41797b95fa7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$Fig2RegionSize", ",", "Fig2Region", ",", "Fig2DrawRegion", ",", 
    "Fig2Color"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig2RegionSize", "=", 
   RowBox[{"{", 
    RowBox[{"37", ",", "30"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fig2Region", "[", 
    RowBox[{"{", 
     RowBox[{"x0_", ",", "y0_"}], "}"}], "]"}], ":=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "y0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0", ",", "y0"}], "}"}], "+", "$Fig2RegionSize"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fig2DrawRegion", "[", 
    RowBox[{"origin_", ",", "clr_", ",", 
     RowBox[{"thk__:", 
      RowBox[{"Thickness", "[", "0.015", "]"}]}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EdgeForm", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dashing", "[", 
         RowBox[{"{", "0.02", "}"}], "]"}], ",", "thk", ",", "clr"}], "}"}], 
      "]"}], ",", 
     RowBox[{"FaceForm", "[", "None", "]"}], ",", 
     RowBox[{"Fig2Region", "[", "origin", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fig2Color", "[", 
      RowBox[{"\"\<Data\>\"", ",", 
       RowBox[{"type", ":", 
        RowBox[{"\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\""}]}], ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Function", "@", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{"True", ",", "\[IndentingNewLine]", 
        RowBox[{"Blend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
            RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",", 
            RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"#", "[", "type", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fig2Color", "[", 
      RowBox[{"\"\<Prediction\>\"", ",", 
       RowBox[{"type", ":", 
        RowBox[{"\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\""}]}], ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Function", "@", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"0", "<", "#PredictedVisualArea", "<", "4"}], "&&", 
         RowBox[{"#PredictedEccentricity", "<", "12"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Blend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
            RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",", 
            RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"#", "[", 
           RowBox[{"\"\<Predicted\>\"", "<>", "type"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fig2Color", "[", 
      RowBox[{"\"\<Prior\>\"", ",", 
       RowBox[{"type", ":", 
        RowBox[{"\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\""}]}], ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Function", "@", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"0", "<", "#Benson14VisualArea", "<", "4"}], "&&", 
         RowBox[{"#Benson14Eccentricity", "<", "12"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Blend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
            RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",", 
            RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"#", "[", 
           RowBox[{"\"\<Benson14\>\"", "<>", "type"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fig2Color", "[", 
      RowBox[{"\"\<Validation\>\"", ",", 
       RowBox[{"type", ":", 
        RowBox[{"\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\""}]}], ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Function", "@", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{"True", ",", "\[IndentingNewLine]", 
        RowBox[{"Blend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
            RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",", 
            RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"#", "[", 
           RowBox[{"\"\<Gold\>\"", "<>", "type"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fig2Color", "[", 
      RowBox[{"\"\<Full\>\"", ",", 
       RowBox[{"type", ":", 
        RowBox[{"\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\""}]}], ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Function", "@", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#GoldVarianceExplained", ">", "0.1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Blend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
            RowBox[{"$PolarAngleBlendColors", "[", "hemi", "]"}], ",", 
            RowBox[{"$EccentricityBlendColors", "[", "hemi", "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"#", "[", 
           RowBox[{"\"\<Gold\>\"", "<>", "type"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Curvature\>\""}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"c8af802f-7257-4c6d-88e8-4b38e5b586bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Fig2Params", ",", "Fig2Row", ",", "$Fig2All"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig2Params", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Subject\>\"", "\[Rule]", "\"\<S1203\>\""}], ",", 
       RowBox[{"\"\<Hemi\>\"", "\[Rule]", "RH"}], ",", 
       RowBox[{"\"\<Dataset\>\"", "\[Rule]", "1"}], ",", 
       RowBox[{"\"\<Type\>\"", "\[Rule]", "\"\<Eccentricity\>\""}], ",", 
       RowBox[{"\"\<Origin\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "28"}], ",", "12"}], "}"}]}]}], "|>"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Subject\>\"", "\[Rule]", "\"\<S1204\>\""}], ",", 
       RowBox[{"\"\<Hemi\>\"", "\[Rule]", "LH"}], ",", 
       RowBox[{"\"\<Dataset\>\"", "\[Rule]", "1"}], ",", 
       RowBox[{"\"\<Type\>\"", "\[Rule]", "\"\<Eccentricity\>\""}], ",", 
       RowBox[{"\"\<Origin\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", 
          RowBox[{"-", "20"}]}], "}"}]}]}], "|>"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Subject\>\"", "\[Rule]", "\"\<S1204\>\""}], ",", 
       RowBox[{"\"\<Hemi\>\"", "\[Rule]", "RH"}], ",", 
       RowBox[{"\"\<Dataset\>\"", "\[Rule]", "1"}], ",", 
       RowBox[{"\"\<Type\>\"", "\[Rule]", "\"\<PolarAngle\>\""}], ",", 
       RowBox[{"\"\<Origin\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "50"}], ",", 
          RowBox[{"-", "25"}]}], "}"}]}]}], "|>"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"List", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fig2Row", "[", 
      RowBox[{"k_", "/;", 
       RowBox[{"0", "<", "k", "\[LessEqual]", 
        RowBox[{"Length", "[", "$Fig2Params", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"$Fig2Params", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "//", 
      RowBox[{"Function", "@", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"map", "=", 
            RowBox[{"SubjectMap", "[", 
             RowBox[{"#Subject", ",", "#Hemi", ",", "#Dataset"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"rng", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#Origin", "===", "None"}], ",", "Automatic", ",", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"#Origin", ",", 
                 RowBox[{"#Origin", "+", "$Fig2RegionSize"}]}], "}"}], 
               "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Append", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"kk", "\[Rule]", 
               RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<fig2/\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<_\>\"", "<>", 
                  RowBox[{"ToLowerCase", "[", "kk", "]"}], "<>", 
                  "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
                 RowBox[{"CortexPlot", "[", 
                  RowBox[{"map", ",", 
                   RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Fig2Color", "[", 
                    RowBox[{"kk", ",", "#Type", ",", "#Hemi"}], "]"}]}], ",", 
                   
                   RowBox[{"PlotRange", "\[Rule]", "rng"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", "400"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"kk", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Data\>\"", ",", "\"\<Prior\>\"", ",", 
                  "\"\<Prediction\>\"", ",", "\"\<Validation\>\""}], "}"}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<Full\>\"", "\[Rule]", 
             RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<fig3/\>\"", "<>", 
                RowBox[{"ToString", "[", "k", "]"}], "<>", 
                "\"\<_full.png\>\""}], ",", "\[IndentingNewLine]", 
               RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
                RowBox[{"map", ",", "\[IndentingNewLine]", 
                 RowBox[{"ColorFunction", "\[Rule]", 
                  RowBox[{"Fig2Color", "[", 
                   RowBox[{"\"\<Full\>\"", ",", "#Type", ",", "#Hemi"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Epilog", "\[Rule]", 
                  RowBox[{"Fig2DrawRegion", "[", 
                   RowBox[{"#Origin", ",", "White"}], "]"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", "400"}], "]"}]}]}], "]"}]}]}], 
        "]"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig2All", ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Fig2Row", "[", "ii", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "$Fig2Params", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"750bb472-8893-4ff2-b5a0-\
3259f7d89386"]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure 3: Inference Methods", "Section",ExpressionUUID->"04f66724-5788-46d9-aaaf-fccd0def574d"],

Cell[CellGroupData[{

Cell["Setup", "Subsection",ExpressionUUID->"1bb702e5-ae45-4867-87c3-91aa425f2e8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$Fig3ExampleSubject", ",", "$Fig3ExampleDataset", ",", "$Fig3ExampleHemi",
     ",", "Fig3SubMap", ",", "$Fig3DataColor", ",", "$Fig3DataTransColor", 
    ",", "$Fig3Benson14Color", ",", "$Fig3PredColor", ",", "SquareCurv"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig3ExampleSubject", "=", "\"\<S1204\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig3ExampleDataset", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig3ExampleHemi", "=", "LH"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompoundExpression", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fig3SubMap", "[", "\"\<Anatomical\>\"", "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"map", "=", 
         RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SubjectMesh", "[", 
            RowBox[{
            "$Fig3ExampleSubject", ",", "$Fig3ExampleHemi", ",", 
             "\"\<Registered\>\"", ",", "$Fig3ExampleDataset"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Center", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Options", "[", 
                RowBox[{
                 RowBox[{"MapTemplate", "[", "$Fig3ExampleHemi", "]"}], ",", 
                 "Center"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"58.58", ",", 
                RowBox[{"-", "61.84"}], ",", 
                RowBox[{"-", "52.39"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Radius", "\[Rule]", 
            RowBox[{"Quantity", "[", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"Pi", "/", "4"}], "]"}], ",", "\"\<Radians\>\""}], 
             "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"map", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"\"\<Squares\>\"", "\[Rule]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Times", "@@", 
             RowBox[{"Sign", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"xy", ",", "40"}], "]"}], ")"}], "/", "40"}], 
                "]"}], "-", "0.5"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"xy", ",", 
              RowBox[{"VertexCoordinates", "[", "map", "]"}]}], "}"}]}], 
           "]"}]}], "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fig3SubMap", "[", "\"\<Native\>\"", "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"amap", "=", 
          RowBox[{"Fig3SubMap", "[", "\"\<Anatomical\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"nmsh", "=", 
          RowBox[{"SubjectMesh", "[", 
           RowBox[{
           "$Fig3ExampleSubject", ",", "$Fig3ExampleHemi", ",", 
            "\"\<Sphere\>\"", ",", "$Fig3ExampleDataset"}], "]"}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Reproject", "[", "\[IndentingNewLine]", 
        RowBox[{"amap", ",", "\[IndentingNewLine]", 
         RowBox[{"VertexCoordinates", "[", "nmsh", "]"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fig3SubMap", "[", "\"\<Retinotopic\>\"", "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"amap", "=", 
          RowBox[{"Fig3SubMap", "[", "\"\<Anatomical\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"amsh", "=", 
          RowBox[{"SubjectMesh", "[", 
           RowBox[{
           "$Fig3ExampleSubject", ",", "$Fig3ExampleHemi", ",", 
            "\"\<Registered\>\"", ",", "$Fig3ExampleDataset"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"bmsh", "=", 
          RowBox[{"Benson14Mesh", "[", 
           RowBox[{"$Fig3ExampleHemi", ",", "\"\<Sphere\>\""}], "]"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"brmsh", "=", 
            RowBox[{"CorticalMesh", "[", 
             RowBox[{"bmsh", ",", 
              RowBox[{"VertexCoordinates", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"\"\<PredictedRegistration\>\"", "/.", "bmsh"}], 
                ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"anaX", "=", 
            RowBox[{"VertexCoordinates", "[", "amap", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"retX", "=", 
            RowBox[{"VertexCoordinates", "@", 
             RowBox[{"Reproject", "[", 
              RowBox[{"amap", ",", 
               RowBox[{"\"\<PredictedRegistration\>\"", "/.", "amsh"}]}], 
              "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"priX", "=", 
             RowBox[{"VertexCoordinates", "@", 
              RowBox[{"Reproject", "[", "\[IndentingNewLine]", 
               RowBox[{"amap", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"dbg", "=", 
                    RowBox[{"{", 
                    RowBox[{"amsh", ",", "bmsh", ",", "brmsh", ",", "#"}], 
                    "}"}]}], ";", "#"}], ")"}], "&"}], "@", 
                 RowBox[{"CortexLookup", "[", 
                  RowBox[{"brmsh", ",", 
                   RowBox[{"CortexAddress", "[", 
                    RowBox[{"bmsh", ",", 
                    RowBox[{"VertexCoordinates", "[", "amsh", "]"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Reproject", "[", "\[IndentingNewLine]", 
            RowBox[{"amap", ",", "\[IndentingNewLine]", 
             RowBox[{"CortexLookup", "[", 
              RowBox[{"bmsh", ",", 
               RowBox[{"CortexAddress", "[", 
                RowBox[{"brmsh", ",", 
                 RowBox[{"\"\<PredictedRegistration\>\"", "/.", "amsh"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig3DataColor", "=", 
   RowBox[{"Function", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#VarianceExplained", ">", "0.1"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Blend", "[", 
       RowBox[{
        RowBox[{"$EccentricityBlendColors", "[", "LH", "]"}], ",", 
        "#Eccentricity"}], "]"}], ",", "\[IndentingNewLine]", 
      "\"\<Curvature\>\""}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig3DataTransColor", "=", 
   RowBox[{"Function", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#VarianceExplained", ">", "0.1"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Blend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CorticalCurvatureColor", "[", "#Curvature", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"$EccentricityBlendColors", "[", "LH", "]"}], ",", 
            "#Eccentricity"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        "0.75"}], "]"}], ",", "\[IndentingNewLine]", "\"\<Curvature\>\""}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig3PredColor", "=", 
   RowBox[{"Function", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "#PredictedVisualArea", "<", "4"}], "&&", 
       RowBox[{"#PredictedEccentricity", "<", "12"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Blend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CorticalCurvatureColor", "[", "#Curvature", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"$EccentricityBlendColors", "[", "LH", "]"}], ",", 
            "#PredictedEccentricity"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "0.75"}], "]"}], ",", "\[IndentingNewLine]", 
      "\"\<Curvature\>\""}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Fig3Benson14Color", "=", 
   RowBox[{"Function", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "#Benson14VisualArea", "<", "4"}], "&&", 
       RowBox[{"#Benson14Eccentricity", "<", "12"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Blend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CorticalCurvatureColor", "[", "#Curvature", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"$EccentricityBlendColors", "[", "LH", "]"}], ",", 
            "#Benson14Eccentricity"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "0.75"}], "]"}], ",", "\[IndentingNewLine]", 
      "\"\<Curvature\>\""}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SquareCurv", "[", "map_", "]"}], ":=", 
   RowBox[{"map", "/.", 
    RowBox[{"\"\<Curvature\>\"", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"\"\<Squares\>\"", "/.", "map"}], ")"}]}]}]}], ";"}]}], "Input",ExpressionUUID->"b23c0d42-72bd-4a59-a87f-fbf897957659"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Fig3MapPlot", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fig3MapPlot", "[", 
    RowBox[{"map_", ",", 
     RowBox[{"clrFn1_:", "Automatic"}], ",", 
     RowBox[{"clrFn2_:", "Automatic"}], ",", 
     RowBox[{"lines", ":", 
      RowBox[{"(", 
       RowBox[{"None", "|", "\"\<Theory\>\"", "|", "\"\<Data\>\""}], ")"}], 
      ":", "None"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cfn1", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"clrFn1", "===", "Automatic"}], ",", "$Fig3PredColor", ",", 
          "clrFn1"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"cfn2", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"clrFn2", "===", "Automatic"}], ",", "$Fig3DataColor", ",", 
          "clrFn2"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sqmap", "=", 
        RowBox[{"SquareCurv", "[", "map", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"b14", "=", 
        RowBox[{"Benson14Map", "[", "$Fig3ExampleHemi", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"b14w", "=", 
        RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Benson14Map", "[", "$Fig3ExampleHemi", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexCoordinates", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
             RowBox[{"Benson14Map", "[", "$Fig3ExampleHemi", "]"}]}], 
            ")"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
         RowBox[{"sqmap", ",", "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", "cfn1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.225", ",", "0.225"}], "}"}], "]"}], ",", 
                 RowBox[{"ImageScaled", "[", "0.228", "]"}]}], "]"}]}], "}"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"CortexPlot", "[", 
                RowBox[{"map", ",", 
                 RowBox[{"ColorFunction", "\[Rule]", "cfn2"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageScaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.45", ",", "0.45"}], "}"}], "]"}]}], "]"}]}], 
            "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"lines", "===", "None"}], ",", "Nothing", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"lines", "\[Equal]", "\"\<Theory\>\""}], ",", 
          RowBox[{"Graphics", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", 
                RowBox[{
                 RowBox[{"Blend", "[", 
                  RowBox[{
                   RowBox[{"$EccentricityBlendColors", "[", "All", "]"}], ",",
                    "e"}], "]"}], ",", "0.4"}], "]"}], ",", 
               "\[IndentingNewLine]", "Thick", ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"FMMIsoEccenLinePoints", "[", 
                 RowBox[{
                  RowBox[{"Benson17Model", "[", "LH", "]"}], ",", "e", ",", 
                  RowBox[{"VisualAreas", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}]}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"e", ",", 
               RowBox[{"{", 
                RowBox[{"0.75", ",", "1.5", ",", "3", ",", "6", ",", "12"}], 
                "}"}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "True",
           ",", 
          RowBox[{"Graphics", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pts", "=", 
                 RowBox[{"FMMIsoEccenLinePoints", "[", 
                  RowBox[{
                   RowBox[{"Benson17Model", "[", "LH", "]"}], ",", "e", ",", 
                   RowBox[{"VisualAreas", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Lighter", "[", 
                  RowBox[{
                   RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "All", "]"}], 
                    ",", "e"}], "]"}], ",", "0.4"}], "]"}], ",", 
                 "\[IndentingNewLine]", "Thick", ",", 
                 RowBox[{"Point", "/@", 
                  RowBox[{"CortexLookup", "[", 
                   RowBox[{"b14", ",", 
                    RowBox[{"CortexAddress", "[", 
                    RowBox[{"b14w", ",", "pts"}], "]"}]}], "]"}]}]}], "}"}]}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"e", ",", 
               RowBox[{"{", 
                RowBox[{"0.75", ",", "1.5", ",", "3", ",", "6", ",", "12"}], 
                "}"}]}], "}"}]}], "]"}]}]}], "]"}]}], "}"}], "]"}]}], "]"}]}],
   ";"}]}], "Input",ExpressionUUID->"5c4194b8-1257-486a-8a81-ad7935d1c00e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Panel A: Data-to-Data Prediction", "Subsection",ExpressionUUID->"c09b8e66-79d0-4614-a9da-f97cba3d8542"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Fig3ARight", ",", "$Fig3ALeft"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Fig3ALeft", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/A_left.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Native\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "$Fig3DataColor"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3ARight", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/A_right.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Native\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "$Fig3DataColor"}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"f92019f4-4766-467a-\
818c-33a0dbcea75c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Panel B: Prior-Alone Prediction", "Subsection",ExpressionUUID->"5e12d321-6157-4693-90e1-59cbad7035cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$Fig3BPlot1", ",", "$Fig3BPlot2", ",", "$Fig3BPlot3", ",", 
    "$Fig3BPlot4"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Fig3BPlot1", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/B_1.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Native\>\"", "]"}], ",", 
         "\"\<Curvature\>\"", ",", "$Fig3DataColor", ",", "None"}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3BPlot2", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/B_2.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Anatomical\>\"", "]"}], ",", 
         "\"\<Curvature\>\"", ",", "$Fig3DataColor", ",", "\"\<Data\>\""}], 
        "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3BPlot3", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/B_3.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Anatomical\>\"", "]"}], ",", 
         "$Fig3Benson14Color", ",", "$Fig3DataColor", ",", "\"\<Data\>\""}], 
        "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3BPlot4", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/B_4.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Native\>\"", "]"}], ",", 
         "$Fig3Benson14Color", ",", "$Fig3DataColor", ",", "None"}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"b81021ff-038d-4782-\
8f1e-3bf389e42c0c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Panel C: Data+Prior Prediction", "Subsection",ExpressionUUID->"c26b3ea3-21fd-4c26-a9a6-55a816a4bbe3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$Fig3CPlot1", ",", "$Fig3CPlot2", ",", "$Fig3CPlot3", ",", "$Fig3CPlot4", 
    ",", "$Fig3CPlot5"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Fig3CPlot1", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/C_1.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Native\>\"", "]"}], ",", 
         "\"\<Curvature\>\"", ",", "$Fig3DataColor", ",", "None"}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3CPlot2", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/C_2.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Anatomical\>\"", "]"}], ",", 
         "\"\<Curvature\>\"", ",", "$Fig3DataColor", ",", "\"\<Data\>\""}], 
        "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3CPlot3", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/C_3.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Retinotopic\>\"", "]"}], ",", 
         "$Fig3DataTransColor", ",", "$Fig3DataColor", ",", "\"\<Data\>\""}], 
        "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3CPlot4", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/C_4.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Retinotopic\>\"", "]"}], ",", 
         "$Fig3PredColor", ",", "$Fig3DataColor", ",", "\"\<Data\>\""}], 
        "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$Fig3CPlot5", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<fig2/C_5.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Fig3MapPlot", "[", 
        RowBox[{
         RowBox[{"Fig3SubMap", "[", "\"\<Native\>\"", "]"}], ",", 
         "$Fig3PredColor", ",", "$Fig3DataColor", ",", "None"}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"b59231e1-794c-4091-\
b9a3-078b88c29298"]
}, Closed]],

Cell[CellGroupData[{

Cell["All Parts", "Subsection",ExpressionUUID->"09489c12-b45c-4d02-86d5-37f249071666"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$Fig3All", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Fig3All", ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "$Fig3ARight", ",", "$Fig3ALeft", ",", "\[IndentingNewLine]", 
      "$Fig3BPlot1", ",", "$Fig3BPlot2", ",", "$Fig3BPlot3", ",", 
      "$Fig3BPlot4", ",", "\[IndentingNewLine]", "$Fig3CPlot1", ",", 
      "$Fig3CPlot2", ",", "$Fig3CPlot3", ",", "$Fig3CPlot4", ",", 
      "$Fig3CPlot5"}], "}"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->\
"40a4d9a9-933e-4c9d-8dbe-655104786ade"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure 4: Deformations", "Section",ExpressionUUID->"7246ace7-b8d3-4a5e-9876-90a014ae02d5"],

Cell[CellGroupData[{

Cell["A. Major deformation: S1205, dataset 9", "Subsection",ExpressionUUID->"35bdf46f-23cc-4588-b313-5ae062724172"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$Fig4AMajorDeform", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Fig4AMajorDeform", ":=", 
    RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<fig4/A_major.png\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"plots", "=", 
           RowBox[{"StandardInflatedPlots", "[", 
            RowBox[{"\"\<S1205\>\"", ",", "9"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ins", "=", 
           RowBox[{
            RowBox[{"Inset", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"ImageScaled", "[", "#2", "]"}], ",", 
              RowBox[{"ImageScaled", "[", "#2", "]"}]}], "]"}], "&"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"White", ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3.25", "*", "72"}], ",", 
                 RowBox[{"3.25", "*", "72"}]}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "\"\<PolarAngle\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"RH", ",", "\"\<PolarAngle\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "\"\<Eccentricity\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"RH", ",", "\"\<Eccentricity\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"a79a1a28-\
e537-4c38-b0fe-33c2f920d7fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["B. Major deformation: S1202, dataset 17", "Subsection",ExpressionUUID->"4cf3a8b5-489d-4dab-8135-100c7161e4f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$Fig4BMinorDeform", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Fig4BMinorDeform", ":=", 
    RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<fig4/B_minor.png\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"plots", "=", 
           RowBox[{"StandardInflatedPlots", "[", 
            RowBox[{"\"\<S1202\>\"", ",", "18"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ins", "=", 
           RowBox[{
            RowBox[{"Inset", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"ImageScaled", "[", "#2", "]"}], ",", 
              RowBox[{"ImageScaled", "[", "#2", "]"}]}], "]"}], "&"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"White", ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3.25", "*", "72"}], ",", 
                 RowBox[{"3.25", "*", "72"}]}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "\"\<PolarAngle\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"RH", ",", "\"\<PolarAngle\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "\"\<Eccentricity\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ins", "[", 
            RowBox[{
             RowBox[{"plots", "[", 
              RowBox[{"{", 
               RowBox[{"RH", ",", "\"\<Eccentricity\>\""}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"ecb69b60-\
5aae-47f6-938b-ae325ab6ab33"]
}, Closed]],

Cell[CellGroupData[{

Cell["C. Iso-lines", "Subsection",ExpressionUUID->"d6677979-6472-46c3-b15a-f690ef6e8cbf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Fig4MajorTraceAngle", ",", "$Fig4MajorTraceEccen"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Fig4MajorTraceAngle", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sub", "=", "\"\<S1205\>\""}], ",", 
         RowBox[{"hemi", "=", "RH"}], ",", 
         RowBox[{"ds", "=", "9"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", "=", 
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<Sphere\>\"", ",", "ds"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"edges", "=", 
              RowBox[{"EdgePairsTr", "[", "m", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"angs", "=", 
              RowBox[{"\"\<GoldPolarAngle\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ilbls", "=", 
              RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ieccs", "=", 
              RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"blbls", "=", 
              RowBox[{"\"\<Benson14VisualArea\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"beccs", "=", 
              RowBox[{"\"\<Benson14Eccentricity\>\"", "/.", "m"}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"eangs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"angs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ielbls", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ilbls", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ieeccs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ieccs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"belbls", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"blbls", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"beeccs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"beccs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ii", "=", 
                  RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "edge", " ", "straddles", " ", "visual", " ", "areas"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{
                    RowBox[{"ielbls", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"ielbls", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "1"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "one", " ", "of", " ", "the", " ", "visual", " ", "areas",
                     " ", "is", " ", "3"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"(", 
                    RowBox[{"ielbls", "-", "3"}], ")"}]}], "]"}], ",", "0"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"less", " ", "than", " ", "12", " ", "degrees"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"12", "-", 
                    RowBox[{"Mean", "[", "ieeccs", "]"}]}], "]"}], ",", "1"}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "greater", " ", "than", " ", "1.5", " ", "degrees"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"Mean", "[", "ieeccs", "]"}], "-", "1.5"}], "]"}],
                     ",", "1"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"bi", "=", 
                  RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "edge", " ", "straddles", " ", "visual", " ", "areas"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{
                    RowBox[{"belbls", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"belbls", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "1"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "one", " ", "of", " ", "the", " ", "visual", " ", "areas",
                     " ", "is", " ", "3"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"(", 
                    RowBox[{"belbls", "-", "3"}], ")"}]}], "]"}], ",", "0"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"less", " ", "than", " ", "12", " ", "degrees"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"12", "-", 
                    RowBox[{"Mean", "[", "beeccs", "]"}]}], "]"}], ",", "1"}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "greater", " ", "than", " ", "1.5", " ", "degrees"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"Mean", "[", "beeccs", "]"}], "-", "1.5"}], "]"}],
                     ",", "1"}], "]"}]}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"iiUpper", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"(", 
                    RowBox[{"ielbls", "-", "4"}], ")"}]}], "]"}], ",", " ", 
                    "0"}], "]"}], ",", "ii"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"ieeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"iiLower", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{"Plus", "@@", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ielbls", "-", "4"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
                    "1"}], "]"}], ",", "\[IndentingNewLine]", "ii"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"ieeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"biUpper", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"(", 
                    RowBox[{"belbls", "-", "4"}], ")"}]}], "]"}], ",", " ", 
                    "0"}], "]"}], ",", "bi"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"beeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"biLower", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{"Plus", "@@", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"belbls", "-", "4"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
                    "1"}], "]"}], ",", "\[IndentingNewLine]", "bi"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"beeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"0.75", "+", "#1"}], "]"}], ",", "#2"}], "}"}], 
                    "]"}], "&"}], "@@@", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"ieeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"eangs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"iiLower", ",", "iiUpper"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"beeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"eangs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"biLower", ",", "biUpper"}], "}"}]}]}], "]"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{"$BaseStyle", ",", "Black"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Red", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Blue", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Darker", "[", 
                    RowBox[{"Red", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Darker", "[", 
                    RowBox[{"Blue", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", "Dashed"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Dashed"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"0.75", "+", "1.3"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"0.75", "+", "12"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "180"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"2.75", "*", 
                    RowBox[{"72", "/", "2"}]}], ")"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "45"}], ",", 
                    RowBox[{"-", "90"}], ",", 
                    RowBox[{"-", "135"}], ",", 
                    RowBox[{"-", "180"}]}], "}"}], ",", "None"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"0.75", "+", "e"}], "]"}], ",", "e"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", 
                    RowBox[{"{", 
                    RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
                    "}"}]}], "]"}], ",", "None"}], "}"}]}], "}"}]}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FigMajorTraceEccen", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sub", "=", "\"\<S1205\>\""}], ",", 
         RowBox[{"hemi", "=", "RH"}], ",", 
         RowBox[{"ds", "=", "9"}], ",", 
         RowBox[{"e1", "=", "0.75"}], ",", 
         RowBox[{"e2", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", "=", 
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<Sphere\>\"", ",", "ds"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"edges", "=", 
              RowBox[{"EdgePairsTr", "[", "m", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"eccs", "=", 
              RowBox[{"\"\<GoldEccentricity\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ilbls", "=", 
              RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"iangs", "=", 
              RowBox[{"\"\<PredictedPolarAngle\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ieccs", "=", 
              RowBox[{"\"\<PredictedEccentrcity\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"blbls", "=", 
              RowBox[{"\"\<Benson14VisualArea\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"bangs", "=", 
              RowBox[{"\"\<Benson14PolarAngle\>\"", "/.", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"beccs", "=", 
              RowBox[{"\"\<Benson14Eccentrcity\>\"", "/.", "m"}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"eeccs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"eccs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ieeccs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ieccs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ielbls", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ilbls", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ieangs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"iangs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"beeccs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"beccs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"belbls", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"blbls", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"beangs", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bangs", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edges"}]}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ii", "=", 
                  RowBox[{"Indices", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Unitize", "@*", "Times"}], "@@", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"ielbls", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", "1"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"bi", "=", 
                  RowBox[{"Indices", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Unitize", "@*", "Times"}], "@@", 
                    RowBox[{"Clip", "[", 
                    RowBox[{"belbls", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", "1"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"sortFn", "=", 
                  RowBox[{"Function", "@", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeangs", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "\[Equal]", "\"\<Inferred\>\""}], ",", 
                    "ieangs", ",", "beangs"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"xelbls", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "\[Equal]", "\"\<Inferred\>\""}], ",", 
                    "ielbls", ",", "belbls"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ang", "=", 
                    RowBox[{"Mean", "@", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"xeangs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}]}]}], ",", 
                    RowBox[{"lbl", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"xelbls", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}]}]}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"lbl", "\[Equal]", "1"}], ",", "ang", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"lbl", "\[Equal]", "2"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ang", "<", "90"}], ",", 
                    RowBox[{"-", "ang"}], ",", 
                    RowBox[{"ang", "+", "90"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ang", "<", "90"}], ",", 
                    RowBox[{
                    RowBox[{"-", "ang"}], "-", "90"}], ",", 
                    RowBox[{"ang", "+", "180"}]}], "]"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ii1", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"ieeccs", "-", "e1"}], "]"}]}], ",", " ", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "ii"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sortFn", "[", "\"\<Inferred\>\"", "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"ii2", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"ieeccs", "-", "e2"}], "]"}]}], ",", " ", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "ii"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sortFn", "[", "\"\<Inferred\>\"", "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"bi1", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"beeccs", "-", "e1"}], "]"}]}], ",", " ", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "ii"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sortFn", "[", "\"\<Benson14\>\"", "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"bi2", "=", 
                    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"beeccs", "-", "e2"}], "]"}]}], ",", " ", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "ii"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sortFn", "[", "\"\<Benson14\>\"", "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Transpose", "@@@", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sortFn", "[", "\"\<Inferred\>\"", "]"}], "/@", 
                    "#"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"eeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"ii1", ",", "ii2"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sortFn", "[", "\"\<Benson14\>\"", "]"}], "/@", 
                    "#"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"eeccs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"bi1", ",", "bi2"}], "}"}]}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{"$BaseStyle", ",", "Black"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Red", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Blue", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Darker", "[", 
                    RowBox[{"Red", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Darker", "[", 
                    RowBox[{"Blue", ",", "0.5"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", "Dashed"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Dashed"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "180"}], ",", "360"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "12"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"2.75", "*", 
                    RowBox[{"72", "/", "2"}]}], ")"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "45"}], ",", 
                    RowBox[{"-", "90"}], ",", 
                    RowBox[{"-", "135"}], ",", 
                    RowBox[{"-", "180"}]}], "}"}], ",", "None"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"0.75", "+", "e"}], "]"}], ",", "e"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", 
                    RowBox[{"{", 
                    RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
                    "}"}]}], "]"}], ",", "None"}], "}"}]}], "}"}]}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"fd210c9a-795e-40ef-\
b2c3-af91fd49c50f"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"$Failed\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\
\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\
\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\
\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\
\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\
\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\
\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\
\"5\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \\\
\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\
\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \\\
\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\
\"9\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"10\\\", \
\\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\", \
\\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \
\\\",\\\", \\\"13\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\", \
\\\",\\\", \\\"14\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"470218\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,4749,
   502,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"44d21cb2-ec45-429d-9891-bb7488d9c87c"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"$Failed\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \\\
\"4\\\", \\\",\\\", \\\"129\\\", \\\",\\\", \\\"130\\\", \\\",\\\", \\\"133\\\
\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"130\\\", \\\",\
\\\", \\\"134\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \
\\\"8\\\", \\\",\\\", \\\"132\\\", \\\",\\\", \\\"133\\\", \\\",\\\", \\\"136\
\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"133\\\", \
\\\",\\\", \\\"6\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \
\\\"10\\\", \\\",\\\", \\\"134\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"134\
\\\", \\\",\\\", \\\"135\\\", \\\",\\\", \\\"138\\\", \\\",\\\", \\\"8\\\", \
\\\",\\\", \\\"11\\\", \\\",\\\", \\\"136\\\", \\\",\\\", \\\"139\\\", \
\\\",\\\", \\\"9\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"12\\\", \
\\\",\\\", \\\"13\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"13\\\", \
\\\",\\\", \\\"137\\\", \\\",\\\", \\\"137\\\", \\\",\\\", \\\"138\\\", \\\",\
\\\", \\\"12\\\", \\\",\\\", \\\"139\\\", \\\",\\\", \\\"140\\\", \\\",\\\", \
\\\"13\\\", \\\",\\\", \\\"140\\\", \\\",\\\", \\\"141\\\", \\\",\\\", \
\\\"137\\\", \\\",\\\", \\\"141\\\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"17\
\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"470218\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,4749,503,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"1c225cfb-b0a2-4b19-9115-7f71cd24f880"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"$Failed\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\
\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\
\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\
\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\
\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\
\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\
\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\
\"5\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \\\
\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\
\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \\\
\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\
\"9\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"10\\\", \
\\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\", \
\\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \
\\\",\\\", \\\"13\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\", \
\\\",\\\", \\\"14\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"470218\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,4749,
   504,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"5c49454d-3c03-4137-a7b1-a6e4737a0543"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,4749,505,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"e792e636-060d-4e18-b666-7d2a4dab7f4c"],

Cell[BoxData[
 TemplateBox[{
  "Intersection","heads",
   "\"Heads \\!\\(\\*RowBox[{\\\"List\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"Indices\\\"}]\\) at positions \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) and \\!\\(\\*RowBox[{\\\"1\\\"}]\\) are \
expected to be the same.\"",2,4749,506,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"8c8c6f07-7a8e-4513-a41b-3cacf3d6bd42"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"Indices\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"Sign\\\", \\\"[\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"0.75`\\\"}], \\\"+\\\", RowBox[{\\\"$Failed\\\", \\\"\[LeftDoubleBracket]\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"2\\\", \
\\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \
\\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \
\\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \
\\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \
\\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \
\\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \
\\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \
\\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \
\\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \
\\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \
\\\"11\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"12\\\
\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \
\\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\", \\\",\\\", \\\"14\\\", \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"470218\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"\[RightDoubleBracket]\\\"}]}], \
\\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sign\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.75`\\\"}], \\\"+\\\", \
RowBox[{\\\"$Failed\\\", \\\"\[LeftDoubleBracket]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"2\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"129\\\", \\\",\\\", \
\\\"130\\\", \\\",\\\", \\\"133\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\
\", \\\",\\\", \\\"130\\\", \\\",\\\", \\\"134\\\", \\\",\\\", \\\"4\\\", \
\\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"132\\\", \
\\\",\\\", \\\"133\\\", \\\",\\\", \\\"136\\\", \\\",\\\", \\\"5\\\", \\\",\\\
\", \\\"8\\\", \\\",\\\", \\\"133\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"8\
\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"134\\\", \\\
\",\\\", \\\"10\\\", \\\",\\\", \\\"134\\\", \\\",\\\", \\\"135\\\", \
\\\",\\\", \\\"138\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"11\\\", \
\\\",\\\", \\\"136\\\", \\\",\\\", \\\"139\\\", \\\",\\\", \\\"9\\\", \\\",\\\
\", \\\"11\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \
\\\"10\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"137\\\", \\\",\\\", \\\"137\
\\\", \\\",\\\", \\\"138\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"139\\\", \
\\\",\\\", \\\"140\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"140\\\", \
\\\",\\\", \\\"141\\\", \\\",\\\", \\\"137\\\", \\\",\\\", \\\"141\\\", \\\",\
\\\", \\\"15\\\", \\\",\\\", \\\"17\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"470218\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\"\[RightDoubleBracket]\\\"}]}], \\\"]\\\"}]}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"",2,4749,507,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"c26a220c-23b7-41aa-b4bb-e12e272962e7"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"Indices\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"Sign\\\", \\\"[\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"0.75`\\\"}], \\\"+\\\", RowBox[{\\\"$Failed\\\", \\\"\[LeftDoubleBracket]\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"2\\\", \
\\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \
\\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \
\\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \
\\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \
\\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \
\\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \
\\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \
\\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \
\\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \
\\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \
\\\"11\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"12\\\
\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \
\\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\", \\\",\\\", \\\"14\\\", \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"470218\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"\[RightDoubleBracket]\\\"}]}], \
\\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sign\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.75`\\\"}], \\\"+\\\", \
RowBox[{\\\"$Failed\\\", \\\"\[LeftDoubleBracket]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"2\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"129\\\", \\\",\\\", \
\\\"130\\\", \\\",\\\", \\\"133\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\
\", \\\",\\\", \\\"130\\\", \\\",\\\", \\\"134\\\", \\\",\\\", \\\"4\\\", \
\\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"132\\\", \
\\\",\\\", \\\"133\\\", \\\",\\\", \\\"136\\\", \\\",\\\", \\\"5\\\", \\\",\\\
\", \\\"8\\\", \\\",\\\", \\\"133\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"8\
\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"134\\\", \\\
\",\\\", \\\"10\\\", \\\",\\\", \\\"134\\\", \\\",\\\", \\\"135\\\", \
\\\",\\\", \\\"138\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"11\\\", \
\\\",\\\", \\\"136\\\", \\\",\\\", \\\"139\\\", \\\",\\\", \\\"9\\\", \\\",\\\
\", \\\"11\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \
\\\"10\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"137\\\", \\\",\\\", \\\"137\
\\\", \\\",\\\", \\\"138\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"139\\\", \
\\\",\\\", \\\"140\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"140\\\", \
\\\",\\\", \\\"141\\\", \\\",\\\", \\\"137\\\", \\\",\\\", \\\"141\\\", \\\",\
\\\", \\\"15\\\", \\\",\\\", \\\"17\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"470218\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\"\[RightDoubleBracket]\\\"}]}], \\\"]\\\"}]}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"",2,4749,508,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"78835991-84a1-40fe-85f9-a770fbac5a7c"],

Cell[BoxData[
 TemplateBox[{
  "Intersection","heads",
   "\"Heads \\!\\(\\*RowBox[{\\\"Indices\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"List\\\"}]\\) at positions \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) and \\!\\(\\*RowBox[{\\\"1\\\"}]\\) are \
expected to be the same.\"",2,4749,509,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"64502e81-482f-41dd-a23b-aa4254c3371b"],

Cell[BoxData[
 TemplateBox[{
  "Intersection","heads",
   "\"Heads \\!\\(\\*RowBox[{\\\"List\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"Indices\\\"}]\\) at positions \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) and \\!\\(\\*RowBox[{\\\"1\\\"}]\\) are \
expected to be the same.\"",2,4749,510,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"ca35d14d-2610-4304-8b33-a1d7d1022d25"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Intersection\\\", \
\\\"::\\\", \\\"heads\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,4749,511,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"208c6fce-3142-4b52-847a-b921775e42f1"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"Indices\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"Sign\\\", \\\"[\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"3\\\"}], \\\"+\\\", RowBox[{\\\"$Failed\\\", \
\\\"\[LeftDoubleBracket]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"2\\\", \
\\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"3\\\", \
\\\",\\\", \\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \
\\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"5\\\", \
\\\",\\\", \\\"5\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \
\\\"6\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \
\\\",\\\", \\\"7\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \
\\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \
\\\",\\\", \\\"9\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \
\\\"10\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"11\\\
\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"12\\\", \
\\\",\\\", \\\"13\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\", \
\\\",\\\", \\\"14\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"470218\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\"\[RightDoubleBracket]\\\"}]}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sign\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"-\\\", \\\"3\\\"}], \\\"+\\\", \
RowBox[{\\\"$Failed\\\", \\\"\[LeftDoubleBracket]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"2\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"129\\\", \\\",\\\", \
\\\"130\\\", \\\",\\\", \\\"133\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\
\", \\\",\\\", \\\"130\\\", \\\",\\\", \\\"134\\\", \\\",\\\", \\\"4\\\", \
\\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"132\\\", \
\\\",\\\", \\\"133\\\", \\\",\\\", \\\"136\\\", \\\",\\\", \\\"5\\\", \\\",\\\
\", \\\"8\\\", \\\",\\\", \\\"133\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"8\
\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"134\\\", \\\
\",\\\", \\\"10\\\", \\\",\\\", \\\"134\\\", \\\",\\\", \\\"135\\\", \
\\\",\\\", \\\"138\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"11\\\", \
\\\",\\\", \\\"136\\\", \\\",\\\", \\\"139\\\", \\\",\\\", \\\"9\\\", \\\",\\\
\", \\\"11\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \
\\\"10\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"137\\\", \\\",\\\", \\\"137\
\\\", \\\",\\\", \\\"138\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"139\\\", \
\\\",\\\", \\\"140\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"140\\\", \
\\\",\\\", \\\"141\\\", \\\",\\\", \\\"137\\\", \\\",\\\", \\\"141\\\", \\\",\
\\\", \\\"15\\\", \\\",\\\", \\\"17\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"470218\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\"\[RightDoubleBracket]\\\"}]}], \\\"]\\\"}]}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"",2,4749,512,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"aa0a0b9f-8b86-4cfe-aed6-59f8dbee9255"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,4749,513,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"be2e2168-56cd-4a78-a8a0-b41325a54c02"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","list",
   "\"List expected at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"124.50477981567383`\\\", \\\",\
\\\", \\\"125.19293975830078`\\\", \\\",\\\", \\\"129.8450698852539`\\\", \
\\\",\\\", \\\"125.61200714111328`\\\", \\\",\\\", \
\\\"128.6330108642578`\\\", \\\",\\\", \\\"123.0042839050293`\\\", \\\",\\\", \
\\\"120.18876266479492`\\\", \\\",\\\", \\\"123.4233512878418`\\\", \
\\\",\\\", \\\"120.68076705932617`\\\", \\\",\\\", \
\\\"124.94079208374023`\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"32\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
\\\"116.84457397460938`\\\", \\\",\\\", \\\"114.17807006835938`\\\", \
\\\",\\\", \\\"114.91251754760742`\\\", \\\",\\\", \
\\\"111.80645370483398`\\\", \\\",\\\", \\\"112.86016464233398`\\\", \
\\\",\\\", \\\"111.24371719360352`\\\", \\\",\\\", \
\\\"179.62654876708984`\\\", \\\",\\\", \\\"173.989501953125`\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"41185\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\"\[Intersection]\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\).\
\"",2,4749,514,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"9a444d0f-c358-4979-b760-45d24aa6bc60"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","list",
   "\"List expected at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"124.50477981567383`\\\", \\\",\
\\\", \\\"125.19293975830078`\\\", \\\",\\\", \\\"129.8450698852539`\\\", \
\\\",\\\", \\\"125.61200714111328`\\\", \\\",\\\", \
\\\"128.6330108642578`\\\", \\\",\\\", \\\"123.0042839050293`\\\", \\\",\\\", \
\\\"120.18876266479492`\\\", \\\",\\\", \\\"123.4233512878418`\\\", \
\\\",\\\", \\\"120.68076705932617`\\\", \\\",\\\", \
\\\"124.94079208374023`\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"32\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
\\\"116.84457397460938`\\\", \\\",\\\", \\\"114.17807006835938`\\\", \
\\\",\\\", \\\"114.91251754760742`\\\", \\\",\\\", \
\\\"111.80645370483398`\\\", \\\",\\\", \\\"112.86016464233398`\\\", \
\\\",\\\", \\\"111.24371719360352`\\\", \\\",\\\", \
\\\"179.62654876708984`\\\", \\\",\\\", \\\"173.989501953125`\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"41185\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\"\[Intersection]\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\).\
\"",2,4749,515,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"32645e96-eb43-4738-8995-9ff76aa48f14"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","list",
   "\"List expected at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"If\
\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"117.41382598876953`\\\", \\\",\\\", \\\"117.41382598876953`\\\", \
\\\",\\\", \\\"118.86510467529297`\\\", \\\",\\\", \
\\\"117.41382598876953`\\\", \\\",\\\", \\\"120.84588623046875`\\\", \
\\\",\\\", \\\"117.41382598876953`\\\", \\\",\\\", \
\\\"117.41382598876953`\\\", \\\",\\\", \\\"117.41382598876953`\\\", \
\\\",\\\", \\\"117.41382598876953`\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"33\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", \\\"121.32177734375`\\\", \\\",\\\", \\\"114.31690216064453`\\\", \
\\\",\\\", \\\"117.81933975219727`\\\", \\\",\\\", \
\\\"114.31690216064453`\\\", \\\",\\\", \\\"114.31690216064453`\\\", \
\\\",\\\", \\\"114.31690216064453`\\\", \\\",\\\", \
\\\"157.84605407714844`\\\", \\\",\\\", \\\"150.41293334960938`\\\", \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"41185\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"<\\\", \\\"90\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\",\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\"+\\\", \\\"180\\\"}]}], \
\\\"]\\\"}], \\\"\[Intersection]\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\).\
\"",2,4749,516,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"b9bb7891-1834-49f6-8eb6-c86948e6a061"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Transpose\\\", \\\"::\\\
\", \\\"list\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,4749,517,15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"5372716a-9a1b-4d4b-b035-a251dbe71f83"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"$Failed\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Neurotica`Util`Private`$MemoizePatternName\\\", \
\\\":\\\", \\\"$Failed\\\"}]\\) is Protected.\"",2,4749,518,
   15263928100769408971,"Local"},
  "MessageTemplate"]], "Message", \
"MSG",ExpressionUUID->"9f18063b-025e-440b-8478-ac7a4aecf4ed"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure 5: Average Step Deformations", "Section",ExpressionUUID->"76664132-3c07-44b1-b2c1-f0a2c84cebb8"],

Cell[CellGroupData[{

Cell["The vectors and angle between them.", "Subsection",ExpressionUUID->"9d8e4efb-122d-4a74-8ed5-40c5663fdb16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$DeformOrder", ",", "DeformRads", ",", "DeformMean", ",", 
    "DeformStandardDeviation", ",", "DeformEmbedding", ",", 
    "DeformFullEmbeddings", ",", "DeformAngles"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$DeformOrder", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$DeviationSummariesOrder", ",", 
     RowBox[{
     "\"\<Native\>\"", "|", "\"\<FSAverage\>\"", "|", 
      "\"\<Retinotopy\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeformRads", "]"}], "=", 
   RowBox[{"Options", "[", "DeviationSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeformMean", "]"}], "=", 
   RowBox[{"Options", "[", "DeviationSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeformStandardDeviation", "]"}], "=", 
   RowBox[{"Options", "[", "DeviationSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeformEmbedding", "]"}], "=", 
   RowBox[{"Options", "[", "DeviationSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeformAngles", "]"}], "=", 
   RowBox[{"Options", "[", "DeviationSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DeformRads", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ds", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"DeviationSummaries", "[", "]"}], ",", "opts"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"ii", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"Indices", "[", 
              RowBox[{"$DeviationSummariesOrder", ",", "#"}], "]"}]}], "&"}], 
           "/@", "$DeformOrder"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"ArcSin", "[", 
           RowBox[{"#", "/", "200.0"}], "]"}]}], "&"}], "@", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Values", "[", "ds", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "ii", ",", "ii"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeformMean", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dr", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"DeformRads", "[", "]"}], ",", "opts"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{"Mean", ",", "dr", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeformStandardDeviation", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dr", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"DeformRads", "[", "]"}], ",", "opts"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{"StandardDeviation", ",", "dr", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeformEmbedding", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mu", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"DeformMean", "[", "]"}], ",", "opts"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x0", "=", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"n", "=", 
                  RowBox[{"Length", "[", "mu", "]"}]}], ",", 
                 RowBox[{"vars", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"u", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"u", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "}"}]}], "]"}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"vars", "/.", 
                RowBox[{"Last", "@", 
                 RowBox[{"NMinimize", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Simplify", "@", 
                    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "-", 
                    RowBox[{"x", "[", "j", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "-", 
                    RowBox[{"y", "[", "j", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "-", 
                    RowBox[{"mu", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], "^", 
                    "2"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Flatten", "[", "vars", "]"}]}], "]"}]}]}]}], 
              "]"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "x0", "]"}], "-", 
           RowBox[{"Mean", "[", "x0", "]"}]}], "]"}]}], "]"}]}], "]"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeformFullEmbeddings", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dr", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"DeformRads", "[", "]"}], ",", "opts"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x0", "=", 
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"n", "=", 
                    RowBox[{"Length", "[", "#", "]"}]}], ",", 
                    RowBox[{"vars", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"u", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"u", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "}"}]}], "]"}]}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"vars", "/.", 
                   RowBox[{"Last", "@", 
                    RowBox[{"NMinimize", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Simplify", "@", 
                    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "-", 
                    RowBox[{"x", "[", "j", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "-", 
                    RowBox[{"y", "[", "j", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], "^", 
                    "2"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Flatten", "[", "vars", "]"}]}], "]"}]}]}]}], 
                 "]"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "x0", "]"}], "-", 
              RowBox[{"Mean", "[", "x0", "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"dr", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeformAngles", "[", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ems", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"DeformFullEmbeddings", "[", "]"}], ",", "opts"}], "]"}]}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ArcCos", "@", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"Normalize", "[", 
                RowBox[{"#1", "-", "#2"}], "]"}], ",", 
               RowBox[{"Normalize", "[", 
                RowBox[{"#3", "-", "#2"}], "]"}]}], "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"em", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
             RowBox[{"em", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
             RowBox[{"em", "[", 
              RowBox[{"[", 
               RowBox[{"3", ";;", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"em", ",", "ems"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"165d93a9-087e-4f99-996f-24122bdf4b28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"PlotDeformSteps", ",", "DeformPlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeformPlot", "]"}], "=", 
   RowBox[{"Options", "[", "DeviationSummaries", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotDeformSteps", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d12_", ",", "sd12_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d23_", ",", "sd23_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "sda_"}], "}"}], ",", "c1_", ",", "c2_", ",", 
     RowBox[{"x0_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "/", "2"}], "]"}]}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"a", "/", "2"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"u3", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"a", "/", "2"}], "]"}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"a", "/", "2"}], "]"}]}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"u1", "*", "d12"}]}], ",", 
         RowBox[{"p3", "=", 
          RowBox[{"u3", "*", "d23"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Identity", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
            RowBox[{"FaceForm", "@", 
             RowBox[{"Opacity", "[", 
              RowBox[{"0.25", ",", "c1"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Disk", "[", 
             RowBox[{"x0", ",", 
              RowBox[{"d12", "-", "sd12"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "-", 
                    RowBox[{"sda", "/", "2"}]}], ",", 
                   RowBox[{"#", "+", 
                    RowBox[{"sda", "/", "2"}]}]}], "}"}], "&"}], "@*", 
                "ArcTan"}], "@@", "u1"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"FaceForm", "@", 
             RowBox[{"Opacity", "[", 
              RowBox[{"0.5", ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"c1", ",", "0.5"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Annulus", "[", 
             RowBox[{"x0", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"d12", "-", "sd12"}], ",", 
                RowBox[{"d12", "+", "sd12"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "-", 
                    RowBox[{"sda", "/", "2"}]}], ",", 
                   RowBox[{"#", "+", 
                    RowBox[{"sda", "/", "2"}]}]}], "}"}], "&"}], "@*", 
                "ArcTan"}], "@@", "u1"}]}], "]"}], ",", "\[IndentingNewLine]",
             "c1", ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x0", "+", "p1"}], ",", "x0"}], "}"}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
            RowBox[{"FaceForm", "@", 
             RowBox[{"Opacity", "[", 
              RowBox[{"0.25", ",", "c2"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Disk", "[", 
             RowBox[{"x0", ",", 
              RowBox[{"d23", "-", "sd23"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "-", 
                    RowBox[{"sda", "/", "2"}]}], ",", 
                   RowBox[{"#", "+", 
                    RowBox[{"sda", "/", "2"}]}]}], "}"}], "&"}], "@*", 
                "ArcTan"}], "@@", "u3"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"FaceForm", "@", 
             RowBox[{"Opacity", "[", 
              RowBox[{"0.5", ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"c2", ",", "0.5"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Annulus", "[", 
             RowBox[{"x0", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"d23", "-", "sd23"}], ",", 
                RowBox[{"d23", "+", "sd23"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "-", 
                    RowBox[{"sda", "/", "2"}]}], ",", 
                   RowBox[{"#", "+", 
                    RowBox[{"sda", "/", "2"}]}]}], "}"}], "&"}], "@*", 
                "ArcTan"}], "@@", "u3"}]}], "]"}], ",", "\[IndentingNewLine]",
             "c2", ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"x0", ",", 
               RowBox[{"x0", "+", "p3"}]}], "}"}], "]"}]}], "}"}]}], "}"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeformPlot", "[", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<fig5/A_deform.pdf\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"em", "=", 
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"DeformEmbedding", "[", "]"}], ",", "opts"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"mu", "=", 
           RowBox[{
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"DeformMean", "[", "]"}], ",", "opts"}], "]"}], "*", 
            RowBox[{"180", "/", "Pi"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"sig", "=", 
           RowBox[{
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"DeformStandardDeviation", "[", "]"}], ",", "opts"}], 
             "]"}], "*", 
            RowBox[{"180", "/", "Pi"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"angs", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"DeformAngles", "[", "]"}], ",", "opts"}], "]"}]}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"amu", "=", 
             RowBox[{"Mean", "/@", "angs"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"asd", "=", 
             RowBox[{"StandardDeviation", "/@", "angs"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "@", 
           RowBox[{"PlotDeformSteps", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mu", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"sig", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mu", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
               RowBox[{"sig", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"amu", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"asd", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "Red", ",", "Blue"}], "]"}]}]}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"f686b5d9-\
43a1-4147-aa85-ecdcfa1bae77"]
}, Closed]],

Cell[CellGroupData[{

Cell["Histogram of Curvature Std\[CloseCurlyQuote]s", "Subsection",ExpressionUUID->"ad67615b-d1f0-4c6f-916b-1a427e378caa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectCurvatures", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectCurvatures", "[", 
     RowBox[{"t", ":", 
      RowBox[{
      "\"\<Native\>\"", "|", "\"\<Prior\>\"", "|", "\"\<Retinotopy\>\""}]}], 
     "]"}], ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h", "\[Rule]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"idcs", "=", 
             RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Indices", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
                RowBox[{"Unitize", "@", 
                 RowBox[{"Clip", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"\"\<PredictedVisualArea\>\"", "/.", 
                    RowBox[{"Benson14Mesh", "[", 
                    RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Indices", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
                RowBox[{"Unitize", "@", 
                 RowBox[{"Clip", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"\"\<PredictedEccentricity\>\"", "/.", 
                    RowBox[{"Benson14Mesh", "[", 
                    RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "12"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}]}], "]"}]}], 
            ",", "\[IndentingNewLine]", " ", 
            RowBox[{"bmsh", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"t", "\[Equal]", "\"\<Retinotopy\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"CorticalMesh", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Benson14Mesh", "[", 
                  RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"VertexCoordinates", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
                    RowBox[{"Benson14Mesh", "[", 
                    RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}]}], ")"}]}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Benson14Mesh", "[", 
                RowBox[{"h", ",", "\"\<Sphere\>\""}], "]"}]}], "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"mesh", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"t", "\[Equal]", "\"\<Retinotopy\>\""}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"CorticalMesh", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"s", ",", "h", ",", "\"\<Sphere\>\"", ",", "99"}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"VertexCoordinates", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"s", ",", "h", ",", "\"\<Sphere\>\"", ",", "99"}],
                     "]"}]}], ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"SubjectMesh", "[", 
                   RowBox[{"s", ",", "h", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"t", "\[Equal]", "\"\<Native\>\""}], ",", 
                    "\"\<Sphere\>\"", ",", "\"\<Registered\>\""}], "]"}], ",",
                     "99"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "idcs", "]"}], "]"}], "&"}], "@", 
               RowBox[{"CortexResample", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mesh", "\[Rule]", "bmsh"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Properties", "\[Rule]", "\"\<Curvature\>\""}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Method", "\[Rule]", "\"\<Nearest\>\""}]}], 
                "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"s", ",", "$Subjects"}], "}"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"h", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"e053e0b6-ec1d-4f51-b6bc-70ee7b7cdd20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$CurvStdPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$CurvStdPlot", ":=", 
    RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<fig5/B_curvstd.pdf\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"SmoothHistogram", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "@@@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StandardDeviation", "/@", 
            RowBox[{"Values", "@", 
             RowBox[{"SubjectCurvatures", "[", "t", "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Prior\>\"", ",", "\"\<Retinotopy\>\"", ",", 
               "\"\<Native\>\""}], "}"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0.35"}], "}"}], ",", "Full"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.4275730525673304`", ",", "0.`", ",", "0.43614862287327383`"}],
              "]"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"RGBColor", "[", 
             RowBox[{
             "0.`", ",", "0.6206759746700237`", ",", "0.6041046768902113`"}], 
             "]"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "Black", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Filling", "\[Rule]", "Axis"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"3.25", "*", "72"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Probability Density\>\"", ",", "None"}], "}"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"\"\<Curvature, Stdandard Deviation\>\"", ",", "None"}], 
            "}"}]}], "}"}]}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",ExpressionUUID->"8336d279-70cd-4b64-\
be16-ff141570d59a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure 6: Quantified Error", "Section",ExpressionUUID->"7152e3a2-4a9b-43a6-a935-800f89d4e793"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ErrorComparisonPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ErrorComparisonPlot", "[", 
     RowBox[{"areas_:", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], ":=", 
    RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
       RowBox[{"\"\<fig6/errcmp_[\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"ToString", "/@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", "areas", "]"}], ",", "areas", ",", 
             RowBox[{"{", "areas", "}"}]}], "]"}]}], ",", "\"\<,\>\""}], 
         "]"}], ",", "\[IndentingNewLine]", "\"\<].pdf\>\""}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ee", "=", 
           RowBox[{"ErrorByCoverage", "[", 
            RowBox[{"VisualAreas", "\[Rule]", "areas"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"inset", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.125", ",", "1.225"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.175", ",", "0.675"}], "}"}]}], "}"}], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.1", ",", "3.0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.2", ",", "2.45"}], "}"}]}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"styles", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Black", ",", "Red", ",", "White"}], "}"}], ",", 
               "#"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "0.15", ",", "0.3", ",", "0.45", ",", "0.6", ",", "0.75", ",", 
              "0.9"}], "}"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"aa", "=", 
             RowBox[{"Mean", "[", 
              RowBox[{"ee", "[", "\"\<Anatomical\>\"", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"tesum", "=", 
             RowBox[{"ee", "[", "\"\<Training\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"iesum", "=", 
             RowBox[{"ee", "[", "\"\<Inferred\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"xrng", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3"}], "}"}]}], ",", 
            RowBox[{"yrng", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"terrs", "=", 
               RowBox[{"tesum", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"tstds", "=", 
               RowBox[{"tesum", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ierrs", "=", 
               RowBox[{"iesum", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"istds", "=", 
               RowBox[{"iesum", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"times", "=", 
               RowBox[{"3.2", "*", 
                RowBox[{"Range", "[", "6", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"f", "=", "Identity"}], ",", 
              RowBox[{"dx", "=", "0.25"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "a", ",", "b", ",", "c", ",", "q"}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"fits", "=", 
                  RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"NonlinearModelFit", "[", "\[IndentingNewLine]", 
                    RowBox[{"data", ",", "\[IndentingNewLine]", 
                    RowBox[{"c", "+", 
                    RowBox[{"a", "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "^", "2"}], "+", "x"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"q", "^", "2"}], ")"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "0.1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "1"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "x", ",", "\[IndentingNewLine]", 
                    RowBox[{"MaxIterations", "\[Rule]", "200"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"data", ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"times", ",", "terrs"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"times", ",", "ierrs"}], "}"}], "]"}]}], "}"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"NonlinearModelFit", "::", "cvmit"}], "}"}]}], 
                   "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Show", "[", 
                   RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3", ",", "#1"}], "}"}], 
                   "]"}], "&"}], "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Red", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"#2", "-", "#3"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"#2", "+", "#3"}], "]"}]}], "}"}]}], "}"}], "]"}],
                     "&"}], "@@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"times", "-", "dx"}], ",", "ierrs", ",", 
                    "istds"}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"PointSize", "[", "Small", "]"}], ",", 
                    RowBox[{"Point", "/@", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"times", "-", "dx"}], ",", 
                    RowBox[{"f", "@", "ierrs"}]}], "}"}], "]"}]}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"#2", "-", "#3"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"#2", "+", "#3"}], "]"}]}], "}"}]}], "}"}], "]"}],
                     "&"}], "@@@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"times", "+", "dx"}], ",", "terrs", ",", 
                    "tstds"}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"PointSize", "[", "Small", "]"}], ",", 
                    RowBox[{"Point", "/@", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"times", "+", "dx"}], ",", 
                    RowBox[{"f", "@", "terrs"}]}], "}"}], "]"}]}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "}"}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"PointSize", "[", "Small", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"f", "@", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", "Dashed", ",", "Thin", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                     "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DataRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "20"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TickSide", "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Ticks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "20", ",", "5"}], "]"}], ",", "4"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"LabelFunction", "\[Rule]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TickLengths", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.1", ",", "0.05"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LabelSide", "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "AxisLabel", "\[Rule]", 
                    "\"\<Time in Scanner [minutes]\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AxisLabelSpacing", "\[Rule]", "3"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"Directive", "@@", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{"$BaseStyle", ",", "Black"}], "]"}]}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "3.0"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DataRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TickSide", "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Ticks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "3", ",", "1"}], "]"}], ",", "4"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"LabelFunction", "\[Rule]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TickLengths", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "0.1"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LabelSide", "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AxisLabel", "\[Rule]", "\"\<Scaled MSE\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"AxisLabelSpacing", "\[Rule]", "4"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"Directive", "@@", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{"$BaseStyle", ",", "Black"}], "]"}]}]}]}], 
                    "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"3.25", "*", "72"}]}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Plot", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"fits", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "20"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", "Black"}], "}"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Plot", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"fits", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "t", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "3", ",", "20"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", "Red"}], "}"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}]}], "]"}]}], "]"}]}], 
               "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"8385af31-ff42-46b9-9818-bebce447211b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure 7: Systematic Errors", "Section",ExpressionUUID->"47c98728-29ba-4b2f-9d8f-0ee3e0eb6fdf"],

Cell[CellGroupData[{

Cell["A. Biases Favoring Training-Data", "Subsection",ExpressionUUID->"4bb7be1d-fc88-4b27-937a-ce7a6b8ef673"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$Fig6BiasPlots", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$Fig6BiasPlots", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plan", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<S1203\>\"", ",", "LH"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "10", ",", 
             RowBox[{"-", "20"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<S1206\>\"", ",", "RH"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "10", ",", 
             RowBox[{"-", "20"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<S1205\>\"", ",", "LH"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "10", ",", 
             RowBox[{"-", "20"}]}], "}"}]}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<fig7/A_bias_\>\"", "<>", 
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            
            RowBox[{"ToString", "[", 
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
            "\"\<_\>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ds", "<", "0"}], ",", "\"\<i\>\"", ",", "\"\<\>\""}], 
             "]"}], "<>", 
            RowBox[{"ToString", "@", 
             RowBox[{"Abs", "[", "ds", "]"}]}], "<>", "\"\<.png\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"SubjectMap", "[", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"Abs", "[", "ds", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ds", "<", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{"RetinotopyColor", "[", 
                 RowBox[{"\"\<PredictedPolarAngle\>\"", ",", 
                  RowBox[{"Method", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
                    "&"}], ")"}]}], ",", 
                  RowBox[{"Range", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "12"}], "}"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"RetinotopyColor", "[", 
                 RowBox[{"\"\<PolarAngle\>\"", ",", 
                  RowBox[{"Method", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "<", "0.05"}], ",", "0", ",", "1"}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "===", "RH"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "60"}], ",", "40"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "40"}], ",", "60"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "50"}], ",", "50"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"0.8", "*", "72"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ds", ">", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"map", "=", 
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"Abs", "[", "ds", "]"}]}], "]"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lbl", "=", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "map"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"erg", "=", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"12", "-", 
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "map"}], 
                    ")"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"e", "=", 
                    RowBox[{"IndexedEdgePairsTr", "[", "map", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"x", "=", 
                    RowBox[{"VertexCoordinates", "[", "map", "]"}]}]}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"el", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"lbl", "*", "erg"}], ")"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "e"}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"ex", "=", 
                    RowBox[{"Mean", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "e"}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"PointSize", "[", "Tiny", "]"}], ",", 
                    RowBox[{"Point", "/@", 
                    RowBox[{"ex", "[", 
                    RowBox[{"[", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Unitize", "[", 
                    RowBox[{
                    RowBox[{"el", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"el", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "1"}], 
                    "]"}], "]"}], "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], 
                 "]"}]}], "]"}]}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"p", ",", "plan"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"ds", ",", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], "}"}]}], 
        "]"}]}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"001b9058-\
f052-46e3-b7ab-70789a5d3336"]
}, Closed]],

Cell[CellGroupData[{

Cell["B. Messy Plot", "Subsection",ExpressionUUID->"8ebe2741-af2c-464e-8dbf-bdc0a687e383"],

Cell[CellGroupData[{

Cell["Messy Plot Disks and Visual Field", "Subsubsection",
 CellChangeTimes->{{3.7064781514220543`*^9, 3.706478156141756*^9}, {
  3.7065556218444033`*^9, 
  3.706555624109915*^9}},ExpressionUUID->"ca35ebb6-6cc8-4615-b9bb-\
72e6babbd549"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$MessPlotDisks", ",", "$MessPlotVisualField"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MessPlotDisks", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Red", ",", "Brown", ",", 
            RowBox[{"Darker", "@", "Green"}], ",", "Blue", ",", "Purple"}], 
           "}"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"t", "/", "225"}], "*", "5"}], "]"}]}], "]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"4", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"t", "*", 
                 RowBox[{"Pi", "/", "180"}]}]}], "]"}], ",", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"t", "*", 
                 RowBox[{"Pi", "/", "180"}]}]}], "]"}]}], "}"}]}], ",", 
           "1.25"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"-", "135"}], ",", "180", ",", "45"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MessPlotVisualField", "=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LightGray", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "12"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "12"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "12"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "12"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "12"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"12", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Values", "[", "$MessPlotDisks", "]"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.706477066059559*^9, 3.706477208263812*^9}, {
   3.706477243654866*^9, 3.706477318683165*^9}, {3.70647740625604*^9, 
   3.706477554035681*^9}, {3.706477599132386*^9, 3.706477635462922*^9}, 
   3.706477683059057*^9, {3.706477771210747*^9, 3.7064778302789793`*^9}, {
   3.706477880161648*^9, 3.7064780299044333`*^9}, {3.706478115210575*^9, 
   3.706478123760236*^9}, {3.706478157152293*^9, 3.706478169327128*^9}, {
   3.706543217274971*^9, 
   3.706543255669071*^9}},ExpressionUUID->"4bfa9bce-1dd5-42f2-897e-\
8bd337ddbeba"]
}, Closed]],

Cell[CellGroupData[{

Cell["Messy Plot V123 Figs", "Subsubsection",
 CellChangeTimes->{{3.706478291798492*^9, 3.706478295164578*^9}, {
  3.706555628677289*^9, 
  3.706555635926071*^9}},ExpressionUUID->"3e3e13b2-09d4-4aa6-9eae-\
e368839f5dd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$MessPlotSubSpec", ",", "MessPlotSubField"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MessPlotSubSpec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<S1203\>\"", ",", "LH", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<S1203\>\"", ",", "RH", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MessPlotSubField", "]"}], "=", 
   RowBox[{"Options", "[", "SubjectMap", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MessPlotSubField", "[", "\[IndentingNewLine]", 
     RowBox[{"sub_", ",", "hemi_", ",", "ds_", ",", 
      RowBox[{"type", ":", 
       RowBox[{"\"\<Predicted\>\"", "|", "\"\<Measured\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"hemi", "===", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MessPlotSubField", "[", 
         RowBox[{"sub", ",", "#", ",", "ds", ",", "type", ",", "opts"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"LH", ",", "RH"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"SubjectMesh", "[", 
             RowBox[{
             "sub", ",", "hemi", ",", "\"\<Registered\>\"", ",", "ds"}], 
             "]"}], ",", "opts"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pa", "=", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<Predicted\>\""}], ",", 
                "\"\<PredictedPolarAngle\>\"", ",", "\"\<PolarAngle\>\""}], 
               "]"}], "/.", "m"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"ec", "=", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<Predicted\>\""}], ",", 
                "\"\<PredictedEccentricity\>\"", ",", 
                "\"\<Eccentricity\>\""}], "]"}], "/.", "m"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ws", "=", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"type", "\[Equal]", "\"\<Predicted\>\""}], ",", 
                "\"\<PredictedVisualArea\>\"", ",", 
                "\"\<VarianceExplained\>\""}], "]"}], "/.", "m"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "=", 
               RowBox[{
                RowBox[{"Pi", "/", "180"}], "*", 
                RowBox[{"(", 
                 RowBox[{"90", "-", 
                  RowBox[{"Abs", "[", "pa", "]"}]}], ")"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"w", "=", 
               RowBox[{"Unitize", "[", 
                RowBox[{"1", "+", 
                 RowBox[{"Sign", "[", 
                  RowBox[{"ws", "-", "0.1"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vfcoords", "=", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ec", "*", 
                    RowBox[{"Cos", "[", "a", "]"}]}], ",", 
                   RowBox[{"ec", "*", 
                    RowBox[{"Sin", "[", "a", "]"}]}]}], "}"}], "]"}]}], "}"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"-", "45"}], "+", 
               RowBox[{"w", "*", 
                RowBox[{"Total", "@", 
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"45", "+", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "@", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"RegionDistance", "[", 
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "vfcoords"}], 
                    "]"}], "]"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", 
                    RowBox[{"Normal", "[", "$MessPlotDisks", "]"}]}], "}"}]}],
                   "]"}]}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
    "]"}], ";"}]}], "Input",ExpressionUUID->"949cc270-4601-4a4a-8751-\
75dd979e9e32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "MessPlotProjPlot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MessPlotProjPlot", "]"}], "=", 
   RowBox[{"Options", "[", "V123FigContourPlot", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MessPlotProjPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spec", ":", 
       RowBox[{"{", 
        RowBox[{"sub_", ",", "hemi_", ",", "ds_"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"type", ":", 
       RowBox[{"\"\<Measured\>\"", "|", "\"\<Predicted\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"True", "||", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RetinotopyModel", "]"}], 
             "\[Equal]", "\"\<Schira\>\""}]}], ",", "\[IndentingNewLine]", 
           "SchiraMeshPlot", ",", "\[IndentingNewLine]", "V123FigMeshPlot"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"field", "=", 
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"MessPlotSubField", "[", 
            RowBox[{"sub", ",", "hemi", ",", "ds", ",", "type"}], "]"}], ",", 
           "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fig", "=", 
           RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"f", "[", "\[IndentingNewLine]", 
              RowBox[{"spec", ",", 
               RowBox[{"(", 
                RowBox[{"field", "+", "45"}], ")"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Threshold", "\[Rule]", 
                RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"MaxPlotPoints", "\[Rule]", "5000"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Range", "\[Rule]", "12"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ColorFunction", "\[Rule]", 
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"k", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "45"}], ")"}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"k", "\[GreaterEqual]", "0"}], "&&", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"$MessPlotDisks", ",", "k"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$MessPlotDisks", "[", "k", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "LightGray"}], "]"}]}], 
                  "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "opts"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"lines", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "@", 
              RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"V123FigLines", "[", 
                 RowBox[{"LH", ",", "12", ",", 
                  RowBox[{"RetinotopyModel", "\[Rule]", "\"\<Schira\>\""}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"h", "===", "LH"}], ",", 
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x_", "?", "NumericQ"}], ",", 
                    RowBox[{"y_", "?", "NumericQ"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"h", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", 
             RowBox[{"fig", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fig", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"lines", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", 
             RowBox[{"fig", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fig", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"lines", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
         "}"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->\
"4255fd0e-ee28-4f16-984e-d3b509f82ed7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Messy Plot Panel", "Subsubsection",
 CellChangeTimes->{{3.706555640116941*^9, 
  3.706555646574168*^9}},ExpressionUUID->"76a161a7-ca6b-4282-98a2-\
fa90c7a0e5d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$MessPlot", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$MessPlot", ":=", 
    RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<fig7/B_mess.png\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v123figs", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"MessPlotProjPlot", "[", "\[IndentingNewLine]", 
                RowBox[{"spec", ",", "type", ",", "\[IndentingNewLine]", 
                 RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"type", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Measured\>\"", ",", "\"\<Predicted\>\""}], 
                "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"spec", ",", "$MessPlotSubSpec"}], "}"}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"field", "=", "$MessPlotVisualField"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FaceForm", "@", 
               RowBox[{"Opacity", "[", 
                RowBox[{"0", ",", "White"}], "]"}]}], ",", 
              RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"Inset", "[", 
                RowBox[{"#1", ",", 
                 RowBox[{"{", 
                  RowBox[{"#2", ",", "1"}], "}"}], ",", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"#3", ",", "1"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.2125", ",", "0.85"}], "}"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Transpose", "@", 
               RowBox[{"List", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v123figs", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0", ",", 
                   "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v123figs", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "0.375", ",", 
                   "1"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v123figs", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "0.625", ",", 
                   "0"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v123figs", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
                   "1"}], "}"}]}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", 
             RowBox[{"field", ",", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "1"}], "}"}], ",", 
              RowBox[{"ImageScaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1"}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.2125", ",", "0.85"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", "\[IndentingNewLine]", 
             RowBox[{"\"\<Validation Data\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"0.1875", ",", "0"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ImageScaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", "\[IndentingNewLine]", 
             RowBox[{"\"\<Inferred Maps\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", "0.1875"}], ",", "0"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ImageScaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0"}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"9cbfc249-9a73-4185-\
9b5e-985cd54b4baa"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure 8: Eccentricity Error", "Section",ExpressionUUID->"9feee25d-5ab2-4b62-bf75-f472c98f3b44"],

Cell[CellGroupData[{

Cell["A. Clipped Eccentricity Plots", "Subsection",ExpressionUUID->"5d0f7a48-a474-4bdf-8906-8608887f6ada"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "ClippedEccenData", ",", "ClippedEccenStats", ",", "ClippedEccenPlot", ",",
     "$ClippedEccenColors"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ClippedEccenColors", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"3", "\[Rule]", 
      RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
     RowBox[{"6", "\[Rule]", "Red"}], ",", 
     RowBox[{"12", "\[Rule]", "Black"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ClippedEccenColors", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"3", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0.75", ",", "0.6", ",", "0.1"}], "]"}]}], ",", 
     RowBox[{"6", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0", ",", "0.5", ",", "0.15"}], "]"}]}], ",", 
     RowBox[{"12", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0", ",", "0.4", ",", "0.75"}], "]"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ClippedEccenData", "[", 
      RowBox[{
       RowBox[{"clip", ":", 
        RowBox[{"3", "|", "6", "|", "12"}]}], ",", 
       RowBox[{"mdl_String:", "\"\<Benson17\>\""}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<clipped-eccen-data_clip=\>\"", "<>", 
        RowBox[{"ToString", "[", "clip", "]"}], "<>", "\"\<_model=\>\"", "<>", 
        RowBox[{"ToLowerCase", "[", "mdl", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"maxecc", "=", "14"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Join", ",", "#"}], "]"}], "&"}], "@", 
          RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"map", "=", 
                 RowBox[{"SubjectMap", "[", 
                  RowBox[{"sub", ",", "hemi", ",", "ds", ",", 
                   RowBox[{"RetinotopyModel", "\[Rule]", "mdl"}], ",", 
                   RowBox[{"Clip", "\[Rule]", "clip"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"gs", "=", 
                 RowBox[{"SubjectMap", "[", 
                  RowBox[{"sub", ",", "hemi", ",", "ds", ",", 
                   RowBox[{"RetinotopyModel", "\[Rule]", "mdl"}], ",", 
                   RowBox[{"Clip", "\[Rule]", "12"}]}], "]"}]}]}], "}"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"gsvexpl", "=", 
                   RowBox[{"\"\<VarianceExplained\>\"", "/.", "gs"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"gseccen", "=", 
                   RowBox[{"\"\<Eccentricity\>\"", "/.", "gs"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"gpeccen", "=", 
                   RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "gs"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"gpvarea", "=", 
                   RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "gs"}]}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"preccen", "=", 
                   RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "map"}]}]}],
                  "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"idcs", "=", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"gpeccen", "-", "maxecc"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", "gpvarea", "]"}], ",", 
                    RowBox[{"1", "|", "2", "|", "3"}]}], "]"}]}], "]"}]}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"gseccen", ",", "preccen", ",", "gsvexpl"}], 
                    "}"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "idcs"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"hemi", ",", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ds", ",", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
                  RowBox[{"0", "<", "#", "<", "99"}]}], "&"}]}], "]"}]}], 
             "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClippedEccenStats", "[", 
      RowBox[{
       RowBox[{"clip", ":", 
        RowBox[{"3", "|", "6", "|", "12"}]}], ",", 
       RowBox[{"mdl_String:", "\"\<Benson17\>\""}]}], "]"}], ":=", 
     RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<clipped-eccen-stats_clip=\>\"", "<>", 
        RowBox[{"ToString", "[", "clip", "]"}], "<>", "\"\<_model=\>\"", "<>", 
        RowBox[{"ToLowerCase", "[", "mdl", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d", "=", 
            RowBox[{"Transpose", "@", 
             RowBox[{"ClippedEccenData", "[", 
              RowBox[{"clip", ",", "mdl"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"dx", "=", "1"}], ",", 
           RowBox[{"x0", "=", "0.5"}], ",", 
           RowBox[{"xx", "=", "12"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xbins", "=", 
             RowBox[{"N", "@", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"Log", "[", 
                 RowBox[{"2", ",", "x0"}], "]"}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"2", ",", "xx"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "xx"}], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "x0"}], "]"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"xx", "-", "x0"}], ")"}], "/", "dx"}], ")"}]}]}], 
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b", "=", 
                RowBox[{
                 RowBox[{"BinLists", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", "^", "xbins"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "12"}], "}"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100"}], "}"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1", ",", "1", ",", "All", ",", 
                   RowBox[{"2", ";;", "3"}]}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"x", "=", 
                RowBox[{"Mean", "/@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Most", "[", "xbins", "]"}], ",", 
                    RowBox[{"Rest", "[", "xbins", "]"}]}], "}"}], "]"}]}]}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mu", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "/", 
                    RowBox[{"Total", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", "b"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"n", "=", 
                  RowBox[{"Length", "/@", "b"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"var", "=", 
                   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "-", "#2"}], 
                    ")"}], "^", "2"}], ",", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "/", 
                    RowBox[{"Total", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "mu"}], "}"}]}], "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"<|", 
                  RowBox[{
                   RowBox[{"\"\<Bins\>\"", "\[Rule]", "xbins"}], ",", 
                   RowBox[{"\"\<Xs\>\"", "\[Rule]", "x"}], ",", 
                   RowBox[{"\"\<Means\>\"", "\[Rule]", "mu"}], ",", 
                   RowBox[{"\"\<Variances\>\"", "\[Rule]", "var"}]}], 
                  "|>"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClippedEccenPlot", "[", 
      RowBox[{
       RowBox[{"clip", ":", 
        RowBox[{"3", "|", "6", "|", "12"}]}], ",", 
       RowBox[{"mdl_String:", "\"\<Benson17\>\""}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", "=", 
          RowBox[{"ClippedEccenStats", "[", 
           RowBox[{"clip", ",", "mdl"}], "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"dx", "=", "1"}], ",", 
         RowBox[{"x0", "=", "0.5"}], ",", 
         RowBox[{"xx", "=", "12"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xbins", "=", 
            RowBox[{"d", "[", "\"\<Bins\>\"", "]"}]}], ",", 
           RowBox[{"mu", "=", 
            RowBox[{"d", "[", "\"\<Means\>\"", "]"}]}], ",", 
           RowBox[{"var", "=", 
            RowBox[{"d", "[", "\"\<Variances\>\"", "]"}]}], ",", 
           RowBox[{"x", "=", 
            RowBox[{"d", "[", "\"\<Xs\>\"", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ErrorListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}], ",", 
                RowBox[{"ErrorBar", "[", "#3", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "+", 
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"clip", "\[Equal]", "12"}], ",", "0.1", ",", 
                  RowBox[{"clip", "\[Equal]", "6"}], ",", "0", ",", 
                  RowBox[{"clip", "\[Equal]", "3"}], ",", 
                  RowBox[{"-", "0.1"}]}], "]"}]}], ",", "\[IndentingNewLine]",
                "mu", ",", 
               RowBox[{"Sqrt", "[", "var", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MinMax", "[", "xbins", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "xx"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", 
               RowBox[{"$ClippedEccenColors", "[", "clip", "]"}]}], "}"}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"e747ab69-0e9b-4bbf-\
87fe-aca29600c7c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ClippedEccenPanel", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClippedEccenPanel", "[", 
     RowBox[{"mdl_String:", "\"\<Benson17\>\""}], "]"}], ":=", 
    RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "\"\<fig8/clipped-eccen-\>\"", "<>", "mdl", "<>", "\"\<.pdf\>\""}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Dashed", ",", "Black", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3.25", ",", "3.25"}], "}"}]}], "}"}], "]"}]}], 
             "}"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ClippedEccenPlot", "[", 
               RowBox[{"k", ",", "mdl"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "6", ",", "12"}], "}"}]}], "}"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"x_", "?", "NumericQ"}], ",", 
                RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "/;", 
              RowBox[{"y", ">", "0"}]}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Log", "[", 
                RowBox[{"2", ",", "y"}], "]"}]}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "@", 
             RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1.5"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", 
                   RowBox[{"-", "1.5"}]}], "}"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"LabelFunction", "\[Rule]", 
                RowBox[{"Function", "@", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "^", "#"}], "<", "1"}], ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"2", "^", "#"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                   RowBox[{"2", "^", "#"}]}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
               "AxisLabel", "\[Rule]", "\"\<Validation Eccen. [deg]\>\""}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"AxisLabelSpacing", "\[Rule]", "2.5"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"Directive", "@@", "$BaseStyle"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TickSide", "\[Rule]", 
                RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"TickLengths", "\[Rule]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.05", ",", "0.025"}], "}"}], "/", "0.25"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"Ticks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "2", ",", 
                    "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.322", ",", "0.585", ",", "0.807"}], "}"}]}], 
                 "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "@", 
             RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1.25"}], ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1.25"}], ",", "3"}], "}"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"LabelFunction", "\[Rule]", 
                RowBox[{"Function", "@", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{"2", "^", "#"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
               "AxisLabel", "\[Rule]", "\"\<Inferred Eccen. [deg]\>\""}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"AxisLabelSpacing", "\[Rule]", "3.5"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"LabelSpacing", "\[Rule]", "0.75"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"Directive", "@@", "$BaseStyle"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TickSide", "\[Rule]", 
                RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"TickLengths", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0.05", ",", "0.025"}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Ticks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "2", ",", 
                    "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.322", ",", "0.585", ",", "0.807"}], "}"}]}], 
                 "}"}]}]}], "]"}]}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Text", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Fit with \!\(\*
StyleBox[\"\[Rho]\",
FontSlant->\"Italic\"]\) \[LessEqual] 3\[Degree]\>\"", ",", 
               RowBox[{"FontColor", "\[Rule]", 
                RowBox[{"$ClippedEccenColors", "[", "3", "]"}]}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3"}], "}"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Fit with \!\(\*
StyleBox[\"\[Rho]\",
FontSlant->\"Italic\"]\) \[LessEqual] 6\[Degree]\>\"", ",", 
               RowBox[{"FontColor", "\[Rule]", 
                RowBox[{"$ClippedEccenColors", "[", "6", "]"}]}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "2.5"}], "}"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Fit with \!\(\*
StyleBox[\"\[Rho]\",
FontSlant->\"Italic\"]\) \[LessEqual] 12\[Degree]\>\"", ",", 
               RowBox[{"FontColor", "\[Rule]", 
                RowBox[{"$ClippedEccenColors", "[", "12", "]"}]}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "2"}], "}"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}]}], "]"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2.1"}], ",", "3.4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "3.1"}], ",", "3.5"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"3.25", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"f1cf6012-62df-4e69-b2d2-f4f347160cbe"]
}, Closed]],

Cell[CellGroupData[{

Cell["B. Wide-field Eccentricity", "Subsection",ExpressionUUID->"6bd83ad0-770b-450e-a238-0d5b97f03a09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$WideEccenErrors", ",", "$WideEccenErrorGroups"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$WideEccenErrors", ":=", 
     RowBox[{
      RowBox[{"Dataset", "@*", "Join"}], "@@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MapVertices", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#WideVarianceExplained", ">", "0.1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<ID\>\"", "\[Rule]", "#VertexIndex"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<PredictedCenter\>\"", "\[Rule]", 
                RowBox[{"#PredictedEccentricity", "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", "*", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90", "-", "#PredictedPolarAngle"}], ")"}], "/", 
                    "180"}], "*", "Pi"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<WideCenter\>\"", "\[Rule]", 
                RowBox[{"#WideEccentricity", "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", "*", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90", "-", "#WidePolarAngle"}], ")"}], "/", 
                    "180"}], "*", "Pi"}], "]"}]}]}], ",", 
               RowBox[{"\"\<WideSize\>\"", "\[Rule]", "#WidePRFSize"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<MeasuredCenter\>\"", "\[Rule]", 
                RowBox[{"#Eccentricity", "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", "*", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90", "-", "#PolarAngle"}], ")"}], "/", "180"}], 
                   "*", "Pi"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<MeasuredSize\>\"", "\[Rule]", "#PRFSize"}]}], 
              "|>"}], ",", "\[IndentingNewLine]", "Nothing"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"SubjectMesh", "[", 
           RowBox[{
           "\"\<S1201\>\"", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "99"}],
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"hemi", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$WideEccenErrorGroups", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&&", 
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "0"}]}], 
              "&"}]}], "]"}], "&"}], "@", 
          RowBox[{"Transpose", "@", 
           RowBox[{"List", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Abs", "@", 
              RowBox[{"Normal", "@", 
               RowBox[{"$WideEccenErrors", "[", 
                RowBox[{"All", ",", "\"\<WideCenter\>\""}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Abs", "@", 
              RowBox[{"Normal", "@", 
               RowBox[{"$WideEccenErrors", "[", 
                RowBox[{"All", ",", "\"\<PredictedCenter\>\""}], "]"}]}]}]}], 
            "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", "#1", "]"}], "\[Rule]", "#2"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GroupBy", "[", 
           RowBox[{"cmp", ",", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "0.25"}], "]"}], 
             "&"}]}], "]"}]}], "]"}]}]}], "]"}]}]}], "]"}], ";"}]}], "Input",E\
xpressionUUID->"151930d4-f369-46b2-83b6-e49de005d261"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$WideEccenFigure", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$WideEccenFigure", ":=", 
    RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<fig8/wide-eccen.png\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dat", "=", 
           RowBox[{
            RowBox[{"SortBy", "[", "First", "]"}], "@", 
            RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#1", "\[GreaterEqual]", "0.5"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"StandardDeviation", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Length", "[", "#2", "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", "Nothing"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "$WideEccenErrorGroups"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"mne", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mark", "=", 
            RowBox[{"Function", "@", 
             RowBox[{"List", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "#2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "#3"}], "}"}]}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#1", "-", "0.05"}], ",", "#3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#1", "+", "0.05"}], ",", "#3"}], "}"}]}], "}"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#2", "\[LessEqual]", "mne"}], ",", "Nothing", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#1", "-", "0.05"}], ",", "#2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#1", "+", "0.05"}], ",", "#2"}], "}"}]}], "}"}], 
                  "]"}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Map", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"y", "=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"sem", "=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"x", "\[LessEqual]", "12"}], ",", "Black", ",", 
                    "Pink"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"mark", "[", 
                    RowBox[{
                    RowBox[{"Log", "[", "x", "]"}], ",", 
                    RowBox[{"Log", "@", 
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"y", "-", "sem"}], ",", "mne"}], "}"}], "]"}]}], 
                    ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"y", "+", "sem"}], "]"}], ",", "True"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Point", "@", 
                    RowBox[{"Log", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], "}"}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Select", "[", 
                 RowBox[{"dat", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"mne", "<", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", "50"}], "&&", 
                    RowBox[{"mne", "<", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", "50"}]}], "&"}]}], 
                 "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Log", "[", "mne", "]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Log", "[", "32", "]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"LabelFunction", "\[Rule]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Exp", "[", "#", "]"}], "<", "1"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Exp", "[", "#", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Exp", "[", "#", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                "AxisLabel", "\[Rule]", "\"\<Validation Eccen. [deg]\>\""}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"AxisLabelSpacing", "\[Rule]", "3"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"BaseStyle", "\[Rule]", 
                 RowBox[{"Directive", "@@", "$BaseStyle"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TickSide", "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"TickLengths", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.025", ",", "0.0125"}], "}"}], "/", "0.25"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Ticks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "0.5", ",", "1", ",", "2", ",", "4", ",", "8", ",", "16", 
                    ",", "32"}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.322", ",", "0.585", ",", "0.807"}], "}"}]}], 
                  "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"InsetAxis", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"Log", "[", "mne", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"Log", "[", "32", "]"}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"LabelFunction", "\[Rule]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Exp", "[", "#", "]"}], "<", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Exp", "[", "#", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "<", "16"}], ",", 
                    RowBox[{"\"\< \>\"", "<>", 
                    RowBox[{"ToString", "[", "#", "]"}]}], ",", "#"}], "]"}], 
                    "&"}], "@", 
                    RowBox[{"Exp", "[", "#", "]"}]}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                "AxisLabel", "\[Rule]", "\"\<Inferred Eccen. [deg]\>\""}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"AxisLabelSpacing", "\[Rule]", "3.5"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"LabelSpacing", "\[Rule]", "0.75"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"BaseStyle", "\[Rule]", 
                 RowBox[{"Directive", "@@", "$BaseStyle"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TickSide", "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"TickLengths", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0.05", ",", "0.025"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Ticks", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "0.5", ",", "1", ",", "2", ",", "4", ",", "8", ",", "16", 
                    ",", "32"}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.322", ",", "0.585", ",", "0.807"}], "}"}]}], 
                  "}"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", "0.55"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"3.25", "*", "72"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1.85"}], ",", 
                 RowBox[{"Log", "[", "48", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2.5"}], ",", 
                 RowBox[{"Log", "[", "48", "]"}]}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Prolog", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", "Dashed", ",", 
               RowBox[{"Line", "@", 
                RowBox[{"Log", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"mne", ",", "mne"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"48", ",", "48"}], "}"}]}], "}"}], "]"}]}]}], 
              "}"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"7fa4277e-9f2b-4858-985a-3b8cf3af715e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure 9: pRF Size and Cortical Magnification", "Section",ExpressionUUID->"5f251400-66e8-4f52-929c-b72f89a9a7ad"],

Cell[CellGroupData[{

Cell["A. PRF Line-Fits", "Subsection",ExpressionUUID->"ddef97b5-b086-4a70-ab75-12e259f4d5eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"PRFFitsBySubject", ",", "PRFLinePlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PRFFitsBySubject", "]"}], "=", 
   RowBox[{"Options", "[", "PRFSizeData", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PRFFitsBySubject", "[", 
      RowBox[{
       RowBox[{"prefix", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Predicted\>\"", "|", "\"\<\>\""}], ")"}], ":", 
        "\"\<\>\""}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"allPRFS", "=", 
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"PRFSizeData", "[", "]"}], ",", "opts"}], "]"}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"sel", "=", 
               RowBox[{"allPRFS", "@", 
                RowBox[{"Select", "@", 
                 RowBox[{"Function", "@", 
                  RowBox[{"And", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"#VisualArea", "\[Equal]", "v"}], ",", 
                    RowBox[{"#Dataset", "\[Equal]", "99"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"#PredictedEccentricity", "<", "12"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"#VarianceExplained", ">", "0.1"}]}], 
                   "]"}]}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"p", "=", 
                   RowBox[{"sel", "@", 
                    RowBox[{"Select", "@", 
                    RowBox[{"Function", "[", 
                    RowBox[{"#Subject", "\[Equal]", "s"}], "]"}]}]}]}], "}"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"eccs", "=", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"p", "[", 
                    RowBox[{"All", ",", 
                    RowBox[{"prefix", "<>", "\"\<Eccentricity\>\""}]}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"sigs", "=", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"p", "[", 
                    RowBox[{"All", ",", 
                    RowBox[{"prefix", "<>", "\"\<PRFSize\>\""}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ws", "=", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"p", "[", 
                    RowBox[{"All", ",", "\"\<VarianceExplained\>\""}], 
                    "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"LinearModelFit", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"eccs", ",", "sigs"}], "}"}], "]"}], ",", "x", 
                    ",", "x", ",", 
                    RowBox[{"Weights", "\[Rule]", "ws"}]}], "]"}]}], "]"}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"s", ",", 
                 RowBox[{"Union", "@", 
                  RowBox[{"Normal", "@", 
                   RowBox[{"sel", "[", 
                    RowBox[{"All", ",", "\"\<Subject\>\""}], "]"}]}]}]}], 
                "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"v", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PRFLinePlot", "[", 
      RowBox[{"prefix", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<\>\"", "|", "\"\<Predicted\>\""}], ")"}], ":", 
       "\"\<\>\""}], "]"}], ":=", 
     RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"prefix", "\[Equal]", "\"\<\>\""}], ",", 
         "\"\<fig8/A_prflines.pdf\>\"", ",", 
         RowBox[{
         "\"\<fig8/B_prflines_\>\"", "<>", "prefix", "<>", "\"\<.pdf\>\""}]}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", "0"}], ",", 
           RowBox[{"xmax", "=", "12"}], ",", 
           RowBox[{"ymin", "=", "0"}], ",", 
           RowBox[{"ymax", "=", "6"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "@", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"params", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", "\"\<BestFitParameters\>\"", "]"}], 
                    "&"}], "/@", "#2"}]}], "}"}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ps", "=", 
                    RowBox[{"Mean", "[", "params", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"mm", "=", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#1", "-", "#2"}], ",", 
                    RowBox[{"#1", "+", "#2"}]}], "}"}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", "params", "]"}], ",", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Variance", "[", "params", "]"}], "/", 
                    RowBox[{"Length", "[", "params", "]"}]}], "]"}]}], 
                    "}"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fmin", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"#", "*", 
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"fmax", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"#", "*", 
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"f", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"ps", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"#", "*", 
                    RowBox[{"ps", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "}"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.5", ",", "#1"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xmin", ",", 
                    RowBox[{"fmin", "[", "xmin", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xmax", ",", 
                    RowBox[{"fmin", "[", "xmax", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"xmax", ",", 
                    RowBox[{"fmax", "[", "xmax", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xmin", ",", 
                    RowBox[{"fmax", "[", "xmin", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", "#1", ",", "Thick", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xmin", ",", 
                    RowBox[{"f", "[", "xmin", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xmax", ",", 
                    RowBox[{"f", "[", "xmax", "]"}]}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Red", ",", 
                 RowBox[{"Darker", "@", "Green"}], ",", "Blue"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PRFFitsBySubject", "[", "prefix", "]"}]}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<pRF Size [deg]\>\"", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Eccentricity [deg]\>\"", ",", "None"}], "}"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Text", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"\"\<V\>\"", "<>", 
                   RowBox[{"ToString", "[", "v", "]"}]}], ",", 
                  RowBox[{"FontColor", "\[Rule]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Darker", "[", "Green", "]"}], ",", "Blue"}], 
                    "}"}], "[", 
                    RowBox[{"[", "v", "]"}], "]"}]}], ",", "$BaseStyle"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageScaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.35", ",", 
                   RowBox[{"0.95", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"v", "-", "1"}], ")"}], "*", "0.1"}]}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageScaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"v", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "5"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", "0.8"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"1.62", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}]}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"f2ce868d-d956-498a-81d9-\
2c6ceb5b3eca"]
}, Closed]],

Cell[CellGroupData[{

Cell["B. CMag Log-Log Fits", "Subsection",ExpressionUUID->"3c4196f4-2b6f-462d-bbfb-4a9573e0b6ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"CMagLogLogFitsBySubject", ",", "CMagLinePlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CMagLogLogFitsBySubject", "]"}], "=", 
   RowBox[{"Options", "[", "PRFSizeData", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CMagLogLogFitsBySubject", "[", 
    RowBox[{
     RowBox[{"type", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<\>\"", "|", "\"\<Predicted\>\""}], ")"}], ":", 
      "\"\<\>\""}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"allCMags", "=", 
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"PRFSizeData", "[", "]"}], ",", "opts"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"tx", "=", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "#"}], ")"}], "/", "0.75"}], "]"}], "&"}]}]}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sel", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"type", "\[Equal]", "\"\<Predicted\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"allCMags", "@", 
                RowBox[{"Select", "@", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"#VisualArea", "\[Equal]", "v"}], "&&", 
                   RowBox[{"#PredictedMagnification", ">", "0"}], "&&", 
                   RowBox[{"#Dataset", "\[Equal]", "99"}]}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"allCMags", "@", 
                RowBox[{"Select", "@", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"#VisualArea", "\[Equal]", "v"}], "&&", 
                   RowBox[{"#Magnification", ">", "0"}], "&&", 
                   RowBox[{"#Dataset", "\[Equal]", "99"}]}], "]"}]}]}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p", "=", 
                 RowBox[{"sel", "@", 
                  RowBox[{"Select", "@", 
                   RowBox[{"Function", "[", 
                    RowBox[{"#Subject", "\[Equal]", "s"}], "]"}]}]}]}], "}"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"eccs", "=", 
                    RowBox[{"tx", "@", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"p", "[", 
                    RowBox[{"All", ",", 
                    RowBox[{"type", "<>", "\"\<Eccentricity\>\""}]}], 
                    "]"}]}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"sigs", "=", 
                    RowBox[{"tx", "@", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"p", "[", 
                    RowBox[{"All", ",", 
                    RowBox[{"type", "<>", "\"\<Magnification\>\""}]}], 
                    "]"}]}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"ws", "=", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"p", "[", 
                    RowBox[{"All", ",", "\"\<VarianceExplained\>\""}], 
                    "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"LinearModelFit", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"eccs", ",", "sigs"}], "}"}], "]"}], ",", "x", 
                   ",", "x", ",", 
                   RowBox[{"Weights", "\[Rule]", "ws"}]}], "]"}]}], "]"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"Union", "@", 
                RowBox[{"Normal", "@", 
                 RowBox[{"sel", "[", 
                  RowBox[{"All", ",", "\"\<Subject\>\""}], "]"}]}]}]}], 
              "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"v", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CMagLinePlot", "[", 
     RowBox[{"type", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<\>\"", "|", "\"\<Predicted\>\""}], ")"}], ":", 
      "\"\<\>\""}], "]"}], ":=", 
    RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "\"\<\>\""}], ",", 
        "\"\<fig8/C_cmaglines.pdf\>\"", ",", 
        RowBox[{
        "\"\<fig8/D_cmaglines_\>\"", "<>", "type", "<>", "\"\<.pdf\>\""}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tx", "=", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "#"}], ")"}], "/", "0.75"}], "]"}], "&"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xmin", "=", "0.75"}], ",", 
            RowBox[{"xmax", "=", "12"}]}], "}"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Black", ",", "Dashed", ",", "Thick", ",", 
                RowBox[{"Line", "@", 
                 RowBox[{"tx", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"17.3", "/", 
                    RowBox[{"(", 
                    RowBox[{"0.75", "+", "#"}], ")"}]}], ")"}], "^", "2"}]}], 
                    "}"}], "&"}], "/@", 
                   RowBox[{"{", 
                    RowBox[{"xmin", ",", "xmax"}], "}"}]}], "]"}]}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "@", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"params", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<BestFitParameters\>\"", "]"}], 
                    "&"}], "/@", "#2"}]}], "}"}], ",", "\[IndentingNewLine]", 
                   
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ps", "=", 
                    RowBox[{"Mean", "[", "params", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"mm", "=", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#1", "-", "#2"}], ",", 
                    RowBox[{"#1", "+", "#2"}]}], "}"}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", "params", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Variance", "[", "params", "]"}], "/", 
                    RowBox[{"Length", "[", "params", "]"}]}], "]"}]}], 
                    "}"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fmin", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"#", "*", 
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"fmax", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"#", "*", 
                    RowBox[{"mm", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"f", "=", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"ps", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"#", "*", 
                    RowBox[{"ps", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "}"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.5", ",", "#1"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "@", 
                    RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tx", "@", "xmin"}], ",", 
                    RowBox[{"fmin", "[", 
                    RowBox[{"tx", "@", "xmin"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tx", "@", "xmax"}], ",", 
                    RowBox[{"fmin", "[", 
                    RowBox[{"tx", "@", "xmax"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tx", "@", "xmax"}], ",", 
                    RowBox[{"fmax", "[", 
                    RowBox[{"tx", "@", "xmax"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tx", "@", "xmin"}], ",", 
                    RowBox[{"fmax", "[", 
                    RowBox[{"tx", "@", "xmin"}], "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", "#1", ",", "Thick", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tx", "@", "xmin"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"tx", "@", "xmin"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tx", "@", "xmax"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"tx", "@", "xmax"}], "]"}]}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Red", ",", 
                    RowBox[{"Darker", "@", "Green"}], ",", "Blue"}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"CMagLogLogFitsBySubject", "[", "type", "]"}]}], 
                 "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"tx", "[", "#", "]"}]}], ",", "#"}], "}"}], "]"}],
                    "&"}], "@", 
                  RowBox[{"{", 
                   RowBox[{"0.5", ",", "2", ",", "8", ",", "32", ",", "128"}],
                    "}"}]}], ",", "\[IndentingNewLine]", "None"}], "}"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"tx", "[", "#", "]"}]}], ",", "#"}], "}"}], "]"}],
                    "&"}], "@", 
                  RowBox[{"{", 
                   RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
                 ",", "\[IndentingNewLine]", "None"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<C. Mag. [\!\(\*SuperscriptBox[\(mm\), \
\(2\)]\)/\!\(\*SuperscriptBox[\(deg\), \(2\)]\)]\>\"", ",", "None"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Eccentricity [deg]\>\"", ",", "None"}], "}"}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"tx", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.75", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "128"}], "}"}]}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"\"\<V\>\"", "<>", 
                    RowBox[{"ToString", "[", "v", "]"}]}], ",", 
                   RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Darker", "[", "Green", "]"}], ",", "Blue"}], 
                    "}"}], "[", 
                    RowBox[{"[", "v", "]"}], "]"}]}], ",", "$BaseStyle"}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.8", ",", 
                    RowBox[{"0.95", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"v", "-", "1"}], ")"}], "*", "0.1"}]}]}], "}"}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", "0.8"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"1.62", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"016f2aeb-79c8-4c14-\
8fcf-bc4c3183ae24"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure S1: Cross-validation Schema", "Section",ExpressionUUID->"fd0160b9-ee92-4963-8580-35ee4c4e0115"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$CrossValidationPlots", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CrossValidationPlots", ":=", 
   RowBox[{"AutoCachePDF", "[", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<supplemental/figS1/signals.pdf\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "=", "50"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sig0", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", "n", "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sigs", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"sig0", "+", 
                RowBox[{"0.8", "*", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{
                   RowBox[{"NormalDistribution", "[", "]"}], ",", 
                   RowBox[{"{", "n", "}"}]}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", "12", "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Partition", "[", 
                RowBox[{"#", ",", "4"}], "]"}], "&"}], "@", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"sigs", "[", 
                   RowBox[{"[", "s", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AspectRatio", "\[Rule]", 
                   RowBox[{"0.075", "/", 
                    RowBox[{"(", 
                    RowBox[{"0.5", "*", 
                    RowBox[{"n", "/", "100"}]}], ")"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Thickness", "[", "Small", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Switch", "[", 
                    RowBox[{"s", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "1", "|", "2", "|", "5", "|", "6", "|", "9", "|", "10"}], 
                    ",", "Black", ",", "\[IndentingNewLine]", "3", ",", 
                    RowBox[{"Darker", "[", "Red", "]"}], ",", 
                    "\[IndentingNewLine]", "4", ",", 
                    RowBox[{"Darker", "[", "Orange", "]"}], ",", 
                    "\[IndentingNewLine]", "7", ",", 
                    RowBox[{"Darker", "[", "Yellow", "]"}], ",", 
                    "\[IndentingNewLine]", "8", ",", 
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    "\[IndentingNewLine]", "11", ",", 
                    RowBox[{"Darker", "[", "Blue", "]"}], ",", 
                    "\[IndentingNewLine]", "12", ",", 
                    RowBox[{"Darker", "[", "Magenta", "]"}]}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"s", ",", 
                  RowBox[{"Range", "@", 
                   RowBox[{"Length", "[", "sigs", "]"}]}]}], "}"}]}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"1.75", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",ExpressionUUID->"2118618c-0d31-452d-\
bf70-1cba67db85f8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure S2: The Anatomical Prior", "Section",ExpressionUUID->"ad615207-2894-43a9-bfef-323c7915f646"],

Cell[CellGroupData[{

Cell["Panel A: The Retinotopy Model", "Subsection",ExpressionUUID->"a2cf5fbf-edcd-42c9-b93e-9eb976a14f90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FigS2AEccenLines", ",", "$FigS2AModelPlots", ",", "$FigS2ALegend", ",", 
    "$FigS2AMaxEccen"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigS2AEccenLines", "=", 
   RowBox[{"{", 
    RowBox[{"1.5", ",", "3", ",", "6", ",", "12"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigS2AMaxEccen", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$FigS2AModelPlots", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hemi", ",", "type"}], "}"}], "\[Rule]", 
         RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<supplemental/figS2/A_model_\>\"", "<>", 
            RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<-\>\"", "<>", 
            "type", "<>", "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mdl", "=", 
                RowBox[{"Benson17Model", "[", "hemi", "]"}]}], ",", 
               RowBox[{"maxEcc", "=", "$FigS2AMaxEccen"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lbl", "=", 
                  RowBox[{"mdl", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"dat", "=", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{"180", "/", "Pi"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Pi", "/", "2"}], "-", 
                    RowBox[{"mdl", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ")"}]}]}], ",", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
                    RowBox[{"mdl", "[", "\"\<Eccentricity\>\"", "]"}]}]}], 
                   "|>"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"mesh", "=", 
                  RowBox[{"mdl", "[", "\"\<Mesh\>\"", "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"X", "=", 
                    RowBox[{"MeshCoordinates", "[", "mesh", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"fs0", "=", 
                    RowBox[{
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fs", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"fs0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"lbl", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "<", "4"}], "&&", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{
                    RowBox[{"dat", "[", "\"\<Eccentricity\>\"", "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "<", "maxEcc"}]}], 
                    ")"}], "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"es", "=", 
                    RowBox[{"Union", "@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sort", ",", "\[IndentingNewLine]", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"fs0", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"fs0", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"fs0", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}]}], "]"}]}],
                     "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MeshCoordinates", "[", "mesh", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Select", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MeshCells", "[", 
                    RowBox[{"mesh", ",", "2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"lbl", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], "<", 
                    "4"}], "&&", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{
                    RowBox[{"dat", "[", "\"\<Eccentricity\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], "<", 
                    "maxEcc"}]}], ")"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"VertexColors", "\[Rule]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CorticalColorData", "[", "type", "]"}], "[", 
                    RowBox[{"<|", 
                    RowBox[{"type", "\[Rule]", "#"}], "|>"}], "]"}], "&"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rc", "=", 
                    RowBox[{"RetinotopyColor", "[", 
                    RowBox[{"\"\<Eccentricity\>\"", ",", 
                    RowBox[{"Method", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"1.0", "&"}], ")"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"rc", "[", 
                    RowBox[{"<|", 
                    RowBox[{
                    RowBox[{"\"\<Curvature\>\"", "\[Rule]", "0"}], ",", 
                    RowBox[{"type", "\[Rule]", "#"}]}], "|>"}], "]"}], 
                    "&"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"dat", "[", "type", "]"}]}], "]"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"V123DotLines", "[", 
                    RowBox[{"hemi", ",", "maxEcc"}], "]"}]}], "}"}], "]"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "400"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"hemi", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"type", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
           "}"}]}], "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FigS2ALegend", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hemi", ",", "type"}], "}"}], "\[Rule]", 
         RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<supplemental/figS2/A_legend_\>\"", "<>", 
            RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<-\>\"", "<>", 
            "type", "<>", "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mdl", "=", 
                RowBox[{"Benson17Model", "[", "hemi", "]"}]}], ",", 
               RowBox[{"maxEcc", "=", "$FigS2AMaxEccen"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"cpart", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"hemi", "===", "LH"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"lines", "=", "$FigS2AEccenLines"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"type", "\[Equal]", "\"\<PolarAngle\>\""}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PolarAngleLegend", "[", "\[IndentingNewLine]", 
                   RowBox[{
                   "hemi", ",", "maxEcc", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$PolarAngleBlendColors", "[", "All", "]"}], ",", 
                    "#"}], "]"}], "&"}], ")"}]}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"EccentricityLegend", "[", "\[IndentingNewLine]", 
                   RowBox[{
                   "hemi", ",", "maxEcc", ",", "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "All", "]"}], 
                    ",", "#"}], "]"}], "&"}], ")"}]}]}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics", "@", 
                 RowBox[{"List", "[", "\[IndentingNewLine]", 
                  RowBox[{"White", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "#", ",", "cpart"}], 
                    "]"}], "&"}], "/@", "lines"}], ",", "\[IndentingNewLine]",
                    "Black", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "maxEcc"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "maxEcc"}], "}"}]}], "}"}], "]"}], ",", 
                   
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"maxEcc", "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ",", "0"}], 
                    "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "12", ",", "cpart"}],
                     "]"}]}], "]"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"hemi", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"type", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
           "}"}]}], "}"}]}], "]"}]}]}]}], "]"}], ";"}]}], "Input",ExpressionUU\
ID->"3848fc14-cb3c-490b-b8a1-ad91f4f8b860"]
}, Closed]],

Cell[CellGroupData[{

Cell["Panel B: Group Average Data", "Subsection",ExpressionUUID->"10f07e07-34fc-4220-8a21-a3eb00309499"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FigS2BZoomViews", ",", "$FigS2BZooms", ",", "$FigS2BInflated", ",", 
    "$FigS2BSphere", ",", "$FigS2BMap"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigS2BZoomViews", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LH", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.943563767721429`", ",", 
           RowBox[{"-", "2.7175491665620792`"}], ",", 
           RowBox[{"-", "0.5361775900932758`"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.6136320711156591`", ",", 
           RowBox[{"-", "0.4137252488186562`"}], ",", "0.6725229362544061`"}],
           "}"}]}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.8549503483970555`", ",", "0.5062916120506187`"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"ViewAngle", "\[Rule]", "0.11845286309257992`"}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"RH", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.8019200995186977`"}], ",", 
           RowBox[{"-", "2.8603941479497803`"}], ",", 
           RowBox[{"-", "0.14570268811926027`"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.6395666607256235`"}], ",", 
           RowBox[{"-", "0.3152041682606248`"}], ",", "0.7011425096222615`"}],
           "}"}]}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.2976348929320872`", ",", "0.5703519449645706`"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"ViewAngle", "\[Rule]", "0.11336893434121936`"}]}], "}"}]}]}],
     "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$FigS2BZooms", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hemi", ",", "type"}], "}"}], "\[Rule]", 
         RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<supplemental/figS2/B_\>\"", "<>", 
            RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<-\>\"", "<>", 
            "type", "<>", "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Benson14Mesh", "[", 
              RowBox[{"hemi", ",", "\"\<White\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"RetinotopyColor", "[", 
               RowBox[{"type", ",", 
                RowBox[{"Method", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", ">", "0.1"}], ",", "1", ",", "0"}], "]"}], 
                   "&"}], ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"$FigS2BZoomViews", "[", "hemi", "]"}]}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"hemi", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"type", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
           "}"}]}], "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FigS2BInflated", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<supplemental/figS2/B_inflated.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Benson14Mesh", "[", 
          RowBox[{"LH", ",", "\"\<Inflated\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"Function", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#VarianceExplained", ">", "0.1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#PolarAngle", "<", "0"}], ",", 
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               "\"\<PolarAngle\>\""}], "]"}], ",", "\[IndentingNewLine]", 
             "\"\<Curvature\>\""}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1.1083446129664334`", ",", 
            RowBox[{"-", "3.1429036977426215`"}], ",", 
            RowBox[{"-", "0.5862836903957351`"}]}], "}"}]}], ",", 
         RowBox[{"ViewVertical", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.5202792846991046`", ",", 
            RowBox[{"-", "0.46543318621060836`"}], ",", 
            "0.7160177477457031`"}], "}"}]}], ",", 
         RowBox[{"ViewCenter", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.4696326573133537`", ",", "0.47337625671620776`"}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"ViewAngle", "\[Rule]", "0.20751551557565143`"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FigS2BSphere", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<supplemental/figS2/B_sphere.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Benson14Mesh", "[", 
          RowBox[{"LH", ",", "\"\<Sphere\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"Function", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#VarianceExplained", ">", "0.1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#PolarAngle", "<", "0"}], ",", 
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               "\"\<PolarAngle\>\""}], "]"}], ",", "\[IndentingNewLine]", 
             "\"\<Curvature\>\""}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.38611889086462015`", ",", 
            RowBox[{"-", "2.6958454361972675`"}], ",", 
            RowBox[{"-", "2.0083151112940008`"}]}], "}"}]}], ",", 
         RowBox[{"ViewVertical", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.4407856879898612`", ",", 
            RowBox[{"-", "0.8161003862512615`"}], ",", 
            "0.37374876163520165`"}], "}"}]}], ",", 
         RowBox[{"ViewCenter", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.4928721571112542`", ",", "0.5024256314635835`"}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"ViewAngle", "\[Rule]", "0.3175387160398889`"}]}], "]"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FigS2BMap", ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<supplemental/figS2/B_map.png\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Benson14Map", "[", "LH", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"Function", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#VarianceExplained", ">", "0.1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#PolarAngle", "<", "0"}], ",", 
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               "\"\<PolarAngle\>\""}], "]"}], ",", "\[IndentingNewLine]", 
             "\"\<Curvature\>\""}], "]"}]}]}]}], "]"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",ExpressionUUID->"7ce07ca3-1a15-4be7-83dc-1bef45525d91"]
}, Closed]],

Cell[CellGroupData[{

Cell["Panel C: Atlas Construction", "Subsection",ExpressionUUID->"83a3d458-8c5b-4aa4-8bc6-eea1498d6935"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FigS2MapTemplate", ",", "$FigS2SquaresMap", ",", 
    "FigS2CAtlasExplanationPlot", ",", "$FigS2CMapNormal", ",", 
    "\[IndentingNewLine]", "$FigS2CMapWarped", ",", "FigS2CColor", ",", 
    "FigS2CDataColor", ",", "$FigS2CPlots"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$FigS2MapTemplate", ":=", 
     RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Benson14Mesh", "[", 
        RowBox[{"LH", ",", "\"\<Sphere\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Center", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", 
            RowBox[{
             RowBox[{"MapTemplate", "[", "LH", "]"}], ",", "Center"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"58.58", ",", 
            RowBox[{"-", "61.84"}], ",", 
            RowBox[{"-", "52.39"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Method", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Radius", "\[Rule]", 
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Pi", "/", "4"}], "]"}], ",", "\"\<Radians\>\""}], 
         "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FigS2SquaresMap", ":=", 
     RowBox[{"$FigS2MapTemplate", "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<VarianceExplained\>\"", "\[Rule]", 
         RowBox[{"0.7", "*", 
          RowBox[{"Unitize", "[", 
           RowBox[{"1", "+", 
            RowBox[{"Sign", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "\"\<VarianceExplained\>\"", "/.", "$FigS2MapTemplate"}], 
               ")"}], "-", "0.5"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Curvature\>\"", "\[Rule]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"Sign", "[", 
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"xy", ",", "40"}], "]"}], ")"}], "/", "40"}], "]"}],
               "-", "0.5"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"xy", ",", 
             RowBox[{"VertexCoordinates", "[", "$FigS2MapTemplate", "]"}]}], 
            "}"}]}], "]"}]}]}], "}"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigS2CAtlasExplanationPlot", "[", 
    RowBox[{"coords_", ",", 
     RowBox[{"clrFn_:", "Automatic"}], ",", 
     RowBox[{"modelPlot", ":", 
      RowBox[{"True", "|", "False"}], ":", "True"}], ",", 
     RowBox[{"miniColorFn_:", "\"\<Same\>\""}], ",", 
     RowBox[{"miniMap_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cfn", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"clrFn", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
          RowBox[{"RetinotopyColor", "[", 
           RowBox[{"\"\<Eccentricity\>\"", ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "<", "0.1"}], ",", "0", ",", "0.65"}], "]"}], 
               "&"}], ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", "clrFn"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sqmap", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"CorticalMapQ", "[", "coords", "]"}], ",", "coords", ",", 
          "$FigS2SquaresMap"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"CorticalMapQ", "[", "coords", "]"}], ",", 
          RowBox[{"VertexCoordinates", "[", "coords", "]"}], ",", "coords"}], 
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mcfn", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringQ", "[", "miniColorFn", "]"}], "&&", 
             RowBox[{
              RowBox[{"ToLowerCase", "[", "miniColorFn", "]"}], "\[Equal]", 
              "\"\<same\>\""}]}], ",", "\[IndentingNewLine]", "cfn", ",", 
            "\[IndentingNewLine]", "miniColorFn"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"mmap", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"miniMap", "===", "Automatic"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"CorticalMap", "[", 
             RowBox[{"$FigS2MapTemplate", ",", 
              RowBox[{"VertexCoordinates", "\[Rule]", "X"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "miniMap"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CorticalMap", "[", 
             RowBox[{"sqmap", ",", 
              RowBox[{"VertexCoordinates", "\[Rule]", "X"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", "cfn"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"White", ",", 
                 RowBox[{"Disk", "[", 
                  RowBox[{
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", "0.775"}], ",", "0.225"}], "}"}], "]"}],
                    ",", 
                   RowBox[{"ImageScaled", "[", "0.228", "]"}]}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Inset", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"CortexPlot", "[", 
                  RowBox[{"mmap", ",", 
                   RowBox[{"ColorFunction", "\[Rule]", "mcfn"}]}], "]"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageScaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.45", ",", "0.45"}], "}"}], "]"}]}], "]"}]}], 
              "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"modelPlot", ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Lighter", "[", 
                  RowBox[{
                   RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"$EccentricityBlendColors", "[", "All", "]"}], 
                    ",", "e"}], "]"}], ",", "0.2"}], "]"}], ",", 
                 "\[IndentingNewLine]", "Thick", ",", 
                 RowBox[{"Point", "/@", 
                  RowBox[{"FMMIsoEccenLinePoints", "[", 
                   RowBox[{
                    RowBox[{"Benson17Model", "[", "LH", "]"}], ",", "e", ",", 
                    
                    RowBox[{"VisualAreas", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"e", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.75", ",", "1.5", ",", "3", ",", "6", ",", "12"}],
                   "}"}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            "Nothing"}], "]"}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FigS2CColor", "=", 
   RowBox[{"Function", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", 
        RowBox[{"Abs", "@", 
         RowBox[{"Round", "[", "#PredictedVisualArea", "]"}]}], "<", "4"}], "&&", 
       RowBox[{"#PredictedEccentricity", "<", "12"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Blend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CorticalCurvatureColor", "[", "#Curvature", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"$EccentricityBlendColors", "[", "LH", "]"}], ",", 
            "#PredictedEccentricity"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "#Curvature", "]"}], ",", "0.7", ",", 
          "1"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      "\"\<Curvature\>\""}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FigS2CDataColor", "=", 
    RowBox[{"Function", "@", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#Eccentricity", "<", "12"}], "&&", 
        RowBox[{"#VarianceExplained", ">", "0.1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Blend", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"CorticalCurvatureColor", "[", "#Curvature", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"$EccentricityBlendColors", "[", "LH", "]"}], ",", 
             "#Eccentricity"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "#Curvature", "]"}], ",", "0.7", ",", 
           "1"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       "\"\<Curvature\>\""}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$FigS2CMapNormal", "=", "$FigS2MapTemplate"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$FigS2CMapWarped", ":=", 
     RowBox[{"Reproject", "[", "\[IndentingNewLine]", 
      RowBox[{"$FigS2MapTemplate", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<PredictedRegistration\>\"", "/.", 
        RowBox[{"Benson14Mesh", "[", 
         RowBox[{"LH", ",", "\"\<Sphere\>\""}], "]"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$FigS2CPlots", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cfn", "=", 
          RowBox[{"RetinotopyColor", "[", 
           RowBox[{"\"\<Eccentricity\>\"", ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0.1"}], ",", "1", ",", "0"}], "]"}], 
               "&"}], ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cfnTr", "=", 
          RowBox[{"RetinotopyColor", "[", 
           RowBox[{"\"\<Eccentricity\>\"", ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0.1"}], ",", "0.65", ",", "0"}], "]"}], 
               "&"}], ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"cfnM", "=", 
          RowBox[{"RetinotopyColor", "[", 
           RowBox[{"\"\<PredictedEccentricity\>\"", ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0.1"}], ",", "1", ",", "0"}], "]"}], 
               "&"}], ")"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "@", 
          RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<supplemental/figS2/C_plot\>\"", "<>", 
             RowBox[{"ToString", "[", "#1", "]"}], "<>", "\"\<.png\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "FigS2CAtlasExplanationPlot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"VertexCoordinates", "[", "#2", "]"}], ",", 
              "\[IndentingNewLine]", "#3", ",", "#4"}], "]"}]}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "$FigS2CMapNormal", ",", "$FigS2CMapWarped", ",", 
             "$FigS2CMapWarped", ",", "$FigS2CMapNormal"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "FigS2CDataColor", ",", "FigS2CDataColor", ",", "FigS2CColor", 
             ",", "FigS2CColor"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True", ",", "False"}], "}"}]}],
           "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID\
->"8229a709-2256-4e30-878e-08207d4094fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Panel D: Area Boundaries", "Subsection",ExpressionUUID->"679b9093-9334-48f6-a3cc-a847083b4cf4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$FigBoundaryColors", ",", "$HemiViewOpts"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HemiViewOpts", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LH", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.4714082926089251`", ",", 
           RowBox[{"-", "3.011960033080586`"}], ",", 
           RowBox[{"-", "0.4615781575929298`"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.476839276963692`", ",", "0.489304155498146`"}], 
            "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.6070765292789136`", ",", 
           RowBox[{"-", "0.39088753513393465`"}], ",", 
           "0.6918562151745009`"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ViewAngle", "\[Rule]", "0.2175453358656651`"}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"RH", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.4558253983893905`"}], ",", 
           RowBox[{"-", "3.011960033080586`"}], ",", 
           RowBox[{"-", "0.4615781575929298`"}]}], "}"}]}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "0.5`", ",", "0.5`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5002151806453589`", ",", "0.4809947393760827`"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.0147833526841943`"}], ",", 
           RowBox[{"-", "0.5488379955533766`"}], ",", "1.0898597144646813`"}],
           "}"}]}], ",", 
        RowBox[{"ViewAngle", "\[Rule]", "0.2175453358656651`"}]}], "}"}]}]}], 
    "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigBoundaryColors", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "1"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "2"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "3"}], "}"}], "\[Rule]", "Black"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "4"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "5"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "6"}], "}"}], "\[Rule]", "Black"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "7"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "8"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "9"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "10"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "11"}], "}"}], "\[Rule]", "Black"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Benson17\>\"", ",", "12"}], "}"}], "\[Rule]", "Black"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Schira\>\"", ",", "1"}], "}"}], "\[Rule]", "Black"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Schira\>\"", ",", "2"}], "}"}], "\[Rule]", "Black"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Schira\>\"", ",", "3"}], "}"}], "\[Rule]", "Black"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "1"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "2"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "3"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "4"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "5"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "6"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "7"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Wang15\>\"", ",", "8"}], "}"}], "\[Rule]", "Magenta"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Other\>\"", "\[Rule]", "Green"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<V1\>\"", "\[Rule]", 
      RowBox[{"Darker", "[", "Green", "]"}]}]}], "|>"}]}], ";"}]}], "Input",Ex\
pressionUUID->"0f6977c2-a805-4426-9939-4b31328793f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"FigBoundariesPlots", ",", "FigBoundariesPlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FigBoundariesPlot", "[", 
      RowBox[{"mdl_:", "\"\<Benson17\>\""}], "]"}], ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<supplemental/figS2/D_\>\"", "<>", 
        RowBox[{"ToLowerCase", "[", "mdl", "]"}], "<>", "\"\<.png\>\""}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{"FigBoundariesPlots", "[", "mdl", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"LH", ",", "RH"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacings", "\[Rule]", 
          RowBox[{"Scaled", "[", 
           RowBox[{"-", "0.125"}], "]"}]}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigBoundariesPlots", "[", "mdlArg_", "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mdls", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "[", "mdlArg", "]"}], ",", "mdlArg", ",", 
           RowBox[{"{", "mdlArg", "}"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"meshes", "=", 
           RowBox[{"Association", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"h", "\[Rule]", 
               RowBox[{"SetVertexProperties", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Benson14Mesh", "[", 
                  RowBox[{"h", ",", "\"\<Inflated\>\""}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Join", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<Wang15\>\"", "\[Rule]", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"$Wang2015Atlas", "[", "h", "]"}]}]}], "}"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"m", "\[Rule]", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"Round", "@", 
                    RowBox[{
                    "VertexPropertyValues", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Benson14Mesh", "[", 
                    RowBox[{"h", ",", "\"\<Inflated\>\"", ",", 
                    RowBox[{"RetinotopyModel", "\[Rule]", "m"}]}], "]"}], ",",
                     "\[IndentingNewLine]", "\"\<PredictedVisualArea\>\""}], 
                    "]"}]}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "mdls"}], "}"}]}], "]"}]}], "]"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"h", ",", 
                RowBox[{"Keys", "[", "$Wang2015Atlas", "]"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"h", "\[Rule]", 
               RowBox[{"Image", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], 
              "&"}], "@", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CortexPlot3D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"meshes", "[", "h", "]"}], "/.", 
                   RowBox[{"\"\<Curvature\>\"", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"0.0053", "+", 
                    RowBox[{"(", 
                    RowBox[{"\"\<Curvature\>\"", "/.", 
                    RowBox[{"meshes", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"$HemiViewOpts", "[", "h", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "1"}], "}"}], "*", "72", "*", 
                    "5"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "@", 
                 RowBox[{"Join", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"$FigBoundaryColors", ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "area"}], "}"}]}], "]"}]}], "||", 
                    RowBox[{
                    RowBox[{"$FigBoundaryColors", "[", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "area"}], "}"}], "]"}], "===", 
                    "None"}]}], ",", "\[IndentingNewLine]", "Nothing", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"$FigBoundaryColors", "[", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "area"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"#", ",", "0.5"}], "]"}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Most", "@", "#"}], ",", 
                    RowBox[{"Rest", "@", "#"}]}], "}"}], "]"}], "&"}], "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "LabelBoundaryVertexCoordinates", "[", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"meshes", "[", "h", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Abs", "@", 
                    RowBox[{"Round", "[", 
                    RowBox[{"l", "/.", 
                    RowBox[{"meshes", "[", "h", "]"}]}], "]"}]}], ",", 
                    "area"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Method", "\[Rule]", "All"}]}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "\"\<Wang15\>\"", "}"}], ",", "mdls"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"area", ",", 
                    RowBox[{"Range", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"l", "\[Equal]", "\"\<Benson17\>\""}], ",", "3", 
                    ",", "3"}], "]"}]}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"$FigBoundaryColors", ",", "\"\<V1\>\""}], "]"}], 
                    "||", 
                    RowBox[{
                    RowBox[{"$FigBoundaryColors", "[", "\"\<V1\>\"", "]"}], "===",
                     "None"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$FigBoundaryColors", "[", "\"\<V1\>\"", "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"#", ",", "0.75"}], "]"}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Most", "@", "#"}], ",", 
                    RowBox[{"Rest", "@", "#"}]}], "}"}], "]"}], "&"}], "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    "LabelBoundaryVertexCoordinates", "[", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"meshes", "[", "h", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V1Label\>\"", "/.", 
                    RowBox[{"meshes", "[", "h", "]"}]}]}], "]"}]}]}], "]"}]}],
                     "}"}]}], "]"}]}], "]"}]}]}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{"{", 
               RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
        "]"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID->"372d5585-\
925a-4c9b-9d06-1695f01d76ed"]
}, Closed]],

Cell[CellGroupData[{

Cell["All Together", "Subsection",ExpressionUUID->"b6183c3f-198d-4310-a042-187dfd9e97cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$FigS2All", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$FigS2All", ":=", 
    RowBox[{"{", 
     RowBox[{
     "$FigS2AModelPlots", ",", "$FigS2ALegend", ",", "$FigS2BZoomViews", ",", 
      "$FigS2BZooms", ",", "$FigS2BInflated", ",", "$FigS2BSphere", ",", 
      "$FigS2BMap", ",", "$FigS2CPlots", ",", 
      RowBox[{"FigBoundariesPlot", "[", "\"\<Benson17\>\"", "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",ExpressionUUID->"7b500c7f-6f5f-4fd8-82dd-\
4dcc30079e6e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure S3: The Extended Prior", "Section",ExpressionUUID->"41ee9fc2-32ca-44ba-aa06-7a9d0dfebbee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"FigS3Prior", ",", "FigS3Bounds", ",", "$FigS3Priors"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FigS3Bounds", "[", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"map", "=", 
         RowBox[{"Benson14Map", "[", "hemi", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lbl", "=", 
            RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "map"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ecc", "=", 
            RowBox[{"\"\<PredictedEccentricity\>\"", "/.", "map"}]}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"q", "=", 
              RowBox[{"lbl", "*", 
               RowBox[{"Unitize", "@", 
                RowBox[{"Clip", "[", 
                 RowBox[{"ecc", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "12"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"e", "=", 
              RowBox[{"IndexedEdgePairsTr", "[", "map", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"x", "=", 
              RowBox[{"VertexCoordinates", "[", "map", "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"qe", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"q", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "e"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"xe", "=", 
                RowBox[{"Mean", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "e"}], 
                 "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"xe", "[", 
              RowBox[{"[", 
               RowBox[{"Indices", "[", 
                RowBox[{
                 RowBox[{"Unitize", "[", 
                  RowBox[{"Subtract", "@@", "qe"}], "]"}], ",", "1"}], "]"}], 
               "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FigS3Prior", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "type_String"}], "]"}], ":=", 
     RowBox[{"AutoCachePNG", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<supplemental/figS3/\>\"", "<>", 
        RowBox[{"ToString", "[", "hemi", "]"}], "<>", "\"\<-\>\"", "<>", 
        "type", "<>", "\"\<.png\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"CortexPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Benson14Map", "[", "hemi", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"RetinotopyColor", "[", 
           RowBox[{
            RowBox[{"\"\<Predicted\>\"", "<>", "type"}], ",", 
            RowBox[{"Range", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "12"}], "}"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"PointSize", "[", "Small", "]"}], ",", 
            RowBox[{"Point", "/@", 
             RowBox[{"FigS3Bounds", "[", "hemi", "]"}]}]}], "}"}]}]}], "]"}], 
       ",", "\[IndentingNewLine]", "300"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$FigS3Priors", ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FigS3Prior", "[", 
        RowBox[{"h", ",", "t"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"h", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], 
          "}"}]}], "}"}]}], "]"}]}]}], "]"}], ";"}]}], "Input",ExpressionUUID-\
>"14dff1c9-b9d5-4e9c-90ec-06024e560897"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{974, 761},
WindowMargins->{{Automatic, 17}, {Automatic, 11}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TrackCellChangeTimes->False,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Chapter"], CellFrame -> {{False, False}, {False, True}}], 
   Cell[
    StyleData["Subchapter"], CellMargins -> {{48, Inherited}, {8, 20}}], 
   Cell[
    StyleData["Section"], CellFrame -> {{0, 0}, {0, 0}}, CellDingbat -> 
    "\[GraySquare]", CellMargins -> {{51, Inherited}, {8, 18}}, FontSize -> 
    24, FontColor -> 
    RGBColor[0.7529411764705882, 0.15294117647058825`, 
      0.12156862745098039`]]}, Visible -> False, FrontEndVersion -> 
  "11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 129, 3, 148, "Title", "ExpressionUUID" -> \
"8d4e763a-023f-4955-bab5-41368eb985c1"],
Cell[712, 27, 920, 25, 127, "Chapter", "ExpressionUUID" -> \
"53abb8f0-427e-41cf-a18a-2373101a7a0a"],
Cell[CellGroupData[{
Cell[1657, 56, 80, 0, 63, "Chapter", "ExpressionUUID" -> \
"22e3e616-22a0-4d44-b329-2e5f6c36aab0"],
Cell[1740, 58, 534, 9, 144, "Text", "ExpressionUUID" -> \
"cc710ea1-b471-4a37-9e59-5adda0d67774"],
Cell[CellGroupData[{
Cell[2299, 71, 89, 0, 63, "Subchapter", "ExpressionUUID" -> \
"e7e7ff45-d5c6-45bf-b6a5-946d1d516f8f"],
Cell[CellGroupData[{
Cell[2413, 75, 86, 0, 55, "Section", "ExpressionUUID" -> \
"c865ccc4-87cf-43da-8ced-b782821d42f0"],
Cell[2502, 77, 172, 3, 70, "Input", "ExpressionUUID" -> \
"1a59d6d9-0721-4ea4-a7bf-1bd215ee3e8d"]
}, Closed]],
Cell[CellGroupData[{
Cell[2711, 85, 79, 0, 41, "Section", "ExpressionUUID" -> \
"2d83157c-2445-47bc-a4df-ca5ed1b9d327"],
Cell[2793, 87, 436, 6, 68, "Text", "ExpressionUUID" -> \
"48921840-01bd-4d50-b387-14c57db6aefd"],
Cell[3232, 95, 2226, 51, 369, "Input", "ExpressionUUID" -> \
"673cb347-00ca-437d-8bfd-174cb5c89235"],
Cell[5461, 148, 148, 2, 30, "Text", "ExpressionUUID" -> \
"376e780c-9366-41a2-92fd-88a766d36bae"],
Cell[5612, 152, 2817, 72, 411, "Input", "ExpressionUUID" -> \
"532b5e3a-bf9d-4a30-b93d-26ed995e4127"],
Cell[8432, 226, 115, 0, 30, "Text", "ExpressionUUID" -> \
"ff27e4fa-1a4e-4748-9817-038011652e97"],
Cell[8550, 228, 388, 10, 54, "Input", "ExpressionUUID" -> \
"b1ab3cf7-5b82-4f3d-9a57-167951ace5f5"],
Cell[8941, 240, 148, 1, 30, "Text", "ExpressionUUID" -> \
"096e146a-1c3e-4848-b0b2-9d4ebd930a87"],
Cell[9092, 243, 629, 15, 117, "Input", "ExpressionUUID" -> \
"b0408970-f60f-4633-ac49-25f60d0017f5"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[9770, 264, 91, 0, 47, "Subchapter", "ExpressionUUID" -> \
"dd463ddd-83c9-4728-bc73-cabc33e4c4b5"],
Cell[9864, 266, 224, 3, 49, "Text", "ExpressionUUID" -> \
"0188cd34-0261-447d-8333-00e1244f5c7d"],
Cell[CellGroupData[{
Cell[10113, 273, 95, 0, 55, "Section", "ExpressionUUID" -> \
"b3999b89-ac20-4187-9858-e1b30d628597"],
Cell[CellGroupData[{
Cell[10233, 277, 156, 2, 44, "Subsection", "ExpressionUUID" -> \
"2ce2f043-6c4b-4956-9abd-f3e526529791"],
Cell[10392, 281, 11762, 269, 70, "Input", "ExpressionUUID" -> \
"e12cd5a6-e823-422f-bda3-9b115d82dcce"]
}, Closed]],
Cell[CellGroupData[{
Cell[22191, 555, 98, 0, 36, "Subsection", "ExpressionUUID" -> \
"a27c6ea1-9b90-41fe-a611-b88e5d60e72b"],
Cell[22292, 557, 166, 3, 30, "Text", "ExpressionUUID" -> \
"ce8ed4ac-c1d4-49eb-9e99-b635d7b8f517"],
Cell[22461, 562, 9716, 229, 1042, "Input", "ExpressionUUID" -> \
"39aa1918-a59f-4b5b-b8a7-c0c24519db44"],
Cell[32180, 793, 1384, 37, 117, "Input", "ExpressionUUID" -> \
"5de752c6-62a1-4704-bfde-88b7dc238a43"]
}, Closed]],
Cell[CellGroupData[{
Cell[33601, 835, 107, 0, 36, "Subsection", "ExpressionUUID" -> \
"fbc2a41d-469f-448b-9286-648a1eea5195"],
Cell[33711, 837, 121, 0, 30, "Text", "ExpressionUUID" -> \
"e436b776-c0a4-468e-93e5-718058654fe8"],
Cell[33835, 839, 11082, 285, 1062, "Input", "ExpressionUUID" -> \
"e7505a84-4962-4093-b645-743165b9b1bd"],
Cell[44920, 1126, 25507, 608, 2679, "Input", "ExpressionUUID" -> \
"c366d373-00f1-4167-8f0f-90a4efc4c873"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[70476, 1740, 86, 0, 41, "Section", "ExpressionUUID" -> \
"a3ef7226-5bd7-48e3-af8d-243257829892"],
Cell[70565, 1742, 2616, 65, 327, "Input", "ExpressionUUID" -> \
"5ff26971-3209-4f3e-8c32-e91e88bdfb1e"],
Cell[73184, 1809, 171, 3, 30, "Text", "ExpressionUUID" -> \
"7aee201c-f5b6-425c-80dd-928ef35241db"],
Cell[73358, 1814, 1806, 49, 201, "Input", "ExpressionUUID" -> \
"15acbdbd-b790-48fc-beab-ad6e33a7be9e"]
}, Closed]],
Cell[CellGroupData[{
Cell[75201, 1868, 109, 0, 41, "Section", "ExpressionUUID" -> \
"915cc7ed-f753-4751-b2b2-06aef3e4794d"],
Cell[CellGroupData[{
Cell[75335, 1872, 120, 0, 44, "Subsection", "ExpressionUUID" -> \
"15c6cef9-af7a-43ae-837c-e0f1c8237e9e"],
Cell[75458, 1874, 8213, 190, 915, "Input", "ExpressionUUID" -> \
"bd46d951-0891-4679-b5ce-5eb6b217feb1"]
}, Closed]],
Cell[CellGroupData[{
Cell[83708, 2069, 110, 0, 36, "Subsection", "ExpressionUUID" -> \
"c78ba169-4b66-4674-b3d5-e147155f8224"],
Cell[83821, 2071, 13493, 325, 1661, "Input", "ExpressionUUID" -> \
"0ef92fd6-0de6-4743-94cc-8826659080ee"],
Cell[97317, 2398, 1457, 39, 170, "Input", "ExpressionUUID" -> \
"3b496899-6d5b-46a4-a600-084895a6757c"],
Cell[98777, 2439, 2430, 61, 338, "Input", "ExpressionUUID" -> \
"59cf4f16-8281-4b65-a299-1ab6693d35b4"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[101256, 2506, 94, 0, 41, "Section", "ExpressionUUID" -> \
"0e3f1085-9dee-4227-a6d7-86441afe6954"],
Cell[CellGroupData[{
Cell[101375, 2510, 115, 0, 44, "Subsection", "ExpressionUUID" -> \
"110c9e12-9379-4f79-bcad-0c0a9113819d"],
Cell[101493, 2512, 183, 3, 30, "Text", "ExpressionUUID" -> \
"dcdf2e91-6323-4ea1-ad56-e278b537d46a"],
Cell[101679, 2517, 20044, 473, 1997, "Input", "ExpressionUUID" -> \
"380027be-e9a6-46a6-b46d-cd3050269425"],
Cell[121726, 2992, 196, 3, 30, "Text", "ExpressionUUID" -> \
"aae2ec8b-88aa-4b72-a71e-7cb3f1a79a36"],
Cell[121925, 2997, 28353, 607, 3089, "Input", "ExpressionUUID" -> \
"b20248dc-ad96-4538-ba15-66857ccda745"],
Cell[150281, 3606, 4390, 105, 401, "Input", "ExpressionUUID" -> \
"abce13b6-88be-4fef-abdf-a7ccc3c85762"]
}, Closed]],
Cell[CellGroupData[{
Cell[154708, 3716, 118, 0, 36, "Subsection", "ExpressionUUID" -> \
"6ea778a1-be85-4233-9da7-9868a116d90d"],
Cell[154829, 3718, 121, 0, 30, "Text", "ExpressionUUID" -> \
"71e2d094-3e94-4dd6-99da-9096cfa338e6"],
Cell[154953, 3720, 475, 11, 75, "Input", "ExpressionUUID" -> \
"38be62a3-af4d-45fe-8ac8-6d3e84442b66"],
Cell[155431, 3733, 168, 3, 30, "Text", "ExpressionUUID" -> \
"24f13436-2ba7-43fc-9102-b666f64039e8"],
Cell[155602, 3738, 1394, 36, 159, "Input", "ExpressionUUID" -> \
"4d3307c0-2a44-48d9-9902-6f5b51858a4c"],
Cell[156999, 3776, 278, 4, 49, "Text", "ExpressionUUID" -> \
"d79eb474-a227-41d2-a06b-508306878b89"],
Cell[157280, 3782, 8056, 188, 936, "Input", "ExpressionUUID" -> \
"c7081acd-42e3-465e-bdc2-3b524487352f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[165385, 3976, 90, 0, 41, "Section", "ExpressionUUID" -> \
"86b1d656-5762-4650-94a3-50e105f21cca"],
Cell[CellGroupData[{
Cell[165500, 3980, 89, 0, 44, "Subsection", "ExpressionUUID" -> \
"0e1731a0-f763-4c62-b06d-19c7e6dddc01"],
Cell[165592, 3982, 371, 10, 43, "Input", "ExpressionUUID" -> \
"7146a2f2-77bc-4358-9b4d-4c19bd8d1c77"]
}, Closed]],
Cell[CellGroupData[{
Cell[166000, 3997, 99, 0, 36, "Subsection", "ExpressionUUID" -> \
"6ad825cb-dfbe-4998-9b32-0cf33026fc3b"],
Cell[166102, 3999, 1589, 40, 243, "Input", "ExpressionUUID" -> \
"564ad5b8-a778-4231-9013-d148f81761a9"]
}, Closed]],
Cell[CellGroupData[{
Cell[167728, 4044, 111, 0, 36, "Subsection", "ExpressionUUID" -> \
"848f34ad-ccbf-4898-ac44-9e317691c4db"],
Cell[167842, 4046, 3640, 88, 411, "Input", "ExpressionUUID" -> \
"29623af9-eced-4d53-b183-6a3bcd00a570"]
}, Closed]],
Cell[CellGroupData[{
Cell[171519, 4139, 102, 0, 36, "Subsection", "ExpressionUUID" -> \
"f2424fab-7e52-48b2-ae65-529fd0c74f75"],
Cell[171624, 4141, 2778, 66, 317, "Input", "ExpressionUUID" -> \
"92617289-e2d1-4830-8a85-e0e3544d4d02"],
Cell[174405, 4209, 4823, 127, 495, "Input", "ExpressionUUID" -> \
"6ae5ceaf-dd4a-47c0-b501-9cbb58fb389c"],
Cell[179231, 4338, 96, 0, 30, "Text", "ExpressionUUID" -> \
"34681644-1332-4ce3-9827-798aac894ae7"],
Cell[179330, 4340, 15075, 354, 1703, "Input", "ExpressionUUID" -> \
"8aac0e9c-c5b6-4cc7-9375-34de5382600d"],
Cell[194408, 4696, 4562, 112, 590, "Input", "ExpressionUUID" -> \
"07908459-5814-4b9f-b280-6fe25c8fae42"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[199031, 4815, 195, 3, 47, "Subchapter", "ExpressionUUID" -> \
"4c83839d-e39b-4e27-a90a-8a322170b2b3"],
Cell[CellGroupData[{
Cell[199251, 4822, 203, 4, 55, "Section", "ExpressionUUID" -> \
"ad840763-fbc9-4d1c-abd7-460f26883deb"],
Cell[CellGroupData[{
Cell[199479, 4830, 103, 0, 44, "Subsection", "ExpressionUUID" -> \
"d6f0bb22-45e9-4f6e-92d7-d365389f07e3"],
Cell[199585, 4832, 944, 24, 70, "Input", "ExpressionUUID" -> \
"ac0f1697-6ec7-4c09-8d61-d54a94e791ca"],
Cell[200532, 4858, 470, 11, 70, "Input", "ExpressionUUID" -> \
"7670f440-3eec-4b29-9ad8-da885b215a4b"],
Cell[201005, 4871, 1066, 22, 70, "Input", "ExpressionUUID" -> \
"b8d1e1fa-7772-4ae4-8192-03c7a6544e5b"]
}, Closed]],
Cell[CellGroupData[{
Cell[202108, 4898, 225, 4, 36, "Subsection", "ExpressionUUID" -> \
"38341fdb-c3f0-4017-b9c2-cca874d2e052"],
Cell[202336, 4904, 4552, 121, 70, "Input", "ExpressionUUID" -> \
"feaa8ba1-f80c-4112-9ab5-1acfd9f79c19"]
}, Closed]],
Cell[CellGroupData[{
Cell[206925, 5030, 106, 0, 36, "Subsection", "ExpressionUUID" -> \
"d79c90f1-3ddf-43ae-97b4-b94e7cd81756"],
Cell[207034, 5032, 376, 6, 70, "Text", "ExpressionUUID" -> \
"5684d721-995d-48e9-9357-f026c17de0d7"],
Cell[207413, 5040, 6362, 157, 70, "Input", "ExpressionUUID" -> \
"f5f242e6-1ff8-407f-be32-42cd0869763f"]
}, Closed]],
Cell[CellGroupData[{
Cell[213812, 5202, 163, 3, 36, "Subsection", "ExpressionUUID" -> \
"af822b92-4514-429c-9542-8624001eeb01"],
Cell[213978, 5207, 44021, 1065, 5567, "Input", "ExpressionUUID" -> \
"a1e9957a-85e8-426a-868f-8d003f42b7d1"]
}, Closed]],
Cell[CellGroupData[{
Cell[258036, 6277, 188, 3, 36, "Subsection", "ExpressionUUID" -> \
"09f24c71-cb48-4382-ad87-8f9c8b3b7223"],
Cell[258227, 6282, 6209, 163, 70, "Input", "ExpressionUUID" -> \
"c57cd5f6-6b13-4a64-9fff-039bf27b4a34"]
}, Closed]],
Cell[CellGroupData[{
Cell[264473, 6450, 92, 0, 36, "Subsection", "ExpressionUUID" -> \
"361dfdf9-7674-4dfa-91b5-3487092ab9ef"],
Cell[264568, 6452, 174, 3, 30, "Text", "ExpressionUUID" -> \
"1897b273-8c92-433a-b255-3f6e2e280cca"],
Cell[264745, 6457, 1128, 30, 139, "Input", "ExpressionUUID" -> \
"310eeeb8-a6ef-4850-b1fc-f6ef202e65b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[265910, 6492, 112, 0, 36, "Subsection", "ExpressionUUID" -> \
"6f6f9a10-cd95-4b1d-8b38-1a368e2f5c6d"],
Cell[266025, 6494, 2383, 60, 243, "Input", "ExpressionUUID" -> \
"8fc7f285-7870-4f0f-9ec0-e73060cd73b6"],
Cell[268411, 6556, 1309, 33, 138, "Input", "ExpressionUUID" -> \
"6614d31b-a683-4eae-afdf-3e72ee1e29a8"]
}, Closed]],
Cell[CellGroupData[{
Cell[269757, 6594, 122, 0, 36, "Subsection", "ExpressionUUID" -> \
"a28ef6ca-0cf2-4208-98d4-81a773b8d48c"],
Cell[269882, 6596, 1551, 43, 70, "Input", "ExpressionUUID" -> \
"e6e30776-b5ca-46e9-b1e8-905f3d176046"]
}, Closed]],
Cell[CellGroupData[{
Cell[271470, 6644, 123, 0, 36, "Subsection", "ExpressionUUID" -> \
"6da88d4d-8561-43c0-9d6f-23991cc83a43"],
Cell[271596, 6646, 11667, 264, 70, "Input", "ExpressionUUID" -> \
"8ae224b1-7421-4dde-9f41-f15407f00435"]
}, Closed]],
Cell[CellGroupData[{
Cell[283300, 6915, 103, 0, 36, "Subsection", "ExpressionUUID" -> \
"efb50789-2533-4ab9-8b95-e30bd8df2b67"],
Cell[283406, 6917, 3082, 77, 70, "Input", "ExpressionUUID" -> \
"5f5e97d6-3704-44a8-a15b-d7aac7fef307"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[286537, 7000, 94, 0, 41, "Section", "ExpressionUUID" -> \
"4c0516a3-6250-4ed5-9999-c09da9736816"],
Cell[CellGroupData[{
Cell[286656, 7004, 95, 0, 44, "Subsection", "ExpressionUUID" -> \
"7384ed12-bf48-4646-806b-4644acb12e47"],
Cell[286754, 7006, 18876, 428, 1797, "Input", "ExpressionUUID" -> \
"439d35e7-67ee-4246-9f7e-f6d36228ef24"],
Cell[305633, 7436, 7479, 164, 957, "Input", "ExpressionUUID" -> \
"f754a305-d725-4d70-bc13-739aec031f0e"]
}, Closed]],
Cell[CellGroupData[{
Cell[313149, 7605, 101, 0, 36, "Subsection", "ExpressionUUID" -> \
"f422aabe-3796-4000-8998-7bea0babe4ce"],
Cell[313253, 7607, 17466, 371, 1388, "Input", "ExpressionUUID" -> \
"d95b5c38-0d67-400c-92f6-da128ee175c6"]
}, Closed]],
Cell[CellGroupData[{
Cell[330756, 7983, 134, 0, 36, "Subsection", "ExpressionUUID" -> \
"8556b810-eb32-4ab2-8e55-d8536618358f"],
Cell[330893, 7985, 13069, 300, 1230, "Input", "ExpressionUUID" -> \
"a7598d07-ba2f-4ca2-bb82-e609edf8a6b0"],
Cell[343965, 8287, 10247, 222, 915, "Input", "ExpressionUUID" -> \
"a1ee7405-3eae-4d15-87f8-1a9bae844a8b"]
}, Closed]],
Cell[CellGroupData[{
Cell[354249, 8514, 110, 0, 36, "Subsection", "ExpressionUUID" -> \
"210f6cd2-37b1-42c2-b590-02a3dc0f3793"],
Cell[354362, 8516, 14606, 322, 1503, "Input", "ExpressionUUID" -> \
"f1d3e145-bf1a-40fc-96a2-a11dbd6e4afd"],
Cell[368971, 8840, 6445, 150, 621, "Input", "ExpressionUUID" -> \
"6d7d9878-d7ed-4db7-9405-a48142149613"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[375465, 8996, 125, 0, 41, "Section", "ExpressionUUID" -> \
"740216cd-e0eb-47b0-942d-56f32658b2b8"],
Cell[375593, 8998, 16871, 364, 1482, "Input", "ExpressionUUID" -> \
"c9040798-5dbc-4ee7-97ee-263aff501ec0"]
}, Closed]],
Cell[CellGroupData[{
Cell[392501, 9367, 143, 2, 41, "Section", "ExpressionUUID" -> \
"48084d53-3837-481c-8283-4d013c0d6266"],
Cell[392647, 9371, 286, 4, 49, "Text", "ExpressionUUID" -> \
"db03362c-b47b-4887-9069-01118e09ed97"],
Cell[CellGroupData[{
Cell[392958, 9379, 103, 0, 44, "Subsection", "ExpressionUUID" -> \
"7d3ad60a-7a80-409c-a8a2-04393eccf467"],
Cell[393064, 9381, 157, 2, 30, "Text", "ExpressionUUID" -> \
"247c33b9-128a-413d-8f62-cc9068472ad0"],
Cell[393224, 9385, 10778, 257, 1461, "Input", "ExpressionUUID" -> \
"28029415-8ef1-4c8b-9c92-2d2671fd32cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[404039, 9647, 113, 0, 36, "Subsection", "ExpressionUUID" -> \
"d58ed629-e2d9-4aa0-9120-28d81b18f4e7"],
Cell[404155, 9649, 321, 5, 70, "Text", "ExpressionUUID" -> \
"44aab93c-c7bd-4d55-b4f7-58f68f13efd4"],
Cell[404479, 9656, 46077, 990, 70, "Input", "ExpressionUUID" -> \
"62469fef-f688-4433-bd2f-3466e0048f20"]
}, Closed]],
Cell[CellGroupData[{
Cell[450593, 10651, 111, 0, 36, "Subsection", "ExpressionUUID" -> \
"960ea701-bcc8-49a1-a77d-318e741a64f8"],
Cell[450707, 10653, 28157, 622, 2742, "Input", "ExpressionUUID" -> \
"9f9a3481-7dd5-4bca-9aef-b8a912e003a4"]
}, Closed]],
Cell[CellGroupData[{
Cell[478901, 11280, 115, 0, 36, "Subsection", "ExpressionUUID" -> \
"b373c471-03c3-4f52-8ee5-455c0dbafaf1"],
Cell[479019, 11282, 100715, 2191, 8864, "Input", "ExpressionUUID" -> \
"046e5aa3-0180-4b59-9e09-bb103efdcb08"],
Cell[579737, 13475, 8688, 203, 926, "Input", "ExpressionUUID" -> \
"0b5ad54b-e4cd-4544-91a7-56fd04d07940"]
}, Closed]],
Cell[CellGroupData[{
Cell[588462, 13683, 132, 0, 36, "Subsection", "ExpressionUUID" -> \
"11b59c04-6873-4149-8bab-81d2824b0be0"],
Cell[588597, 13685, 187, 3, 30, "Text", "ExpressionUUID" -> \
"9309d20f-7a77-4dd5-87b9-426667d0ba9a"],
Cell[588787, 13690, 37011, 790, 3666, "Input", "ExpressionUUID" -> \
"da7a34b1-536e-4793-80d9-f982d7d71a95"]
}, Closed]],
Cell[CellGroupData[{
Cell[625835, 14485, 121, 0, 36, "Subsection", "ExpressionUUID" -> \
"e03b4835-c822-488b-84b6-6ba07d43e78f"],
Cell[625959, 14487, 7012, 168, 70, "Input", "ExpressionUUID" -> \
"c81e165e-6653-4c17-b420-04bdb62f3b8b"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[633044, 14663, 78, 0, 74, "Chapter", "ExpressionUUID" -> \
"18d4fb76-9a7b-4e9d-a8fe-eaf1130f3db4"],
Cell[633125, 14665, 541, 7, 87, "Text", "ExpressionUUID" -> \
"806d9f4c-1d5c-4650-b7d0-d5796c2d70a8"],
Cell[CellGroupData[{
Cell[633691, 14676, 83, 0, 63, "Subchapter", "ExpressionUUID" -> \
"db372683-fc6a-4410-9a0a-0be4b95c1412"],
Cell[CellGroupData[{
Cell[633799, 14680, 112, 0, 55, "Section", "ExpressionUUID" -> \
"51136743-ece1-4f22-a054-e4cd3cbb46af"],
Cell[633914, 14682, 10311, 221, 978, "Input", "ExpressionUUID" -> \
"72b7d3cd-b46d-4a13-996e-0e5fb8157586"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[644274, 14909, 84, 0, 47, "Subchapter", "ExpressionUUID" -> \
"066117cd-5693-4899-9792-d5c6ad57efa3"],
Cell[CellGroupData[{
Cell[644383, 14913, 107, 0, 55, "Section", "ExpressionUUID" -> \
"1a501746-110e-49d1-a90b-41797b95fa7c"],
Cell[644493, 14915, 6633, 161, 768, "Input", "ExpressionUUID" -> \
"c8af802f-7257-4c6d-88e8-4b38e5b586bb"],
Cell[651129, 15078, 5476, 125, 516, "Input", "ExpressionUUID" -> \
"750bb472-8893-4ff2-b5a0-3259f7d89386"]
}, Closed]],
Cell[CellGroupData[{
Cell[656642, 15208, 101, 0, 41, "Section", "ExpressionUUID" -> \
"04f66724-5788-46d9-aaaf-fccd0def574d"],
Cell[CellGroupData[{
Cell[656768, 15212, 82, 0, 44, "Subsection", "ExpressionUUID" -> \
"1bb702e5-ae45-4867-87c3-91aa425f2e8f"],
Cell[656853, 15214, 10011, 239, 1272, "Input", "ExpressionUUID" -> \
"b23c0d42-72bd-4a59-a87f-fbf897957659"],
Cell[666867, 15455, 6389, 144, 684, "Input", "ExpressionUUID" -> \
"5c4194b8-1257-486a-8a81-ad7935d1c00e"]
}, Closed]],
Cell[CellGroupData[{
Cell[673293, 15604, 109, 0, 36, "Subsection", "ExpressionUUID" -> \
"c09b8e66-79d0-4614-a9da-f97cba3d8542"],
Cell[673405, 15606, 1187, 26, 264, "Input", "ExpressionUUID" -> \
"f92019f4-4766-467a-818c-33a0dbcea75c"]
}, Closed]],
Cell[CellGroupData[{
Cell[674629, 15637, 108, 0, 36, "Subsection", "ExpressionUUID" -> \
"5e12d321-6157-4693-90e1-59cbad7035cc"],
Cell[674740, 15639, 1952, 41, 306, "Input", "ExpressionUUID" -> \
"b81021ff-038d-4782-8f1e-3bf389e42c0c"]
}, Closed]],
Cell[CellGroupData[{
Cell[676729, 15685, 107, 0, 36, "Subsection", "ExpressionUUID" -> \
"c26b3ea3-21fd-4c26-a9a6-55a816a4bbe3"],
Cell[676839, 15687, 2383, 49, 369, "Input", "ExpressionUUID" -> \
"b59231e1-794c-4091-b9a3-078b88c29298"]
}, Closed]],
Cell[CellGroupData[{
Cell[679259, 15741, 86, 0, 36, "Subsection", "ExpressionUUID" -> \
"09489c12-b45c-4d02-86d5-37f249071666"],
Cell[679348, 15743, 636, 13, 138, "Input", "ExpressionUUID" -> \
"40a4d9a9-933e-4c9d-8dbe-655104786ade"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[680033, 15762, 96, 0, 41, "Section", "ExpressionUUID" -> \
"7246ace7-b8d3-4a5e-9876-90a014ae02d5"],
Cell[CellGroupData[{
Cell[680154, 15766, 115, 0, 44, "Subsection", "ExpressionUUID" -> \
"35bdf46f-23cc-4588-b313-5ae062724172"],
Cell[680272, 15768, 2818, 70, 285, "Input", "ExpressionUUID" -> \
"a79a1a28-e537-4c38-b0fe-33c2f920d7fc"]
}, Closed]],
Cell[CellGroupData[{
Cell[683127, 15843, 116, 0, 36, "Subsection", "ExpressionUUID" -> \
"4cf3a8b5-489d-4dab-8135-100c7161e4f2"],
Cell[683246, 15845, 2819, 70, 70, "Input", "ExpressionUUID" -> \
"ecb69b60-5aae-47f6-938b-ae325ab6ab33"]
}, Closed]],
Cell[CellGroupData[{
Cell[686102, 15920, 89, 0, 36, "Subsection", "ExpressionUUID" -> \
"d6677979-6472-46c3-b15a-f690ef6e8cbf"],
Cell[CellGroupData[{
Cell[686216, 15924, 34068, 745, 2763, "Input", "ExpressionUUID" -> \
"fd210c9a-795e-40ef-b2c3-af91fd49c50f"],
Cell[720287, 16671, 1616, 24, 70, "Message", "ExpressionUUID" -> \
"44d21cb2-ec45-429d-9891-bb7488d9c87c"],
Cell[721906, 16697, 1662, 24, 70, "Message", "ExpressionUUID" -> \
"1c225cfb-b0a2-4b19-9115-7f71cd24f880"],
Cell[723571, 16723, 1616, 24, 70, "Message", "ExpressionUUID" -> \
"5c49454d-3c03-4137-a7b1-a6e4737a0543"],
Cell[725190, 16749, 356, 7, 70, "Message", "ExpressionUUID" -> \
"e792e636-060d-4e18-b666-7d2a4dab7f4c"],
Cell[725549, 16758, 402, 8, 70, "Message", "ExpressionUUID" -> \
"8c8c6f07-7a8e-4513-a41b-3cacf3d6bd42"],
Cell[725954, 16768, 3362, 47, 70, "Message", "ExpressionUUID" -> \
"c26a220c-23b7-41aa-b4bb-e12e272962e7"],
Cell[729319, 16817, 3362, 47, 70, "Message", "ExpressionUUID" -> \
"78835991-84a1-40fe-85f9-a770fbac5a7c"],
Cell[732684, 16866, 402, 8, 70, "Message", "ExpressionUUID" -> \
"64502e81-482f-41dd-a23b-aa4254c3371b"],
Cell[733089, 16876, 402, 8, 70, "Message", "ExpressionUUID" -> \
"ca35d14d-2610-4304-8b33-a1d7d1022d25"],
Cell[733494, 16886, 364, 7, 70, "Message", "ExpressionUUID" -> \
"208c6fce-3142-4b52-847a-b921775e42f1"],
Cell[733861, 16895, 3354, 47, 70, "Message", "ExpressionUUID" -> \
"aa0a0b9f-8b86-4cfe-aed6-59f8dbee9255"],
Cell[737218, 16944, 358, 7, 70, "Message", "ExpressionUUID" -> \
"be2e2168-56cd-4a78-a8a0-b41325a54c02"],
Cell[737579, 16953, 1477, 24, 70, "Message", "ExpressionUUID" -> \
"9a444d0f-c358-4979-b760-45d24aa6bc60"],
Cell[739059, 16979, 1477, 24, 70, "Message", "ExpressionUUID" -> \
"32645e96-eb43-4738-8995-9ff76aa48f14"],
Cell[740539, 17005, 1767, 28, 70, "Message", "ExpressionUUID" -> \
"b9bb7891-1834-49f6-8eb6-c86948e6a061"],
Cell[742309, 17035, 360, 7, 70, "Message", "ExpressionUUID" -> \
"5372716a-9a1b-4d4b-b035-a251dbe71f83"],
Cell[742672, 17044, 369, 8, 70, "Message", "ExpressionUUID" -> \
"9f18063b-025e-440b-8478-ac7a4aecf4ed"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[743102, 17059, 109, 0, 41, "Section", "ExpressionUUID" -> \
"76664132-3c07-44b1-b2c1-f0a2c84cebb8"],
Cell[CellGroupData[{
Cell[743236, 17063, 112, 0, 44, "Subsection", "ExpressionUUID" -> \
"9d8e4efb-122d-4a74-8ed5-40c5663fdb16"],
Cell[743351, 17065, 12319, 311, 1104, "Input", "ExpressionUUID" -> \
"165d93a9-087e-4f99-996f-24122bdf4b28"],
Cell[755673, 17378, 8784, 226, 726, "Input", "ExpressionUUID" -> \
"f686b5d9-43a1-4147-aa85-ecdcfa1bae77"]
}, Closed]],
Cell[CellGroupData[{
Cell[764494, 17609, 122, 0, 36, "Subsection", "ExpressionUUID" -> \
"ad67615b-d1f0-4c6f-916b-1a427e378caa"],
Cell[764619, 17611, 5614, 122, 621, "Input", "ExpressionUUID" -> \
"e053e0b6-ec1d-4f51-b6bc-70ee7b7cdd20"],
Cell[770236, 17735, 3030, 71, 453, "Input", "ExpressionUUID" -> \
"8336d279-70cd-4b64-be16-ff141570d59a"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[773315, 17812, 100, 0, 41, "Section", "ExpressionUUID" -> \
"7152e3a2-4a9b-43a6-a935-800f89d4e793"],
Cell[773418, 17814, 18542, 407, 1671, "Input", "ExpressionUUID" -> \
"8385af31-ff42-46b9-9818-bebce447211b"]
}, Closed]],
Cell[CellGroupData[{
Cell[791997, 18226, 101, 0, 41, "Section", "ExpressionUUID" -> \
"47c98728-29ba-4b2f-9d8f-0ee3e0eb6fdf"],
Cell[CellGroupData[{
Cell[792123, 18230, 109, 0, 44, "Subsection", "ExpressionUUID" -> \
"4bb7be1d-fc88-4b27-937a-ce7a6b8ef673"],
Cell[792235, 18232, 9093, 210, 705, "Input", "ExpressionUUID" -> \
"001b9058-f052-46e3-b7ab-70789a5d3336"]
}, Closed]],
Cell[CellGroupData[{
Cell[801365, 18447, 90, 0, 36, "Subsection", "ExpressionUUID" -> \
"8ebe2741-af2c-464e-8dbf-bdc0a687e383"],
Cell[CellGroupData[{
Cell[801480, 18451, 237, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"ca35ebb6-6cc8-4615-b9bb-72e6babbd549"],
Cell[801720, 18457, 3343, 89, 70, "Input", "ExpressionUUID" -> \
"4bfa9bce-1dd5-42f2-897e-8bd337ddbeba"]
}, Closed]],
Cell[CellGroupData[{
Cell[805100, 18551, 220, 4, 29, "Subsubsection", "ExpressionUUID" -> \
"3e3e13b2-09d4-4aa6-9eae-e368839f5dd2"],
Cell[805323, 18557, 5325, 131, 70, "Input", "ExpressionUUID" -> \
"949cc270-4601-4a4a-8751-75dd979e9e32"],
Cell[810651, 18690, 6253, 147, 70, "Input", "ExpressionUUID" -> \
"4255fd0e-ee28-4f16-984e-d3b509f82ed7"]
}, Closed]],
Cell[CellGroupData[{
Cell[816941, 18842, 167, 3, 29, "Subsubsection", "ExpressionUUID" -> \
"76a161a7-ca6b-4282-98a2-fa90c7a0e5d8"],
Cell[817111, 18847, 5878, 132, 726, "Input", "ExpressionUUID" -> \
"9cbfc249-9a73-4185-9b5e-985cd54b4baa"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[823050, 18986, 102, 0, 41, "Section", "ExpressionUUID" -> \
"9feee25d-5ab2-4b62-bf75-f472c98f3b44"],
Cell[CellGroupData[{
Cell[823177, 18990, 106, 0, 44, "Subsection", "ExpressionUUID" -> \
"5d0f7a48-a474-4bdf-8906-8608887f6ada"],
Cell[823286, 18992, 14545, 336, 1272, "Input", "ExpressionUUID" -> \
"e747ab69-0e9b-4bbf-87fe-aca29600c7c1"],
Cell[837834, 19330, 9704, 225, 957, "Input", "ExpressionUUID" -> \
"f1cf6012-62df-4e69-b2d2-f4f347160cbe"]
}, Closed]],
Cell[CellGroupData[{
Cell[847575, 19560, 103, 0, 36, "Subsection", "ExpressionUUID" -> \
"6bd83ad0-770b-450e-a238-0d5b97f03a09"],
Cell[847681, 19562, 4666, 111, 453, "Input", "ExpressionUUID" -> \
"151930d4-f369-46b2-83b6-e49de005d261"],
Cell[852350, 19675, 12626, 282, 1062, "Input", "ExpressionUUID" -> \
"7fa4277e-9f2b-4858-985a-3b8cf3af715e"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[865025, 19963, 119, 0, 41, "Section", "ExpressionUUID" -> \
"5f251400-66e8-4f52-929c-b72f89a9a7ad"],
Cell[CellGroupData[{
Cell[865169, 19967, 93, 0, 44, "Subsection", "ExpressionUUID" -> \
"ddef97b5-b086-4a70-ab75-12e259f4d5eb"],
Cell[865265, 19969, 13729, 313, 1293, "Input", "ExpressionUUID" -> \
"f2ce868d-d956-498a-81d9-2c6ceb5b3eca"]
}, Closed]],
Cell[CellGroupData[{
Cell[879031, 20287, 97, 0, 36, "Subsection", "ExpressionUUID" -> \
"3c4196f4-2b6f-462d-bbfb-4a9573e0b6ea"],
Cell[879131, 20289, 17189, 399, 1475, "Input", "ExpressionUUID" -> \
"016f2aeb-79c8-4c14-8fcf-bc4c3183ae24"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[896369, 20694, 108, 0, 41, "Section", "ExpressionUUID" -> \
"fd0160b9-ee92-4963-8580-35ee4c4e0115"],
Cell[896480, 20696, 4121, 89, 621, "Input", "ExpressionUUID" -> \
"2118618c-0d31-452d-bf70-1cba67db85f8"]
}, Closed]],
Cell[CellGroupData[{
Cell[900638, 20790, 105, 0, 41, "Section", "ExpressionUUID" -> \
"ad615207-2894-43a9-bfef-323c7915f646"],
Cell[CellGroupData[{
Cell[900768, 20794, 106, 0, 44, "Subsection", "ExpressionUUID" -> \
"a2cf5fbf-edcd-42c9-b93e-9eb976a14f90"],
Cell[900877, 20796, 13951, 309, 1272, "Input", "ExpressionUUID" -> \
"3848fc14-cb3c-490b-b8a1-ad91f4f8b860"]
}, Closed]],
Cell[CellGroupData[{
Cell[914865, 21110, 104, 0, 44, "Subsection", "ExpressionUUID" -> \
"10f07e07-34fc-4220-8a21-a3eb00309499"],
Cell[914972, 21112, 8821, 203, 1041, "Input", "ExpressionUUID" -> \
"7ce07ca3-1a15-4be7-83dc-1bef45525d91"]
}, Closed]],
Cell[CellGroupData[{
Cell[923830, 21320, 104, 0, 44, "Subsection", "ExpressionUUID" -> \
"83a3d458-8c5b-4aa4-8bc6-eea1498d6935"],
Cell[923937, 21322, 14105, 339, 1629, "Input", "ExpressionUUID" -> \
"8229a709-2256-4e30-878e-08207d4094fc"]
}, Closed]],
Cell[CellGroupData[{
Cell[938079, 21666, 101, 0, 44, "Subsection", "ExpressionUUID" -> \
"679b9093-9334-48f6-a3cc-a847083b4cf4"],
Cell[938183, 21668, 5634, 156, 495, "Input", "ExpressionUUID" -> \
"0f6977c2-a805-4426-9939-4b31328793f0"],
Cell[943820, 21826, 10654, 233, 1104, "Input", "ExpressionUUID" -> \
"372d5585-925a-4c9b-9d06-1695f01d76ed"]
}, Closed]],
Cell[CellGroupData[{
Cell[954511, 22064, 89, 0, 44, "Subsection", "ExpressionUUID" -> \
"b6183c3f-198d-4310-a042-187dfd9e97cd"],
Cell[954603, 22066, 593, 13, 96, "Input", "ExpressionUUID" -> \
"7b500c7f-6f5f-4fd8-82dd-4dcc30079e6e"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[955245, 22085, 103, 0, 41, "Section", "ExpressionUUID" -> \
"41ee9fc2-32ca-44ba-aa06-7a9d0dfebbee"],
Cell[955351, 22087, 4739, 118, 569, "Input", "ExpressionUUID" -> \
"14dff1c9-b9d5-4e9c-90ec-06024e560897"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

