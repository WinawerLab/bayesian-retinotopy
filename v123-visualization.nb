(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    347981,       8076]
NotebookOptionsPosition[    342655,       7906]
NotebookOutlinePosition[    343694,       7937]
CellTagsIndexPosition[    343651,       7934]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
V1, V2, and V3 Retinotopic Maps:
Visualizations\
\>", "Title"],

Cell[TextData[{
 "Noah C. Benson",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]]],
 ", Geoff K. Aguirre",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "2"], TraditionalForm]]],
 ", Jonathan Winawer",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", 
    RowBox[{"1", ",", "3"}]], TraditionalForm]]],
 "\[LineSeparator]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "1"], TraditionalForm]],
  FontSize->18],
 StyleBox["Department of Psychology, New York University, New York, NY, USA\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "2"], TraditionalForm]],
  FontSize->18],
 StyleBox["Department of Neurology, University of Pennsylvania, Philadelphia, \
PA, USA\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "3"], TraditionalForm]],
  FontSize->18],
 StyleBox["Center for Neural Sciences, New York University, New York, NY, USA",
  FontSize->18]
}], "Chapter"],

Cell[CellGroupData[{

Cell["Header", "Chapter"],

Cell["\<\
This section includes all code that:
  (a) defines a piece of data
  (b) configures the environment
  (c) constructs a library of tools for visualization and analysis
All code in this section should either run very quickly or should be defined \
using MemoizeSafe, AutoCache, and/or AutoManageData so as to run immediately \
and load data or perform calculations lazily when requested. Accordingly, \
this section should evaluate quickly, much like loading a project library.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Introduction", "Subchapter"],

Cell[CellGroupData[{

Cell["Dependencies", "Section"],

Cell[BoxData[{
 RowBox[{"<<", "ErrorBarPlots`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Neurotica`"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Paths", "Section"],

Cell["\<\
This notebook expects to be able to access data in the V123 data root, the \
contents of which can be downloaded from the open science framework \
(http://osf.io/). If you have the V123_DATA_ROOT environment variable set \
correctly, or if this notebook is in the root, then this cell should find the \
root fine; otherwise, you may need to set it manually.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$DataRoot", ",", "$V123VisualizationNotebookDirectory"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$V123VisualizationNotebookDirectory", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$DataRoot", ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"env", "=", 
         RowBox[{"Environment", "[", "\"\<V123_DATA_ROOT\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"loc", "=", "$V123VisualizationNotebookDirectory"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"env", "=!=", "$Failed"}], ",", "env", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<analyses\>\""}], "}"}], "]"}], ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<freesurfer_subjects\>\""}], "}"}], 
              "]"}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "loc", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"And", "@@", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{"DirectoryQ", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"loc", ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"loc", ",", "\"\<data_root\>\""}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "True", ",", "$Failed"}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input"],

Cell["\<\
These data simply define directories in terms of the above data root:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FreeSurferRoot", ",", "$AnalysesRoot", ",", "$RetinotopyRoot", ",", 
    "$FigureRoot"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FreeSurferRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<freesurfer_subjects\>\""}], "}"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AnalysesRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<analyses\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RetinotopyRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<retinotopy\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FigureRoot", ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", ":", 
       RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"s", ",", "\"\<figures\>\""}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input"],

Cell["We also want to correctly set Neurotica\[CloseCurlyQuote]s cache \
directory:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CacheDirectory", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$CacheDirectory", ":=", 
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{"$DataRoot", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", ":", 
        RowBox[{"Except", "[", "$Failed", "]"}]}], "\[RuleDelayed]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"s", ",", "\"\<cache\>\"", ",", "\"\<mma\>\""}], "}"}], 
        "]"}]}]}], "]"}]}], "]"}], ";"}]}], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing Data", "Subchapter"],

Cell["\<\
In this section of the notebook, we import the data from the retinotopy and \
analyses directories; we setup subject datasets according to these \
\>", "Text"],

Cell[CellGroupData[{

Cell["The list of subjects", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"$Subjects", ",", "$SubjectDatasets"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Subjects", ":=", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FileNames", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$RetinotopyRoot", ",", "\"\<S*\>\""}], "}"}], "]"}]}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$SubjectDatasets", ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "\[Rule]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fs", "=", 
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FileNames", "@", 
                RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                  "$RetinotopyRoot", ",", "sub", ",", 
                   "\"\<lh_*_angle.mgz\>\""}], "}"}], "]"}]}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Union", "@", 
            RowBox[{"ToExpression", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "5"}], "}"}]}], "]"}], "&"}], "/@", 
              "fs"}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"sub", ",", "$Subjects"}], "}"}]}], "]"}]}]}]}], "]"}], 
  ";"}]}], "Input"],

Cell["\<\
Simple function to return the fraction of total scans that went into a \
particular dataset.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SubjectScanCount", ",", "SubjectDatasetCoverage"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectScanCount", "[", "sub_", "]"}], ":=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"StringTake", "[", 
     RowBox[{"sub", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectDatasetCoverage", "[", 
    RowBox[{"sub_", ",", "ds_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"scans", "=", 
        RowBox[{"SubjectScanCount", "[", "sub", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fnm", "=", 
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "@", 
          RowBox[{"First", "@", 
           RowBox[{"FileNames", "@", 
            RowBox[{"FileNameJoin", "@", 
             RowBox[{"List", "[", "\[IndentingNewLine]", 
              RowBox[{
              "$RetinotopyRoot", ",", "sub", ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<lh_\>\"", "<>", 
                RowBox[{"IntegerString", "[", 
                 RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                "\"\<:*_angle.mgz\>\""}]}], "]"}]}]}]}]}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "@", 
      RowBox[{"StringTake", "[", 
       RowBox[{"fnm", ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "8"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading subject surface data", "Section"],

Cell["\<\
These cells just import the mgz files in the analyses directory and organize \
them into a convenient data structure.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "SubjectRetinotopyData", ",", "SubjectAnalysesData", ",", 
    "SubjectBenson14Data", ",", "SubjectData"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubjectRetinotopyData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FileNames", "@", 
               RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "$RetinotopyRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                  RowBox[{"StringJoin", "@", 
                   RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], "<>", 
                    "\"\<:*\>\""}], ",", 
                    RowBox[{"#1", "<>", "\"\<.mgz\>\""}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\"\<_\>\""}], "]"}]}]}], "}"}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<prfsz\>\"", ",", 
            "\"\<vexpl\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<PRFSize\>\"", ",", "\"\<VarianceExplained\>\""}], "}"}]}], 
         "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectAnalysesData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "@", 
           RowBox[{"Rule", "[", "\[IndentingNewLine]", 
            RowBox[{"#2", ",", "\[IndentingNewLine]", 
             RowBox[{"Import", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                  RowBox[{"StringJoin", "@", 
                   RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], ",", 
                    "\"\<.predict_\>\"", ",", "\[IndentingNewLine]", "#1", 
                    ",", "\"\<.\>\"", ",", 
                    RowBox[{"IntegerString", "[", 
                    RowBox[{"ds", ",", "10", ",", "2"}], "]"}], ",", 
                    "\"\<.mgz\>\""}], "]"}]}]}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<v123roi\>\""}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
              "\"\<VisualArea\>\""}], "}"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ds", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"Outer", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "@", 
              RowBox[{"Rule", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Magnification\>\"", "<>", "#1", "<>", "#2"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Import", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"FileNameJoin", "@", 
                   RowBox[{"List", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "$AnalysesRoot", ",", "sub", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", 
                    "\"\<.cm_\>\"", "<>", 
                    RowBox[{"ToLowerCase", "[", "#1", "]"}], "<>", 
                    "\"\<_\>\"", "<>", 
                    RowBox[{"ToLowerCase", "[", "#2", "]"}], "<>", 
                    "\"\<.mgz\>\""}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], 
                 "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<Pial\>\"", ",", "\"\<White\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", 
               "\"\<Tangential\>\""}], "}"}], ",", "\[IndentingNewLine]", "1",
              ",", "1"}], "]"}]}]}], "]"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectBenson14Data", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "@", 
         RowBox[{"Rule", "[", "\[IndentingNewLine]", 
          RowBox[{"#2", ",", "\[IndentingNewLine]", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"List", "[", "\[IndentingNewLine]", 
               RowBox[{"$AnalysesRoot", ",", "sub", ",", 
                RowBox[{
                 RowBox[{"ToLowerCase", "@", 
                  RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", "\"\<.\>\"",
                  "<>", "#1", "<>", "\"\<_benson14.mgz\>\""}]}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<GZIP\>\"", ",", "\"\<MGH\>\""}], "}"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<angle\>\"", ",", "\"\<eccen\>\"", ",", "\"\<v123roi\>\""}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<VisualArea\>\""}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubjectData", "[", 
      RowBox[{"sub_", ",", 
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rdat", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"adat", "=", 
          RowBox[{"SubjectAnalysesData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rgs", "=", 
          RowBox[{"SubjectRetinotopyData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ags", "=", 
          RowBox[{"SubjectAnalysesData", "[", 
           RowBox[{"sub", ",", "hemi", ",", "0"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"b14", "=", 
          RowBox[{"SubjectBenson14Data", "[", 
           RowBox[{"sub", ",", "hemi"}], "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"This", " ", "is", " ", "the", " ", "vexpl"}], "-", "to", 
           "-", 
           RowBox[{
           "weight", " ", "transform", " ", "used", " ", "in", " ", "the", 
            " ", "python", " ", "library", " ", "v123"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"vexplToWeight", "=", 
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"#", ">", "0.2"}], "&"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Erf", "@", 
              RowBox[{"Times", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"InverseErf", "[", "0.5", "]"}], "/", 
                 RowBox[{"Median", "[", "w", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Unitize", "[", "#", "]"}], "*", "#"}]}], "]"}]}]}], 
            "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<PRFSize\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<VarianceExplained\>\"", "\[Rule]", 
             RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Weight\>\"", "\[Rule]", 
             RowBox[{"vexplToWeight", "@", 
              RowBox[{"rdat", "[", "\"\<VarianceExplained\>\"", "]"}]}]}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<Benson14PolarAngle\>\"", "\[Rule]", 
             RowBox[{"b14", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Benson14Eccentricity\>\"", "\[Rule]", 
             RowBox[{"b14", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Benson14VisualArea\>\"", "\[Rule]", 
             RowBox[{"b14", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<PredictedPolarAngle\>\"", "\[Rule]", 
             RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<PredictedEccentricity\>\"", "\[Rule]", 
             RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<PredictedVisualArea\>\"", "\[Rule]", 
             RowBox[{"adat", "[", "\"\<VisualArea\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<ResidualPolarAngle\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}], "-", 
               RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], ")"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<ResidualEccentricity\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}], "-", 
               RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}], ")"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<ResidualAngle\>\"", "\[Rule]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pang", "=", 
                  RowBox[{
                   RowBox[{"Pi", "/", "180"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"adat", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"pecc", "=", 
                  RowBox[{"adat", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"gang", "=", 
                  RowBox[{
                   RowBox[{"Pi", "/", "180"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"gecc", "=", 
                  RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pxy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pecc", "*", 
                    RowBox[{"Cos", "[", "pang", "]"}]}], ",", 
                    RowBox[{"pecc", "*", 
                    RowBox[{"Sin", "[", "pang", "]"}]}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"gxy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"gecc", "*", 
                    RowBox[{"Cos", "[", "gang", "]"}]}], ",", 
                    RowBox[{"gecc", "*", 
                    RowBox[{"Sin", "[", "gang", "]"}]}]}], "}"}]}]}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"ColumnNorms", "[", 
                  RowBox[{"gxy", "-", "pxy"}], "]"}]}], "]"}]}], "]"}]}], ",",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldPolarAngle\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<PolarAngle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldEccentricity\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldPRFSize\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<PRFSize\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldVarianceExplained\>\"", "\[Rule]", 
             RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<GoldWeight\>\"", "\[Rule]", 
             RowBox[{"vexplToWeight", "@", 
              RowBox[{"rgs", "[", "\"\<VarianceExplained\>\"", "]"}]}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nm", "\[Rule]", 
             RowBox[{"ags", "[", "nm", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"nm", ",", 
              RowBox[{"Join", "@@", 
               RowBox[{"Outer", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\"\<Magnification\>\"", "<>", "#1", "<>", "#2"}], 
                  "&"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<White\>\"", ",", "\"\<Pial\>\""}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Areal\>\"", ",", "\"\<Radial\>\"", ",", 
                   "\"\<Tangential\>\""}], "}"}], ",", "\[IndentingNewLine]", 
                 "1", ",", "1"}], "]"}]}]}], "}"}]}], "]"}]}], "]"}]}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading subject meshes and maps", "Section"],

Cell["Here we just cache the FreeSurfer subject objects.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Subject", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Subject", "[", "sub_String", "]"}], ":=", 
    RowBox[{"FreeSurferSubject", "@", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"$FreeSurferRoot", ",", "sub"}], "}"}], "]"}]}]}], "]"}], 
  ";"}]}], "Input"],

Cell["\<\
Here, we create a subject mesh and apply all the subject\[CloseCurlyQuote]s \
data to it.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectMesh", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectMesh", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "surf_String", ",", "ds_Integer"}], 
     "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdat", "=", 
         RowBox[{"SubjectData", "[", 
          RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"msh", "=", 
         RowBox[{"Cortex", "[", 
          RowBox[{
           RowBox[{"Subject", "[", "sub", "]"}], ",", "hemi", ",", "surf"}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SetVertexProperties", "[", 
       RowBox[{"msh", ",", 
        RowBox[{"Normal", "[", "sdat", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input"],

Cell["\<\
This cell creates a template map projection that is a duplicate of the one \
found in the standard.ffm.gz file distributed with the Neuropythy library \
(this is the V123 model used in registration).\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SymToMap", ",", "SubjectMap"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymToMap", "::", "usage"}], "=", 
    "\"\<SymToMap[mesh, hemi] projects the given fsaverage_sym-aligned \
spherical mesh to a map; if hemi is RH, then reverses this so that it \
resembles a right-hemisphere projection.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymToMap", "[", 
     RowBox[{"mesh_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"map0", "=", 
        RowBox[{"CorticalMap", "[", "\[IndentingNewLine]", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"Center", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"14.6527", ",", 
               RowBox[{"-", "79.1814"}], ",", 
               RowBox[{"-", "50.0635"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"66.23000", ",", 
               RowBox[{"-", "47.09000"}], ",", 
               RowBox[{"-", "58.28000"}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", "\"\<Equirectangular\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Radius", "\[Rule]", 
           RowBox[{"Quantity", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"Pi", "/", "4"}], "]"}], ",", "\"\<Radians\>\""}], 
            "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"hemi", "===", "LH"}], ",", "\[IndentingNewLine]", "map0", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"CorticalMap", "[", 
         RowBox[{"map0", ",", 
          RowBox[{"VertexCoordinates", "\[Rule]", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
             RowBox[{"VertexCoordinatesTr", "[", "map0", "]"}]}], "]"}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectMap", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "ds_Integer"}], "]"}], ":=", 
    RowBox[{"SymToMap", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SubjectMesh", "[", 
       RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "ds"}], "]"}], 
      ",", "\[IndentingNewLine]", "hemi"}], "]"}]}], "]"}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading cortical magnification path data", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectPathData", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectPathData", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", 
      RowBox[{"surf", ":", 
       RowBox[{"\"\<White\>\"", "|", "\"\<Pial\>\""}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flbase", "=", 
        RowBox[{
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"ToString", "[", "hemi", "]"}]}], "<>", "\"\<.cmpath_\>\"", 
         "<>", 
         RowBox[{"ToLowerCase", "[", "surf", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"angFiles", "=", 
           RowBox[{"FileNames", "@", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{"$AnalysesRoot", ",", "sub", ",", 
               RowBox[{"flbase", "<>", "\"\<_*_ang=*.dat\>\""}]}], "}"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"eccFiles", "=", 
           RowBox[{"FileNames", "@", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{"$AnalysesRoot", ",", "sub", ",", 
               RowBox[{"flbase", "<>", "\"\<_*_ecc=*.dat\>\""}]}], "}"}], 
             "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"parsed", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"nm", "=", 
                  RowBox[{"Last", "@", 
                   RowBox[{"FileNameSplit", "[", "flnm", "]"}]}]}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"parts", "=", 
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"nm", ",", 
                    RowBox[{
                    "\"\<_ecc=\>\"", "|", "\"\<_ang=\>\"", "|", 
                    "\"\<.dat\>\"", "|", "\"\<_\>\""}]}], "]"}]}], "}"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"flnm", ",", 
                    RowBox[{"parts", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"N", "@", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"parts", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
                 "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"fls", ",", 
                RowBox[{"{", 
                 RowBox[{"angFiles", ",", "eccFiles"}], "}"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"flnm", ",", "fls"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"asc0", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "@", 
                  RowBox[{"Rule", "[", "\[IndentingNewLine]", 
                   RowBox[{"#1", ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", "=", 
                    RowBox[{"GroupBy", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k", "\[Rule]", 
                    RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"part", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"raw", "=", 
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{"part", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Table\>\""}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#2", ",", "#3", ",", "#4"}], "}"}], "]"}], ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"#5", ",", "#6"}], "}"}], "]"}]}], "}"}], "&"}], "@@@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", ",", "\[IndentingNewLine]", 
                    RowBox[{"GatherBy", "[", 
                    RowBox[{"raw", ",", "First"}], "]"}]}], "]"}]}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"part", ",", 
                    RowBox[{"p", "[", "k", "]"}]}], "}"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Keys", "[", "p", "]"}]}], "}"}]}], "]"}]}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Isoangular\>\"", ",", "\"\<Isoeccentric\>\""}], 
                    "}"}], ",", "parsed"}], "}"}]}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Fix", " ", "up", " ", "the", " ", 
               RowBox[{"VL", "/", "DL"}], " ", "so", " ", "that", " ", 
               RowBox[{"it", "'"}], "s", " ", "in", " ", "both", " ", "V2", 
               " ", "and", " ", "V3"}], ";", " ", 
              RowBox[{"also", " ", "add", " ", 
               RowBox[{"V1", "'"}], "s", " ", "borders", " ", "to", " ", 
               "V2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"#", ",", 
                RowBox[{"\"\<Isoangular\>\"", "\[Rule]", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Isoangular\>\"", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "\"\<VL\>\"", "}"}], ",", 
                    RowBox[{"{", "\"\<DL\>\"", "}"}]}], "}"}]}], "]"}]}]}], 
               "]"}], "&"}], "@", 
             RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
              RowBox[{"asc0", ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Isoangular\>\"", ",", "\"\<V2\>\""}], "}"}], 
                  "\[Rule]", 
                  RowBox[{"Append", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V2\>\"", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<90V\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<VL\>\"", "]"}], "[", "90.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<90D\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<DL\>\"", "]"}], "[", "90.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0.0", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V1\>\"", "]"}], "[", "0.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"180.0", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V1\>\"", "]"}], "[", "180.0", "]"}]}]}], "}"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Isoangular\>\"", ",", "\"\<V3\>\""}], "}"}], 
                  "\[Rule]", 
                  RowBox[{"Append", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<V3\>\"", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<90V\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<VL\>\"", "]"}], "[", "90.0", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<90D\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"asc0", "[", "\"\<Isoangular\>\"", "]"}], "[", 
                    "\"\<DL\>\"", "]"}], "[", "90.0", "]"}]}]}], "}"}]}], 
                   "]"}]}]}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "SubjectPath", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectPath", "[", 
     RowBox[{"sub_", ",", 
      RowBox[{"hemi", ":", 
       RowBox[{"LH", "|", "RH"}]}], ",", "meshName_String"}], "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ToLowerCase", "[", "meshName", "]"}], "\[Equal]", 
       "\"\<white\>\""}], ",", 
      RowBox[{"SubjectPathData", "[", 
       RowBox[{"sub", ",", "hemi", ",", "\"\<White\>\""}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToLowerCase", "[", "meshName", "]"}], "\[Equal]", 
       "\"\<pial\>\""}], ",", 
      RowBox[{"SubjectPathData", "[", 
       RowBox[{"sub", ",", "hemi", ",", "\"\<Pial\>\""}], "]"}], ",", 
      "\[IndentingNewLine]", "True", ",", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"omesh", "=", 
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "meshName", ",", "0"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"wmesh", "=", 
           RowBox[{"SubjectMesh", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<White\>\"", ",", "0"}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Association", "@", 
         RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"#1", "\[Rule]", 
             RowBox[{"Association", "@", 
              RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{"#1", "\[Rule]", 
                  RowBox[{"Association", "@", 
                   RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"CortexLookup", "[", 
                    RowBox[{"omesh", ",", 
                    RowBox[{"CortexAddress", "[", 
                    RowBox[{"wmesh", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
                    "\[IndentingNewLine]", "#2"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "#2"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", "#2"}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"SubjectPathData", "[", 
            RowBox[{"sub", ",", "hemi", ",", "\"\<White\>\""}], "]"}]}], 
          "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting/Analysis Code", "Subchapter",
 CellChangeTimes->{{3.662807324689231*^9, 3.662807328992319*^9}, 
   3.6628132807895737`*^9}],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.658508587333959*^9, 3.658508589721416*^9}, {
  3.662853387814995*^9, 3.662853389412607*^9}}],

Cell[CellGroupData[{

Cell["Default Styles for Figures", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$FontFamily", ",", "$FontWeight", ",", "$FontSize", ",", "$BaseStyle"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontFamily", "=", "\"\<Helvetica Neue\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontWeight", "=", "\"\<Light\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FontSize", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$BaseStyle", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{"$FontSize", ",", 
     RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}]}], "]"}]}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auto-Cache Exported Images", "Subsection",
 CellChangeTimes->{{3.662845319835968*^9, 3.6628453308192596`*^9}, {
  3.662853392948634*^9, 3.662853395036529*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"AutoCachePNG", ",", "AutoCachePDF"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePNG", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoCachePNG", "[", 
     RowBox[{"name_", ",", "code_"}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flnm", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"#", ",", 
               RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.png\>\""}], ",",
             "#", ",", 
            RowBox[{"#", "<>", "\"\<.png\>\""}]}], "]"}], "&"}], "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"Prepend", "[", 
             RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"img", "=", 
            RowBox[{"Image", "[", 
             RowBox[{"code", ",", 
              RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{"flnm", ",", "img", ",", "\"\<PNG\>\"", ",", 
             RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "AutoCachePDF", "]"}], "=", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoCachePDF", "[", 
    RowBox[{"name_", ",", "code_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"flnm", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"-", "4"}]}], "]"}], "\[Equal]", "\"\<.pdf\>\""}], ",", 
           "#", ",", 
           RowBox[{"#", "<>", "\"\<.pdf\>\""}]}], "]"}], "&"}], "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "[", "name", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Prepend", "[", 
            RowBox[{"name", ",", "$FigureRoot"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"$FigureRoot", ",", "name"}], "}"}], "]"}]}], "]"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Import", "[", "flnm", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"img", "=", "code"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"flnm", ",", "img", ",", "\"\<PDF\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", "img"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Color Functions", "Subsection",
 CellChangeTimes->{{3.676117055363916*^9, 3.676117057478757*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "RetinotopyColor", ",", "$CMagBlendColors", ",", "$PRFBlendColors"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RetinotopyColor", "::", "usage"}], "=", 
    "\"\<RetinotopyColor[\\\"PolarAngle\\\"] and \
RetinotopyColor[\\\"Eccentricity\\\"] both yield functions appropriate for \
use with CortexPlot and CortexPlot3D which deduce whether the map/mesh is a \
raw data or predicted mesh and color it appropriately. Color schemas \
\\\"Magnification\\\" and \\\"PRFSize\\\" also plot the appropriate data.\n\
RetinotopyColor[name -> \\\"PolarAngle\\\"] can alternately be used to tell \
RetinotopyColor that the property with the given name should be colored as if \
it were PolarAngle.\n\nThe following options may be used:\n * Range (default: \
Automatic) specifies that only the eccentricity range given will be plotted; \
this may be given as a single max eccentricity or as {min, max}.\n * \
Eccentricity, VisualArea, and Weights may all be given strings, which change \
the default name of the property used in determining whether a vertex should \
be plotted and its transparency.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "RetinotopyColor", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Eccentricity", "\[Rule]", "\"\<Eccentricity\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VisualArea", "\[Rule]", "\"\<VisualArea\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Weights", "\[Rule]", "\"\<Weight\>\""}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CMagBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Black"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Brown"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"3.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Red"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"9.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "Yellow"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"27.0", ",", 
       RowBox[{"Opacity", "[", 
        RowBox[{"1", ",", "White"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PRFBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", "White"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"6.0", ",", "Black"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PolarAngleErrorBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "30.0"}], ",", "White"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "20.0"}], ",", "Yellow"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10.0"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"10.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"20.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"30.0", ",", "White"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EccentricityErrorBlendColors", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5"}], ",", "White"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.0"}], ",", "Yellow"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1.5", ",", "White"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$AngleErrorBlendColors", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3.0"}], ",", "White"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.0"}], ",", "Yellow"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.0"}], ",", "Red"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "Black"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.0", ",", "Blue"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"2.0", ",", "Cyan"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"3.0", ",", "White"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", ":", 
      RowBox[{
      "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
       "\"\<Magnification\>\"", "|", "\"\<CMag\>\"", "|", 
       "\"\<PRFSize\>\""}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"RetinotopyColor", "[", 
    RowBox[{
     RowBox[{"type", "\[Rule]", "type"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RetinotopyColor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prop_String", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"type", ":", 
        RowBox[{
        "\"\<PolarAngle\>\"", "|", "\"\<Eccentricity\>\"", "|", 
         "\"\<Magnification\>\"", "|", "\"\<PRFSize\>\""}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"range", "=", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Automatic", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "90"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"n_", "?", "NumberQ"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "n"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eccenName", "=", 
        RowBox[{"OptionValue", "[", "Eccentricity", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"areasName", "=", 
        RowBox[{"OptionValue", "[", "VisualArea", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"weightName", "=", 
        RowBox[{"OptionValue", "[", "Weights", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vertexOkayFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", "eccenName"}], "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"NumberQ", "[", 
               RowBox[{"#", "[", "eccenName", "]"}], "]"}]}]}], ",", "False", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"range", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
               RowBox[{"#", "[", "eccenName", "]"}], "\[LessEqual]", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", "False", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"NumberQ", "@", 
                 RowBox[{"#", "[", "areasName", "]"}]}]}], "||", 
               RowBox[{
                RowBox[{"#", "[", "areasName", "]"}], "\[Equal]", "0"}]}], 
              ")"}]}], ",", "False", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
             RowBox[{
              RowBox[{"#", "[", "weightName", "]"}], "\[LessEqual]", "0"}]}], 
            ",", "False", ",", "\[IndentingNewLine]", "True", ",", "True"}], 
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<CMag\>\""}], "||", 
          RowBox[{"type", "\[Equal]", "\"\<Magnification\>\""}]}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$CMagBlendColors", ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<CMag2\>\"", ",", "\"\<Magnification2\>\"", ",", 
             "\"\<MagnificationSquared\>\"", ",", "\"\<CMagSquared\>\""}], 
            "}"}], ",", "type"}], "]"}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$CMagBlendColors", ",", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"#", "[", "prop", "]"}], "]"}]}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<PRFSize\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", 
               RowBox[{"#", "[", "prop", "]"}], "]"}]}], "||", 
             RowBox[{
              RowBox[{"#", "[", "prop", "]"}], "\[Equal]", "0"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"Blend", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"CorticalCurvatureColor", "[", 
                 RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Blend", "[", 
                 RowBox[{"$PRFBlendColors", ",", 
                  RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"#", ",", "weightName"}], "]"}], ",", 
                RowBox[{"#", "[", "weightName", "]"}], ",", "0.65"}], "]"}]}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<PolarAngleError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$PolarAngleErrorBlendColors", ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<EccentricityError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$EccentricityErrorBlendColors", ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"type", "\[Equal]", "\"\<AngleError\>\""}], ",", 
         RowBox[{"Function", "@", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\"\<Curvature\>\"", ",", "\[IndentingNewLine]", "True", ",", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$AngleErrorBlendColors", ",", 
                    RowBox[{"#", "[", "prop", "]"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Function", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"vertexOkayFn", "[", "#", "]"}]}], ",", 
            "\[IndentingNewLine]", "\"\<Curvature\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"w", "=", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "areasName"}], "]"}], "&&", 
                   RowBox[{"NumberQ", "@", 
                    RowBox[{"#", "[", "areasName", "]"}]}]}], ",", "0.65", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"#", ",", "weightName"}], "]"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", "weightName", "]"}], ">", "0"}]}], ",", 
                  
                  RowBox[{"#", "[", "weightName", "]"}], ",", 
                  "\[IndentingNewLine]", "True", ",", "0"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Blend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"CorticalCurvatureColor", "@", 
                   RowBox[{"#", "[", "\"\<Curvature\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"CorticalColorData", "[", "type", "]"}], "[", 
                   RowBox[{"<|", 
                    RowBox[{"type", "\[Rule]", 
                    RowBox[{"#", "[", "prop", "]"}]}], "|>"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", "w"}], "]"}]}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a Direction Compass on the Maps", "Subsection",
 CellChangeTimes->{{3.676119297276575*^9, 3.676119301843574*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "MapCompass", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapCompass", "::", "usage"}], "=", 
    "\"\<MapCompass[hemi] yields a Graphics object that represents the \
appropriate directions compass (dorsal/ventral, medial/lateral indicator) for \
the given hemisphere's map projections.\nMapCompass[hemi, style] uses the \
given style for the compass arrows.\nMapCompass accepts all the options \
appropriate for Graphics as well as the Style option, which may be a list of \
any options appropriate for Style; these are used to format the text.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MapCompass", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Options", "[", "Graphics", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Scale", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Center", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapCompass", "[", 
    RowBox[{
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", 
     RowBox[{"style_:", 
      RowBox[{"{", "White", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sty", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Style", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "$FontFamily"}], ",", 
            RowBox[{"FontSize", "\[Rule]", "$FontSize"}], ",", 
            RowBox[{"FontColor", "\[Rule]", "White"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "$FontWeight"}]}], "}"}]}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Scale", "]"}], "/.", 
         RowBox[{"Automatic", "\[Rule]", "10"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"medlat", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"hemi", "===", "LH"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"center", "=", 
        RowBox[{"OptionValue", "[", "Center", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
         RowBox[{"{", "style", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"center", "+", 
             RowBox[{"xy", "*", "scale", "*", "0.9"}]}]}], "}"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"xy", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<D\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", "scale"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<V\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "scale"}]}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<L\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", 
               RowBox[{"-", "scale"}]}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "+", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"WithOptions", "[", 
            RowBox[{
             RowBox[{"Style", "[", "\"\<M\>\"", "]"}], ",", "sty"}], "]"}], 
           ",", 
           RowBox[{"center", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"medlat", "*", "scale"}], ",", "0"}], "}"}]}], ",", 
           RowBox[{"ImageScaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", "-", 
               RowBox[{"0.5", "*", "medlat"}]}], ",", "0.5"}], "}"}], "]"}]}],
           "]"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Common Patterns", "Subsection"],

Cell["\<\
These variables are common patterns that we want to be used commonly \
throughout the notebook.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$EmpiricalPattern", ",", "$GoldPattern", ",", "$PredictedPattern"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$EmpiricalPattern", "=", 
   RowBox[{
   "\"\<Empirical\>\"", "|", "\"\<Measured\>\"", "|", "\"\<PRF\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$GoldPattern", "=", 
   RowBox[{
   "\"\<Gold\>\"", "|", "\"\<GoldStandard\>\"", "|", "\"\<Validation\>\""}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PredictedPattern", "=", 
   RowBox[{
   "\"\<Predicted\>\"", "|", "\"\<Prediction\>\"", "|", "\"\<Fit\>\"", "|", 
    "\"\<Model\>\""}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Handling the V123 Model", "Subsection"],

Cell["\<\
Note that, if you do not have the cache file, the $V123Model will take quite \
awhile to generate the first time it is evaluated.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$V123Model", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$V123Model", ":=", 
    RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<v123model\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        RowBox[{"$V123Model", "[", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FindArgMin", "::", "cvmitt"}], ",", 
          RowBox[{"FindArgMin", "::", "lstol"}]}], "}"}]}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input"],

Cell["These functions generate lines for use in figures.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "V123FigLines", ",", "V123FigBoundary", ",", "$VisualFieldToFigData", ",", 
    "$VisualFieldToFigFn", ",", "$FigToVisualFieldFn", ",", 
    "VisualFieldFnToV123FigFn"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"V123FigLines", "[", "maxEcc_", "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vbs", "=", 
          RowBox[{"$V123Model", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<V1BoundaryMesh\>\"", ",", "\"\<V2BoundaryMesh\>\"", ",", 
             "\"\<V3BoundaryMesh\>\""}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ecc", "=", 
          RowBox[{"$V123Model", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"msh", "=", 
          RowBox[{"$V123Model", "[", "\"\<Mesh\>\"", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"outer", "=", 
            RowBox[{"ConvexHullMesh", "@", 
             RowBox[{"Pick", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"MeshCoordinates", "[", "msh", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Sign", "[", 
                RowBox[{"ecc", "-", "maxEcc"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"0", "|", 
                RowBox[{"-", "1"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"iidcs", "=", 
            RowBox[{"Pick", "[", 
             RowBox[{
              RowBox[{"Range", "@", 
               RowBox[{"Length", "[", "ecc", "]"}]}], ",", 
              RowBox[{"Sign", "[", 
               RowBox[{"ecc", "-", "maxEcc"}], "]"}], ",", 
              RowBox[{"0", "|", 
               RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"X", "=", 
            RowBox[{"MeshCoordinates", "[", "msh", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"v1b", "=", 
            RowBox[{"vbs", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"v2b", "=", 
            RowBox[{"RegionUnion", "[", 
             RowBox[{
              RowBox[{"vbs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vbs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"v3b", "=", 
            RowBox[{"RegionUnion", "@@", "vbs"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"hulls", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ConvexHullMesh", "[", 
                  RowBox[{"X", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "@", 
                RowBox[{"Pick", "[", "\[IndentingNewLine]", 
                 RowBox[{"iidcs", ",", "\[IndentingNewLine]", 
                  RowBox[{"Sign", "@", 
                   RowBox[{"SignedRegionDistance", "[", 
                    RowBox[{"reg", ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"[", "iidcs", "]"}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"0", "|", 
                   RowBox[{"-", "1"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"reg", ",", 
                 RowBox[{"{", 
                  RowBox[{"v1b", ",", "v2b", ",", "v3b"}], "}"}]}], "}"}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Join", "@@", 
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", "=", 
                   RowBox[{"MeshCoordinates", "[", "#", "]"}]}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"MeshCells", "[", 
                   RowBox[{"#", ",", "1"}], "]"}], "/.", 
                  RowBox[{
                   RowBox[{"Line", "[", "i_", "]"}], "\[RuleDelayed]", 
                   RowBox[{"Line", "[", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], "&"}],
               ",", "\[IndentingNewLine]", "hulls"}], "]"}]}]}], "]"}]}], 
        "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V123FigBoundary", "[", "maxEcc_", "]"}], ":=", 
     RowBox[{"ConvexHullMesh", "@", 
      RowBox[{"Union", "@", 
       RowBox[{"Apply", "[", 
        RowBox[{"Join", ",", 
         RowBox[{
          RowBox[{"V123FigLines", "[", "maxEcc", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$VisualFieldToFigData", ":=", 
     RowBox[{"V123MeshFunctions", "[", 
      RowBox[{"$V123Model", ",", "None"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$VisualFieldToFigFn", ":=", 
     RowBox[{
     "$VisualFieldToFigData", "[", "\"\<VisualFieldToCorticalMap\>\"", 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FigToVisualFieldFn", ":=", 
     RowBox[{
     "$VisualFieldToFigData", "[", "\"\<CorticalMapToVisualField\>\"", 
      "]"}]}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VisualFieldFnToV123FigFn", "[", "f_", "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fns", "=", 
         RowBox[{"PadRight", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", "f", "]"}], ",", "f", ",", 
             RowBox[{"{", "f", "}"}]}], "]"}], ",", "5", ",", "None"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"frommap", "=", "$FigToVisualFieldFn"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Function", "@", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"datPost", "=", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"ListQ", "[", 
                 RowBox[{
                  RowBox[{"{", "##", "}"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                RowBox[{"ListQ", "[", 
                 RowBox[{
                  RowBox[{"{", "##", "}"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "##", "}"}], "]"}], ",", "Identity"}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ListQ", "[", 
                RowBox[{
                 RowBox[{"{", "##", "}"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"#1", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", "#1", "]"}]}], "]"}]}], "}"}], 
                  "]"}], ",", "Identity"}], "}"}], " ", ",", 
               RowBox[{"ListQ", "[", 
                RowBox[{
                 RowBox[{"{", "##", "}"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", "##", "}"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                 ",", "Identity"}], "}"}], ",", "\[IndentingNewLine]", "True",
                ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", "##", "}"}], "}"}], ",", "First"}], "}"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"MatrixQ", "[", "#", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], ",",
                  "#", ",", 
                 RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], ",", 
               "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"VectorQ", "[", "#", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "#", "}"}], ",", "First"}], "}"}], ",", "True", 
             ",", 
             RowBox[{"{", 
              RowBox[{"#", ",", "Identity"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dat", "=", 
              RowBox[{"datPost", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"post", "=", 
              RowBox[{"datPost", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ptsAndAreas", "=", 
               RowBox[{"frommap", "[", "dat", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pts", "=", 
                  RowBox[{"ptsAndAreas", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"areas", "=", 
                  RowBox[{"1", "+", 
                   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"ptsAndAreas", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Missing", "[", "_", "]"}], "\[RuleDelayed]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_Integer", "/;", 
                    RowBox[{
                    RowBox[{"0", "<", "x", "\[LessEqual]", 
                    RowBox[{"Length", "[", "fns", "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"fns", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "=!=", "None"}]}]}], 
                    "}"}], "\[RuleDelayed]", "x"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"_", "\[Rule]", "0"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"fs", "=", 
                  RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "===", "None"}], ",", 
                    RowBox[{"Indeterminate", "&"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indeterminate", "&"}]}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"post", "@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"fs", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], "[", "#2", "]"}], "&"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"areas", ",", "pts"}], "}"}]}], "]"}]}]}], "]"}]}],
             "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Residuals and Errors", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SubjectErrorSummary", ",", "$SymMeshErrorInclusionRadius"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectErrorSummary", "::", "usage"}], "=", 
   "\"\<SubjectErrorSummary[sub,hemi,dataset,type] yields a summary of the \
error for the appropriate subject, hemisphere, and dataset; the summary is a \
nested association containing error data calculated as the weighted mean of \
the difference between the datatype in the given dataset and the \
gold-standard (weight is the gold-standard variance explained). The type \
argument may be \\\"Predicted\\\", \\\"Training\\\", or \\\"Anatomical\\\".\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SymMeshErrorInclusionRadius", "=", "65.0"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"in", " ", "sym"}], "-", "space"}], ",", " ", 
    RowBox[{"distance", " ", "from", " ", "Occipital", " ", "Pole"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Options", "[", "SubjectErrorSummary", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "SubjectMesh", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Radius", "\[RuleDelayed]", "$SymMeshErrorInclusionRadius"}]}],
       "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubjectErrorSummary", "[", 
     RowBox[{"sub_", ",", "hemi_", ",", "ds_", ",", "type_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"msh", "=", 
         RowBox[{"SubjectMesh", "[", 
          RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "ds"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"gs", "=", 
         RowBox[{"SubjectMesh", "[", 
          RowBox[{"sub", ",", "hemi", ",", "\"\<Sym\>\"", ",", "0"}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"rad", "=", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Radius", "]"}], ",", 
           RowBox[{
           "Automatic", "\[RuleDelayed]", "$SymMeshErrorInclusionRadius"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tname", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ToLowerCase", "@", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ListQ", "[", "type", "]"}], ",", 
              RowBox[{"First", "[", "type", "]"}], ",", "type"}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "\"\<predict\>\"", "|", "\"\<predicted\>\"", "|", 
               "\"\<prediction\>\""}], "\[Rule]", "\"\<Predicted\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "\"\<empirical\>\"", "|", "\"\<measured\>\"", "|", 
               "\"\<train\>\"", "|", "\"\<training\>\""}], "\[Rule]", 
              "\"\<\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "\"\<anatomical\>\"", "|", "\"\<anatomy\>\"", "|", 
               "\"\<benson14\>\""}], "\[Rule]", "\"\<Benson14\>\""}]}], 
            "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tarea", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", "type", "]"}], ",", 
             RowBox[{"Last", "[", "type", "]"}], ",", "All"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"All", "|", "Full"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"1", "|", "2", "|", "3"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"x", ":", 
               RowBox[{"1", "|", "2", "|", "3"}]}], "\[RuleDelayed]", "x"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"x_List", "\[RuleDelayed]", 
              RowBox[{"Apply", "[", 
               RowBox[{"Alternatives", ",", "x"}], "]"}]}]}], "}"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "10"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"All", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"Full", "|", "None"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "x"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{"OccipitalPole", "[", 
          RowBox[{
           RowBox[{"$FreeSurferSubjects", "[", "\"\<fsaverage_sym\>\"", "]"}],
            ",", "LH", ",", "\"\<Sphere\>\""}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"VertexCount", "[", "msh", "]"}]}], ",", 
          RowBox[{"rn", "=", 
           RowBox[{"Range", "@", 
            RowBox[{"VertexCount", "[", "msh", "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"eccidcs", "=", 
             RowBox[{"Pick", "[", 
              RowBox[{"rn", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"tname", "<>", "\"\<Eccentricity\>\""}], ")"}], "/.",
                 "msh"}], ",", 
               RowBox[{
                RowBox[{"x_", "?", "NumericQ"}], "/;", 
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "x", "<", 
                 RowBox[{"range", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"vaidcs", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ListQ", "[", "type", "]"}], ",", 
               RowBox[{"Pick", "[", 
                RowBox[{"rn", ",", 
                 RowBox[{"Round", "@", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tname", "<>", "\"\<VisualArea\>\""}], ")"}], "/.",
                     "msh"}], "]"}]}], ",", "tarea"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"tname", "\[Equal]", "\"\<\>\""}], ",", 
               RowBox[{"Pick", "[", 
                RowBox[{"rn", ",", 
                 RowBox[{"Sign", "[", 
                  RowBox[{
                   RowBox[{"ColumnNorms", "[", 
                    RowBox[{
                    RowBox[{"VertexCoordinatesTr", "[", "msh", "]"}], "-", 
                    "op"}], "]"}], "-", "rad"}], "]"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"tname", "\[Equal]", "\"\<Benson14\>\""}], ",", 
               RowBox[{"Pick", "[", 
                RowBox[{"rn", ",", 
                 RowBox[{"Round", "@", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"\"\<Benson14VisualArea\>\"", "/.", "msh"}], 
                   "]"}]}], ",", 
                 RowBox[{"1", "|", "2", "|", "3"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"tname", "\[Equal]", "\"\<Predicted\>\""}], ",", 
               RowBox[{"Pick", "[", 
                RowBox[{"rn", ",", 
                 RowBox[{"Round", "@", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], 
                   "]"}]}], ",", 
                 RowBox[{"1", "|", "2", "|", "3"}]}], "]"}]}], "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"idcs", "=", 
              RowBox[{"Intersection", "[", 
               RowBox[{"eccidcs", ",", "vaidcs"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"vals", "=", 
                 RowBox[{"Part", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tname", "<>", "\"\<PolarAngle\>\""}], ")"}], "/.",
                     "msh"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tname", "<>", "\"\<Eccentricity\>\""}], ")"}], "/.",
                     "msh"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<PolarAngle\>\"", "/.", "gs"}], ",", 
                    RowBox[{"\"\<Eccentricity\>\"", "/.", "gs"}]}], "}"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", "All", ",", "All", ",",
                    "idcs"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"w", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\"\<VarianceExplained\>\"", "/.", "gs"}], ")"}], 
                  "[", 
                  RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"delta", "=", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"vals", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"vals", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"xys", "=", 
                   RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pa", "=", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", "pa", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", "pa", "]"}]}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", "vals"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"prfsz", "=", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\"\<PRFSize\>\"", "/.", "gs"}], ")"}], "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"absang", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Abs", "@", "#"}], ",", 
                    RowBox[{"Arg", "@", "#"}]}], "}"}], "&"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "I"}], "}"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"xys", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}]}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Association", "@", 
                   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mean", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{"#2", ",", "w"}], "]"}], "/", 
                    RowBox[{"Total", "[", "w", "]"}]}], ")"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"<|", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<Mean\>\"", "\[Rule]", "mean"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<StandardDeviation\>\"", "\[Rule]", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#2", "-", "mean"}], ")"}], "^", "2"}], ",", 
                    "w"}], "]"}], "/", 
                    RowBox[{"Total", "[", "w", "]"}]}], "]"}]}]}], "|>"}]}]}],
                     "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\"", ",", 
                    "\"\<AbsAngle\>\"", ",", "\"\<ArgAngle\>\"", ",", 
                    "\"\<AnglePerPRFRadius\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "delta", ",", "absang", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Unitize", "[", "prfsz", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"absang", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"prfsz", "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", "prfsz", "]"}]}], ")"}]}], 
                    ")"}]}], ")"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}]}]}], 
                 "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$ErrorSummaries", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$ErrorSummaries", ":=", 
    RowBox[{"AutoCache", "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<error_summaries\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Subject\>\"", "\[Rule]", "sub"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Hemi\>\"", "\[Rule]", "hemi"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Dataset\>\"", "\[Rule]", "ds"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Coverage\>\"", "\[Rule]", 
           RowBox[{"SubjectDatasetCoverage", "[", 
            RowBox[{"sub", ",", "ds"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Training\>\"", "\[Rule]", 
           RowBox[{"SubjectErrorSummary", "[", 
            RowBox[{
            "sub", ",", "hemi", ",", "ds", ",", "\"\<Training\>\"", ",", 
             RowBox[{"Range", "\[Rule]", "None"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Predicted\>\"", "\[Rule]", 
           RowBox[{"SubjectErrorSummary", "[", 
            RowBox[{
            "sub", ",", "hemi", ",", "ds", ",", "\"\<Predicted\>\"", ",", 
             RowBox[{"Range", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Anatomical\>\"", "\[Rule]", " ", 
           RowBox[{"SubjectErrorSummary", "[", 
            RowBox[{
            "sub", ",", "hemi", ",", "0", ",", "\"\<Anatomical\>\"", ",", 
             RowBox[{"Range", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "12"}], "}"}]}]}], "]"}]}]}], "|>"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"sub", ",", "$Subjects"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"hemi", ",", 
          RowBox[{"{", 
           RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"ds", ",", 
          RowBox[{"Rest", "@", 
           RowBox[{"$SubjectDatasets", "[", "sub", "]"}]}]}], "}"}]}], 
       "]"}]}], "]"}]}], "]"}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Organizing Cortical Magnification Data", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$CMagData", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{"$CMagData", ":=", 
    RowBox[{"Association", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hemi", "\[Rule]", 
        RowBox[{"Association", "@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sub", "\[Rule]", 
            RowBox[{"Association", "@", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pa", "=", 
                  RowBox[{
                   RowBox[{"Pi", "/", "180"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"90", "-", 
                    RowBox[{"(", 
                    RowBox[{"\"\<PredictedPolarAngle\>\"", "/.", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}], ")"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ec", "=", 
                  RowBox[{"\"\<PredictedEccentricity\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"va", "=", 
                  RowBox[{"\"\<PredictedVisualArea\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"cma", "=", 
                  RowBox[{"\"\<MagnificationWhiteAreal\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"cmt", "=", 
                  RowBox[{"\"\<MagnificationWhiteTangential\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"cmr", "=", 
                  RowBox[{"\"\<MagnificationWhiteRadial\>\"", "/.", 
                   RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "0"}], 
                    "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"idcs", "=", 
                   RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{"ec", ",", 
                    RowBox[{
                    RowBox[{"x_", "?", "NumericQ"}], "/;", 
                    RowBox[{"x", "\[LessEqual]", "24"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"N", "[", "va", "]"}], ",", 
                    RowBox[{"1.0", "|", "2.0", "|", "3.0"}]}], "]"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{
                    RowBox[{"ec", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"pa", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}]}], ",", 
                    RowBox[{"y", "=", 
                    RowBox[{
                    RowBox[{"ec", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"pa", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}]}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Coordinate\>\"", "\[Rule]", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", 
                    RowBox[{"ec", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<VisualArea\>\"", "\[Rule]", 
                    RowBox[{"va", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<ArealMagnification\>\"", "\[Rule]", 
                    RowBox[{"cma", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<TangentialMagnification\>\"", "\[Rule]", 
                    RowBox[{"cmt", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<RadialMagnification\>\"", "\[Rule]", 
                    RowBox[{"cmr", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
                "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"sub", ",", "$Subjects"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"hemi", ",", 
         RowBox[{"{", 
          RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], 
  ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$CMagSummaryBySubject", ",", "CMagSummaryBySubject", ",", "CMagSummary"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$CMagSummaryBySubject", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eccs", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0.5", ",", "12", ",", "0.25"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Association", "@", 
        RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "@", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"key", "=", "#1"}], ",", 
               RowBox[{"val", "=", "#2"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"key", "\[Rule]", 
              RowBox[{"Association", "@", 
               RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "@", 
                  RowBox[{"With", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"data", "=", "#2"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"mags", "=", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"t", "<>", "\"\<Magnification\>\""}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Radial\>\"", ",", "\"\<Tangential\>\"", ",", 
                    "\"\<Areal\>\""}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ecc", "=", 
                    RowBox[{"#2", "[", "\"\<Eccentricity\>\"", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"va", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"#2", "[", "\"\<VisualArea\>\"", "]"}], "]"}]}]}],
                     "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"#1", "\[Rule]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{"Pick", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "va", "]"}]}], ",", "va", ",", 
                    "area"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"near", "=", 
                    RowBox[{"Nearest", "@", 
                    RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"ecc", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"mags", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], "]"}]}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mean", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
                    RowBox[{"#", "<", "85"}]}], "&"}]}], "]"}]}], "&"}], ",", 
                    
                    RowBox[{"Transpose", "@", 
                    RowBox[{"near", "[", 
                    RowBox[{"e0", ",", 
                    RowBox[{"{", 
                    RowBox[{"Infinity", ",", "0.5"}], "}"}]}], "]"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "e0"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"e0", ",", "eccs"}], "}"}]}], "]"}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"area", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
                    "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", "val"}], 
                "]"}]}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "$CMagData"}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CMagSummaryBySubject", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH", "|", "All"}]}], ",", "area_", ",", 
       "type_String"}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tid", "=", 
         RowBox[{"type", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Radial\>\"", "\[Rule]", "1"}], ",", 
            RowBox[{"\"\<Tangential\>\"", "\[Rule]", "2"}], ",", 
            RowBox[{"\"\<Areal\>\"", "\[Rule]", "3"}]}], "}"}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"FlatTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"$CMagSummaryBySubject", "[", "hem", "]"}], "[", "sub", 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"tid", "+", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"hem", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"hemi", "===", "All"}], ",", 
             RowBox[{"{", 
              RowBox[{"LH", ",", "RH"}], "}"}], ",", 
             RowBox[{"{", "hemi", "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"sub", ",", 
           RowBox[{"Keys", "@", 
            RowBox[{"$CMagSummaryBySubject", "[", "hem", "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"IntegerQ", "[", "area", "]"}], ",", 
             RowBox[{"{", "area", "}"}], ",", 
             RowBox[{"area", "===", "All"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "True", ",", 
             "area"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CMagSummary", "[", 
      RowBox[{
       RowBox[{"hemi", ":", 
        RowBox[{"LH", "|", "RH", "|", "All"}]}], ",", "area_", ",", 
       "type_String", ",", 
       RowBox[{"q_:", "0.1"}]}], "]"}], ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"CMagSummaryBySubject", "[", 
           RowBox[{"hemi", ",", "area", ",", "type"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dat", "=", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{"Prepend", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Quantile", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"q", ",", "0.25", ",", "0.5", ",", "0.75", ",", 
                   RowBox[{"1", "-", "q"}]}], "}"}]}], "]"}], "&"}], "/@", 
              "dat"}], ",", "\[IndentingNewLine]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Plotting projections to the visual field and retinotopy model\
\>", "Section"],

Cell["\<\
The functions defined in this section of the notebook allow one to plot data \
projected into the visual field; these projections can be based either on the \
individualized template fits or on the raw data.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Functions to Parse Options", "Subsection"],

Cell["\<\
These functions parse options given to the various functions that follow them,\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldParseOption", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "::", "badopt"}], "=", 
   "\"\<Bad option given to VisualField option parser: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Range", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Projection", "\[Rule]", "\"\<Empirical\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Weights", "\[Rule]", "\"\<VarianceExplained\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Select", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VisualArea", "\[Rule]", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Range", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Range", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"m_", "?", "NumericQ"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mm", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "\[RuleDelayed]", 
        "mm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"None", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Automatic", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Range should be a max eccentricity or a {min,max} list.\>\""}],
          "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Select", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Select", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"None", "|", "Automatic", "|", "False"}], "\[Rule]", "None"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"VisualArea", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "VisualArea", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"None", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"All", "|", "Full"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", ":", 
         RowBox[{"1", "|", "2", "|", "3"}]}], "\[RuleDelayed]", 
        RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{"3", "\[Equal]", 
          RowBox[{"Length", "@", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "x"}], 
            "]"}]}]}]}], "\[RuleDelayed]", 
        RowBox[{"Union", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<VisualArea must be 1, 2, 3, a list containing 1, 2, or 3, or \
All\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Projection", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$EmpiricalPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<PolarAngle\>\"", ",", "\"\<Eccentricity\>\""}], "}"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"$GoldPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GoldPolarAngle\>\"", ",", "\"\<GoldEccentricity\>\""}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$PredictedPattern", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<PredictedPolarAngle\>\"", ",", 
          "\"\<PredictedEccentricity\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ang_String", ",", "ecc_String"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"inAllMeshes", "[", "ang", "]"}], "&&", 
           RowBox[{"inAllMeshes", "[", "ecc", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ang", ",", "ecc"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<polar angle/eccentricity properties were not present in all \
specified meshes\>\""}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m_", "?", "MatrixQ"}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit angles can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Projection should be Empirical or GoldStandard\>\""}], 
         "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldParseOption", "[", 
    RowBox[{"Weights", ",", "nSubHems_", ",", "inAllMeshes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Weights", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"False", "|", "None"}], "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Weight\>\"", "\[Rule]", "\"\<Weight\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<VarianceExplained\>\"", "\[Rule]", "\"\<VarianceExplained\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"s_String", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"inAllMeshes", "[", "s", "]"}], ",", "\[IndentingNewLine]", 
          "s", ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\[IndentingNewLine]", 
            "\"\<weight property not present in all meshes\>\""}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m_List", "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"1", "\[Equal]", "nSubHems"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", "m", 
            ",", 
            RowBox[{"Transpose", "[", "m", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
            "\"\<explicit weights can only be given when there is only one \
subject/hemisphere specified\>\""}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"Message", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "::", "badopt"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<Weights should be \\\"Weight\\\", \\\"VarianceExplained\\\", \
or None\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Averaging data into the visual field", "Subsection"],

Cell["\<\
Given a subject or group of subjects, a property to project, and polar \
angle/eccentricity properties (optionally weight), combine all the data into \
a single visual field mesh and return it.
The visual field mesh is returned as a function.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VisualFieldFunction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldFunction", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Options", "[", "VisualFieldParseOption", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "GaussianInterpolation", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "::", "badarg"}], "=", 
   "\"\<Bad argument given to VisualFieldFunction: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldFunction", "[", 
    RowBox[{"who_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"allMeshes", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Outer", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub", "=", "#1"}], ",", 
                    RowBox[{"hem", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{"sub", ",", "hem", ",", "\"\<Sym\>\"", ",", "#"}],
                     "]"}]}], "&"}], "/@", 
                   RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", "All"}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Empirical\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Measured\>\""}]}], ",", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Training\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Train\>\""}]}], ",", 
                    RowBox[{"Rest", "@", 
                    RowBox[{"$SubjectDatasets", "[", "sub", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<Gold\>\""}], "||", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
                    "\"\<GoldStandard\>\""}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
                    "True", ",", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\"\<Unrecognized dataset arg\>\""}], "]"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"{", 
                    RowBox[{"w", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "===", "All"}], ",", 
                 "$Subjects", ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "All"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "===", "LR"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"LH", ",", "RH"}], "}"}], ",", 
                 RowBox[{"ListQ", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"w", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "True", ",", 
                 RowBox[{"{", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "1", ",", "1"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"Dimensions", "[", "who", "]"}]}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{"{", "who", "}"}], ",", "who"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sel", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Select", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"area", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "VisualArea", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nSubHems", "=", 
          RowBox[{"Length", "@", 
           RowBox[{"Union", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Subject\>\"", ",", "\"\<Hemisphere\>\""}], "}"}],
                "/.", 
               RowBox[{"Options", "[", 
                RowBox[{"msh", ",", "MetaInformation"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"msh", ",", "allMeshes"}], "}"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"meshes", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"hemi", "\[Rule]", 
              RowBox[{"Select", "[", 
               RowBox[{"allMeshes", ",", 
                RowBox[{
                 RowBox[{"hemi", "===", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Hemisphere\>\"", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"#", ",", "MetaInformation"}], "]"}]}], ")"}]}], 
                 "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"hemi", ",", 
               RowBox[{"{", 
                RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"inAllMeshes", "=", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "=", "#1"}], "}"}], ",", 
             RowBox[{"AllTrue", "[", 
              RowBox[{"allMeshes", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"VertexPropertyList", "[", "#", "]"}], ",", "x"}], 
                 "]"}], "&"}]}], "]"}]}], "]"}], "&"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"projAngleNames", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Projection", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                 RowBox[{"Association", "@", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"_", "\[Rule]", "None"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"weights", "=", 
            RowBox[{"WithOptions", "[", 
             RowBox[{
              RowBox[{"VisualFieldParseOption", "[", 
               RowBox[{"Weights", ",", "nSubHems", ",", "inAllMeshes"}], 
               "]"}], ",", "opts"}], "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projAngle", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Pi", "/", "180.0"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"90.0", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "msh"}], ")"}]}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "msh"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"projAngleNames", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ws0", "=", 
              RowBox[{"Association", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"hemi", "\[Rule]", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"weights", "===", "None"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"VertexCount", "[", "msh", "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ListQ", "[", "weights", "]"}], ",", "weights", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"weights", "===", "Automatic"}], ",", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Projection", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$EmpiricalPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"\"\<VarianceExplained\>\"", "/.", "msh"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$GoldPattern", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "\"\<GoldVarianceExplained\>\"", ")"}], "/.",
                     "msh"}], ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"$PredictedPattern", "\[RuleDelayed]", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"\"\<PredictedVisualArea\>\"", "/.", "msh"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"_", "\[RuleDelayed]", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<If Projection is explicit, weights must be explicit \
or None.\>\""}], "]"}]}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"StringQ", "[", "weights", "]"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"weights", "/.", "msh"}], ")"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"VisualFieldFunction", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<Could not understand Weights argument; should be \
\\\"VarianceExplained\\\", \\\"Weight\\\", or None\>\""}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"msh", ",", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], "}"}]}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"hemi", ",", 
                   RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"idcs", "=", 
               RowBox[{"Association", "@", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"hemi", "\[Rule]", 
                   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"allVtcs", "=", 
                    RowBox[{"Range", "@", 
                    RowBox[{"VertexCount", "[", "#1", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sel", "===", "None"}], ",", "allVtcs", ",", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"MapVertices", "[", 
                    RowBox[{"sel", ",", "#1"}], "]"}], ",", "True"}], "]"}]}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"e_", "/;", 
                    RowBox[{
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "e", 
                    "\[LessEqual]", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allVtcs", ",", 
                    RowBox[{"Sign", "[", "#3", "]"}], ",", "1"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"area", "===", "None"}], "||", 
                    RowBox[{"#4", "===", "None"}]}], ",", 
                    "\[IndentingNewLine]", "allVtcs", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{"#4", ",", "a"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "area"}], "}"}]}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"areas", "===", "None"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"None", "&"}], ")"}], "/@", 
                    RowBox[{"meshes", "[", "hemi", "]"}]}], ",", 
                    RowBox[{"areas", "[", "hemi", "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"coords", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ang", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"ecc", "=", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "RH"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", "ecc", "*", 
                    RowBox[{"Cos", "[", "ang", "]"}]}], ",", 
                    RowBox[{"ecc", "*", 
                    RowBox[{"Sin", "[", "ang", "]"}]}]}], "}"}], "]"}], "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"projAngle", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"vals", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", "prop", "]"}], ",", 
                    RowBox[{"prop", "/.", "#1"}], ",", "prop"}], "]"}], ",", 
                    "#2"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"meshes", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"ws", "=", 
                  RowBox[{"Association", "@", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ws0", "[", "hemi", "]"}], ",", 
                    RowBox[{"idcs", "[", "hemi", "]"}]}], "}"}]}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"fs", "=", 
                   RowBox[{"Association", "@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"hemi", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"coords", "[", "hemi", "]"}]}], "\[Equal]", "0"}],
                     ",", "\[IndentingNewLine]", "None", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "GaussianInterpolation", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Append", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", "hemi", "]"}], ",", 
                    RowBox[{"vals", "[", "hemi", "]"}]}], "}"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Weights", "\[Rule]", 
                    RowBox[{"ws", "[", "hemi", "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"hemi", ",", 
                    RowBox[{"{", 
                    RowBox[{"LH", ",", "RH"}], "}"}]}], "}"}]}], "]"}]}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], "&&", 
                    RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}]}], ",", 
                   "$Failed", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "LH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "RH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"fs", "[", "RH", "]"}], "===", "None"}], ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#", "===", "RH"}], ",", "False", ",", 
                    RowBox[{"#", "===", "LH"}], ",", "True", ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"f", "[", "#", "]"}]}], "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "True", ",", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fl", "=", 
                    RowBox[{"fs", "[", "LH", "]"}]}], ",", 
                    RowBox[{"fr", "=", 
                    RowBox[{"fs", "[", "RH", "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "===", "LH"}], "||", 
                    RowBox[{"#", "===", "RH"}]}], ",", "\[IndentingNewLine]", 
                    "True", ",", "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dat", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "#", "]"}]}], "\[Equal]", "2"}], 
                    ",", "#", ",", 
                    RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", "#", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"hems", "=", 
                    RowBox[{"3", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Unitize", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ")"}]}],
                     ")"}], "/", "2"}], "+", 
                    RowBox[{"3", "/", "2"}]}], ")"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lidcs", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"hems", ",", "1"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ridcs", "=", 
                    RowBox[{"Indices", "[", 
                    RowBox[{"hems", ",", "2"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", "=", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"SparseArray", "@", 
                    RowBox[{"Join", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"lidcs", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"lidcs", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"fl", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", "lidcs", "]"}], "]"}], "]"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"ridcs", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ridcs", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"fr", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", "ridcs", "]"}], "]"}], "]"}]}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatrixQ", "[", "#", "]"}], ",", "r", ",", 
                    RowBox[{"First", "[", "r", "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
   ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a Visual Field Projection", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "VisualFieldDensityPlot", ",", "VisualFieldContourPlot", ",", 
    "$VisualFieldOptionDeltas"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$VisualFieldOptionDeltas", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "Automatic"}], ")"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ColorFunction", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"ColorFunction", "\[Rule]", "Automatic"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Frame", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Frame", "\[Rule]", "None"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"AspectRatio", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BaseStyle", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"PlotRange", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"WorkingPrecision", "\[Rule]", "_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"WorkingPrecision", "->", "MachinePrecision"}], ")"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], "=", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldFunction", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "[", "ContourPlot", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "$VisualFieldOptionDeltas", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldFunction", "[", 
           RowBox[{"spec", ",", "prop"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"projections", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "RH", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "LH", "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"reg", "=", 
            RowBox[{"Apply", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "Annulus", 
                ",", "Disk"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "range", 
                  ",", 
                  RowBox[{"range", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"projections", "[", "RH", "]"}], "&&", 
                   RowBox[{"projections", "[", "LH", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"projections", "[", "RH", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", "True", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"DensityPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Element", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", "reg"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Thin", ",", "White", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xmin", "\[Equal]", "0"}], "||", 
                  RowBox[{"xmax", "\[Equal]", "0"}]}], ",", "2", ",", "1"}], 
                "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ColorFunctionScaling", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===", 
                  "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{
                   "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], "[", 
                   RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                   "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{
                   "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                   "[", 
                   RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                   "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "\"\<MagnificationSquared\>\"", "|", 
                  "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}]}], 
               "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "\[Rule]", 
                   RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@",
                 
                RowBox[{
                 RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Options", "[", "DensityPlot", "]"}]}], "]"}]}], 
            "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualFieldContourPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldFunction", "[", 
           RowBox[{"spec", ",", "prop"}], "]"}], ",", "opts"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"projections", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xmin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "RH", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"projections", "[", "LH", "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"reg", "=", 
            RowBox[{"Apply", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "Annulus", 
                ",", "Disk"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "range", 
                  ",", 
                  RowBox[{"range", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"projections", "[", "RH", "]"}], "&&", 
                   RowBox[{"projections", "[", "LH", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"projections", "[", "RH", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", "True", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Element", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", "reg"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Epilog", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Thin", ",", "White", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xmin", "\[Equal]", "0"}], "||", 
                  RowBox[{"xmax", "\[Equal]", "0"}]}], ",", "2", ",", "1"}], 
                "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ColorFunctionScaling", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Automatic", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===", 
                  "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{
                   "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], "[", 
                   RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                   "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{
                   "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                   "[", 
                   RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                   "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "\"\<MagnificationSquared\>\"", "|", 
                  "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Blend", "[", 
                   RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}]}], 
               "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "\[Rule]", 
                   RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{
                 RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Options", "[", "ContourPlot", "]"}]}], "]"}]}], 
            "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting a V123 Schematic Model Figure", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"V123FigDensityPlot", ",", "V123FigContourPlot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldDensityPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"VisualArea", "\[Rule]", "_"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "=", 
   RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Options", "[", "VisualFieldContourPlot", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"MaxPlotPoints", "\[Rule]", "500"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"VisualArea", "\[Rule]", "_"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V123FigDensityPlot", "[", 
    RowBox[{"spec_", ",", "prop_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"projections", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithOptions", "[", 
           RowBox[{
            RowBox[{"VisualFieldFunction", "[", 
             RowBox[{"spec", ",", "prop", ",", 
              RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"WithOptions", "[", 
         RowBox[{
          RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", 
          "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mpp", "=", 
        RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotFn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hemi", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"pts", "=", 
                RowBox[{"Join", "@@", 
                 RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "@", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"imesh", "=", 
                    RowBox[{"MeshCoordinates", "[", "#1", "]"}]}], ",", 
                    RowBox[{"ifield", "=", 
                    RowBox[{"ReIm", "[", "#2", "]"}]}], ",", 
                    RowBox[{"f", "=", "#3"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ns", "=", 
                    RowBox[{"RowNorms", "[", "imesh", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ns", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ns", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"ifield", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], ")"}], 
                    "&"}], "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"imesh", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "$VisualFieldToFigData", "[", "\"\<VisualFieldMeshes\>\"",
                     "]"}], "[", "#", "]"}], ")"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<V1\>\"", ",", "\"\<V2\>\"", ",", "\"\<V3\>\""}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "$VisualFieldToFigData", "[", "\"\<VisualFieldFields\>\"",
                     "]"}], "[", "#", "]"}], ")"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<V1\>\"", ",", "\"\<V2\>\"", ",", "\"\<V3\>\""}], 
                    "}"}]}], ",", "\[IndentingNewLine]", "projections"}], 
                    "}"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"ListDensityPlot", "[", "\[IndentingNewLine]", 
               RowBox[{"pts", ",", "\[IndentingNewLine]", 
                RowBox[{"ColorFunctionScaling", "\[Rule]", 
                 RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigDensityPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Options", "[", "ListDensityPlot", "]"}]}], 
                   "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"projections", ",", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
          RowBox[{
           RowBox[{"projections", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plotFn", "[", "LH", "]"}], ",", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V123FigContourPlot", "[", 
   RowBox[{"spec_", ",", "prop_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"projections", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WithOptions", "[", 
          RowBox[{
           RowBox[{"VisualFieldFunction", "[", 
            RowBox[{"spec", ",", "prop", ",", 
             RowBox[{"VisualArea", "\[Rule]", "a"}]}], "]"}], ",", "opts"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"WithOptions", "[", 
        RowBox[{
         RowBox[{"VisualFieldParseOption", "[", "Range", "]"}], ",", "opts"}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"mpp", "=", 
       RowBox[{"OptionValue", "[", "MaxPlotPoints", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plotFn", "=", 
        RowBox[{"Function", "@", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"hemi", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pts", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Function", "@", 
                   RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"imesh", "=", 
                    RowBox[{"MeshCoordinates", "[", "#1", "]"}]}], ",", 
                    RowBox[{"ifield", "=", 
                    RowBox[{"ReIm", "[", "#2", "]"}]}], ",", 
                    RowBox[{"f", "=", "#3"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ns", "=", 
                    RowBox[{"RowNorms", "[", "imesh", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idcs", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomSample", "[", 
                    RowBox[{"#", ",", "mpp"}], "]"}], "&"}], "@", 
                    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ns", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"ns", "-", 
                    RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"0", "|", 
                    RowBox[{"-", "1"}]}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], 
                    ")"}]}], "]"}], "&"}], "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"ifield", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hemi", "===", "LH"}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], ")"}], 
                    "&"}], "/@", "#"}]}], "]"}], "&"}], "@", 
                    RowBox[{"imesh", "[", 
                    RowBox[{"[", "idcs", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "$VisualFieldToFigData", "[", "\"\<VisualFieldMeshes\>\"",
                     "]"}], "[", "#", "]"}], ")"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<V1\>\"", ",", "\"\<V2\>\"", ",", "\"\<V3\>\""}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "$VisualFieldToFigData", "[", "\"\<VisualFieldFields\>\"",
                     "]"}], "[", "#", "]"}], ")"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<V1\>\"", ",", "\"\<V2\>\"", ",", "\"\<V3\>\""}], 
                    "}"}]}], ",", "\[IndentingNewLine]", "projections"}], 
                   "}"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListContourPlot", "[", "\[IndentingNewLine]", 
              RowBox[{"pts", ",", "\[IndentingNewLine]", 
               RowBox[{"ColorFunctionScaling", "\[Rule]", 
                RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Automatic", "\[RuleDelayed]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "ColorFunction", "]"}], "===",
                     "Automatic"}], ",", "True", ",", "False"}], "]"}]}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"ColorFunction", "\[Rule]", 
                RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"OptionValue", "[", "ColorFunction", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
                    "Red"}], "}"}], ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<PolarAngle\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<PolarAngle\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "CorticalColorData", "[", "\"\<Eccentricity\>\"", "]"}], 
                    "[", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Eccentricity\>\"", "\[Rule]", "#"}], "|>"}], 
                    "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Magnification\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "\"\<MagnificationSquared\>\"", "|", 
                    "\"\<Magnification2\>\""}], "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", 
                    RowBox[{"Sqrt", "[", "#", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<PRFSize\>\"", "\[RuleDelayed]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$PRFBlendColors", ",", "#"}], "]"}]}]}]}], 
                   "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Options", "[", "V123FigContourPlot", "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Options", "[", "ListContourPlot", "]"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AnyTrue", "[", 
         RowBox[{"projections", ",", 
          RowBox[{
           RowBox[{"#", "===", "$Failed"}], "&"}]}], "]"}], ",", "$Failed", 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], "&&", 
         RowBox[{
          RowBox[{"projections", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"plotFn", "[", "LH", "]"}], ",", 
          RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"projections", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "LH", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"plotFn", "[", "LH", "]"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"projections", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "RH", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"plotFn", "[", "RH", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "True", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting Subject Paths/Contours on the Cortical Surface", "Subsection"],

Cell["\<\
This function, SubjectContours, returns a GraphicsComplex that will plot an \
overlay of contours and lines.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SubjectContours", ",", "VisualAreaStyleFunction"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "::", "badarg"}], "=", 
   "\"\<Bad argument given to SubjectContours: `1`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualAreaStyleFunction", "::", "usage"}], "=", 
   "\"\<VisualAreasStyleFunction is an option to SubjectContours.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SubjectContours", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EccentricityLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "1.25", ",", "2.5", ",", "5", ",", "10", ",", "20", ",", "40", ",", 
          "80"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"EccentricityStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90", ",", "180"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAngleStyleFunction", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreas", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"VisualAreaStyleFunction", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BoundaryStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Mesh", "\[Rule]", "Automatic"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VertexCoordinates", "\[Rule]", "Automatic"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "[", "SubjectMap", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubjectContours", "[", 
    RowBox[{"sub_", ",", 
     RowBox[{"hemi", ":", 
      RowBox[{"LH", "|", "RH"}]}], ",", "ds_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Xarg", "=", 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{
              RowBox[{"Length", "[", "m", "]"}], "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}]}]}], "\[RuleDelayed]", 
            RowBox[{"Transpose", "[", "m", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"m_", "?", "MatrixQ"}], "/;", 
             RowBox[{"1", "<", 
              RowBox[{"Length", "@", 
               RowBox[{"First", "[", "m", "]"}]}], "<", "4"}]}], 
            "\[RuleDelayed]", "m"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Automatic", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"_", "\[RuleDelayed]", 
            RowBox[{"Message", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SubjectContours", "::", "badarg"}], ",", 
              "\[IndentingNewLine]", 
              "\"\<VertexCoordinates must be an n x 2 or n x 3 matrix or \
Automatic\>\""}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pre", "=", 
         RowBox[{"Fold", "[", "\[IndentingNewLine]", 
          RowBox[{"Replace", ",", "\[IndentingNewLine]", 
           RowBox[{"OptionValue", "[", "Mesh", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"s_String", "\[RuleDelayed]", 
              RowBox[{"ToLowerCase", "[", "s", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s_String", "\[RuleDelayed]", 
                RowBox[{"WithOptions", "[", 
                 RowBox[{
                  RowBox[{"SubjectMesh", "[", 
                   RowBox[{"sub", ",", "hemi", ",", "s", ",", "ds"}], "]"}], 
                  ",", "opts"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Xarg", "===", "Automatic"}], ",", 
                  RowBox[{"WithOptions", "[", 
                   RowBox[{
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "opts"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"First", "[", "Xarg", "]"}]}], "\[Equal]", "2"}], 
                  ",", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectMap", "[", 
                    RowBox[{"sub", ",", "hemi", ",", "ds"}], "]"}], ",", 
                    "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Length", "[", "Xarg", "]"}], "\[Equal]", 
                    RowBox[{"VertexCount", "@", 
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "ds"}], 
                    "]"}]}]}], ",", 
                    RowBox[{"WithOptions", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectMesh", "[", 
                    RowBox[{
                    "sub", ",", "hemi", ",", "\"\<Inflated\>\"", ",", "ds"}], 
                    "]"}], ",", "\[IndentingNewLine]", "opts"}], "]"}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Message", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<VertexCoordinates do not match a mesh size\>\""}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "}"}]}], "}"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"elines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "1.25", ",", "2.5", ",", "5", ",", "10", ",", "20", ",", 
                   "40", ",", "80"}], "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<EccentricityLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"estyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "EccentricityStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", "Black", "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"plines", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleLines", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "90"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VectorQ", "[", 
                    RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], 
                  "]"}], "\[RuleDelayed]", 
                 RowBox[{"Message", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"SubjectContours", "::", "badarg"}], ",", 
                   "\[IndentingNewLine]", 
                   "\"\<PolarAngleLines must be a vector of numbers or \
Automatic or None.\>\""}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"pstyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "PolarAngleStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"{", 
                   RowBox[{"Thick", ",", "White"}], "}"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"areas", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreas", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3"}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Full", "|", "All"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "5"}], ",", 
                   RowBox[{"-", "4"}], ",", 
                   RowBox[{"-", "3"}], ",", 
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4",
                    ",", "5"}], "}"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"astyle", "=", 
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "VisualAreaStyleFunction", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"Function", "@", 
                  RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Round", "@", 
                    RowBox[{"Abs", "[", "#", "]"}]}], ",", 
                    "\[IndentingNewLine]", "1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Blue"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Green"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "3", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                    RowBox[{"FaceForm", "@", 
                    RowBox[{"Opacity", "[", 
                    RowBox[{"0.6", ",", "Red"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "_", ",", "None"}], "]"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"None", "\[Rule]", 
                 RowBox[{"Function", "[", "None", "]"}]}]}], "}"}]}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"bstyle", "=", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "BoundaryStyle", "]"}], ",", 
              RowBox[{"Automatic", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"idxFix", "=", 
              RowBox[{"Function", "[", 
               RowBox[{"VertexIndex", "[", 
                RowBox[{"pre", ",", "#"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"inRangeQ", "=", 
              RowBox[{"Replace", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"OptionValue", "[", "Range", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"All", "|", "Full"}], "\[Rule]", 
                   RowBox[{"Function", "[", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", "#3"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"emax_", "?", "NumericQ"}], "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", "#3"}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", "#3"}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a0_", "?", "NumericQ"}], ",", 
                    RowBox[{"amax_", "?", "NumericQ"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e0_", "?", "NumericQ"}], ",", 
                    RowBox[{"emax_", "?", "NumericQ"}]}], "}"}]}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "e0", "\[LessEqual]", "#2", "\[LessEqual]", "emax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    "a0", "\[LessEqual]", "#1", "\[LessEqual]", "amax"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"areas", ",", 
                    RowBox[{"Round", "[", "#3", "]"}]}], "]"}]}], "]"}]}]}]}],
                  "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"angleDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedPolarAngle\>\""}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"eccenDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedEccentricity\>\""}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"areasDat", "=", 
              RowBox[{"VertexPropertyValues", "[", 
               RowBox[{"pre", ",", "\"\<PredictedVisualArea\>\""}], "]"}]}]}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"checkfn", "=", 
               RowBox[{"Function", "@", 
                RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"a", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"IntegerQ", "[", "#1", "]"}], ",", 
                    RowBox[{"{", "#1", "}"}], ",", "#1"}], "]"}]}], ",", 
                    RowBox[{"e", "=", "#2"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"e", "===", "None"}], ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"a", ",", "#PredictedVisualArea"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"a", "===", "None"}], ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"#PredictedEccentricity", "<", "e"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "True", ",", 
                    RowBox[{"Function", "@", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"a", ",", "#PredictedVisualArea"}], "]"}], "&&", 
                    RowBox[{"#PredictedEccentricity", "<", "e"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inRangeQ", "[", 
                    RowBox[{
                    "#PredictedPolarAngle", ",", "#PredictedEccentricity", 
                    ",", "#PredictedVisualArea"}], "]"}]}], "]"}]}]}], 
                   "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"bound", "=", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"bound0", "=", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"a", ",", "None"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "rotate", " ", "it", " ", "so", " ", "that", " ", "the", 
                    " ", "start", " ", "is", " ", "the", " ", "fovea"}], 
                    "..."}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"RotateLeft", "[", 
                    RowBox[{"bound0", ",", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Ordering", "[", 
                    RowBox[{
                    RowBox[{"eccenDat", "[", 
                    RowBox[{"[", "bound0", "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "-", "1"}]}], "]"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"GraphicsComplex", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"OptionValue", "[", "VertexCoordinates", "]"}], 
                   ",", 
                   RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"VertexCoordinates", "[", "pre", "]"}]}]}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"Okay", ",", " ", 
                   RowBox[{
                    RowBox[{
                    "the", " ", "rest", " ", "will", " ", "be", " ", "done", 
                    " ", "somewhat", " ", "procedurally"}], "..."}]}], " ", 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"First", "@", 
                  RowBox[{"Last", "@", 
                   RowBox[{"Reap", "[", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"First", ",", " ", 
                    RowBox[{
                    RowBox[{
                    "find", " ", "the", " ", "areas", " ", "and", " ", 
                    "render", " ", "them"}], "..."}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"astyle", "[", "a", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"a", ",", "None"}], "]"}]}], "]"}]}], "]"}]}]}]}],
                     "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "areas"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Next", ",", " ", 
                    RowBox[{"we", " ", "do", " ", "eccentricity"}]}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"estyle", "[", "e", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{"None", ",", "e"}], "]"}]}], "]"}]}], "]"}]}]}]}],
                     "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", "elines"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"Then", " ", "polar", " ", "angle"}], "..."}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"style", "=", 
                    RowBox[{"pstyle", "[", "p", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"style", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Map", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Function", "@", 
                    RowBox[{"Append", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "style", "]"}], ",", "style", ",", 
                    RowBox[{"{", "style", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Line", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "]"}]}], 
                    "&"}], "@", 
                    RowBox[{"idxFix", "@", 
                    RowBox[{
                    "LabelBoundaryVertexList", "[", "\[IndentingNewLine]", 
                    RowBox[{"pre", ",", "\[IndentingNewLine]", 
                    RowBox[{"SelectVertices", "[", 
                    RowBox[{"pre", ",", "#"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", "None"}], "]"}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "180"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "3"}]}], "}"}], ",", "None"}], "]"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"p", "\[Equal]", "90"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", "None"}], "]"}], ",", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}], ",", "None"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"0", "<", "p", "<", "90"}], ",", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cf12", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", "None"}], "]"}]}], 
                    ",", 
                    RowBox[{"cf23", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], ",", "None"}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf12", "[", "#", "]"}], "&&", 
                    RowBox[{"#PredictedPolarAngle", "\[LessEqual]", "p"}]}], 
                    ")"}], "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf23", "[", "#", "]"}], "&&", 
                    RowBox[{"#PredictedPolarAngle", "\[LessEqual]", "p"}]}], 
                    ")"}], "&"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"90", "<", "p", "<", "180"}], ",", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cf12", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}], ",", "None"}], "]"}]}], ",", 
                    
                    RowBox[{"cf23", "=", 
                    RowBox[{"checkfn", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "3"}]}], "}"}], ",", "None"}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf12", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf23", "[", "#", "]"}], "&&", 
                    RowBox[{
                    "#PredictedPolarAngle", "\[GreaterEqual]", "p"}]}], ")"}],
                     "&"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "plines"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Last", ",", " ", 
                    RowBox[{
                    RowBox[{"do", " ", "the", " ", "boundary"}], "..."}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bstyle", "=!=", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "bstyle", "]"}], ",", "bstyle", ",", 
                    RowBox[{"{", "bstyle", "}"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", "bound", "]"}]}], "]"}]}]}], "]"}]}],
                     "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}],
       "]"}]}], "]"}]}], ";"}]}], "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Body", "Chapter"],

Cell["\<\
This section of the notebook contains code that actually creates and displays \
plots of the various data.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Figures", "Subchapter"],

Cell[CellGroupData[{

Cell["Cortical Magnification", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "$CMagFigure", ",", "$CMagFigureLines", ",", "$CMagFigureV123Figs", ",", 
    "$CMagFigureFields"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$CMagFigureV123Figs", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"llines", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Join", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{"V123FigLines", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4", ",", "8", ",", "15"}], "}"}]}], "]"}]}],
            "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"rlines", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"Join", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{"V123FigLines", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "4", ",", "8", ",", "15"}], "}"}]}], 
              "]"}]}], "/.", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "x"}], ",", "y"}], "}"}]}]}], "]"}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "llines"}], "}"}], 
              "]"}], ",", 
             RowBox[{"Show", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "rlines"}], "}"}], 
              "]"}]}], "}"}], "&"}], "@", 
          RowBox[{"V123FigContourPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"All", ",", "All", ",", "0"}], "}"}], ",", 
            RowBox[{"\"\<MagnificationWhite\>\"", "<>", "type"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", "\"\<Magnification\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Contours", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "6", ",", "9", ",", "18", ",", 
               "27"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Range", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "15"}], "}"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"type", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Radial\>\"", ",", "\"\<Tangential\>\""}], "}"}]}], 
          "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$CMagFigureLines", ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rdat", "=", 
            RowBox[{"CMagSummary", "[", 
             RowBox[{"All", ",", "area", ",", "\"\<Radial\>\""}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"tdat", "=", 
            RowBox[{"CMagSummary", "[", 
             RowBox[{"All", ",", "area", ",", "\"\<Tangential\>\""}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"dat", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
               
               RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "#"}], 
                    "}"}], "]"}], "&"}], "/@", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"dat", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"2", ";;", "All"}]}], "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "30"}], "}"}]}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AspectRatio", "\[Rule]", 
                  RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c", ",", "Thin"}], "}"}], ",", 
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "Thin"}], "}"}]}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Filling", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "2", "}"}]}], ",", 
                    RowBox[{"3", "\[Rule]", 
                    RowBox[{"{", "2", "}"}]}]}], "}"}]}]}], "]"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rdat", ",", "tdat"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue"}], "}"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1.075", ",", "0.85"}], "}"}], "*", "72"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"area", ">", "1"}], ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
                  "Automatic"}], "]"}], ",", "None"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "10", ",", "20", ",", "30"}], "}"}], ",", 
                "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}]}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"area", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$CMagFigureFields", ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VisualFieldContourPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"All", ",", "All", ",", "0"}], "}"}], ",", 
         RowBox[{"\"\<MagnificationWhite\>\"", "<>", "type"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Projection", "\[Rule]", "\"\<Predicted\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"VisualArea", "\[Rule]", "area"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<Magnification\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Contours", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "1", ",", "2", ",", "3", ",", "6", ",", "9", ",", "18", ",", 
            "27"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Range", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"area", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"type", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Radial\>\"", ",", "\"\<Tangential\>\""}], "}"}]}], 
        "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"$CMagFigure", ":=", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v123Figs", "=", "$CMagFigureV123Figs"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"lineFigs", "=", "$CMagFigureLines"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"fieldFigs", "=", "$CMagFigureFields"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"imsz", "=", 
           RowBox[{"{", 
            RowBox[{"3.25", ",", "4.6"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rows0", "=", 
              RowBox[{"{", 
               RowBox[{"0.97", ",", "0.78", ",", "0.39"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"r1dx", "=", "0.275"}], ",", 
             RowBox[{"r1x0", "=", "0.12"}], ",", "\[IndentingNewLine]", 
             RowBox[{"fsz", "=", 
              RowBox[{"0.8", "*", "72"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"fldtdy", "=", "0.11"}], ",", 
             RowBox[{"fldbdy", "=", 
              RowBox[{"0.1", "+", 
               RowBox[{"1", "/", 
                RowBox[{"imsz", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"sty", "=", 
              RowBox[{"Function", "@", 
               RowBox[{"Style", "[", 
                RowBox[{"##", ",", 
                 RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}]}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"Row", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"lineFigs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"r1x0", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.05", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"lineFigs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r1x0", "+", "r1dx"}], ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.05", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"lineFigs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r1x0", "+", 
                    RowBox[{"2", "*", "r1dx"}]}], ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.05", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"sty", "[", 
                    RowBox[{"\"\<C.Mag.\\n[mm/deg]\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Gray", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"sty", "[", 
                    RowBox[{"\"\<Eccentricity [deg]\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Gray", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.6", ",", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.145"}]}], "}"}], 
                    "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"sty", "[", 
                    RowBox[{"\"\<Radial\>\"", ",", 
                    RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.42", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"sty", "[", 
                    RowBox[{"\"\<Tangential\>\"", ",", 
                    RowBox[{"FontColor", "\[Rule]", "Blue"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.42", ",", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "0.025"}]}], "}"}], 
                    "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Rows", " ", "2", " ", "and", " ", "3"}], " ", "*)"}],
                "\[IndentingNewLine]", 
               RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "@", 
                  RowBox[{"List", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"#3", "-", "fldtdy"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.67"}], "}"}], "]"}], ",", "fsz"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"#3", "-", "fldbdy"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.33"}], "}"}], "]"}], ",", "fsz"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"#3", "-", "fldbdy"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.33"}], "}"}], "]"}], ",", "fsz"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#3"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"1", "*", "72"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "#3"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"1", "*", "72"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"sty", "[", "#4", "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "#3"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "1.25"}], "}"}], "]"}]}], "]"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"v123Figs", ",", "\[IndentingNewLine]", 
                   RowBox[{"Transpose", "[", "fieldFigs", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Radial\>\"", ",", "\"\<Tangential\>\""}], 
                    "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"y1", "=", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "fldtdy", "-", 
                    "0.075"}]}], ",", 
                   RowBox[{"y2", "=", 
                    RowBox[{
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "fldbdy", "-", 
                    "0.025"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"sty", "[", "\"\<V1\>\"", "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.38", ",", "y1"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"sty", "[", "\"\<V2\>\"", "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.26", ",", "y2"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"sty", "[", "\"\<V3\>\"", "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.51", ",", "y2"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "]"}]}], "]"}]}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "Labels", " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "@", 
                  RowBox[{"Text", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
                    RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#2"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\""}],
                     "}"}], ",", 
                   RowBox[{"rows0", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.05", ",", "0.05"}], "}"}]}]}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Add", " ", "a", " ", "legend", " ", "for", " ", 
                 "magnification"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Inset", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"DensityPlot", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"2", "^", "y"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", "0", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", "64"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", "$BaseStyle"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{"Function", "@", 
                    RowBox[{"Blend", "[", 
                    RowBox[{"$CMagBlendColors", ",", "#"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "7"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"0.3", "*", "72"}]}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"Frame", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\"\<1\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "\"\<4\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "\"\<16\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "\"\<64\>\""}], "}"}]}], "}"}], ",", 
                    "None"}], "}"}], ",", "None"}], "}"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.275"}], "}"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<C.Mag.\\n[mm/deg]\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", "$BaseStyle"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.805", ",", 
                    RowBox[{"rows0", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.15", ",", "1"}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], "}"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                   RowBox[{"imsz", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "72"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                   RowBox[{"imsz", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "72"}]}], "}"}]}], 
               "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"imsz", "*", "72"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparison of Errors", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Figure3A", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Figure3A", "[", "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"errs", "=", "$Figure3Errors"}], ",", "\[IndentingNewLine]", 
        RowBox[{"qfn", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", "=", "#1"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Quantile", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "t", "]"}], "[", "\"\<AbsAngle\>\"", 
                   "]"}], "[", "\"\<Mean\>\"", "]"}], ")"}], "&"}], "/@", 
               "#2"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "0.1", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.9"}], 
               "}"}]}], "]"}]}], "]"}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Training", " ", "time", " ", "versus", " ", "GoldStandard"}],
         ";", " ", 
        RowBox[{"prediction", " ", 
         RowBox[{"errors", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"trainingQs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"qfn", "[", 
              RowBox[{"\"\<Training\>\"", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{"errs", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"SubjectDatasets", "[", "#Subject", "]"}]}], 
                  "\[Equal]", "8"}], "&"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SubjectDatasetCoverage", "[", 
                RowBox[{"#Subject", ",", "#Dataset"}], "]"}], "&"}]}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"predictedQs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"qfn", "[", 
              RowBox[{"\"\<Predicted\>\"", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{"errs", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"SubjectDatasets", "[", "#Subject", "]"}]}], 
                  "\[Equal]", "8"}], "&"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SubjectDatasetCoverage", "[", 
                RowBox[{"#Subject", ",", "#Dataset"}], "]"}], "&"}]}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"anatomicalQs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"qfn", "[", 
              RowBox[{"\"\<Anatomical\>\"", ",", "#"}], "]"}], "&"}], "@", 
            RowBox[{"Select", "[", 
             RowBox[{"errs", ",", 
              RowBox[{
               RowBox[{"#Dataset", "\[Equal]", "1"}], "&"}]}], "]"}]}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"mark", "=", 
           RowBox[{"Function", "@", 
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"clr", "=", "#1"}], ",", 
                RowBox[{"x", "=", "#2"}], ",", "\[IndentingNewLine]", 
                RowBox[{"min", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"q1", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"mu", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                RowBox[{"q3", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], ",", 
                RowBox[{"max", "=", 
                 RowBox[{"#3", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"FaceForm", "@", 
                   RowBox[{"Lighter", "[", 
                    RowBox[{"clr", ",", "0.5"}], "]"}]}], ",", 
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Black"}], "}"}], "]"}], ",", 
                  RowBox[{"Rectangle", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "-", "0.06"}], ",", "q1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "0.06"}], ",", "q3"}], "}"}]}], "]"}]}],
                  "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"clr", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "min"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "max"}], "}"}]}], "}"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Darker", "[", "clr", "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "mu"}], "}"}], ",", "0.05"}], "]"}]}], 
                 "}"}]}], "}"}]}], "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"trainMdls", "=", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "c1", ",", "c2"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Function\>\"", "]"}], "&"}], "@", 
                  RowBox[{"NonlinearModelFit", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"5", ",", "10", ",", "15"}], "}"}], ",", 
                    RowBox[{"trainingQs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "k"}], "]"}], "]"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"c1", "+", 
                    RowBox[{"c2", "/", 
                    RowBox[{"(", "x", ")"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c2", ",", "1"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "x"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
                "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"predMdls", "=", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "c1", ",", "c2", ",", "c3"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Function\>\"", "]"}], "&"}], "@", 
                  RowBox[{"NonlinearModelFit", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "5", ",", "10", ",", "15"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"predictedQs", ",", "anatomicalQs"}], "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "k"}], "]"}], "]"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"c1", "+", 
                    RowBox[{"c2", "/", 
                    RowBox[{"(", 
                    RowBox[{"x", "+", "c3"}], ")"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c2", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c3", ",", "1"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "x"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
                "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"opts", "=", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"BaseStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"10", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], 
                   ",", 
                   RowBox[{"FontColor", "\[Rule]", "Black"}], ",", 
                   RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"FrameStyle", "\[Rule]", 
                 RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FrameTicksStyle", "\[Rule]", 
                 RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AspectRatio", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"2.6", "/", "3.25"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Axes", "\[Rule]", "None"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.15"}], ",", "3.5"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.5", ",", "6.5"}], "}"}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Frame", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<Error [deg]\>\"", ",", "None"}], "}"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"\"\<Scan Time [min]\>\"", ",", "None"}], "}"}]}],
                   "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"FrameTicks", "\[Rule]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6.5"}], "}"}]}], "]"}], ",", 
                    "None"}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "15"}], "}"}]}], "}"}], ",", "None"}], 
                    "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"3.25", ",", "2.6"}], "}"}], "*", "72"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Epilog", "\[Rule]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Data Alone\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], 
                    ",", 
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Prior Alone\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], 
                    ",", 
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Cyan", "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "0.965"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Data + Prior\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], 
                    ",", 
                    RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "0.93"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}]}], 
                  "}"}]}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"{", 
                RowBox[{"#2", ",", "#1", ",", "#2"}], "}"}], "]"}], "&"}], 
             "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Plot", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"trainMdls", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"trainMdls", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"trainMdls", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"predMdls", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"predMdls", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"predMdls", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                   RowBox[{"5", "*", "x"}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "0", ",", "3.5"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Gray"}], "}"}], ",", 
                   "Black", ",", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Gray"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Pink"}], "}"}], ",", 
                   "Red", ",", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Dotted", ",", "Pink"}], "}"}]}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Filling", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "3", "}"}]}], ",", 
                   RowBox[{"4", "\[Rule]", 
                    RowBox[{"{", "6", "}"}]}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FillingStyle", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "\[Rule]", 
                    RowBox[{"{", "LightGray", "}"}]}], ",", 
                   RowBox[{"4", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Lighter", "[", "Pink", "]"}], "}"}]}]}], "}"}]}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Sequence", "@@", "opts"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Join", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"mark", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"q", "-", "0.1"}], ",", 
                    RowBox[{"trainingQs", "[", 
                    RowBox[{"[", "q", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "1", ",", 
                    RowBox[{"Length", "[", "trainingQs", "]"}]}], "}"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"mark", "[", 
                    RowBox[{"Red", ",", 
                    RowBox[{"q", "+", "0.1"}], ",", 
                    RowBox[{"predictedQs", "[", 
                    RowBox[{"[", "q", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "1", ",", 
                    RowBox[{"Length", "[", "predictedQs", "]"}]}], "}"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"mark", "[", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Cyan", "]"}], ",", "0", ",", 
                    "anatomicalQs"}], "]"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.678447437397202*^9, 3.678447502656516*^9}, {
   3.6784477204978228`*^9, 3.678447722104545*^9}, 3.6784478010667057`*^9, {
   3.6784506014693623`*^9, 3.678450601582347*^9}, {3.678450661267316*^9, 
   3.678450663452986*^9}, {3.678450822871966*^9, 3.678450823928915*^9}, {
   3.678450961949649*^9, 3.678450965694807*^9}, {3.678451021505392*^9, 
   3.678451023916038*^9}, 3.678451908918456*^9, {3.6784536916423483`*^9, 
   3.6784537432464437`*^9}, {3.6784539800521107`*^9, 3.678454005164035*^9}, {
   3.67853855821218*^9, 3.67853857264153*^9}, {3.6785535507840242`*^9, 
   3.678553572732564*^9}, {3.678553605617709*^9, 3.678553710850422*^9}, {
   3.678553748706584*^9, 3.678553886182068*^9}, {3.678554487598859*^9, 
   3.6785545792078123`*^9}, {3.678554616538692*^9, 3.678554659014954*^9}, {
   3.678555371594223*^9, 3.6785553865447683`*^9}, {3.678629284351206*^9, 
   3.67862936731953*^9}, {3.678629443966283*^9, 3.6786294483348103`*^9}, {
   3.6792240610274143`*^9, 3.679224125162588*^9}, {3.679224190885645*^9, 
   3.679224200369505*^9}, {3.6792242336806307`*^9, 3.679224564199601*^9}, {
   3.6792246284450703`*^9, 3.679224634519559*^9}, {3.6792246969234657`*^9, 
   3.67922475589647*^9}, {3.679224807218706*^9, 3.679224812281686*^9}, {
   3.679224861580422*^9, 3.6792248903568077`*^9}, {3.6792249270770597`*^9, 
   3.67922503045407*^9}, {3.679225100801049*^9, 3.6792251171808777`*^9}, {
   3.679225223606892*^9, 3.679225228848297*^9}, {3.679225283681102*^9, 
   3.679225288710443*^9}, {3.679225374144335*^9, 3.6792254406567802`*^9}, {
   3.679225831306088*^9, 3.6792258383985643`*^9}, 3.679225977035716*^9, {
   3.679226061082136*^9, 3.6792260618244257`*^9}, {3.67922612551296*^9, 
   3.6792261514311523`*^9}, {3.679226256101145*^9, 3.6792263367204523`*^9}, {
   3.679226381619207*^9, 3.6792264179570713`*^9}, {3.679226525722636*^9, 
   3.679226614067854*^9}, {3.679226693339739*^9, 3.679226695307274*^9}, {
   3.679226867038313*^9, 3.679226945522768*^9}, {3.6792269953452187`*^9, 
   3.679227046948794*^9}, {3.679227127330412*^9, 3.679227154286316*^9}, {
   3.679227187091938*^9, 3.6792274235458193`*^9}, {3.679227529022277*^9, 
   3.6792275554192657`*^9}, {3.67922759796626*^9, 3.679227639502589*^9}, {
   3.679227686458837*^9, 3.679227749673504*^9}, {3.679227828616076*^9, 
   3.679227837975864*^9}, {3.679227883259861*^9, 3.67922789378793*^9}, {
   3.6792279240412083`*^9, 3.679228087176354*^9}, {3.6792281894072723`*^9, 
   3.679228235058805*^9}, {3.679228266109188*^9, 3.679228296101326*^9}, {
   3.6792283276377153`*^9, 3.679228382963073*^9}, {3.6937437250616302`*^9, 
   3.6937437269248753`*^9}, {3.693743764084549*^9, 3.693743794516171*^9}, {
   3.6937438457042227`*^9, 3.693743895632366*^9}, {3.693743926311962*^9, 
   3.693743978115574*^9}, {3.693744049580111*^9, 3.6937440907318296`*^9}, {
   3.693744336995523*^9, 3.693744438830381*^9}, {3.693744555696691*^9, 
   3.693744572165949*^9}, {3.693744971391428*^9, 3.6937450481899633`*^9}, {
   3.693745314536551*^9, 3.693745318166192*^9}, {3.693745407337947*^9, 
   3.6937454298726883`*^9}, {3.6937454974736967`*^9, 3.693745510826248*^9}, {
   3.693755239367272*^9, 3.693755260283176*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Figure3B", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Figure3B", "[", "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"errs", "=", "$Figure3Errors"}], ",", "\[IndentingNewLine]", 
        RowBox[{"dmd", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"Polygon", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{"0.09", ",", "0"}], "}"}]}], ",", 
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.09"}], "}"}]}], ",", 
             RowBox[{"#", "-", 
              RowBox[{"{", 
               RowBox[{"0.09", ",", "0"}], "}"}]}], ",", 
             RowBox[{"#", "-", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.09"}], "}"}]}]}], "}"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"tri", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"Polygon", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.1"}], "}"}]}], ",", 
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{"0.08", ",", 
                RowBox[{"-", "0.05"}]}], "}"}]}], ",", 
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.08"}], ",", 
                RowBox[{"-", "0.05"}]}], "}"}]}]}], "}"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"dsk", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"Disk", "[", 
           RowBox[{"#", ",", "0.07"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"wdg", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"Polygon", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "0.1"}]}], "}"}]}], ",", 
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{"0.08", ",", "0.05"}], "}"}]}], ",", 
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.08"}], ",", "0.05"}], "}"}]}]}], "}"}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"hbound", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"List", "[", "\[IndentingNewLine]", 
           RowBox[{"Thin", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{"#2", ",", 
                    RowBox[{"-", "0.2"}]}], "}"}]}], ",", 
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{"#2", ",", "0.2"}], "}"}]}]}], "}"}], "]"}], ","}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#1", "-", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", "0"}], "}"}]}], ",", 
               RowBox[{"#1", "+", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", "0"}], "}"}]}]}], "}"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{"#2", ",", 
                   RowBox[{"-", "0.2"}]}], "}"}]}], ",", 
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{"#2", ",", "0.2"}], "}"}]}]}], "}"}], "]"}]}], 
            "*)"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"vbound", "=", 
         RowBox[{"Function", "@", 
          RowBox[{"List", "[", "\[IndentingNewLine]", 
           RowBox[{"Thin", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.2"}], ",", "#2"}], "}"}]}], ",", 
                 RowBox[{"#1", "-", 
                  RowBox[{"{", 
                   RowBox[{"0.2", ",", "#2"}], "}"}]}]}], "}"}], "]"}], ","}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#1", "-", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "#2"}], "}"}]}], ",", 
               RowBox[{"#1", "+", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "#2"}], "}"}]}]}], "}"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.2"}], ",", "#2"}], "}"}]}], ",", 
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{"0.2", ",", "#2"}], "}"}]}]}], "}"}], "]"}]}], 
            "*)"}], "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"opts", "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"BaseStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"8", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
                RowBox[{"FontWeight", "\[Rule]", "\"\<Thin\>\""}], ",", 
                RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameStyle", "\[Rule]", 
              RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameTicksStyle", "\[Rule]", 
              RowBox[{"Darker", "[", "Gray", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "6"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Prolog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Dashed", ",", "Gray", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"6", ",", "6"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Epilog", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Text", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Prior Alone\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                    RowBox[{"FontColor", "\[Rule]", 
                    RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.33", ",", "1"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Text", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Data + Prior\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Red"}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.33", ",", "0.93"}], "}"}], "]"}], ",", 
                    RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}]}], "}"}]}],
                ","}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Pred. Error [deg]\>\"", ",", "None"}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Meas. Error [deg]\>\"", ",", "None"}], "}"}]}], 
               "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "\[Rule]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
                  "None"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
                  "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"1.3", "*", "72"}]}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"bySub", "=", 
           RowBox[{"Transpose", "/@", 
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"List", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Training\>\"", "]"}], "[", 
                   "\"\<AbsAngle\>\"", "]"}], "[", "\"\<Mean\>\"", "]"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Predicted\>\"", "]"}], "[", 
                   "\"\<AbsAngle\>\"", "]"}], "[", "\"\<Mean\>\"", "]"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "\"\<Anatomical\>\"", "]"}], "[", 
                   "\"\<AbsAngle\>\"", "]"}], "[", "\"\<Mean\>\"", "]"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"GatherBy", "[", 
               RowBox[{"errs", ",", 
                RowBox[{"#Subject", "&"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "2", "}"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"subShapes", "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                RowBox[{"dmd", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                RowBox[{"tri", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                RowBox[{"wdg", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "#1", "]"}], ",", 
                RowBox[{"FaceForm", "[", "White", "]"}], ",", 
                RowBox[{"dsk", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                RowBox[{"dmd", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                RowBox[{"tri", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                RowBox[{"wdg", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
                RowBox[{"FaceForm", "[", "#1", "]"}], ",", 
                RowBox[{"dsk", "[", "#2", "]"}]}], "}"}], "&"}]}], "}"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mu", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"sd", "=", 
                    RowBox[{"StandardDeviation", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}]}], "}"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
                   RowBox[{"hbound", "[", 
                    RowBox[{"mu", ",", 
                    RowBox[{"sd", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"bySub", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"mu", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"#1", "[", 
                  RowBox[{
                   RowBox[{"Darker", "[", "Cyan", "]"}], ",", "mu"}], "]"}]}],
                 "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"subShapes", ",", 
                RowBox[{"bySub", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "}"}]}],
              "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mu", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"sd", "=", 
                    RowBox[{"StandardDeviation", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}]}], "}"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"Red", ",", "\[IndentingNewLine]", 
                   RowBox[{"hbound", "[", 
                    RowBox[{"mu", ",", 
                    RowBox[{"sd", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"vbound", "[", 
                    RowBox[{"mu", ",", 
                    RowBox[{"sd", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", "bySub"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "@", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"mu", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"#1", "[", 
                  RowBox[{"Red", ",", "mu"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"subShapes", ",", "bySub"}], "}"}]}], "]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.678447727192141*^9, 3.6784477643104067`*^9}, {
   3.678449698181242*^9, 3.678449704725079*^9}, {3.6784497663682833`*^9, 
   3.6784498392631283`*^9}, {3.678449898142198*^9, 3.678449932186398*^9}, {
   3.678450174195571*^9, 3.678450178933539*^9}, {3.678450220551342*^9, 
   3.6784502212490273`*^9}, {3.678450259895447*^9, 3.678450299414605*^9}, 
   3.6784503520318193`*^9, {3.6784504714782248`*^9, 3.678450474935836*^9}, {
   3.678452026726959*^9, 3.678452086787936*^9}, {3.678452137355497*^9, 
   3.678452265398116*^9}, {3.678452304927443*^9, 3.6784525270496063`*^9}, {
   3.678452558854846*^9, 3.6784525791420183`*^9}, {3.6784526110711203`*^9, 
   3.678452651284445*^9}, {3.678452682951623*^9, 3.678452731182467*^9}, {
   3.6784535920801363`*^9, 3.678453663582059*^9}, 3.678453791862505*^9, {
   3.67846555935295*^9, 3.678465561938043*^9}, {3.678465781346094*^9, 
   3.678465856775749*^9}, {3.678465892125132*^9, 3.678465928976368*^9}, {
   3.67853860980768*^9, 3.678538615323326*^9}, {3.678538911748363*^9, 
   3.6785389872682533`*^9}, {3.678542991147149*^9, 3.678543008681514*^9}, {
   3.679221615334634*^9, 3.679221695552997*^9}, {3.679221823145776*^9, 
   3.6792218637240973`*^9}, {3.679221928244054*^9, 3.6792219862705317`*^9}, {
   3.679222017381568*^9, 3.679222409295958*^9}, {3.679222523764969*^9, 
   3.679222585211735*^9}, {3.6792230804957457`*^9, 3.679223091261978*^9}, {
   3.6792231635990877`*^9, 3.679223418850809*^9}, {3.6792235115967712`*^9, 
   3.679223511821352*^9}, 3.679223563144597*^9, {3.679223677266341*^9, 
   3.679223706661154*^9}, 3.6792254508391*^9, {3.6792255055333023`*^9, 
   3.679225508784429*^9}, {3.679225550144149*^9, 3.679225574045871*^9}, {
   3.6792256394470463`*^9, 3.6792257380371*^9}, {3.679225940211813*^9, 
   3.67922596127211*^9}, {3.6792259927728443`*^9, 3.679225995922266*^9}, {
   3.679226034955434*^9, 3.679226035230246*^9}, 3.679226118402821*^9, {
   3.679228505903804*^9, 3.679228508929717*^9}, {3.693744222356299*^9, 
   3.693744292085166*^9}, {3.693744877683741*^9, 3.6937448954126368`*^9}, {
   3.6937450717807703`*^9, 3.693745071891487*^9}, 3.693745441739493*^9, 
   3.693755264398698*^9, {3.6937553165741377`*^9, 3.6937553195687*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Figure3", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemoizeSafe", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Figure3", "[", "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w", "=", 
         RowBox[{"3.25", "*", "72"}]}], ",", 
        RowBox[{"h", "=", 
         RowBox[{"2.6", "*", "72"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"f3a", "=", 
         RowBox[{"Figure3A", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"f3b", "=", 
         RowBox[{"Figure3B", "[", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
       RowBox[{"f3a", ",", "\[IndentingNewLine]", 
        RowBox[{"1", "\[Rule]", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"f3a", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"Inset", "[", 
            RowBox[{"f3b", ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}], "]"}]}]}], 
       "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.678459074039095*^9, 3.678459087739608*^9}, {
   3.678459155186434*^9, 3.678459196545753*^9}, 3.678459232858127*^9, {
   3.679228534408744*^9, 3.679228807483553*^9}, {3.679228837948221*^9, 
   3.679228866028129*^9}, {3.69374554957959*^9, 3.6937455871995*^9}, {
   3.6937458129319143`*^9, 3.693745833068763*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{937, 781},
WindowMargins->{{Automatic, 303}, {Automatic, 120}},
TrackCellChangeTimes->False,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Chapter"], CellFrame -> {{False, False}, {False, True}}], 
   Cell[
    StyleData["Subchapter"], CellMargins -> {{48, Inherited}, {8, 20}}], 
   Cell[
    StyleData["Section"], CellFrame -> {{0, 0}, {0, 0}}, CellDingbat -> 
    "\[GraySquare]", CellMargins -> {{51, Inherited}, {8, 18}}, FontSize -> 
    24, FontColor -> 
    RGBColor[0.7529411764705882, 0.15294117647058825`, 
      0.12156862745098039`]]}, Visible -> False, FrontEndVersion -> 
  "11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, 2016)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 72, 3, 148, "Title"],
Cell[655, 27, 935, 34, 153, "Chapter"],
Cell[CellGroupData[{
Cell[1615, 65, 25, 0, 63, "Chapter"],
Cell[1643, 67, 499, 9, 144, "Text"],
Cell[CellGroupData[{
Cell[2167, 80, 34, 0, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[2226, 84, 31, 0, 55, "Section"],
Cell[2260, 86, 115, 2, 54, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[2412, 93, 24, 0, 41, "Section"],
Cell[2439, 95, 381, 6, 68, "Text"],
Cell[2823, 103, 2169, 50, 369, "Input"],
Cell[4995, 155, 93, 2, 30, "Text"],
Cell[5091, 159, 1892, 49, 285, "Input"],
Cell[6986, 210, 93, 1, 30, "Text"],
Cell[7082, 213, 597, 14, 117, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[7728, 233, 36, 0, 47, "Subchapter"],
Cell[7767, 235, 169, 3, 49, "Text"],
Cell[CellGroupData[{
Cell[7961, 242, 39, 0, 55, "Section"],
Cell[8003, 244, 2073, 53, 285, "Input"],
Cell[10079, 299, 116, 3, 30, "Text"],
Cell[10198, 304, 1600, 44, 214, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[11835, 353, 47, 0, 41, "Section"],
Cell[11885, 355, 141, 3, 30, "Text"],
Cell[12029, 360, 17024, 367, 2133, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[29090, 732, 50, 0, 41, "Section"],
Cell[29143, 734, 66, 0, 30, "Text"],
Cell[29212, 736, 420, 11, 75, "Input"],
Cell[29635, 749, 113, 3, 30, "Text"],
Cell[29751, 754, 1011, 27, 138, "Input"],
Cell[30765, 783, 223, 4, 49, "Text"],
Cell[30991, 789, 2863, 73, 432, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[33891, 867, 59, 0, 41, "Section"],
Cell[33953, 869, 10771, 236, 957, "Input"],
Cell[44727, 1107, 3118, 70, 369, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47894, 1183, 138, 2, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[48057, 1189, 143, 2, 55, "Section"],
Cell[CellGroupData[{
Cell[48225, 1195, 48, 0, 44, "Subsection"],
Cell[48276, 1197, 701, 19, 117, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49014, 1221, 165, 2, 36, "Subsection"],
Cell[49182, 1225, 4020, 104, 437, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[53239, 1334, 103, 1, 36, "Subsection"],
Cell[53345, 1337, 22378, 515, 3057, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[75760, 1857, 128, 1, 36, "Subsection"],
Cell[75891, 1860, 6152, 162, 551, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[82080, 2027, 37, 0, 36, "Subsection"],
Cell[82120, 2029, 119, 3, 30, "Text"],
Cell[82242, 2034, 691, 20, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[82970, 2059, 45, 0, 36, "Subsection"],
Cell[83018, 2061, 153, 3, 30, "Text"],
Cell[83174, 2066, 615, 16, 117, "Input"],
Cell[83792, 2084, 66, 0, 30, "Text"],
Cell[83861, 2086, 5751, 137, 621, "Input"],
Cell[89615, 2225, 8247, 193, 663, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[97911, 2424, 39, 0, 41, "Section"],
Cell[97953, 2426, 16402, 373, 1524, "Input"],
Cell[114358, 2801, 2432, 55, 327, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116827, 2861, 57, 0, 55, "Section"],
Cell[116887, 2863, 6186, 130, 537, "Input"],
Cell[123076, 2995, 8847, 207, 936, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[131960, 3207, 88, 2, 41, "Section"],
Cell[132051, 3211, 231, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[132307, 3219, 48, 0, 44, "Subsection"],
Cell[132358, 3221, 102, 2, 30, "Text"],
Cell[132463, 3225, 9646, 232, 1132, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[142146, 3462, 58, 0, 36, "Subsection"],
Cell[142207, 3464, 266, 5, 68, "Text"],
Cell[142476, 3471, 34652, 747, 2573, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[177165, 4223, 56, 0, 36, "Subsection"],
Cell[177224, 4225, 21828, 501, 2133, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[199089, 4731, 60, 0, 36, "Subsection"],
Cell[199152, 4733, 26018, 584, 1848, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[225207, 5322, 77, 0, 36, "Subsection"],
Cell[225287, 5324, 132, 3, 30, "Text"],
Cell[225422, 5329, 35774, 766, 3561, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[261269, 6103, 23, 0, 74, "Chapter"],
Cell[261295, 6105, 130, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[261450, 6112, 29, 0, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[261504, 6116, 41, 0, 55, "Section"],
Cell[261548, 6118, 30922, 684, 2511, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[292507, 6807, 39, 0, 41, "Section"],
Cell[292549, 6809, 25154, 528, 1839, "Input"],
Cell[317706, 7339, 23188, 519, 1797, "Input"],
Cell[340897, 7860, 1706, 40, 201, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

